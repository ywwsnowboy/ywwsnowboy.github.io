<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>R语言教程 | 既然选择了远方 便只顾风雨兼程</title><meta name="keywords" content="R语言,数据分析"><meta name="author" content="snowboy"><meta name="copyright" content="snowboy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本文主要内容为R语言笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="R语言教程">
<meta property="og:url" content="https://ywwsnowboy.github.io/2022/08/14/R/R%E8%AF%AD%E8%A8%80%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="既然选择了远方 便只顾风雨兼程">
<meta property="og:description" content="本文主要内容为R语言笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://vip2.loli.io/2023/03/13/4lsdSBFfeuRixYV.jpg">
<meta property="article:published_time" content="2022-08-14T14:53:28.000Z">
<meta property="article:modified_time" content="2023-03-15T12:14:21.617Z">
<meta property="article:author" content="snowboy">
<meta property="article:tag" content="R语言">
<meta property="article:tag" content="数据分析">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://vip2.loli.io/2023/03/13/4lsdSBFfeuRixYV.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://ywwsnowboy.github.io/2022/08/14/R/R%E8%AF%AD%E8%A8%80%E6%95%99%E7%A8%8B/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":888},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: snowboy","link":"链接: ","source":"来源: 既然选择了远方 便只顾风雨兼程","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'R语言教程',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-15 20:14:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">34</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 资源</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://vip2.loli.io/2023/03/13/4lsdSBFfeuRixYV.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">既然选择了远方 便只顾风雨兼程</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 资源</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">R语言教程</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-14T14:53:28.000Z" title="发表于 2022-08-14 22:53:28">2022-08-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-15T12:14:21.617Z" title="更新于 2023-03-15 20:14:21">2023-03-15</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">59.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>291分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="R语言教程"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>R语言教程</h1>
<p>数据：是指对客观事件进行记录并可以鉴别的符号，是对客观事物的性质、状态以及相互关系等进行记载的物理符号或这些物理符号的组合。</p>
<p>R语言的特点：</p>
<p>1、有效的数据处理和保存机制：<br>
2、拥有一整套数组和矩阵的操作运算符。<br>
3、一系列连贯而又完整的数据分析中间工具。<br>
4、图形统计可以对数据直接进行分析和显示，可用于多种图形设备。<br>
5、一种相当完善、简洁和高效的程序设计语言。<br>
6、R语言是彻底面向对象的统计编程语言。<br>
7、R语言和其它编程语言、数据库之间有很好的接口。<br>
8、语言是自由软件，可以放心大胆地使用，但其功能却不比任何其它同类软件差。<br>
9、R语言具有丰富的网上资源。</p>
<p>R语言官网：httpsmmmmmmmmmfadsfa://www.r-project.org/</p>
<p>推荐书籍：《R语言实战》</p>
<p>常用快捷键：Ctrl + L 清空终端</p>
<h2 id="R语言基础">R语言基础</h2>
<h3 id="1-1-R语言的基本功能">1.1 R语言的基本功能</h3>
<p>在Linux系统中，R语言中可以通过以下命令启动R软件</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> R</span><br></pre></td></tr></table></figure>
<p>可以通过以下命令来查找每个命令如何使用：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> R <span class="operator">-</span><span class="operator">-</span>help</span><br></pre></td></tr></table></figure>
<p>通过以下命令可以获取当前目录：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> getwd<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>可以通过<code>Rprofile.site</code>对R软件进行全局设置，<code>Rprofile.site</code>文件地址为<code>D:\R\R-4.2.1\etc</code>，这个文件中通过 # 进行注释，可以在最后通过<code>.First()</code>或者<code>.Last()</code>，当开始运行R软件时会执行<code>.First()</code>中的内容，当关闭R软件时执行<code>.Last()</code>中的内容。</p>
<p><code>.First()</code>中可以是常用的库，也可以是自己编写的常用函数的源代码文件。</p>
<p><code>.Last()</code>中可以是保存程序输出或者保存数据文件等。</p>
<p>在Rstudio软件中在命令后加括号进行区分对象和函数，R语法中对象可以是常量、变量，也可以是函数等等，函数必须加括号，便于区分。</p>
<p>可以通过<code>setwd</code>命令设定工作空间（这里是斜线，不是windows的反斜线）：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> setwd<span class="punctuation">(</span>dir <span class="operator">=</span> <span class="string">&quot;f:/Code/Code_R/R_proj_01&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>可以通过<code>list.files()</code>命令查看当前目录下的文件：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> list.files<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>R中不需要进行变量申明，可以进行变量赋值和计算，但是变量名不能以数字开头。</p>
<p>在终端中有以下三种赋值方式：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> 3</span><br><span class="line"><span class="operator">&gt;</span> <span class="number">6</span> <span class="operator">-&gt;</span> y</span><br><span class="line"><span class="operator">&gt;</span> z <span class="operator">=</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>通过<code>xx &lt;&lt;- 9</code>命令对全局变量进行强制赋值：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> xx <span class="operator">&lt;&lt;-</span> <span class="number">9</span></span><br></pre></td></tr></table></figure>
<p>在终端中通过<code>ls()</code>可以列出当前工作空间的变量：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> ls<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><code>ls()</code>命令是无法看到隐藏文件（以<code>.</code>开头的文件）的。可以通过以下命令查看所有文件（包括隐藏文件）：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> ls<span class="punctuation">(</span>all.names <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>在终端中通过<code>list.files()</code>命令列出当前文件夹下的文件：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> list.files<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>删除变量通过<code>rm</code>命令，如下所示，分别为删除单个变量、多个变量和所有变量：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> rm<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> rm<span class="punctuation">(</span>y<span class="punctuation">,</span> z<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>通过<code>Ctrl + L</code>将终端所有代码清屏。</p>
<p>为了避免电脑死机，通过<code>save.image()</code>保存工作空间：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> save.image<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>在终端中输入<code>q()</code>退出软件：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> q<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>相应的操作结果图如下：</p>
<p><img src="https://vip2.loli.io/2023/03/13/i2rYRenNz57QZGT.png" alt="image-20220803214112394"></p>
<p><img src="https://vip2.loli.io/2023/03/13/wQgrjlSt95nzNb4.png" alt="image-20220803214848744"></p>
<p>R表达式中常用的符号：</p>
<p><img src="https://vip2.loli.io/2023/03/13/Vmd6DjQlEigsfqZ.png" alt="image-20220812152701385"></p>
<h3 id="1-2-R包的安装">1.2 R包的安装</h3>
<p>R包的安装：<br>
<img src="https://vip2.loli.io/2023/03/13/g4FI5OWJcnP8wd9.png" alt="image-20220804084814106"></p>
<p>推荐使用在线安装的方式，可以自动安装需要的依赖包。</p>
<p>R中使用字符串要加引号，不加引号会将字符串当作对象处理，程序找不到对象就会报错：</p>
<p>错误用法：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> install.packages<span class="punctuation">(</span>vcd<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>正确用法：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> install.packages<span class="punctuation">(</span><span class="string">&quot;vcd&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 也可以一次性安装多个包</span></span><br><span class="line"><span class="operator">&gt;</span> install.packages<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;tidyr&quot;</span><span class="punctuation">,</span> <span class="string">&quot;dplyr&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/OpDRtd8IXQkwhCn.png" alt="image-20220804085636176"></p>
<p>可以通过以下命令查看库所在的位置：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> .libPaths<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>也可以通过以下命令查看库中所有的包：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果想一次安装多个包，可以通过以下命令：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> install.packages<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;AER&quot;</span><span class="punctuation">,</span><span class="string">&quot;ca&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>使用<code>update.packages()</code>命令可以更新安装的软件包：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> update.packages<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="1-3-R包的使用">1.3 R包的使用</h3>
<p>下载安装完包后，载入包就不需要引号了，如下：</p>
<p>正确用法：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>vcd<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>或者通过<code>require</code>加载包：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> require<span class="punctuation">(</span>vcd<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>R软件自带的包有：base，datasets，utils，grDevices，graphics，stats，methods，splines，stats4，tcltk</p>
<p>base：R基础功能相关的函数</p>
<p>datasets：存放R内置的数据集</p>
<p>grDevices：基于grid绘图相关的设备</p>
<p>graphics：基于base图形的R函数，R的绘图函数都在这个包中</p>
<p>methods：R语言一般的定义方法和类</p>
<p>这些包提供了种类繁多的函数和数据集，这些包集合在一起构成了R软件。</p>
<p>通过帮助文档进行R包的学习和使用：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> help<span class="punctuation">(</span>package <span class="operator">=</span> <span class="string">&quot;vcd&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>也可以通过以下命令查看包的基础信息：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>help <span class="operator">=</span> <span class="string">&quot;vcd&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>可以通过<code>ls(&quot;package:函数包名&quot;)</code>查看包的所有函数，例如：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> ls<span class="punctuation">(</span><span class="string">&quot;package:vcd&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>可以通过<code>data(&quot;package:函数包名&quot;)</code>查看包的所有数据集，例如：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> data<span class="punctuation">(</span><span class="string">&quot;package:vcd&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>可以通过<code>detach(&quot;package:函数包名&quot;)</code>移除加载的包，例如：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> detach<span class="punctuation">(</span><span class="string">&quot;package:vcd&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/cpHMjX4SDNw7R6v.png" alt="image-20220804094804931"></p>
<p>可以通过<code>remove.packages</code>函数彻底删除包：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> remove.packages<span class="punctuation">(</span><span class="string">&quot;vcd&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>将R包迁移到新设备，通过以下步骤进行操作</strong>：</p>
<ol>
<li>列出当前环境已安装的包</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> installed.packages<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>取第1列，即所有包的名字，并保存给变量<code>Rpack</code></li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> Rpack <span class="operator">&lt;-</span> installed.packages<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>将所有的包保存到<code>Rpack.Rdata</code>文件中</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> save<span class="punctuation">(</span>Rpack<span class="punctuation">,</span>file<span class="operator">=</span><span class="string">&quot;Rpack.Rdata&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>将<code>Rpack.Rdata</code>文件移入新设备，在新设备上R软件终端中通过以下命令安装R包：</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="keyword">for</span><span class="punctuation">(</span>i <span class="keyword">in</span> Rpack<span class="punctuation">)</span> install.packages<span class="punctuation">(</span>i<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>即使新设备已经安装了包，R会自动跳过已经安装的包。</p>
<h3 id="1-4-获取帮助">1.4 获取帮助</h3>
<p>R软件的帮助文档可以通过help命令进行查看：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> help.start<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>或者通过菜单栏中的<code>help</code>进行查看。</p>
<p><img src="https://vip2.loli.io/2023/03/13/GEcAZptY5wNvWgf.png" alt="image-20220804134719699"></p>
<p>示例：在终端中</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> help<span class="punctuation">(</span><span class="built_in">sum</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>或者<code>?</code>也可以：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="operator">?</span><span class="built_in">sum</span></span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<p><img src="https://vip2.loli.io/2023/03/13/QYNkfedgmvR8qCO.png" alt="image-20220804135001239"></p>
<p>如果想直接了解函数中的参数，可以通过<code>args</code>函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> args<span class="punctuation">(</span>plot<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>在帮助文档中可以根据example中示例进行学习，也可以在终端中输入<code>example</code>进行实例展示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> example<span class="punctuation">(</span><span class="string">&quot;mean&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>也可以通过以下命令展示绘图demo：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> demo<span class="punctuation">(</span>graphics<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果想查看某个包的帮助文档，可以通过如下命令：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> help<span class="punctuation">(</span>package<span class="operator">=</span>vcd<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>有些R包包含vignette文档，这个文档包含简介，教程文档等，但也并不是所有的包都有：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> vignette<span class="punctuation">(</span><span class="string">&quot;xts&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>有时候明明已经安装了包，但是<code>help</code>搜索不到相应的函数，这是因为相关的包并没有加载，需要通过<code>library</code>进行加载，如果不加载，可以通过以下方式搜索：</p>
<ol>
<li>
<p>通过包的名字：<code>help(package = vcd)</code></p>
</li>
<li>
<p>需要通过双问号命令进行搜索，例如：</p>
</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="operator">?</span><span class="operator">?</span>qplot</span><br></pre></td></tr></table></figure>
<p>有些情况下不知道函数名，可以通过<code>help.search</code>进行本地模糊搜索：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> help.search<span class="punctuation">(</span><span class="string">&quot;heatmap&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>这里的<code>help.search</code>可以通过<code>??</code>来简写：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="operator">?</span><span class="operator">?</span>heatmap</span><br></pre></td></tr></table></figure>
<p>apropos函数可以列出所有包含关键字的内容，例如：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> apropos<span class="punctuation">(</span><span class="string">&quot;sum&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>apropos函数也可以限定搜索范围，比如仅仅对函数进行搜索：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> apropos<span class="punctuation">(</span><span class="string">&quot;sum&quot;</span><span class="punctuation">,</span>mod<span class="operator">=</span><span class="string">&quot;function&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>也可以通过<code>RSiteSearch</code>进行官网搜索：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> RSiteSearch<span class="punctuation">(</span><span class="string">&quot;matlab&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>==注意==：<code>help.search</code>为本地搜索</p>
<p>也可以通过 <a target="_blank" rel="noopener" href="https://rseek.org/">https://rseek.org/</a> 进行搜索，前提是要能够使用Google搜索。</p>
<h3 id="1-5-内置数据集">1.5 内置数据集</h3>
<p>R软件内置数据集存放在datasets中，某人加载这个包。</p>
<p>可以通过help查看数据集的具体内容：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> help<span class="punctuation">(</span><span class="string">&quot;mtcars&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>可以将一些数据组成数据框，示例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> state <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>state.name<span class="punctuation">,</span>state.abb<span class="punctuation">,</span>state.area<span class="punctuation">,</span>state.division<span class="punctuation">,</span>state.region<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> state</span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/7VElopxwPv18OhX.png" alt="image-20220804154517960"></p>
<p>有些数据集可以绘制对应的热图：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> heatmap<span class="punctuation">(</span>volcano<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>可以通过如下操作查看某个包中的数据集：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> data<span class="punctuation">(</span>package<span class="operator">=</span><span class="string">&quot;MASS&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>可以通过如下操作查看R软件中所有数据集（包括自己安装的包的数据集）：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> data<span class="punctuation">(</span>package<span class="operator">=</span>.packages<span class="punctuation">(</span>all.available <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果不想加载某个数据集，但是想用其数据集，可以通过以下命令（Chile为数据集，car为包名）：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> data<span class="punctuation">(</span>Chile<span class="punctuation">,</span>package<span class="operator">=</span><span class="string">&quot;car&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h2 id="2-数据结构">2 数据结构</h2>
<p>R语言中最重要的概念是对象。</p>
<p>对象：object，它是指可以赋值给变量的任何事物，包括常量、数据结构、函数，甚至图形。对象都拥有某个模式，描述了此对象是如何存储的，以及某个类。</p>
<h3 id="2-1-向量">2.1 向量</h3>
<p>向量，vector，是R中最重要的一个概念，它是构成其他数据结构的基础。R中的向量概念与数学中向量是不同的，类似于数学上的集合的概念，由一个或多个元素构成。</p>
<p>向量其实是用于存储数值型、字符型或逻辑型数据结构的一维数组。</p>
<p>用函数c来创建向量。c代表concatenate连接，也可以理解为收集collect，或者合并combine，例如：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>这里的x就是向量，也可以称为对象。</p>
<p>在R语言中字符串要加引号，如果不加引号，就会把字符串当成对象。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> y <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;one&quot;</span><span class="punctuation">,</span><span class="string">&quot;two&quot;</span><span class="punctuation">,</span><span class="string">&quot;three&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>对于逻辑型变量用TRUE、FALSE、T、F进行表示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> z <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">TRUE</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>不能够用首字母大写的模式，如 True 或 False。</p>
<p>用冒号构建等差数列：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">100</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果想调整等差数列的差值，可以通过seq函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> seq<span class="punctuation">(</span>from<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>to<span class="operator">=</span><span class="number">100</span><span class="punctuation">,</span>by<span class="operator">=</span><span class="number">2</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果想等差生成10个值，可以通过如下方式：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> seq<span class="punctuation">(</span>from<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>to<span class="operator">=</span><span class="number">100</span><span class="punctuation">,</span>length.out<span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果想要输出重复的数值，可以通过rep函数，比如重复5次2：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>还有其他用法：x = 1 2 3 4 5</p>
<p>将x向量依次重复5次：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">rep</span><span class="punctuation">(</span>x<span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>输出：1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5</p>
<p>将x向量每个元素重复5次：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">rep</span><span class="punctuation">(</span>x<span class="punctuation">,</span>each<span class="operator">=</span><span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>输出：1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 4 4 4 4 4 5 5 5 5 5</p>
<p>将x向量每个元素依次重复五次，并执行两次：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">rep</span><span class="punctuation">(</span>x<span class="punctuation">,</span>each<span class="operator">=</span><span class="number">5</span><span class="punctuation">,</span>times<span class="operator">=</span><span class="number">2</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>输出：1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 4 4 4 4 4 5 5 5 5 5 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 4 4 4 4 4 5 5 5 5 5</p>
<p>示例：</p>
<p><img src="https://vip2.loli.io/2023/03/13/Bw5dmfYPoKODkGj.png" alt="image-20220805174639683"></p>
<p>向量的数据类型都是同一类型，都是数值型或者字符型。如果不是同一类型，会自动将其转换为同一类型：</p>
<p><img src="https://vip2.loli.io/2023/03/13/wFL3vBG4VQXAu7P.png" alt="image-20220805175541547"></p>
<p>通过如果想要查看变量的类型，可以通过<code>mode</code>函数进行查看。</p>
<p>如果想要提取出x中大于3的值：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x<span class="punctuation">[</span>x<span class="operator">&gt;</span><span class="number">3</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>输出：4 5</p>
<p>例如前面的重复，也可以进行批量处理：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">rep</span><span class="punctuation">(</span>x<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>输出：1 1 2 2 2 2 3 3 3 3 3 3 4 5 5 5</p>
<h3 id="2-2-向量索引">2.2 向量索引</h3>
<p>可以用<code>length</code>统计向量的长度，R中元素序列是从0开始。</p>
<p><code>x[-19]</code>表示不显示第19个数值。</p>
<p><code>x[c(1,23,45,67,89)]</code>表示输出对应位置的数值</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> y <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> y<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">7</span>  <span class="number">9</span></span><br><span class="line"><span class="operator">&gt;</span> y<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span> <span class="number">3</span> <span class="number">5</span> <span class="number">7</span> <span class="number">9</span></span><br><span class="line"><span class="operator">&gt;</span> y<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span> <span class="number">3</span> <span class="number">5</span> <span class="number">7</span> <span class="number">9</span></span><br><span class="line"><span class="operator">&gt;</span> y<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>  <span class="number">4</span>  <span class="number">7</span> <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> y<span class="punctuation">[</span>y<span class="operator">&gt;</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> y<span class="punctuation">[</span>y<span class="operator">&gt;</span><span class="number">5</span> <span class="operator">&amp;</span> y<span class="operator">&lt;</span><span class="number">9</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">6</span> <span class="number">7</span> <span class="number">8</span></span><br><span class="line"><span class="operator">&gt;</span> z <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;one&quot;</span><span class="punctuation">,</span><span class="string">&quot;two&quot;</span><span class="punctuation">,</span><span class="string">&quot;three&quot;</span><span class="punctuation">,</span><span class="string">&quot;four&quot;</span><span class="punctuation">,</span><span class="string">&quot;five&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> z</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="string">&quot;one&quot;</span>   <span class="string">&quot;two&quot;</span>   <span class="string">&quot;three&quot;</span> <span class="string">&quot;four&quot;</span>  <span class="string">&quot;five&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="string">&quot;one&quot;</span> <span class="operator">%in%</span> z</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="literal">TRUE</span></span><br><span class="line"><span class="operator">&gt;</span> z<span class="punctuation">[</span>z <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;one&quot;</span><span class="punctuation">,</span><span class="string">&quot;two&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="string">&quot;one&quot;</span> <span class="string">&quot;two&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> z <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;one&quot;</span><span class="punctuation">,</span><span class="string">&quot;two&quot;</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="literal">TRUE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="operator">&gt;</span> k <span class="operator">&lt;-</span> z <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;one&quot;</span><span class="punctuation">,</span><span class="string">&quot;two&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> z<span class="punctuation">[</span>k<span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="string">&quot;one&quot;</span> <span class="string">&quot;two&quot;</span></span><br></pre></td></tr></table></figure>
<p>也可以通过names函数对变量进行命名：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> y <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">,</span><span class="number">9</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> y</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">names</span><span class="punctuation">(</span>y<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;one&quot;</span><span class="punctuation">,</span><span class="string">&quot;two&quot;</span><span class="punctuation">,</span><span class="string">&quot;three&quot;</span><span class="punctuation">,</span><span class="string">&quot;four&quot;</span><span class="punctuation">,</span><span class="string">&quot;five&quot;</span><span class="punctuation">,</span><span class="string">&quot;six&quot;</span><span class="punctuation">,</span><span class="string">&quot;seven&quot;</span><span class="punctuation">,</span><span class="string">&quot;eight&quot;</span><span class="punctuation">,</span><span class="string">&quot;nine&quot;</span><span class="punctuation">,</span><span class="string">&quot;ten&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> y</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   one   two three  four  five   six seven eight  nine   ten </span><br><span class="line"> <span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span>     <span class="number">1</span>     <span class="number">2</span>     <span class="number">3</span>     <span class="number">4</span>     <span class="number">5</span>     <span class="number">6</span>     <span class="number">7</span>     <span class="number">8</span>     <span class="number">9</span>    <span class="number">10</span> </span><br><span class="line"><span class="operator">&gt;</span> y<span class="punctuation">[</span><span class="string">&quot;two&quot;</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   two </span><br><span class="line"> <span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span>   <span class="number">2</span> </span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/Y1AriO65Vt2GQn3.png" alt="image-20220805222807259"></p>
<p>添加和删除元素：x为1到100的向量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x<span class="punctuation">[</span><span class="number">101</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">101</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span>  <span class="number">24</span>  <span class="number">25</span>  <span class="number">26</span>  <span class="number">27</span>  <span class="number">28</span>  <span class="number">29</span>  <span class="number">30</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span>  <span class="number">31</span>  <span class="number">32</span>  <span class="number">33</span>  <span class="number">34</span>  <span class="number">35</span>  <span class="number">36</span>  <span class="number">37</span>  <span class="number">38</span>  <span class="number">39</span>  <span class="number">40</span>  <span class="number">41</span>  <span class="number">42</span>  <span class="number">43</span>  <span class="number">44</span>  <span class="number">45</span>  <span class="number">46</span>  <span class="number">47</span>  <span class="number">48</span>  <span class="number">49</span>  <span class="number">50</span>  <span class="number">51</span>  <span class="number">52</span>  <span class="number">53</span>  <span class="number">54</span>  <span class="number">55</span>  <span class="number">56</span>  <span class="number">57</span>  <span class="number">58</span>  <span class="number">59</span>  <span class="number">60</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">61</span><span class="punctuation">]</span>  <span class="number">61</span>  <span class="number">62</span>  <span class="number">63</span>  <span class="number">64</span>  <span class="number">65</span>  <span class="number">66</span>  <span class="number">67</span>  <span class="number">68</span>  <span class="number">69</span>  <span class="number">70</span>  <span class="number">71</span>  <span class="number">72</span>  <span class="number">73</span>  <span class="number">74</span>  <span class="number">75</span>  <span class="number">76</span>  <span class="number">77</span>  <span class="number">78</span>  <span class="number">79</span>  <span class="number">80</span>  <span class="number">81</span>  <span class="number">82</span>  <span class="number">83</span>  <span class="number">84</span>  <span class="number">85</span>  <span class="number">86</span>  <span class="number">87</span>  <span class="number">88</span>  <span class="number">89</span>  <span class="number">90</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">91</span><span class="punctuation">]</span>  <span class="number">91</span>  <span class="number">92</span>  <span class="number">93</span>  <span class="number">94</span>  <span class="number">95</span>  <span class="number">96</span>  <span class="number">97</span>  <span class="number">98</span>  <span class="number">99</span> <span class="number">100</span> <span class="number">101</span></span><br></pre></td></tr></table></figure>
<p>还可以通过以下方式添加向量：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> v <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> v</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> v<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> v</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></span><br><span class="line"><span class="operator">&gt;</span> v<span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> v</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span>  <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> append<span class="punctuation">(</span>x <span class="operator">=</span> v<span class="punctuation">,</span> values <span class="operator">=</span> <span class="number">99</span><span class="punctuation">,</span> after <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span> <span class="number">99</span>  <span class="number">6</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span>  <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> append<span class="punctuation">(</span>x <span class="operator">=</span> v<span class="punctuation">,</span> values <span class="operator">=</span> <span class="number">88</span><span class="punctuation">,</span> after <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">88</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span>  <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>如果想要删除某个元素：</p>
<p>方法一：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm<span class="punctuation">(</span>v<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>方法二：通过不显示想删除的部分，然后赋值给自身就相当于删除部分元素了</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y <span class="operator">&lt;-</span> y<span class="punctuation">[</span><span class="operator">-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>如果想替换某个元素：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y<span class="punctuation">[</span><span class="string">&quot;four&quot;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">100</span></span><br></pre></td></tr></table></figure>
<p>不能够将字符串赋值给数值，否则都会变成字符串。</p>
<h3 id="2-3-向量运算">2.3 向量运算</h3>
<p>向量的基本用法：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> x<span class="operator">+</span><span class="number">1</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span></span><br><span class="line"><span class="operator">&gt;</span> x<span class="operator">-</span><span class="number">3</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">2</span> <span class="operator">-</span><span class="number">1</span>  <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span></span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> x<span class="operator">+</span><span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>+</code>为给所有元素相加某一值</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span></span><br><span class="line"><span class="operator">&gt;</span> y <span class="operator">&lt;-</span> seq<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">,</span>length.out <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> y</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>  <span class="number">12</span>  <span class="number">23</span>  <span class="number">34</span>  <span class="number">45</span>  <span class="number">56</span>  <span class="number">67</span>  <span class="number">78</span>  <span class="number">89</span> <span class="number">100</span></span><br><span class="line"><span class="operator">&gt;</span> x<span class="operator">*</span>y</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>    <span class="number">2</span>   <span class="number">36</span>   <span class="number">92</span>  <span class="number">170</span>  <span class="number">270</span>  <span class="number">392</span>  <span class="number">536</span>  <span class="number">702</span>  <span class="number">890</span> <span class="number">1100</span></span><br><span class="line"><span class="operator">&gt;</span> x<span class="operator">**</span><span class="number">2</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">4</span>   <span class="number">9</span>  <span class="number">16</span>  <span class="number">25</span>  <span class="number">36</span>  <span class="number">49</span>  <span class="number">64</span>  <span class="number">81</span> <span class="number">100</span> <span class="number">121</span></span><br><span class="line"> <span class="operator">&gt;</span> x<span class="operator">^</span><span class="number">2</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">4</span>   <span class="number">9</span>  <span class="number">16</span>  <span class="number">25</span>  <span class="number">36</span>  <span class="number">49</span>  <span class="number">64</span>  <span class="number">81</span> <span class="number">100</span> <span class="number">121</span></span><br><span class="line"><span class="operator">&gt;</span> x<span class="operator">%%</span>y</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">0</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span></span><br><span class="line"><span class="operator">&gt;</span> x<span class="operator">%/%</span><span class="number">5</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>*</code>为元素相乘符，<code>**</code>和<code>^</code>均为幂运算，<code>%%</code>为取余符号，<code>%/%</code>为整除符号。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> z <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> z</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span></span><br><span class="line"><span class="operator">&gt;</span> x<span class="operator">+</span>z</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">5</span>  <span class="number">7</span>  <span class="number">7</span>  <span class="number">9</span>  <span class="number">9</span> <span class="number">11</span> <span class="number">11</span> <span class="number">13</span></span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> x<span class="operator">+</span>z</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">4</span> <span class="number">4</span></span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line">In x <span class="operator">+</span> z <span class="operator">:</span> longer object <span class="built_in">length</span> is not a multiple of shorter object <span class="built_in">length</span></span><br></pre></td></tr></table></figure>
<p>总结：长的向量和短的向量相加，长的向量中元素个数必须为短的向量个数的整数倍。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> y <span class="operator">&lt;-</span> seq<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">,</span>length.out <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> y</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>  <span class="number">12</span>  <span class="number">23</span>  <span class="number">34</span>  <span class="number">45</span>  <span class="number">56</span>  <span class="number">67</span>  <span class="number">78</span>  <span class="number">89</span> <span class="number">100</span></span><br><span class="line"><span class="operator">&gt;</span> x<span class="operator">&gt;</span><span class="number">5</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span></span><br><span class="line"><span class="operator">&gt;</span> x<span class="operator">&gt;</span>y</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line"> <span class="operator">&gt;</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span> <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> y</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>  <span class="number">12</span>  <span class="number">23</span>  <span class="number">34</span>  <span class="number">45</span>  <span class="number">56</span>  <span class="number">67</span>  <span class="number">78</span>  <span class="number">89</span> <span class="number">100</span></span><br><span class="line"><span class="operator">&gt;</span> x<span class="operator">==</span>y</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line"> <span class="operator">&gt;</span> x <span class="operator">&lt;-</span> <span class="operator">-</span><span class="number">5</span><span class="operator">:</span><span class="number">5</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">5</span> <span class="operator">-</span><span class="number">4</span> <span class="operator">-</span><span class="number">3</span> <span class="operator">-</span><span class="number">2</span> <span class="operator">-</span><span class="number">1</span>  <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">abs</span><span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">sqrt</span><span class="punctuation">(</span><span class="number">25</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">log</span><span class="punctuation">(</span><span class="number">16</span><span class="punctuation">,</span>base <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">log</span><span class="punctuation">(</span><span class="number">16</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2.772589</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">log</span><span class="punctuation">(</span><span class="number">16</span><span class="punctuation">,</span>base <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1.20412</span></span><br><span class="line"><span class="operator">&gt;</span> log10<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">5</span> <span class="operator">-</span><span class="number">4</span> <span class="operator">-</span><span class="number">3</span> <span class="operator">-</span><span class="number">2</span> <span class="operator">-</span><span class="number">1</span>  <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">exp</span><span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6.737947e-03</span> <span class="number">1.831564e-02</span> <span class="number">4.978707e-02</span> <span class="number">1.353353e-01</span> <span class="number">3.678794e-01</span> <span class="number">1.000000e+00</span> <span class="number">2.718282e+00</span> <span class="number">7.389056e+00</span> <span class="number">2.008554e+01</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="number">5.459815e+01</span> <span class="number">1.484132e+02</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">ceiling</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">2.3</span><span class="punctuation">,</span><span class="number">3.1415</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">2</span>  <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">floor</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">2.3</span><span class="punctuation">,</span><span class="number">3.1415</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">3</span>  <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">trunc</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">2.3</span><span class="punctuation">,</span><span class="number">3.1415</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">2</span>  <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">2.3</span><span class="punctuation">,</span><span class="number">3.1415</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">2</span>  <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">2.3</span><span class="punctuation">,</span><span class="number">3.1415</span><span class="punctuation">)</span><span class="punctuation">,</span>digits <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">2.30</span>  <span class="number">3.14</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">signif</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">2.3</span><span class="punctuation">,</span><span class="number">3.1415</span><span class="punctuation">)</span><span class="punctuation">,</span>digits <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">2.3</span>  <span class="number">3.1</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">sin</span><span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">0.9589243</span>  <span class="number">0.7568025</span> <span class="operator">-</span><span class="number">0.1411200</span> <span class="operator">-</span><span class="number">0.9092974</span> <span class="operator">-</span><span class="number">0.8414710</span>  <span class="number">0.0000000</span>  <span class="number">0.8414710</span>  <span class="number">0.9092974</span>  <span class="number">0.1411200</span> <span class="operator">-</span><span class="number">0.7568025</span> <span class="operator">-</span><span class="number">0.9589243</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">cos</span><span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">0.2836622</span> <span class="operator">-</span><span class="number">0.6536436</span> <span class="operator">-</span><span class="number">0.9899925</span> <span class="operator">-</span><span class="number">0.4161468</span>  <span class="number">0.5403023</span>  <span class="number">1.0000000</span>  <span class="number">0.5403023</span> <span class="operator">-</span><span class="number">0.4161468</span> <span class="operator">-</span><span class="number">0.9899925</span> <span class="operator">-</span><span class="number">0.6536436</span>  <span class="number">0.2836622</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>log(x)</code>默认为以常数e为底的自然对数，<code>log10(x)</code>为以10为底的对数，<code>log(16,base = 10)</code>为以10为底的10的对数，<code>exp</code>表示以e为底的指数，<code>ceiling</code>为大于给定值的最小整数，<code>floor</code>为小于给定值的最大整数，<code>trunc</code>为给定值的整数部分，<code>round</code>为给定值四舍五入，默认为整数，如果设定值<code>digits</code>为2，则为保留两个小数。<code>signif</code>和<code>round</code>功能类似，如果<code>digits</code>为2时，表示保留两位有效数字，<code>sin</code>和<code>cos</code>分别为正弦函数和余弦函数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> vec <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">100</span></span><br><span class="line"><span class="operator">&gt;</span> vec</span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span>  <span class="number">24</span>  <span class="number">25</span>  <span class="number">26</span>  <span class="number">27</span>  <span class="number">28</span>  <span class="number">29</span>  <span class="number">30</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span>  <span class="number">31</span>  <span class="number">32</span>  <span class="number">33</span>  <span class="number">34</span>  <span class="number">35</span>  <span class="number">36</span>  <span class="number">37</span>  <span class="number">38</span>  <span class="number">39</span>  <span class="number">40</span>  <span class="number">41</span>  <span class="number">42</span>  <span class="number">43</span>  <span class="number">44</span>  <span class="number">45</span>  <span class="number">46</span>  <span class="number">47</span>  <span class="number">48</span>  <span class="number">49</span>  <span class="number">50</span>  <span class="number">51</span>  <span class="number">52</span>  <span class="number">53</span>  <span class="number">54</span>  <span class="number">55</span>  <span class="number">56</span>  <span class="number">57</span>  <span class="number">58</span>  <span class="number">59</span>  <span class="number">60</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">61</span><span class="punctuation">]</span>  <span class="number">61</span>  <span class="number">62</span>  <span class="number">63</span>  <span class="number">64</span>  <span class="number">65</span>  <span class="number">66</span>  <span class="number">67</span>  <span class="number">68</span>  <span class="number">69</span>  <span class="number">70</span>  <span class="number">71</span>  <span class="number">72</span>  <span class="number">73</span>  <span class="number">74</span>  <span class="number">75</span>  <span class="number">76</span>  <span class="number">77</span>  <span class="number">78</span>  <span class="number">79</span>  <span class="number">80</span>  <span class="number">81</span>  <span class="number">82</span>  <span class="number">83</span>  <span class="number">84</span>  <span class="number">85</span>  <span class="number">86</span>  <span class="number">87</span>  <span class="number">88</span>  <span class="number">89</span>  <span class="number">90</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">91</span><span class="punctuation">]</span>  <span class="number">91</span>  <span class="number">92</span>  <span class="number">93</span>  <span class="number">94</span>  <span class="number">95</span>  <span class="number">96</span>  <span class="number">97</span>  <span class="number">98</span>  <span class="number">99</span> <span class="number">100</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">sum</span><span class="punctuation">(</span>vec<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5050</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">max</span><span class="punctuation">(</span>vec<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">100</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">min</span><span class="punctuation">(</span>vec<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">range</span><span class="punctuation">(</span>vec<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span> <span class="number">100</span></span><br><span class="line"><span class="operator">&gt;</span> mean<span class="punctuation">(</span>vec<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">50.5</span></span><br><span class="line"><span class="operator">&gt;</span> var<span class="punctuation">(</span>vec<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">841.6667</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">round</span><span class="punctuation">(</span>var<span class="punctuation">(</span>vec<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">842</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">round</span><span class="punctuation">(</span>var<span class="punctuation">(</span>vec<span class="punctuation">)</span><span class="punctuation">,</span>digits <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">841.67</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">round</span><span class="punctuation">(</span>sd<span class="punctuation">(</span>vec<span class="punctuation">)</span><span class="punctuation">,</span>digits <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">29.01</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">prod</span><span class="punctuation">(</span>vec<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">9.332622e+157</span></span><br><span class="line"><span class="operator">&gt;</span> quantile<span class="punctuation">(</span>vec<span class="punctuation">)</span></span><br><span class="line">    <span class="number">0</span><span class="operator">%    25%</span>    <span class="number">50</span><span class="operator">%    75%</span>   <span class="number">100</span><span class="operator">% </span></span><br><span class="line"><span class="operator">  1.00  25.75  50.50  75.25 100.00 </span></span><br><span class="line"><span class="operator">&gt; quantile(vec,c(0.4,0.5,0.8))</span></span><br><span class="line"><span class="operator"> 40%</span>  <span class="number">50</span><span class="operator">%  80%</span> </span><br><span class="line"><span class="number">40.6</span> <span class="number">50.5</span> <span class="number">80.2</span> </span><br></pre></td></tr></table></figure>
<p>总结：<code>sum</code>返回向量的求和，<code>max</code>返回向量最大值，<code>min</code>返回向量最小值，<code>range</code>返回向量最小值和最大值，<code>mean</code>返回向量均值，<code>var</code>返回向量方差，<code>sd</code>返回向量标准差，<code>prod</code>返回向量连乘的积。<code>quantile</code>为计算分位数中的值，<code>quantile(vec,c(0.4,0.5,0.8))</code>为计算四分位、中位和八分位数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> t <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">,</span><span class="number">9</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> t</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">4</span> <span class="number">2</span> <span class="number">5</span> <span class="number">7</span> <span class="number">9</span> <span class="number">6</span></span><br><span class="line"><span class="operator">&gt;</span> which.max<span class="punctuation">(</span>t<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6</span></span><br><span class="line"><span class="operator">&gt;</span> which.min<span class="punctuation">(</span>t<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> which<span class="punctuation">(</span>t<span class="operator">==</span><span class="number">7</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5</span></span><br><span class="line"><span class="operator">&gt;</span> which<span class="punctuation">(</span>t<span class="operator">&gt;</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span></span><br><span class="line"><span class="operator">&gt;</span> t<span class="punctuation">[</span>which<span class="punctuation">(</span>t<span class="operator">&gt;</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">7</span> <span class="number">9</span> <span class="number">6</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>which</code>返回的是对应的位置，<code>which.max(t)</code>返回最大值对应的位置，<code>which.min(t)</code>返回最小值对应的位置，<code>which(t==7)</code>返回数值为7的元素对应的位置，<code>which(t&gt;5)</code>返回<code>t&gt;5</code>对应的元素的位置，<code>t[which(t&gt;5)]</code>返回<code>t&gt;5</code>对应的元素。</p>
<h3 id="2-4-矩阵">2.4 矩阵</h3>
<p>矩阵（Matrix）是一个按照长方阵列排列的复数或实数集合。向量是一维的，而矩阵是二维的，需要有行和列。</p>
<p>在R软件中，矩阵是有维数的向量，这里的矩阵元素可以是数值型，字符型或者逻辑型，但是每个元素必须都拥有相同的模式，这个和向量一致。</p>
<p>矩阵相关操作如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x<span class="operator">&lt;-</span> <span class="number">1</span><span class="operator">:</span><span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> m <span class="operator">&lt;-</span>matrix<span class="punctuation">(</span>x<span class="punctuation">,</span>nrow <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span>ncol <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> m</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> t <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> t</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> t <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> t</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> t <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span>byrow <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> t</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span>    <span class="number">4</span>    <span class="number">5</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">6</span>    <span class="number">7</span>    <span class="number">8</span>    <span class="number">9</span>   <span class="number">10</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">11</span>   <span class="number">12</span>   <span class="number">13</span>   <span class="number">14</span>   <span class="number">15</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">16</span>   <span class="number">17</span>   <span class="number">18</span>   <span class="number">19</span>   <span class="number">20</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过<code>matrix</code>创建矩阵，需要自己设定行数或者列数，也可以只设定列数或行数，默认按照列进行排列，如果<code>byrow</code>为<code>T</code>则按照行进行排列。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> m <span class="operator">&lt;-</span>matrix<span class="punctuation">(</span>x<span class="punctuation">,</span>nrow <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span>ncol <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> m</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> rnames <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;R1&quot;</span><span class="punctuation">,</span><span class="string">&quot;R2&quot;</span><span class="punctuation">,</span><span class="string">&quot;R3&quot;</span><span class="punctuation">,</span><span class="string">&quot;R4&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> rnames</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;R1&quot;</span> <span class="string">&quot;R2&quot;</span> <span class="string">&quot;R3&quot;</span> <span class="string">&quot;R4&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> cnames <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;C1&quot;</span><span class="punctuation">,</span><span class="string">&quot;C2&quot;</span><span class="punctuation">,</span><span class="string">&quot;C3&quot;</span><span class="punctuation">,</span><span class="string">&quot;C4&quot;</span><span class="punctuation">,</span><span class="string">&quot;C5&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> cnames</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;C1&quot;</span> <span class="string">&quot;C2&quot;</span> <span class="string">&quot;C3&quot;</span> <span class="string">&quot;C4&quot;</span> <span class="string">&quot;C5&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">dimnames</span><span class="punctuation">(</span>m<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>rnames<span class="punctuation">,</span>cnames<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> m</span><br><span class="line">   C1 C2 C3 C4 C5</span><br><span class="line">R1  <span class="number">1</span>  <span class="number">5</span>  <span class="number">9</span> <span class="number">13</span> <span class="number">17</span></span><br><span class="line">R2  <span class="number">2</span>  <span class="number">6</span> <span class="number">10</span> <span class="number">14</span> <span class="number">18</span></span><br><span class="line">R3  <span class="number">3</span>  <span class="number">7</span> <span class="number">11</span> <span class="number">15</span> <span class="number">19</span></span><br><span class="line">R4  <span class="number">4</span>  <span class="number">8</span> <span class="number">12</span> <span class="number">16</span> <span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">dim</span><span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="literal">NULL</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">dim</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过<code>dimnames</code>给矩阵的行和列进行命名，也可以通过<code>dim</code>将向量变为矩阵。</p>
<p>数组：示例1</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">dim</span><span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="literal">NULL</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">dim</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">3</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">5</span>    <span class="number">7</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">6</span>    <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">9</span>   <span class="number">11</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">10</span>   <span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">13</span>   <span class="number">15</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">14</span>   <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">17</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">18</span>   <span class="number">20</span></span><br></pre></td></tr></table></figure>
<p>示例2：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> dim1 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A1&quot;</span><span class="punctuation">,</span><span class="string">&quot;A2&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> dim2 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;B1&quot;</span><span class="punctuation">,</span><span class="string">&quot;B2&quot;</span><span class="punctuation">,</span><span class="string">&quot;B3&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> dim3 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;C1&quot;</span><span class="punctuation">,</span><span class="string">&quot;C2&quot;</span><span class="punctuation">,</span><span class="string">&quot;C3&quot;</span><span class="punctuation">,</span><span class="string">&quot;C4&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> z <span class="operator">&lt;-</span> array<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">24</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">dimnames</span> <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>dim1<span class="punctuation">,</span>dim2<span class="punctuation">,</span>dim3<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> z</span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> C1</span><br><span class="line"></span><br><span class="line">   B1 B2 B3</span><br><span class="line">A1  <span class="number">1</span>  <span class="number">3</span>  <span class="number">5</span></span><br><span class="line">A2  <span class="number">2</span>  <span class="number">4</span>  <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> C2</span><br><span class="line"></span><br><span class="line">   B1 B2 B3</span><br><span class="line">A1  <span class="number">7</span>  <span class="number">9</span> <span class="number">11</span></span><br><span class="line">A2  <span class="number">8</span> <span class="number">10</span> <span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> C3</span><br><span class="line"></span><br><span class="line">   B1 B2 B3</span><br><span class="line">A1 <span class="number">13</span> <span class="number">15</span> <span class="number">17</span></span><br><span class="line">A2 <span class="number">14</span> <span class="number">16</span> <span class="number">18</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> C4</span><br><span class="line"></span><br><span class="line">   B1 B2 B3</span><br><span class="line">A1 <span class="number">19</span> <span class="number">21</span> <span class="number">23</span></span><br><span class="line">A2 <span class="number">20</span> <span class="number">22</span> <span class="number">24</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过<code>array</code>创建矩阵，同时给矩阵命名。</p>
<p>读取矩阵中的元素，示例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> m <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span>byrow <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> m</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span>    <span class="number">4</span>    <span class="number">5</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">6</span>    <span class="number">7</span>    <span class="number">8</span>    <span class="number">9</span>   <span class="number">10</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">11</span>   <span class="number">12</span>   <span class="number">13</span>   <span class="number">14</span>   <span class="number">15</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">16</span>   <span class="number">17</span>   <span class="number">18</span>   <span class="number">19</span>   <span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> m<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> m<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> m<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">7</span>    <span class="number">8</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">12</span>   <span class="number">13</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">17</span>   <span class="number">18</span></span><br><span class="line"><span class="operator">&gt;</span> m<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> m<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">2</span>  <span class="number">7</span> <span class="number">12</span> <span class="number">17</span></span><br><span class="line"><span class="operator">&gt;</span> m<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6</span></span><br><span class="line"><span class="operator">&gt;</span> m<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">11</span></span><br><span class="line"><span class="operator">&gt;</span> m<span class="punctuation">[</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">7</span> <span class="number">12</span> <span class="number">17</span></span><br><span class="line"><span class="operator">&gt;</span> rnames <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;R1&quot;</span><span class="punctuation">,</span><span class="string">&quot;R2&quot;</span><span class="punctuation">,</span><span class="string">&quot;R3&quot;</span><span class="punctuation">,</span><span class="string">&quot;R4&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> rnames</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;R1&quot;</span> <span class="string">&quot;R2&quot;</span> <span class="string">&quot;R3&quot;</span> <span class="string">&quot;R4&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> cnames <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;C1&quot;</span><span class="punctuation">,</span><span class="string">&quot;C2&quot;</span><span class="punctuation">,</span><span class="string">&quot;C3&quot;</span><span class="punctuation">,</span><span class="string">&quot;C4&quot;</span><span class="punctuation">,</span><span class="string">&quot;C5&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> cnames</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;C1&quot;</span> <span class="string">&quot;C2&quot;</span> <span class="string">&quot;C3&quot;</span> <span class="string">&quot;C4&quot;</span> <span class="string">&quot;C5&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">dimnames</span><span class="punctuation">(</span>m<span class="punctuation">)</span><span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>rnames<span class="punctuation">,</span>cnames<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> m</span><br><span class="line">   C1 C2 C3 C4 C5</span><br><span class="line">R1  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span></span><br><span class="line">R2  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line">R3 <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span></span><br><span class="line">R4 <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> m<span class="punctuation">[</span><span class="string">&quot;R1&quot;</span><span class="punctuation">,</span><span class="string">&quot;C2&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span></span><br><span class="line"><span class="built_in">sum</span><span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">210</span></span><br><span class="line"><span class="operator">&gt;</span> colSums<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line">C1 C2 C3 C4 C5 </span><br><span class="line"><span class="number">34</span> <span class="number">38</span> <span class="number">42</span> <span class="number">46</span> <span class="number">50</span> </span><br><span class="line"><span class="operator">&gt;</span> rowSums<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line">R1 R2 R3 R4 </span><br><span class="line"><span class="number">15</span> <span class="number">40</span> <span class="number">65</span> <span class="number">90</span> </span><br><span class="line"><span class="operator">&gt;</span> colMeans<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line">  C1   C2   C3   C4   C5 </span><br><span class="line"> <span class="number">8.5</span>  <span class="number">9.5</span> <span class="number">10.5</span> <span class="number">11.5</span> <span class="number">12.5</span> </span><br><span class="line"><span class="operator">&gt;</span> rowMeans<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line">R1 R2 R3 R4 </span><br><span class="line"> <span class="number">3</span>  <span class="number">8</span> <span class="number">13</span> <span class="number">18</span></span><br></pre></td></tr></table></figure>
<p>矩阵的内积和外积：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> n <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">9</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> w <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">2</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> n</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">4</span>    <span class="number">7</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">6</span>    <span class="number">9</span></span><br><span class="line"><span class="operator">&gt;</span> w</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">6</span>    <span class="number">9</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">7</span>   <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> n<span class="operator">*</span>w</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>   <span class="number">20</span>   <span class="number">56</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">6</span>   <span class="number">30</span>   <span class="number">72</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">12</span>   <span class="number">42</span>   <span class="number">90</span></span><br><span class="line"><span class="operator">&gt;</span> n <span class="operator">%*%</span> w</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">42</span>   <span class="number">78</span>  <span class="number">114</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">51</span>   <span class="number">96</span>  <span class="number">141</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">60</span>  <span class="number">114</span>  <span class="number">168</span></span><br><span class="line"><span class="operator">&gt;</span> diag<span class="punctuation">(</span>n<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">5</span> <span class="number">9</span></span><br><span class="line"><span class="operator">&gt;</span> t<span class="punctuation">(</span>n<span class="punctuation">)</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">7</span>    <span class="number">8</span>    <span class="number">9</span></span><br></pre></td></tr></table></figure>
<p>总结：函数内积可通过<code>*</code>将矩阵对应位置进行相乘，外积可以通过<code>%*%</code>符号实现，矩阵对角线的值可以通过<code>diag</code>取得，函数<code>t</code>可以对矩阵进行转置。</p>
<h3 id="2-5-列表">2.5 列表</h3>
<p>列表就是用来存储很多内容的一个集合，在其他编程语言中，列表一般和数组是等同的，但是在R语言中，列表却是最复杂的一种数据结构，也是非常重要的一种数据结构。</p>
<p>列表是一些对象的有序集合。列表中可以存储若干向量、矩阵、数据框，甚至其他列表的组合。</p>
<p>向量与类表：</p>
<ol>
<li>在模式上和向量类似，都是一维数据集合。</li>
<li>向量智能存储一种数据类型，列表中的对象可以是R中的任何数据结构，甚至列表本身。</li>
</ol>
<p>示例：<code>mtcars</code>为数据集</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> a <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> b <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">c</span> <span class="operator">&lt;-</span> mtcars</span><br><span class="line"><span class="operator">&gt;</span> d <span class="operator">&lt;-</span> <span class="string">&quot;This is a test list&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> mlist<span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>a<span class="punctuation">,</span>b<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">,</span>d<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> mlist</span><br><span class="line"><span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line">Ferrari Dino        <span class="number">19.7</span>   <span class="number">6</span> <span class="number">145.0</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.770</span> <span class="number">15.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line">Maserati Bora       <span class="number">15.0</span>   <span class="number">8</span> <span class="number">301.0</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line">Volvo <span class="number">142</span>E          <span class="number">21.4</span>   <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;This is a test list&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> mlist <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>first<span class="operator">=</span>a<span class="punctuation">,</span>second<span class="operator">=</span>b<span class="punctuation">,</span>third<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">,</span>forth<span class="operator">=</span>d<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> mlist</span><br><span class="line"><span class="operator">$</span>first</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>second</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>third</span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line">Ferrari Dino        <span class="number">19.7</span>   <span class="number">6</span> <span class="number">145.0</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.770</span> <span class="number">15.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line">Maserati Bora       <span class="number">15.0</span>   <span class="number">8</span> <span class="number">301.0</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line">Volvo <span class="number">142</span>E          <span class="number">21.4</span>   <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>forth</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;This is a test list&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> mlist<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">$</span>first</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> mlist<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">$</span>first</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>forth</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;This is a test list&quot;</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过以上的方式进行命名，并根据需要输出相关内容。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> state.center<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;x&quot;</span><span class="punctuation">,</span><span class="string">&quot;y&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">$</span>x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="operator">-</span><span class="number">86.7509</span> <span class="operator">-</span><span class="number">127.2500</span> <span class="operator">-</span><span class="number">111.6250</span>  <span class="operator">-</span><span class="number">92.2992</span> <span class="operator">-</span><span class="number">119.7730</span> <span class="operator">-</span><span class="number">105.5130</span>  <span class="operator">-</span><span class="number">72.3573</span>  <span class="operator">-</span><span class="number">74.9841</span>  <span class="operator">-</span><span class="number">81.6850</span>  <span class="operator">-</span><span class="number">83.3736</span> <span class="operator">-</span><span class="number">126.2500</span> <span class="operator">-</span><span class="number">113.9300</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">13</span><span class="punctuation">]</span>  <span class="operator">-</span><span class="number">89.3776</span>  <span class="operator">-</span><span class="number">86.0808</span>  <span class="operator">-</span><span class="number">93.3714</span>  <span class="operator">-</span><span class="number">98.1156</span>  <span class="operator">-</span><span class="number">84.7674</span>  <span class="operator">-</span><span class="number">92.2724</span>  <span class="operator">-</span><span class="number">68.9801</span>  <span class="operator">-</span><span class="number">76.6459</span>  <span class="operator">-</span><span class="number">71.5800</span>  <span class="operator">-</span><span class="number">84.6870</span>  <span class="operator">-</span><span class="number">94.6043</span>  <span class="operator">-</span><span class="number">89.8065</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span>  <span class="operator">-</span><span class="number">92.5137</span> <span class="operator">-</span><span class="number">109.3200</span>  <span class="operator">-</span><span class="number">99.5898</span> <span class="operator">-</span><span class="number">116.8510</span>  <span class="operator">-</span><span class="number">71.3924</span>  <span class="operator">-</span><span class="number">74.2336</span> <span class="operator">-</span><span class="number">105.9420</span>  <span class="operator">-</span><span class="number">75.1449</span>  <span class="operator">-</span><span class="number">78.4686</span> <span class="operator">-</span><span class="number">100.0990</span>  <span class="operator">-</span><span class="number">82.5963</span>  <span class="operator">-</span><span class="number">97.1239</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">37</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">120.0680</span>  <span class="operator">-</span><span class="number">77.4500</span>  <span class="operator">-</span><span class="number">71.1244</span>  <span class="operator">-</span><span class="number">80.5056</span>  <span class="operator">-</span><span class="number">99.7238</span>  <span class="operator">-</span><span class="number">86.4560</span>  <span class="operator">-</span><span class="number">98.7857</span> <span class="operator">-</span><span class="number">111.3300</span>  <span class="operator">-</span><span class="number">72.5450</span>  <span class="operator">-</span><span class="number">78.2005</span> <span class="operator">-</span><span class="number">119.7460</span>  <span class="operator">-</span><span class="number">80.6665</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span>  <span class="operator">-</span><span class="number">89.9941</span> <span class="operator">-</span><span class="number">107.2560</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>y</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">32.5901</span> <span class="number">49.2500</span> <span class="number">34.2192</span> <span class="number">34.7336</span> <span class="number">36.5341</span> <span class="number">38.6777</span> <span class="number">41.5928</span> <span class="number">38.6777</span> <span class="number">27.8744</span> <span class="number">32.3329</span> <span class="number">31.7500</span> <span class="number">43.5648</span> <span class="number">40.0495</span> <span class="number">40.0495</span> <span class="number">41.9358</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">16</span><span class="punctuation">]</span> <span class="number">38.4204</span> <span class="number">37.3915</span> <span class="number">30.6181</span> <span class="number">45.6226</span> <span class="number">39.2778</span> <span class="number">42.3645</span> <span class="number">43.1361</span> <span class="number">46.3943</span> <span class="number">32.6758</span> <span class="number">38.3347</span> <span class="number">46.8230</span> <span class="number">41.3356</span> <span class="number">39.1063</span> <span class="number">43.3934</span> <span class="number">39.9637</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> <span class="number">34.4764</span> <span class="number">43.1361</span> <span class="number">35.4195</span> <span class="number">47.2517</span> <span class="number">40.2210</span> <span class="number">35.5053</span> <span class="number">43.9078</span> <span class="number">40.9069</span> <span class="number">41.5928</span> <span class="number">33.6190</span> <span class="number">44.3365</span> <span class="number">35.6767</span> <span class="number">31.3897</span> <span class="number">39.1063</span> <span class="number">44.2508</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">46</span><span class="punctuation">]</span> <span class="number">37.5630</span> <span class="number">47.4231</span> <span class="number">38.4204</span> <span class="number">44.5937</span> <span class="number">43.0504</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过命名提取相应的列表</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mlist<span class="operator">$</span>first</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"> </span><br><span class="line"> <span class="operator">&gt;</span> mlist<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">$</span>first</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"> </span><br><span class="line"><span class="operator">&gt;</span> mlist<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"> </span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>mlist<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;integer&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>mlist<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;list&quot;</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过class查看数据类型，<code>mlist[1]</code>和<code>mlist[[1]]</code>是不同的数据类型。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mlist <span class="operator">&lt;-</span> mlist<span class="punctuation">[</span><span class="operator">-</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> mlist</span><br><span class="line"><span class="operator">$</span>first</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>second</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>forth</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;This is a test list&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> mlist<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line"><span class="operator">&gt;</span> mlist</span><br><span class="line"><span class="operator">$</span>first</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>forth</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;This is a test list&quot;</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过负号去掉不需要的部分，然后赋值给自身，这样可以删除部分列表内容。或者给相应的列表置空。<code>first</code>、<code>second</code>和<code>forth</code>只是名称并不代表相应的顺序。</p>
<h3 id="2-6-数据框">2.6 数据框</h3>
<p>数据框是一种表格式的数据结构。数据框旨在模拟数据集，与其他统计软件如SAS或者SPSS中的数据集的概念一致。</p>
<p>数据集通常是由数据构成的一个矩形数组，行表示观测，列表示变量。不同的行业对于数据集的行和列的叫法不同。</p>
<p>数据框实际上是一个列表，列表中的元素是向量，这些向量构成数据框的列，每一列必须具有相同的长度，所以数据框是矩形结构，而且数据框的列必须命名。</p>
<p>矩阵和数据框：</p>
<ol>
<li>数据框形状上很像矩阵；</li>
<li>数据框是比较规则的列表；</li>
<li>矩阵必须为同一数据类型；</li>
<li>数据框每一列必须同一类型，每一行可以不同。</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> state <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>state.name<span class="punctuation">,</span>state.abb<span class="punctuation">,</span>state.region<span class="punctuation">,</span>state.x77<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> state</span><br></pre></td></tr></table></figure>
<p>总结：通过<code>data.frame</code>将向量组成数据框。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">state<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">state<span class="punctuation">[</span><span class="punctuation">,</span><span class="string">&quot;state.abb&quot;</span><span class="punctuation">]</span></span><br><span class="line">state<span class="punctuation">[</span><span class="string">&quot;Alabama&quot;</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">state<span class="operator">$</span>state.abb</span><br></pre></td></tr></table></figure>
<p>总结：通过以上方式可以提取相关行或列中的数据。</p>
<p>示例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> women</span><br><span class="line">   height weight</span><br><span class="line"><span class="number">1</span>      <span class="number">58</span>    <span class="number">115</span></span><br><span class="line"><span class="number">2</span>      <span class="number">59</span>    <span class="number">117</span></span><br><span class="line"><span class="number">3</span>      <span class="number">60</span>    <span class="number">120</span></span><br><span class="line"><span class="number">4</span>      <span class="number">61</span>    <span class="number">123</span></span><br><span class="line"><span class="number">5</span>      <span class="number">62</span>    <span class="number">126</span></span><br><span class="line"><span class="number">6</span>      <span class="number">63</span>    <span class="number">129</span></span><br><span class="line"><span class="number">7</span>      <span class="number">64</span>    <span class="number">132</span></span><br><span class="line"><span class="number">8</span>      <span class="number">65</span>    <span class="number">135</span></span><br><span class="line"><span class="number">9</span>      <span class="number">66</span>    <span class="number">139</span></span><br><span class="line"><span class="number">10</span>     <span class="number">67</span>    <span class="number">142</span></span><br><span class="line"><span class="number">11</span>     <span class="number">68</span>    <span class="number">146</span></span><br><span class="line"><span class="number">12</span>     <span class="number">69</span>    <span class="number">150</span></span><br><span class="line"><span class="number">13</span>     <span class="number">70</span>    <span class="number">154</span></span><br><span class="line"><span class="number">14</span>     <span class="number">71</span>    <span class="number">159</span></span><br><span class="line"><span class="number">15</span>     <span class="number">72</span>    <span class="number">164</span></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>women<span class="operator">$</span>height<span class="punctuation">,</span>women<span class="operator">$</span>weight<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<p><img src="https://vip2.loli.io/2023/03/13/yCSWdJP6ghZiDUr.png" alt="image-20220806162002083"></p>
<p>在<code>lm</code>函数进行线性回归的时候，直接给出列名即可：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> lm<span class="punctuation">(</span>height<span class="operator">~</span>weight<span class="punctuation">,</span>data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> height <span class="operator">~</span> weight<span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>       weight  </span><br><span class="line">    <span class="number">25.7235</span>       <span class="number">0.2872</span>  </span><br></pre></td></tr></table></figure>
<p>R语言中提供了<code>attach</code>函数，将数据框加载到搜索框中，不需要再使用<code>$</code>符号，直接输入列的名字即可：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> attach<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> mpg</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">21.0</span> <span class="number">21.0</span> <span class="number">22.8</span> <span class="number">21.4</span> <span class="number">18.7</span> <span class="number">18.1</span> <span class="number">14.3</span> <span class="number">24.4</span> <span class="number">22.8</span> <span class="number">19.2</span> <span class="number">17.8</span> <span class="number">16.4</span> <span class="number">17.3</span> <span class="number">15.2</span> <span class="number">10.4</span> <span class="number">10.4</span> <span class="number">14.7</span> <span class="number">32.4</span> <span class="number">30.4</span> <span class="number">33.9</span> <span class="number">21.5</span> <span class="number">15.5</span> <span class="number">15.2</span> <span class="number">13.3</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span> <span class="number">19.2</span> <span class="number">27.3</span> <span class="number">26.0</span> <span class="number">30.4</span> <span class="number">15.8</span> <span class="number">19.7</span> <span class="number">15.0</span> <span class="number">21.4</span></span><br><span class="line"><span class="operator">&gt;</span> colnames<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;mpg&quot;</span>  <span class="string">&quot;cyl&quot;</span>  <span class="string">&quot;disp&quot;</span> <span class="string">&quot;hp&quot;</span>   <span class="string">&quot;drat&quot;</span> <span class="string">&quot;wt&quot;</span>   <span class="string">&quot;qsec&quot;</span> <span class="string">&quot;vs&quot;</span>   <span class="string">&quot;am&quot;</span>   <span class="string">&quot;gear&quot;</span> <span class="string">&quot;carb&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> rownames<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Mazda RX4&quot;</span>           <span class="string">&quot;Mazda RX4 Wag&quot;</span>       <span class="string">&quot;Datsun 710&quot;</span>          <span class="string">&quot;Hornet 4 Drive&quot;</span>      <span class="string">&quot;Hornet Sportabout&quot;</span>  </span><br><span class="line"> <span class="punctuation">[</span><span class="number">6</span><span class="punctuation">]</span> <span class="string">&quot;Valiant&quot;</span>             <span class="string">&quot;Duster 360&quot;</span>          <span class="string">&quot;Merc 240D&quot;</span>           <span class="string">&quot;Merc 230&quot;</span>            <span class="string">&quot;Merc 280&quot;</span>           </span><br><span class="line"><span class="punctuation">[</span><span class="number">11</span><span class="punctuation">]</span> <span class="string">&quot;Merc 280C&quot;</span>           <span class="string">&quot;Merc 450SE&quot;</span>          <span class="string">&quot;Merc 450SL&quot;</span>          <span class="string">&quot;Merc 450SLC&quot;</span>         <span class="string">&quot;Cadillac Fleetwood&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">16</span><span class="punctuation">]</span> <span class="string">&quot;Lincoln Continental&quot;</span> <span class="string">&quot;Chrysler Imperial&quot;</span>   <span class="string">&quot;Fiat 128&quot;</span>            <span class="string">&quot;Honda Civic&quot;</span>         <span class="string">&quot;Toyota Corolla&quot;</span>     </span><br><span class="line"><span class="punctuation">[</span><span class="number">21</span><span class="punctuation">]</span> <span class="string">&quot;Toyota Corona&quot;</span>       <span class="string">&quot;Dodge Challenger&quot;</span>    <span class="string">&quot;AMC Javelin&quot;</span>         <span class="string">&quot;Camaro Z28&quot;</span>          <span class="string">&quot;Pontiac Firebird&quot;</span>   </span><br><span class="line"><span class="punctuation">[</span><span class="number">26</span><span class="punctuation">]</span> <span class="string">&quot;Fiat X1-9&quot;</span>           <span class="string">&quot;Porsche 914-2&quot;</span>       <span class="string">&quot;Lotus Europa&quot;</span>        <span class="string">&quot;Ford Pantera L&quot;</span>      <span class="string">&quot;Ferrari Dino&quot;</span>       </span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> <span class="string">&quot;Maserati Bora&quot;</span>       <span class="string">&quot;Volvo 142E&quot;</span> </span><br><span class="line"><span class="operator">&gt;</span> detach<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>也可以使用<code>with</code>实现数据集的调用：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> with<span class="punctuation">(</span>mtcars<span class="punctuation">,</span><span class="punctuation">&#123;</span>hp<span class="punctuation">&#125;</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">110</span> <span class="number">110</span>  <span class="number">93</span> <span class="number">110</span> <span class="number">175</span> <span class="number">105</span> <span class="number">245</span>  <span class="number">62</span>  <span class="number">95</span> <span class="number">123</span> <span class="number">123</span> <span class="number">180</span> <span class="number">180</span> <span class="number">180</span> <span class="number">205</span> <span class="number">215</span> <span class="number">230</span>  <span class="number">66</span>  <span class="number">52</span>  <span class="number">65</span>  <span class="number">97</span> <span class="number">150</span> <span class="number">150</span> <span class="number">245</span> <span class="number">175</span>  <span class="number">66</span>  <span class="number">91</span> <span class="number">113</span> <span class="number">264</span> <span class="number">175</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> <span class="number">335</span> <span class="number">109</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> with<span class="punctuation">(</span>mtcars<span class="punctuation">,</span><span class="punctuation">&#123;</span>mpg<span class="punctuation">&#125;</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">21.0</span> <span class="number">21.0</span> <span class="number">22.8</span> <span class="number">21.4</span> <span class="number">18.7</span> <span class="number">18.1</span> <span class="number">14.3</span> <span class="number">24.4</span> <span class="number">22.8</span> <span class="number">19.2</span> <span class="number">17.8</span> <span class="number">16.4</span> <span class="number">17.3</span> <span class="number">15.2</span> <span class="number">10.4</span> <span class="number">10.4</span> <span class="number">14.7</span> <span class="number">32.4</span> <span class="number">30.4</span> <span class="number">33.9</span> <span class="number">21.5</span> <span class="number">15.5</span> <span class="number">15.2</span> <span class="number">13.3</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span> <span class="number">19.2</span> <span class="number">27.3</span> <span class="number">26.0</span> <span class="number">30.4</span> <span class="number">15.8</span> <span class="number">19.7</span> <span class="number">15.0</span> <span class="number">21.4</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> with<span class="punctuation">(</span>mtcars<span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="built_in">sum</span><span class="punctuation">(</span>mpg<span class="punctuation">)</span><span class="punctuation">&#125;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">642.9</span></span><br></pre></td></tr></table></figure>
<p>单双中括号的区别：</p>
<p><img src="https://vip2.loli.io/2023/03/13/XIzQDip8whylaev.png" alt="image-20220806163817291"></p>
<h3 id="2-7-因子">2.7 因子</h3>
<p>变量分类：</p>
<ol>
<li>名义型变量</li>
<li>有序型变量</li>
<li>连续型变量</li>
</ol>
<p>因子：在R中名义型变量和有序型变量称为因子，factor。这些分类变量的可能值成为一个水平，level，例如good、better、better，都称为一个level。由这些水平值构成的向量就称为因子。因子本身也是一个向量，一个集合，只不过里面的元素可以用来分类。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mtcars</span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line">Ferrari Dino        <span class="number">19.7</span>   <span class="number">6</span> <span class="number">145.0</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.770</span> <span class="number">15.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line">Maserati Bora       <span class="number">15.0</span>   <span class="number">8</span> <span class="number">301.0</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line">Volvo <span class="number">142</span>E          <span class="number">21.4</span>   <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> mtcars<span class="operator">$</span>cyl</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6</span> <span class="number">6</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">6</span> <span class="number">6</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"> <span class="number">4</span>  <span class="number">6</span>  <span class="number">8</span> </span><br><span class="line"><span class="number">11</span>  <span class="number">7</span> <span class="number">14</span> </span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>mtcars<span class="operator">$</span>am<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"> <span class="number">0</span>  <span class="number">1</span> </span><br><span class="line"><span class="number">19</span> <span class="number">13</span> </span><br></pre></td></tr></table></figure>
<p>总结：上面的4、6、8并不是因子，而是<code>cyl</code>这一列可以当作因子类型来处理，4、6或8为一个level。使用<code>table</code>函数进行频数统计。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> f <span class="operator">&lt;-</span> factor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span><span class="string">&quot;blue&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> f</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> red   red   green blue  green blue  blue </span><br><span class="line">Levels<span class="operator">:</span> blue green red</span><br><span class="line"><span class="operator">&gt;</span> week <span class="operator">&lt;-</span> factor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Mon&quot;</span><span class="punctuation">,</span><span class="string">&quot;Fri&quot;</span><span class="punctuation">,</span><span class="string">&quot;Thu&quot;</span><span class="punctuation">,</span><span class="string">&quot;Wed&quot;</span><span class="punctuation">,</span><span class="string">&quot;Mon&quot;</span><span class="punctuation">,</span><span class="string">&quot;Fri&quot;</span><span class="punctuation">,</span><span class="string">&quot;Sun&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> week</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> Mon Fri Thu Wed Mon Fri Sun</span><br><span class="line">Levels<span class="operator">:</span> Fri Mon Sun Thu Wed</span><br><span class="line"><span class="operator">&gt;</span> week <span class="operator">&lt;-</span> factor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Mon&quot;</span><span class="punctuation">,</span><span class="string">&quot;Fri&quot;</span><span class="punctuation">,</span><span class="string">&quot;Thu&quot;</span><span class="punctuation">,</span><span class="string">&quot;Wed&quot;</span><span class="punctuation">,</span><span class="string">&quot;Mon&quot;</span><span class="punctuation">,</span><span class="string">&quot;Fri&quot;</span><span class="punctuation">,</span><span class="string">&quot;Sun&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>ordered <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Mon&quot;</span><span class="punctuation">,</span><span class="string">&quot;Tue&quot;</span><span class="punctuation">,</span><span class="string">&quot;Wed&quot;</span><span class="punctuation">,</span><span class="string">&quot;Thu&quot;</span><span class="punctuation">,</span><span class="string">&quot;Fri&quot;</span><span class="punctuation">,</span><span class="string">&quot;Sat&quot;</span><span class="punctuation">,</span><span class="string">&quot;Sun&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> week</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> Mon Fri Thu Wed Mon Fri Sun</span><br><span class="line">Levels<span class="operator">:</span> Mon <span class="operator">&lt;</span> Tue <span class="operator">&lt;</span> Wed <span class="operator">&lt;</span> Thu <span class="operator">&lt;</span> Fri <span class="operator">&lt;</span> Sat <span class="operator">&lt;</span> Sun</span><br><span class="line"><span class="operator">&gt;</span> fcyl <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fcyl</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6</span> <span class="number">6</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">6</span> <span class="number">6</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span></span><br><span class="line">Levels<span class="operator">:</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>factor<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过factor创建因子类型。有序型变量也可以作为因子。<code>fcyl &lt;- factor(mtcars$cyl)</code>可以将<code>cyl</code>向量变为因子。向量输出的是散点图，而因子输出的是条形图。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> num <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> num</span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span>  <span class="number">24</span>  <span class="number">25</span>  <span class="number">26</span>  <span class="number">27</span>  <span class="number">28</span>  <span class="number">29</span>  <span class="number">30</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span>  <span class="number">31</span>  <span class="number">32</span>  <span class="number">33</span>  <span class="number">34</span>  <span class="number">35</span>  <span class="number">36</span>  <span class="number">37</span>  <span class="number">38</span>  <span class="number">39</span>  <span class="number">40</span>  <span class="number">41</span>  <span class="number">42</span>  <span class="number">43</span>  <span class="number">44</span>  <span class="number">45</span>  <span class="number">46</span>  <span class="number">47</span>  <span class="number">48</span>  <span class="number">49</span>  <span class="number">50</span>  <span class="number">51</span>  <span class="number">52</span>  <span class="number">53</span>  <span class="number">54</span>  <span class="number">55</span>  <span class="number">56</span>  <span class="number">57</span>  <span class="number">58</span>  <span class="number">59</span>  <span class="number">60</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">61</span><span class="punctuation">]</span>  <span class="number">61</span>  <span class="number">62</span>  <span class="number">63</span>  <span class="number">64</span>  <span class="number">65</span>  <span class="number">66</span>  <span class="number">67</span>  <span class="number">68</span>  <span class="number">69</span>  <span class="number">70</span>  <span class="number">71</span>  <span class="number">72</span>  <span class="number">73</span>  <span class="number">74</span>  <span class="number">75</span>  <span class="number">76</span>  <span class="number">77</span>  <span class="number">78</span>  <span class="number">79</span>  <span class="number">80</span>  <span class="number">81</span>  <span class="number">82</span>  <span class="number">83</span>  <span class="number">84</span>  <span class="number">85</span>  <span class="number">86</span>  <span class="number">87</span>  <span class="number">88</span>  <span class="number">89</span>  <span class="number">90</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">91</span><span class="punctuation">]</span>  <span class="number">91</span>  <span class="number">92</span>  <span class="number">93</span>  <span class="number">94</span>  <span class="number">95</span>  <span class="number">96</span>  <span class="number">97</span>  <span class="number">98</span>  <span class="number">99</span> <span class="number">100</span></span><br><span class="line"> </span><br><span class="line"><span class="operator">&gt;</span> cut<span class="punctuation">(</span>num<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> </span><br><span class="line"> <span class="punctuation">[</span><span class="number">14</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> </span><br><span class="line"> <span class="punctuation">[</span><span class="number">27</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span> </span><br><span class="line"> <span class="punctuation">[</span><span class="number">40</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">60</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">60</span><span class="punctuation">]</span> </span><br><span class="line"> <span class="punctuation">[</span><span class="number">53</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">60</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">60</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">60</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">60</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">60</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">60</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">60</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">60</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">60</span><span class="punctuation">,</span><span class="number">70</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">60</span><span class="punctuation">,</span><span class="number">70</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">60</span><span class="punctuation">,</span><span class="number">70</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">60</span><span class="punctuation">,</span><span class="number">70</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">60</span><span class="punctuation">,</span><span class="number">70</span><span class="punctuation">]</span> </span><br><span class="line"> <span class="punctuation">[</span><span class="number">66</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">60</span><span class="punctuation">,</span><span class="number">70</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">60</span><span class="punctuation">,</span><span class="number">70</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">60</span><span class="punctuation">,</span><span class="number">70</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">60</span><span class="punctuation">,</span><span class="number">70</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">60</span><span class="punctuation">,</span><span class="number">70</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">70</span><span class="punctuation">,</span><span class="number">80</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">70</span><span class="punctuation">,</span><span class="number">80</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">70</span><span class="punctuation">,</span><span class="number">80</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">70</span><span class="punctuation">,</span><span class="number">80</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">70</span><span class="punctuation">,</span><span class="number">80</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">70</span><span class="punctuation">,</span><span class="number">80</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">70</span><span class="punctuation">,</span><span class="number">80</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">70</span><span class="punctuation">,</span><span class="number">80</span><span class="punctuation">]</span> </span><br><span class="line"> <span class="punctuation">[</span><span class="number">79</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">70</span><span class="punctuation">,</span><span class="number">80</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">70</span><span class="punctuation">,</span><span class="number">80</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">80</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">80</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">80</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">80</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">80</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">80</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">80</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">80</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">80</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">80</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">90</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">92</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">90</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">90</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">90</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">90</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">90</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">90</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">90</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">90</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">90</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">]</span></span><br><span class="line">Levels<span class="operator">:</span> <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">60</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">60</span><span class="punctuation">,</span><span class="number">70</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">70</span><span class="punctuation">,</span><span class="number">80</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">80</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">90</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>cut<span class="punctuation">(</span>num<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;factor&quot;</span></span><br></pre></td></tr></table></figure>
<p>通过<code>cut</code>可以统计每个区间分别有多少。</p>
<h3 id="2-8-缺失数据">2.8 缺失数据</h3>
<p>缺失数据的分类</p>
<p>统计学家通常将缺失数据分为三类。它们都用概率术语进行描述，但思想都非常直观。我们将用sleep研究中对做梦时长的测量（有12个动物有缺失值）来依次阐述三种类型。</p>
<ol>
<li>完全随机缺失若某变量的缺失数据与其他任何观测或未观测变量都不相关，则数据为完全随机缺失（MCAR）。若12个动物的做梦时长值缺失不是由于系统原因，那么可认为数据是MCAR。注意，如果每个有缺失值的变量都是MCAR，那么可以将数据完整的实例看做是对更大数据集的一个简单随机抽样。</li>
<li>随机缺失若某变量上的缺失数据与其他观测变量相关，与它自己的未观测值不相关，则数据为随机缺失（MAR）。例如，体重较小的动物更可能有做梦时长的缺失值（可能因为较小的动物较难观察），“缺失”与动物的做梦时长无关，那么该数据就可以认为是MAR。<br>
此时，一旦你控制了体重变量，做梦时长数据的缺失与出现将是随机的。</li>
<li>非随机缺失若缺失数据不属于MCAR或MAR，则数据为非随机缺失（NMAR）。例如，做梦时长越短的动物也更可能有做梦数据的缺失（可能由于难以测量时长较短的事件），那么数据可认为是NMAR。</li>
</ol>
<p>为何会出现缺失数据：</p>
<ol>
<li>机器断电，设备故障导致某个测量值发生了丢失。</li>
<li>测量根本没有发生，例如在做调查问卷时，有些问题没有回答，或者有些问题是无效回答等。</li>
</ol>
<p>缺失值NA</p>
<p>在R中，NA代表缺失值，NA是不可用，not available的简称，用来存储缺失信息。</p>
<p>这里缺失值NA表示没有，但注意没有并不一定就是0，NA是不知道是多少，也能是0，也可能是任何值，缺失值和值为0是完全不同的。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="number">1</span><span class="operator">+</span><span class="literal">NA</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="literal">NA</span><span class="operator">==</span><span class="number">0</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span></span><br></pre></td></tr></table></figure>
<p>在运行中NA的处理：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> a <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">49</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> a</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span> <span class="number">21</span> <span class="number">22</span> <span class="number">23</span> <span class="number">24</span> <span class="number">25</span> <span class="number">26</span> <span class="number">27</span> <span class="number">28</span> <span class="number">29</span> <span class="number">30</span> <span class="number">31</span> <span class="number">32</span> <span class="number">33</span> <span class="number">34</span> <span class="number">35</span> <span class="number">36</span> <span class="number">37</span> <span class="number">38</span> <span class="number">39</span> <span class="number">40</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">42</span><span class="punctuation">]</span> <span class="number">41</span> <span class="number">42</span> <span class="number">43</span> <span class="number">44</span> <span class="number">45</span> <span class="number">46</span> <span class="number">47</span> <span class="number">48</span> <span class="number">49</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">sum</span><span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span></span><br><span class="line"><span class="operator">&gt;</span> mean<span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">sum</span><span class="punctuation">(</span>a<span class="punctuation">,</span>na.rm <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1225</span></span><br><span class="line"><span class="operator">&gt;</span> mean<span class="punctuation">(</span>a<span class="punctuation">,</span>na.rm <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">25</span></span><br><span class="line"><span class="operator">&gt;</span> mean<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">49</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">25</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">is.na</span><span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">21</span><span class="punctuation">]</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">41</span><span class="punctuation">]</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过<code>na.rm</code>将NA进行剔除，剔除后，不会将NA的位置保留进行计算。通过<code>is.na</code>判断是否存在NA。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">c</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span> <span class="literal">NA</span> <span class="literal">NA</span></span><br><span class="line"> </span><br><span class="line"><span class="operator">&gt;</span> d <span class="operator">&lt;-</span> na.omit<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> d</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"><span class="built_in">attr</span><span class="punctuation">(</span><span class="punctuation">,</span><span class="string">&quot;na.action&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span> <span class="number">22</span> <span class="number">23</span></span><br><span class="line"><span class="built_in">attr</span><span class="punctuation">(</span><span class="punctuation">,</span><span class="string">&quot;class&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;omit&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">is.na</span><span class="punctuation">(</span>d<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line"> </span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">sum</span><span class="punctuation">(</span>d<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">210</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> mean<span class="punctuation">(</span>d<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">10.5</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> na.omit<span class="punctuation">(</span>sleep<span class="punctuation">)</span></span><br><span class="line">    BodyWgt BrainWgt NonD Dream Sleep  Span  Gest Pred Exp Danger</span><br><span class="line"><span class="number">2</span>     <span class="number">1.000</span>     <span class="number">6.60</span>  <span class="number">6.3</span>   <span class="number">2.0</span>   <span class="number">8.3</span>   <span class="number">4.5</span>  <span class="number">42.0</span>    <span class="number">3</span>   <span class="number">1</span>      <span class="number">3</span></span><br><span class="line"><span class="number">5</span>  <span class="number">2547.000</span>  <span class="number">4603.00</span>  <span class="number">2.1</span>   <span class="number">1.8</span>   <span class="number">3.9</span>  <span class="number">69.0</span> <span class="number">624.0</span>    <span class="number">3</span>   <span class="number">5</span>      <span class="number">4</span></span><br><span class="line"><span class="number">6</span>    <span class="number">10.550</span>   <span class="number">179.50</span>  <span class="number">9.1</span>   <span class="number">0.7</span>   <span class="number">9.8</span>  <span class="number">27.0</span> <span class="number">180.0</span>    <span class="number">4</span>   <span class="number">4</span>      <span class="number">4</span></span><br><span class="line"><span class="number">7</span>     <span class="number">0.023</span>     <span class="number">0.30</span> <span class="number">15.8</span>   <span class="number">3.9</span>  <span class="number">19.7</span>  <span class="number">19.0</span>  <span class="number">35.0</span>    <span class="number">1</span>   <span class="number">1</span>      <span class="number">1</span></span><br><span class="line"><span class="number">8</span>   <span class="number">160.000</span>   <span class="number">169.00</span>  <span class="number">5.2</span>   <span class="number">1.0</span>   <span class="number">6.2</span>  <span class="number">30.4</span> <span class="number">392.0</span>    <span class="number">4</span>   <span class="number">5</span>      <span class="number">4</span></span><br><span class="line">...</span><br><span class="line"><span class="number">57</span>    <span class="number">0.900</span>     <span class="number">2.60</span> <span class="number">11.0</span>   <span class="number">2.3</span>  <span class="number">13.3</span>   <span class="number">4.5</span>  <span class="number">60.0</span>    <span class="number">2</span>   <span class="number">1</span>      <span class="number">2</span></span><br><span class="line"><span class="number">58</span>    <span class="number">2.000</span>    <span class="number">12.30</span>  <span class="number">4.9</span>   <span class="number">0.5</span>   <span class="number">5.4</span>   <span class="number">7.5</span> <span class="number">200.0</span>    <span class="number">3</span>   <span class="number">1</span>      <span class="number">3</span></span><br><span class="line"><span class="number">59</span>    <span class="number">0.104</span>     <span class="number">2.50</span> <span class="number">13.2</span>   <span class="number">2.6</span>  <span class="number">15.8</span>   <span class="number">2.3</span>  <span class="number">46.0</span>    <span class="number">3</span>   <span class="number">2</span>      <span class="number">2</span></span><br><span class="line"><span class="number">60</span>    <span class="number">4.190</span>    <span class="number">58.00</span>  <span class="number">9.7</span>   <span class="number">0.6</span>  <span class="number">10.3</span>  <span class="number">24.0</span> <span class="number">210.0</span>    <span class="number">4</span>   <span class="number">3</span>      <span class="number">4</span></span><br><span class="line"><span class="number">61</span>    <span class="number">3.500</span>     <span class="number">3.90</span> <span class="number">12.8</span>   <span class="number">6.6</span>  <span class="number">19.4</span>   <span class="number">3.0</span>  <span class="number">14.0</span>    <span class="number">2</span>   <span class="number">1</span>      <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过<code>na.omit(sleep)</code>将数据框中的NA对应的这一行的数据删除。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">length</span><span class="punctuation">(</span>rownames<span class="punctuation">(</span>sleep<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">62</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">length</span><span class="punctuation">(</span>rownames<span class="punctuation">(</span>na.omit<span class="punctuation">(</span>sleep<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">42</span></span><br></pre></td></tr></table></figure>
<p>但是这样也会出现问题，比如NA占据的行数有一半，则会导致大量数据丢失，影响分析结果。</p>
<p>R提供了多种处理缺失值的方法：</p>
<p><img src="https://vip2.loli.io/2023/03/13/XP1x2LVI4KEhmqC.png" alt="image-20220806180034271"></p>
<p>其他缺失数据：</p>
<ol>
<li>缺失数据NaN，代表不可能的值；</li>
<li>Inf代表无穷，分为正无穷Inf和负无穷-Inf，代表无穷大或者无穷小。</li>
</ol>
<p>不同缺失值之间的差别：</p>
<ol>
<li>NA是存在的值，但是不知道是多少；</li>
<li>NaN是不存在的；</li>
<li>Inf存在，是无穷大或者无穷小，但是表示不可能的值。</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="number">1</span><span class="operator">/</span><span class="number">0</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">Inf</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="operator">-</span><span class="number">1</span><span class="operator">/</span><span class="number">0</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="literal">Inf</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="number">0</span><span class="operator">/</span><span class="number">0</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NaN</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">is.nan</span><span class="punctuation">(</span><span class="number">0</span><span class="operator">/</span><span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">TRUE</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">is.infinite</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">/</span><span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">TRUE</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">is.infinite</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="operator">/</span><span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">TRUE</span></span><br></pre></td></tr></table></figure>
<h3 id="2-9-字符串">2.9 字符串</h3>
<p>R语言支持正则表达式，正则表达式如下：</p>
<p><img src="https://vip2.loli.io/2023/03/13/kiVJt3FIcszSBga.png" alt="image-20220806190036731"></p>
<p>下面介绍处理字符串的函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> nchar<span class="punctuation">(</span><span class="string">&quot;hello world&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">11</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">month.name</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;January&quot;</span>   <span class="string">&quot;February&quot;</span>  <span class="string">&quot;March&quot;</span>     <span class="string">&quot;April&quot;</span>     <span class="string">&quot;May&quot;</span>       <span class="string">&quot;June&quot;</span>      <span class="string">&quot;July&quot;</span>      <span class="string">&quot;August&quot;</span>    <span class="string">&quot;September&quot;</span> <span class="string">&quot;October&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">11</span><span class="punctuation">]</span> <span class="string">&quot;November&quot;</span>  <span class="string">&quot;December&quot;</span> </span><br><span class="line"><span class="operator">&gt;</span> nchar<span class="punctuation">(</span><span class="built_in">month.name</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">7</span> <span class="number">8</span> <span class="number">5</span> <span class="number">5</span> <span class="number">3</span> <span class="number">4</span> <span class="number">4</span> <span class="number">6</span> <span class="number">9</span> <span class="number">7</span> <span class="number">8</span> <span class="number">8</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">length</span><span class="punctuation">(</span><span class="built_in">month.name</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">12</span></span><br><span class="line"><span class="operator">&gt;</span> nchar<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">12</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">345</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">1</span> <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> paste<span class="punctuation">(</span><span class="string">&quot;Everybody&quot;</span><span class="punctuation">,</span><span class="string">&quot;loves&quot;</span><span class="punctuation">,</span><span class="string">&quot;stats&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Everybody loves stats&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> paste<span class="punctuation">(</span><span class="string">&quot;Everybody&quot;</span><span class="punctuation">,</span><span class="string">&quot;loves&quot;</span><span class="punctuation">,</span><span class="string">&quot;stats&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;-&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Everybody-loves-stats&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">names</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Moe&quot;</span><span class="punctuation">,</span><span class="string">&quot;Larry&quot;</span><span class="punctuation">,</span><span class="string">&quot;Curly&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> paste<span class="punctuation">(</span><span class="built_in">names</span><span class="punctuation">,</span><span class="string">&quot;loves stats&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Moe loves stats&quot;</span>   <span class="string">&quot;Larry loves stats&quot;</span> <span class="string">&quot;Curly loves stats&quot;</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>nchar</code>可以用来统计字符数，空格也算一个字符。<code>length</code>计算的是元素的个数，而<code>nchar</code>计算的是每个元素字符的长度。<code>paste</code>是将多个字符串连成一个字符串，通过空格进行连接，也可以通过<code>sep</code>设定连接符，也可以将多个字符串分别和某一个固定的字符串进行连接。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> substr<span class="punctuation">(</span>x <span class="operator">=</span> <span class="built_in">month.name</span><span class="punctuation">,</span>start <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>stop <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Jan&quot;</span> <span class="string">&quot;Feb&quot;</span> <span class="string">&quot;Mar&quot;</span> <span class="string">&quot;Apr&quot;</span> <span class="string">&quot;May&quot;</span> <span class="string">&quot;Jun&quot;</span> <span class="string">&quot;Jul&quot;</span> <span class="string">&quot;Aug&quot;</span> <span class="string">&quot;Sep&quot;</span> <span class="string">&quot;Oct&quot;</span> <span class="string">&quot;Nov&quot;</span> <span class="string">&quot;Dec&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> temp <span class="operator">&lt;-</span> substr<span class="punctuation">(</span>x <span class="operator">=</span> <span class="built_in">month.name</span><span class="punctuation">,</span>start <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>stop <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> toupper<span class="punctuation">(</span>temp<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;JAN&quot;</span> <span class="string">&quot;FEB&quot;</span> <span class="string">&quot;MAR&quot;</span> <span class="string">&quot;APR&quot;</span> <span class="string">&quot;MAY&quot;</span> <span class="string">&quot;JUN&quot;</span> <span class="string">&quot;JUL&quot;</span> <span class="string">&quot;AUG&quot;</span> <span class="string">&quot;SEP&quot;</span> <span class="string">&quot;OCT&quot;</span> <span class="string">&quot;NOV&quot;</span> <span class="string">&quot;DEC&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> tolower<span class="punctuation">(</span>temp<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;jan&quot;</span> <span class="string">&quot;feb&quot;</span> <span class="string">&quot;mar&quot;</span> <span class="string">&quot;apr&quot;</span> <span class="string">&quot;may&quot;</span> <span class="string">&quot;jun&quot;</span> <span class="string">&quot;jul&quot;</span> <span class="string">&quot;aug&quot;</span> <span class="string">&quot;sep&quot;</span> <span class="string">&quot;oct&quot;</span> <span class="string">&quot;nov&quot;</span> <span class="string">&quot;dec&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> gsub<span class="punctuation">(</span><span class="string">&quot;^(\\w)&quot;</span><span class="punctuation">,</span><span class="string">&quot;\\U\\1&quot;</span><span class="punctuation">,</span>tolower<span class="punctuation">(</span>temp<span class="punctuation">)</span><span class="punctuation">,</span>perl <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Jan&quot;</span> <span class="string">&quot;Feb&quot;</span> <span class="string">&quot;Mar&quot;</span> <span class="string">&quot;Apr&quot;</span> <span class="string">&quot;May&quot;</span> <span class="string">&quot;Jun&quot;</span> <span class="string">&quot;Jul&quot;</span> <span class="string">&quot;Aug&quot;</span> <span class="string">&quot;Sep&quot;</span> <span class="string">&quot;Oct&quot;</span> <span class="string">&quot;Nov&quot;</span> <span class="string">&quot;Dec&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> gsub<span class="punctuation">(</span><span class="string">&quot;^(\\w)&quot;</span><span class="punctuation">,</span><span class="string">&quot;\\L\\1&quot;</span><span class="punctuation">,</span>tolower<span class="punctuation">(</span>temp<span class="punctuation">)</span><span class="punctuation">,</span>perl <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;jan&quot;</span> <span class="string">&quot;feb&quot;</span> <span class="string">&quot;mar&quot;</span> <span class="string">&quot;apr&quot;</span> <span class="string">&quot;may&quot;</span> <span class="string">&quot;jun&quot;</span> <span class="string">&quot;jul&quot;</span> <span class="string">&quot;aug&quot;</span> <span class="string">&quot;sep&quot;</span> <span class="string">&quot;oct&quot;</span> <span class="string">&quot;nov&quot;</span> <span class="string">&quot;dec&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> gsub<span class="punctuation">(</span><span class="string">&quot;^(\\w)&quot;</span><span class="punctuation">,</span><span class="string">&quot;\\L\\1&quot;</span><span class="punctuation">,</span>toupper<span class="punctuation">(</span>temp<span class="punctuation">)</span><span class="punctuation">,</span>perl <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;jAN&quot;</span> <span class="string">&quot;fEB&quot;</span> <span class="string">&quot;mAR&quot;</span> <span class="string">&quot;aPR&quot;</span> <span class="string">&quot;mAY&quot;</span> <span class="string">&quot;jUN&quot;</span> <span class="string">&quot;jUL&quot;</span> <span class="string">&quot;aUG&quot;</span> <span class="string">&quot;sEP&quot;</span> <span class="string">&quot;oCT&quot;</span> <span class="string">&quot;nOV&quot;</span> <span class="string">&quot;dEC&quot;</span></span><br></pre></td></tr></table></figure>
<p>总结：字符串分隔符<code>substr</code>可以进行字符串分割，<code>sub</code>进行一次字符替换，而<code>gsub</code>可以进行全局替换，需要使用正则表达式进行操作。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;b&quot;</span><span class="punctuation">,</span><span class="string">&quot;A+&quot;</span><span class="punctuation">,</span><span class="string">&quot;AC&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;b&quot;</span>  <span class="string">&quot;A+&quot;</span> <span class="string">&quot;AC&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> grep<span class="punctuation">(</span><span class="string">&quot;A+&quot;</span><span class="punctuation">,</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> grep<span class="punctuation">(</span><span class="string">&quot;A+&quot;</span><span class="punctuation">,</span>x<span class="punctuation">,</span>fixed <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> grep<span class="punctuation">(</span><span class="string">&quot;A+&quot;</span><span class="punctuation">,</span>x<span class="punctuation">,</span>fixed <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>grep</code>可以用来查找字符串，如果<code>grep</code>参数中<code>fixed</code>为<code>T</code>，则不支持正则表达式，返回值为匹配的下标，<code>grep</code>支持正则表达式，如果<code>Fixed</code>为<code>F</code>，则支持正则表达式，其中<code>A+</code>中的<code>+</code>号表示所有字符。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;b&quot;</span><span class="punctuation">,</span><span class="string">&quot;A+&quot;</span><span class="punctuation">,</span><span class="string">&quot;AC&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;b&quot;</span>  <span class="string">&quot;A+&quot;</span> <span class="string">&quot;AC&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> match<span class="punctuation">(</span><span class="string">&quot;AC&quot;</span><span class="punctuation">,</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>match</code>也可以进行字符串匹配，但是不支持正则表达式，没有<code>grep</code>强大。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> path <span class="operator">&lt;-</span> <span class="string">&quot;/use/local/bin/R&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> strsplit<span class="punctuation">(</span>path<span class="punctuation">,</span><span class="string">&quot;/&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;&quot;</span>      <span class="string">&quot;use&quot;</span>   <span class="string">&quot;local&quot;</span> <span class="string">&quot;bin&quot;</span>   <span class="string">&quot;R&quot;</span>  </span><br><span class="line"><span class="operator">&gt;</span> strsplit<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>path<span class="punctuation">,</span>path<span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&quot;/&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;&quot;</span>      <span class="string">&quot;use&quot;</span>   <span class="string">&quot;local&quot;</span> <span class="string">&quot;bin&quot;</span>   <span class="string">&quot;R&quot;</span>    </span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;&quot;</span>      <span class="string">&quot;use&quot;</span>   <span class="string">&quot;local&quot;</span> <span class="string">&quot;bin&quot;</span>   <span class="string">&quot;R&quot;</span>    </span><br></pre></td></tr></table></figure>
<p>总结：<code>strsplit</code>为字符串分割函数，需要指定分隔符，在上面的例子中，分隔符为<code>/</code>。<code>strsplit</code>返回的值是一个列表而不是一个向量。可以同时处理分割多个字符串，也方便后面的处理。</p>
<p>许多函数都有<code>fixed</code>参数设置，表示是否支持正则表达式，使用正则表达式很方便进行处理。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">face <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">13</span></span><br><span class="line">suit <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;spades&quot;</span><span class="punctuation">,</span><span class="string">&quot;clubs&quot;</span><span class="punctuation">,</span><span class="string">&quot;hearts&quot;</span><span class="punctuation">,</span><span class="string">&quot;diamonds&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> outer<span class="punctuation">(</span>suit<span class="punctuation">,</span>face<span class="punctuation">,</span>FUN<span class="operator">=</span>paste<span class="punctuation">)</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">9</span><span class="punctuation">]</span>        </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;spades 1&quot;</span>   <span class="string">&quot;spades 2&quot;</span>   <span class="string">&quot;spades 3&quot;</span>   <span class="string">&quot;spades 4&quot;</span>   <span class="string">&quot;spades 5&quot;</span>   <span class="string">&quot;spades 6&quot;</span>   <span class="string">&quot;spades 7&quot;</span>   <span class="string">&quot;spades 8&quot;</span>   <span class="string">&quot;spades 9&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;clubs 1&quot;</span>    <span class="string">&quot;clubs 2&quot;</span>    <span class="string">&quot;clubs 3&quot;</span>    <span class="string">&quot;clubs 4&quot;</span>    <span class="string">&quot;clubs 5&quot;</span>    <span class="string">&quot;clubs 6&quot;</span>    <span class="string">&quot;clubs 7&quot;</span>    <span class="string">&quot;clubs 8&quot;</span>    <span class="string">&quot;clubs 9&quot;</span>   </span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;hearts 1&quot;</span>   <span class="string">&quot;hearts 2&quot;</span>   <span class="string">&quot;hearts 3&quot;</span>   <span class="string">&quot;hearts 4&quot;</span>   <span class="string">&quot;hearts 5&quot;</span>   <span class="string">&quot;hearts 6&quot;</span>   <span class="string">&quot;hearts 7&quot;</span>   <span class="string">&quot;hearts 8&quot;</span>   <span class="string">&quot;hearts 9&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;diamonds 1&quot;</span> <span class="string">&quot;diamonds 2&quot;</span> <span class="string">&quot;diamonds 3&quot;</span> <span class="string">&quot;diamonds 4&quot;</span> <span class="string">&quot;diamonds 5&quot;</span> <span class="string">&quot;diamonds 6&quot;</span> <span class="string">&quot;diamonds 7&quot;</span> <span class="string">&quot;diamonds 8&quot;</span> <span class="string">&quot;diamonds 9&quot;</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">11</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">13</span><span class="punctuation">]</span>        </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;spades 10&quot;</span>   <span class="string">&quot;spades 11&quot;</span>   <span class="string">&quot;spades 12&quot;</span>   <span class="string">&quot;spades 13&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;clubs 10&quot;</span>    <span class="string">&quot;clubs 11&quot;</span>    <span class="string">&quot;clubs 12&quot;</span>    <span class="string">&quot;clubs 13&quot;</span>   </span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;hearts 10&quot;</span>   <span class="string">&quot;hearts 11&quot;</span>   <span class="string">&quot;hearts 12&quot;</span>   <span class="string">&quot;hearts 13&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;diamonds 10&quot;</span> <span class="string">&quot;diamonds 11&quot;</span> <span class="string">&quot;diamonds 12&quot;</span> <span class="string">&quot;diamonds 13&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> outer<span class="punctuation">(</span>suit<span class="punctuation">,</span>face<span class="punctuation">,</span>FUN<span class="operator">=</span>paste<span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;-&quot;</span><span class="punctuation">)</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">9</span><span class="punctuation">]</span>        </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;spades-1&quot;</span>   <span class="string">&quot;spades-2&quot;</span>   <span class="string">&quot;spades-3&quot;</span>   <span class="string">&quot;spades-4&quot;</span>   <span class="string">&quot;spades-5&quot;</span>   <span class="string">&quot;spades-6&quot;</span>   <span class="string">&quot;spades-7&quot;</span>   <span class="string">&quot;spades-8&quot;</span>   <span class="string">&quot;spades-9&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;clubs-1&quot;</span>    <span class="string">&quot;clubs-2&quot;</span>    <span class="string">&quot;clubs-3&quot;</span>    <span class="string">&quot;clubs-4&quot;</span>    <span class="string">&quot;clubs-5&quot;</span>    <span class="string">&quot;clubs-6&quot;</span>    <span class="string">&quot;clubs-7&quot;</span>    <span class="string">&quot;clubs-8&quot;</span>    <span class="string">&quot;clubs-9&quot;</span>   </span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;hearts-1&quot;</span>   <span class="string">&quot;hearts-2&quot;</span>   <span class="string">&quot;hearts-3&quot;</span>   <span class="string">&quot;hearts-4&quot;</span>   <span class="string">&quot;hearts-5&quot;</span>   <span class="string">&quot;hearts-6&quot;</span>   <span class="string">&quot;hearts-7&quot;</span>   <span class="string">&quot;hearts-8&quot;</span>   <span class="string">&quot;hearts-9&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;diamonds-1&quot;</span> <span class="string">&quot;diamonds-2&quot;</span> <span class="string">&quot;diamonds-3&quot;</span> <span class="string">&quot;diamonds-4&quot;</span> <span class="string">&quot;diamonds-5&quot;</span> <span class="string">&quot;diamonds-6&quot;</span> <span class="string">&quot;diamonds-7&quot;</span> <span class="string">&quot;diamonds-8&quot;</span> <span class="string">&quot;diamonds-9&quot;</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">11</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">13</span><span class="punctuation">]</span>        </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;spades-10&quot;</span>   <span class="string">&quot;spades-11&quot;</span>   <span class="string">&quot;spades-12&quot;</span>   <span class="string">&quot;spades-13&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;clubs-10&quot;</span>    <span class="string">&quot;clubs-11&quot;</span>    <span class="string">&quot;clubs-12&quot;</span>    <span class="string">&quot;clubs-13&quot;</span>   </span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;hearts-10&quot;</span>   <span class="string">&quot;hearts-11&quot;</span>   <span class="string">&quot;hearts-12&quot;</span>   <span class="string">&quot;hearts-13&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;diamonds-10&quot;</span> <span class="string">&quot;diamonds-11&quot;</span> <span class="string">&quot;diamonds-12&quot;</span> <span class="string">&quot;diamonds-13&quot;</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>outer</code>函数可以生成两个字符串的所有组合，两个字符串的连接默认通过空格的形式，也可以自定义连接符。</p>
<h3 id="2-10-日期和时间">2.10 日期和时间</h3>
<p>时间序列分析：</p>
<ol>
<li>对时间序列的描述；</li>
<li>利用前面的结果进行预测。</li>
</ol>
<p>时间序列包：TimeSeries</p>
<p>时间数据集：sunspots、presidents、airmiles</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>presidents<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;ts&quot;</span></span><br></pre></td></tr></table></figure>
<p>总结：这里的<code>ts</code>表示时间序列，有些数据集是时间序列数据，但是数据形式是数据框。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> Sys.Date<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;2022-08-06&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>Sys.Date<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Date&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> a <span class="operator">&lt;-</span> <span class="string">&quot;2017-01-01&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> a</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;2017-01-01&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> as.Date<span class="punctuation">(</span>a<span class="punctuation">,</span>format <span class="operator">=</span> <span class="string">&quot;%Y-%m-%d&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;2017-01-01&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>as.Date<span class="punctuation">(</span>a<span class="punctuation">,</span>format <span class="operator">=</span> <span class="string">&quot;%Y-%m-%d&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Date&quot;</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>Sys.Date</code>函数可以查看当前的年月日，<code>Sys.Date()</code>中的数据类型为<code>Date</code>类型，可以通过<code>as.Date</code>函数将字符串类型转换成<code>Date</code>类型。</p>
<p>更多格式化参数，可以通过<code>?strftime</code>命令参看<code>strftime</code>函数中的介绍。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> seq<span class="punctuation">(</span>as.Date<span class="punctuation">(</span><span class="string">&quot;2017-01-01&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>as.Date<span class="punctuation">(</span><span class="string">&quot;2017-06-23&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>by <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;2017-01-01&quot;</span> <span class="string">&quot;2017-01-06&quot;</span> <span class="string">&quot;2017-01-11&quot;</span> <span class="string">&quot;2017-01-16&quot;</span> <span class="string">&quot;2017-01-21&quot;</span> <span class="string">&quot;2017-01-26&quot;</span> <span class="string">&quot;2017-01-31&quot;</span> <span class="string">&quot;2017-02-05&quot;</span> <span class="string">&quot;2017-02-10&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="string">&quot;2017-02-15&quot;</span> <span class="string">&quot;2017-02-20&quot;</span> <span class="string">&quot;2017-02-25&quot;</span> <span class="string">&quot;2017-03-02&quot;</span> <span class="string">&quot;2017-03-07&quot;</span> <span class="string">&quot;2017-03-12&quot;</span> <span class="string">&quot;2017-03-17&quot;</span> <span class="string">&quot;2017-03-22&quot;</span> <span class="string">&quot;2017-03-27&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">19</span><span class="punctuation">]</span> <span class="string">&quot;2017-04-01&quot;</span> <span class="string">&quot;2017-04-06&quot;</span> <span class="string">&quot;2017-04-11&quot;</span> <span class="string">&quot;2017-04-16&quot;</span> <span class="string">&quot;2017-04-21&quot;</span> <span class="string">&quot;2017-04-26&quot;</span> <span class="string">&quot;2017-05-01&quot;</span> <span class="string">&quot;2017-05-06&quot;</span> <span class="string">&quot;2017-05-11&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">28</span><span class="punctuation">]</span> <span class="string">&quot;2017-05-16&quot;</span> <span class="string">&quot;2017-05-21&quot;</span> <span class="string">&quot;2017-05-26&quot;</span> <span class="string">&quot;2017-05-31&quot;</span> <span class="string">&quot;2017-06-05&quot;</span> <span class="string">&quot;2017-06-10&quot;</span> <span class="string">&quot;2017-06-15&quot;</span> <span class="string">&quot;2017-06-20&quot;</span></span><br></pre></td></tr></table></figure>
<p>总结：可以使用<code>seq</code>函数创建连续的时间点，<code>by</code>表示间隔五天。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> sales <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span>runif<span class="punctuation">(</span><span class="number">48</span><span class="punctuation">,</span><span class="built_in">min</span><span class="operator">=</span><span class="number">50</span><span class="punctuation">,</span><span class="built_in">max</span><span class="operator">=</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> sales</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">56</span>  <span class="number">88</span>  <span class="number">87</span>  <span class="number">91</span>  <span class="number">83</span>  <span class="number">82</span>  <span class="number">90</span>  <span class="number">68</span> <span class="number">100</span>  <span class="number">64</span>  <span class="number">64</span>  <span class="number">62</span>  <span class="number">85</span>  <span class="number">51</span>  <span class="number">76</span>  <span class="number">91</span>  <span class="number">53</span>  <span class="number">94</span>  <span class="number">80</span>  <span class="number">93</span>  <span class="number">77</span>  <span class="number">73</span>  <span class="number">53</span>  <span class="number">59</span>  <span class="number">88</span>  <span class="number">71</span>  <span class="number">98</span>  <span class="number">89</span>  <span class="number">74</span>  <span class="number">66</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span>  <span class="number">91</span>  <span class="number">57</span>  <span class="number">71</span>  <span class="number">50</span>  <span class="number">67</span>  <span class="number">91</span>  <span class="number">70</span>  <span class="number">60</span>  <span class="number">51</span>  <span class="number">71</span>  <span class="number">99</span>  <span class="number">73</span>  <span class="number">95</span>  <span class="number">52</span>  <span class="number">57</span>  <span class="number">72</span>  <span class="number">82</span>  <span class="number">72</span></span><br><span class="line"><span class="operator">&gt;</span> ts<span class="punctuation">(</span>sales<span class="punctuation">,</span>start <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2010</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span>end <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2014</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span>frequency <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">Time Series<span class="operator">:</span></span><br><span class="line">Start <span class="operator">=</span> <span class="number">2014</span> </span><br><span class="line">End <span class="operator">=</span> <span class="number">2017</span> </span><br><span class="line">Frequency <span class="operator">=</span> <span class="number">1</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">56</span> <span class="number">88</span> <span class="number">87</span> <span class="number">91</span></span><br><span class="line"><span class="operator">&gt;</span> ts<span class="punctuation">(</span>sales<span class="punctuation">,</span>start <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2010</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span>end <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2014</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span>frequency <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">     Qtr1 Qtr2 Qtr3 Qtr4</span><br><span class="line"><span class="number">2011</span>   <span class="number">56</span>   <span class="number">88</span>   <span class="number">87</span>   <span class="number">91</span></span><br><span class="line"><span class="number">2012</span>   <span class="number">83</span>   <span class="number">82</span>   <span class="number">90</span>   <span class="number">68</span></span><br><span class="line"><span class="number">2013</span>  <span class="number">100</span>   <span class="number">64</span>   <span class="number">64</span>   <span class="number">62</span></span><br><span class="line"><span class="number">2014</span>   <span class="number">85</span>   <span class="number">51</span>   <span class="number">76</span>   <span class="number">91</span></span><br><span class="line"><span class="operator">&gt;</span> ts<span class="punctuation">(</span>sales<span class="punctuation">,</span>start <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2010</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span>end <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2014</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span>frequency <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span></span><br><span class="line">     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span><br><span class="line"><span class="number">2010</span>                  <span class="number">56</span>  <span class="number">88</span>  <span class="number">87</span>  <span class="number">91</span>  <span class="number">83</span>  <span class="number">82</span>  <span class="number">90</span>  <span class="number">68</span></span><br><span class="line"><span class="number">2011</span> <span class="number">100</span>  <span class="number">64</span>  <span class="number">64</span>  <span class="number">62</span>  <span class="number">85</span>  <span class="number">51</span>  <span class="number">76</span>  <span class="number">91</span>  <span class="number">53</span>  <span class="number">94</span>  <span class="number">80</span>  <span class="number">93</span></span><br><span class="line"><span class="number">2012</span>  <span class="number">77</span>  <span class="number">73</span>  <span class="number">53</span>  <span class="number">59</span>  <span class="number">88</span>  <span class="number">71</span>  <span class="number">98</span>  <span class="number">89</span>  <span class="number">74</span>  <span class="number">66</span>  <span class="number">91</span>  <span class="number">57</span></span><br><span class="line"><span class="number">2013</span>  <span class="number">71</span>  <span class="number">50</span>  <span class="number">67</span>  <span class="number">91</span>  <span class="number">70</span>  <span class="number">60</span>  <span class="number">51</span>  <span class="number">71</span>  <span class="number">99</span>  <span class="number">73</span>  <span class="number">95</span>  <span class="number">52</span></span><br><span class="line"><span class="number">2014</span>  <span class="number">57</span>  <span class="number">72</span>  <span class="number">82</span>  <span class="number">72</span>                 </span><br></pre></td></tr></table></figure>
<p>总结：<code>runif(48,min=50,max=100)</code>表示随机生成均匀分布d48个数值，最小值为50，最大值为100。<code>round</code>表示四舍五入取整。<code>ts</code>可以将向量转换为时间序列，<code>ts</code>中的<code>frequency</code>值为1，表示以年为单位，如果值为4，表示以季度为单位，如果值为12，表示以月为单位，没有以天为单位的，一般时间序列不用天为单位。</p>
<h3 id="2-11-常见错误">2.11 常见错误</h3>
<p>注意：变量赋值要用<code>c</code>，需要注意括号的使用，字符串需要加上引号。在R语言中文件地址用正斜线，反斜线用来转义。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span>seq<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">      <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">5</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">5</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">6</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">6</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">7</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">7</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">8</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">8</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">9</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">9</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">10</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">11</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">11</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">12</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">12</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">13</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">13</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">14</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">14</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">15</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">15</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">16</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">16</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">17</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">18</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">19</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">20</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">20</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">21</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">22</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">23</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">7</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">24</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">10</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">26</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> getwd<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;C:/Users/ywwsn/Documents&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> setwd<span class="punctuation">(</span><span class="string">&quot;c:\\Users\\Default&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> setwd<span class="punctuation">(</span><span class="string">&quot;c:/Users/Default&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果出现错误，可以访问网站进行解决，比如Google、Rblogger、quickR、stackoverflow等。</p>
<h2 id="3-数据基本操作">3 数据基本操作</h2>
<h3 id="3-1-获取数据">3.1 获取数据</h3>
<p>R获取数据三种途径：</p>
<ol>
<li>利用键盘来输入数据；</li>
<li>通过读取存储在外部文件上的数据；</li>
<li>通过访问数据库系统来获取数据。</li>
</ol>
<p>手动输入方式：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> status <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Poor&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Improved&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Excellent&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Poor&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>patientID<span class="punctuation">,</span> age<span class="punctuation">,</span> diabetes<span class="punctuation">,</span> status<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> data</span><br><span class="line">  patientID age diabetes    status</span><br><span class="line"><span class="number">1</span>         <span class="number">1</span>  <span class="number">25</span>    Type1      Poor</span><br><span class="line"><span class="number">2</span>         <span class="number">2</span>  <span class="number">34</span>    Type2  Improved</span><br><span class="line"><span class="number">3</span>         <span class="number">3</span>  <span class="number">28</span>    Type1 Excellent</span><br><span class="line"><span class="number">4</span>         <span class="number">4</span>  <span class="number">52</span>    Type1      Poor</span><br><span class="line"><span class="operator">&gt;</span> data2 <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>patientID<span class="operator">=</span>character<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>admdate<span class="operator">=</span>character<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>age<span class="operator">=</span>numeric<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>diabetes<span class="operator">=</span>character<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>status<span class="operator">=</span>character<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> data2</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> patientID admdate   age       diabetes  status   </span><br><span class="line"><span class="operator">&lt;</span><span class="number">0</span> 行<span class="operator">&gt;</span> <span class="punctuation">(</span>或<span class="number">0</span><span class="operator">-</span>长度的row.names<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> data2 <span class="operator">&lt;-</span> edit<span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> data2</span><br><span class="line">  patientID    admdate age diabetes    status</span><br><span class="line"><span class="number">1</span>         <span class="number">1</span>  <span class="number">10</span><span class="operator">/</span><span class="number">15</span><span class="operator">/</span><span class="number">200</span>  <span class="number">25</span>    Type1      Poor</span><br><span class="line"><span class="number">2</span>         <span class="number">2</span> <span class="number">11</span><span class="operator">/</span><span class="number">01</span><span class="operator">/</span><span class="number">2009</span>  <span class="number">34</span>    Type2  Improved</span><br><span class="line"><span class="number">3</span>         <span class="number">3</span> <span class="number">10</span><span class="operator">/</span><span class="number">21</span><span class="operator">/</span><span class="number">2009</span>  <span class="number">28</span>    Type1 Excellent</span><br><span class="line"><span class="number">4</span>         <span class="number">4</span> <span class="number">10</span><span class="operator">/</span><span class="number">28</span><span class="operator">/</span><span class="number">2009</span>  <span class="number">52</span>    Type1      Poor</span><br></pre></td></tr></table></figure>
<p>在运行<code>data2 &lt;- edit(data2)</code>命令时会弹出下面的数据编辑器，进行数据输入：</p>
<p><img src="https://vip2.loli.io/2023/03/13/8tToc6379qGXUV5.png" alt="image-20220807100838951"></p>
<p>在linux系统中如果无法打开数据编辑器，可以用vim进行编辑。</p>
<p>也可以使用<code>fix</code>函数启动数据编辑器进行边界，<code>fix</code>修改后会直接保存。</p>
<p>通过IDBC访问数据库，ODBC（Open Database Connectivity）是开放数据库连接。</p>
<p>在R中，可以RODBC包连接和访问数据库。：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> install.packages<span class="punctuation">(</span><span class="string">&quot;RODBC&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>RODBC包允许R和一个通过ODBC连接的SQL数据库之间进行双向的通信，这样不仅可以用R读取数据库的内容，同时还可以将R处理过的数据写入数据库中。需要使用MySQL、SQLlite包就下载相应的包。</p>
<h3 id="3-2-读取文件">3.2 读取文件</h3>
<p>读取纯文本文件，可以使用<code>read.table</code>函数，将读取的文件赋值给一个参数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;input.txt&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">  Ozone Solar.R Wind Temp Month Day</span><br><span class="line"><span class="number">1</span>    <span class="number">41</span>     <span class="number">190</span>  <span class="number">7.4</span>   <span class="number">67</span>     <span class="number">5</span>   <span class="number">1</span></span><br><span class="line"><span class="number">2</span>    <span class="number">36</span>     <span class="number">118</span>  <span class="number">8.0</span>   <span class="number">72</span>     <span class="number">5</span>   <span class="number">2</span></span><br><span class="line"><span class="number">3</span>    <span class="number">12</span>     <span class="number">149</span> <span class="number">12.6</span>   <span class="number">74</span>     <span class="number">5</span>   <span class="number">3</span></span><br><span class="line"><span class="number">4</span>    <span class="number">18</span>     <span class="number">313</span> <span class="number">11.5</span>   <span class="number">62</span>     <span class="number">5</span>   <span class="number">4</span></span><br><span class="line"><span class="number">5</span>    <span class="literal">NA</span>      <span class="literal">NA</span> <span class="number">14.3</span>   <span class="number">56</span>     <span class="number">5</span>   <span class="number">5</span></span><br><span class="line"><span class="number">6</span>    <span class="number">28</span>      <span class="literal">NA</span> <span class="number">14.9</span>   <span class="number">66</span>     <span class="number">5</span>   <span class="number">6</span></span><br><span class="line"><span class="operator">&gt;</span> tail<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">    Ozone Solar.R Wind Temp Month Day</span><br><span class="line"><span class="number">148</span>    <span class="number">14</span>      <span class="number">20</span> <span class="number">16.6</span>   <span class="number">63</span>     <span class="number">9</span>  <span class="number">25</span></span><br><span class="line"><span class="number">149</span>    <span class="number">30</span>     <span class="number">193</span>  <span class="number">6.9</span>   <span class="number">70</span>     <span class="number">9</span>  <span class="number">26</span></span><br><span class="line"><span class="number">150</span>    <span class="literal">NA</span>     <span class="number">145</span> <span class="number">13.2</span>   <span class="number">77</span>     <span class="number">9</span>  <span class="number">27</span></span><br><span class="line"><span class="number">151</span>    <span class="number">14</span>     <span class="number">191</span> <span class="number">14.3</span>   <span class="number">75</span>     <span class="number">9</span>  <span class="number">28</span></span><br><span class="line"><span class="number">152</span>    <span class="number">18</span>     <span class="number">131</span>  <span class="number">8.0</span>   <span class="number">76</span>     <span class="number">9</span>  <span class="number">29</span></span><br><span class="line"><span class="number">153</span>    <span class="number">20</span>     <span class="number">223</span> <span class="number">11.5</span>   <span class="number">68</span>     <span class="number">9</span>  <span class="number">30</span></span><br><span class="line"></span><br><span class="line">x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;f:/Learning/R语言入门与数据分析/RData/input.txt&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;input.csv&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">                    V1                                                                  V2</span><br><span class="line"><span class="number">1</span>                      <span class="punctuation">,</span><span class="string">&quot;mpg&quot;</span><span class="punctuation">,</span><span class="string">&quot;cyl&quot;</span><span class="punctuation">,</span><span class="string">&quot;disp&quot;</span><span class="punctuation">,</span><span class="string">&quot;hp&quot;</span><span class="punctuation">,</span><span class="string">&quot;drat&quot;</span><span class="punctuation">,</span><span class="string">&quot;wt&quot;</span><span class="punctuation">,</span><span class="string">&quot;qsec&quot;</span><span class="punctuation">,</span><span class="string">&quot;vs&quot;</span><span class="punctuation">,</span><span class="string">&quot;am&quot;</span><span class="punctuation">,</span><span class="string">&quot;gear&quot;</span><span class="punctuation">,</span><span class="string">&quot;carb&quot;</span></span><br><span class="line"><span class="number">2</span>            Mazda RX4                                <span class="punctuation">,</span><span class="number">21</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span><span class="number">160</span><span class="punctuation">,</span><span class="number">110</span><span class="punctuation">,</span><span class="number">3.9</span><span class="punctuation">,</span><span class="number">2.62</span><span class="punctuation">,</span><span class="number">16.46</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">4</span></span><br><span class="line"><span class="number">3</span>        Mazda RX4 Wag                               <span class="punctuation">,</span><span class="number">21</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span><span class="number">160</span><span class="punctuation">,</span><span class="number">110</span><span class="punctuation">,</span><span class="number">3.9</span><span class="punctuation">,</span><span class="number">2.875</span><span class="punctuation">,</span><span class="number">17.02</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">4</span></span><br><span class="line"><span class="number">4</span>           Datsun <span class="number">710</span>                              <span class="punctuation">,</span><span class="number">22.8</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">108</span><span class="punctuation">,</span><span class="number">93</span><span class="punctuation">,</span><span class="number">3.85</span><span class="punctuation">,</span><span class="number">2.32</span><span class="punctuation">,</span><span class="number">18.61</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">1</span></span><br><span class="line">...</span><br><span class="line"><span class="number">31</span>        Ferrari Dino                              <span class="punctuation">,</span><span class="number">19.7</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span><span class="number">145</span><span class="punctuation">,</span><span class="number">175</span><span class="punctuation">,</span><span class="number">3.62</span><span class="punctuation">,</span><span class="number">2.77</span><span class="punctuation">,</span><span class="number">15.5</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">6</span></span><br><span class="line"><span class="number">32</span>       Maserati Bora                                <span class="punctuation">,</span><span class="number">15</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">,</span><span class="number">301</span><span class="punctuation">,</span><span class="number">335</span><span class="punctuation">,</span><span class="number">3.54</span><span class="punctuation">,</span><span class="number">3.57</span><span class="punctuation">,</span><span class="number">14.6</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">8</span></span><br><span class="line"><span class="number">33</span>          Volvo <span class="number">142</span>E                              <span class="punctuation">,</span><span class="number">21.4</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">121</span><span class="punctuation">,</span><span class="number">109</span><span class="punctuation">,</span><span class="number">4.11</span><span class="punctuation">,</span><span class="number">2.78</span><span class="punctuation">,</span><span class="number">18.6</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;input.csv&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;,&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">                    V1   V2  V3    V4  V5   V6    V7    V8 V9 V10  V11  V12</span><br><span class="line"><span class="number">1</span>                       mpg cyl  disp  hp drat    wt  qsec vs  am gear carb</span><br><span class="line"><span class="number">2</span>            Mazda RX4   <span class="number">21</span>   <span class="number">6</span>   <span class="number">160</span> <span class="number">110</span>  <span class="number">3.9</span>  <span class="number">2.62</span> <span class="number">16.46</span>  <span class="number">0</span>   <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">3</span>        Mazda RX4 Wag   <span class="number">21</span>   <span class="number">6</span>   <span class="number">160</span> <span class="number">110</span>  <span class="number">3.9</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>   <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">4</span>           Datsun <span class="number">710</span> <span class="number">22.8</span>   <span class="number">4</span>   <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span>  <span class="number">2.32</span> <span class="number">18.61</span>  <span class="number">1</span>   <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line"><span class="number">31</span>        Ferrari Dino <span class="number">19.7</span>   <span class="number">6</span>   <span class="number">145</span> <span class="number">175</span> <span class="number">3.62</span>  <span class="number">2.77</span>  <span class="number">15.5</span>  <span class="number">0</span>   <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line"><span class="number">32</span>       Maserati Bora   <span class="number">15</span>   <span class="number">8</span>   <span class="number">301</span> <span class="number">335</span> <span class="number">3.54</span>  <span class="number">3.57</span>  <span class="number">14.6</span>  <span class="number">0</span>   <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line"><span class="number">33</span>          Volvo <span class="number">142</span>E <span class="number">21.4</span>   <span class="number">4</span>   <span class="number">121</span> <span class="number">109</span> <span class="number">4.11</span>  <span class="number">2.78</span>  <span class="number">18.6</span>  <span class="number">1</span>   <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;input.csv&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;,&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">                     X  mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line"><span class="number">1</span>            Mazda RX4 <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">2</span>        Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">3</span>           Datsun <span class="number">710</span> <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line"><span class="number">30</span>        Ferrari Dino <span class="number">19.7</span>   <span class="number">6</span>   <span class="number">145</span> <span class="number">175</span> <span class="number">3.62</span>  <span class="number">2.77</span>  <span class="number">15.5</span>  <span class="number">0</span>   <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line"><span class="number">31</span>       Maserati Bora <span class="number">15.0</span>   <span class="number">8</span> <span class="number">301.0</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line"><span class="number">32</span>          Volvo <span class="number">142</span>E <span class="number">21.4</span>   <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;input 1.txt&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>skip <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">    Ozone Solar.R Wind Temp Month Day</span><br><span class="line"><span class="number">1</span>      <span class="number">41</span>     <span class="number">190</span>  <span class="number">7.4</span>   <span class="number">67</span>     <span class="number">5</span>   <span class="number">1</span></span><br><span class="line"><span class="number">2</span>      <span class="number">36</span>     <span class="number">118</span>  <span class="number">8.0</span>   <span class="number">72</span>     <span class="number">5</span>   <span class="number">2</span></span><br><span class="line"><span class="number">3</span>      <span class="number">12</span>     <span class="number">149</span> <span class="number">12.6</span>   <span class="number">74</span>     <span class="number">5</span>   <span class="number">3</span></span><br><span class="line">...</span><br><span class="line"><span class="number">151</span>    <span class="number">14</span>     <span class="number">191</span> <span class="number">14.3</span>   <span class="number">75</span>     <span class="number">9</span>  <span class="number">28</span></span><br><span class="line"><span class="number">152</span>    <span class="number">18</span>     <span class="number">131</span>  <span class="number">8.0</span>   <span class="number">76</span>     <span class="number">9</span>  <span class="number">29</span></span><br><span class="line"><span class="number">153</span>    <span class="number">20</span>     <span class="number">223</span> <span class="number">11.5</span>   <span class="number">68</span>     <span class="number">9</span>  <span class="number">30</span></span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;input 1.txt&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>skip <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span>nrows <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">  X1 X41 X190 X7.4 X67 X5 X1.1</span><br><span class="line"><span class="number">1</span>  <span class="number">2</span>  <span class="number">36</span>  <span class="number">118</span>  <span class="number">8.0</span>  <span class="number">72</span>  <span class="number">5</span>    <span class="number">2</span></span><br><span class="line"><span class="number">2</span>  <span class="number">3</span>  <span class="number">12</span>  <span class="number">149</span> <span class="number">12.6</span>  <span class="number">74</span>  <span class="number">5</span>    <span class="number">3</span></span><br><span class="line"><span class="number">3</span>  <span class="number">4</span>  <span class="number">18</span>  <span class="number">313</span> <span class="number">11.5</span>  <span class="number">62</span>  <span class="number">5</span>    <span class="number">4</span></span><br><span class="line"><span class="number">4</span>  <span class="number">5</span>  <span class="literal">NA</span>   <span class="literal">NA</span> <span class="number">14.3</span>  <span class="number">56</span>  <span class="number">5</span>    <span class="number">5</span></span><br><span class="line"><span class="number">5</span>  <span class="number">6</span>  <span class="number">28</span>   <span class="literal">NA</span> <span class="number">14.9</span>  <span class="number">66</span>  <span class="number">5</span>    <span class="number">6</span></span><br><span class="line"><span class="number">6</span>  <span class="number">7</span>  <span class="number">23</span>  <span class="number">299</span>  <span class="number">8.6</span>  <span class="number">65</span>  <span class="number">5</span>    <span class="number">7</span></span><br></pre></td></tr></table></figure>
<p>总结：这里的<code>head</code>为显示<code>x</code>的头部6行，<code>tail</code>为显示<code>x</code>的尾部6行。<code>read.table</code>读取的文件可以写全局路径。如果读写的是csv文件，需要将分隔符设为<code>,</code>。否则会出现问题，如果想知道用什么分隔符，可以打开文件看看。<code>header</code>参数如果为TRUE表示将第一行作为变量名称。<code>skip</code>参数用来跳过部分内容，比如有些数据会有介绍性文字。通过<code>skip</code>和<code>nrows</code>组合可以读取任意一段数据。<code>na.strings</code>参数可以将设定的其他软件中的缺失符号替换为NA，NA属于R中的缺失值。<code>stringAsFactors</code>控制读入的字符串是否转换成因子，R读取数据时，数字被读取成数值型数据，而在读取字符串时，会默认将读取的字符串转为因子类型，但是很多情况下不需要这样的转换，因此需要将<code>stringAsFactors</code>设为FALSE。</p>
<p>除了<code>read.table</code>函数，还有<code>read.csv</code>函数，<code>read.csv</code>函数默认用<code>,</code>分隔。<code>read.delim</code>表示读取用制表符分割的文件，<code>read.fwf</code>表示读取固定宽度的文件，每一列都开始于固定的位置，例如：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read.fwf<span class="punctuation">(</span><span class="string">&quot;fwf.txt&quot;</span><span class="punctuation">,</span>widths <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>使用<code>read.fwf</code>需要用<code>widths</code>参数给定每一列所占用的宽度值。这种文件使用的不多。</p>
<p>R还支持读取网络文件，<code>read.table</code>会将文件下载到本地。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;https://codeload.github.com/mperdeck/LINQtoCSV/zip/master&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果读取网页中的数据，需要安装包<code>XML</code>，然后通过<code>readHTMLTable</code>函数进行读取，如果想读取网页中第三个表格的数据，可以将<code>which</code>参数值设为3。</p>
<p>可以通过<code>foreign</code>包中的函数对其他软件格式的数据进行导入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">help(package = &quot;foreign&quot;)</span><br></pre></td></tr></table></figure>
<p>如果其他格式的文件不在<code>foreign</code>包中，一种方法就是另存为文本文件，另一种就是搜索R中对应的包，例如搜索能够读取Matlab相关格式的包，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RSiteSearch<span class="punctuation">(</span><span class="string">&quot;Matlab&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>R还支持读取剪贴板的数据：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;clipboard&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">                   X  mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line"><span class="number">1</span>          Mazda RX4 <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">2</span>      Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">3</span>         Datsun <span class="number">710</span> <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line"><span class="number">4</span>     Hornet <span class="number">4</span> Drive <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line"><span class="number">5</span>  Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> readClipboard<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;\tmpg\tcyl\tdisp\thp\tdrat\twt\tqsec\tvs\tam\tgear\tcarb&quot;</span>           </span><br><span class="line"> <span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span> <span class="string">&quot;Mazda RX4\t21\t6\t160\t110\t3.9\t2.62\t16.46\t0\t1\t4\t4&quot;</span>           </span><br><span class="line"> <span class="punctuation">[</span><span class="number">3</span><span class="punctuation">]</span> <span class="string">&quot;Mazda RX4 Wag\t21\t6\t160\t110\t3.9\t2.875\t17.02\t0\t1\t4\t4&quot;</span>      </span><br><span class="line"> <span class="punctuation">[</span><span class="number">4</span><span class="punctuation">]</span> <span class="string">&quot;Datsun 710\t22.8\t4\t108\t93\t3.85\t2.32\t18.61\t1\t1\t4\t1&quot;</span>        </span><br><span class="line"> <span class="punctuation">[</span><span class="number">5</span><span class="punctuation">]</span> <span class="string">&quot;Hornet 4 Drive\t21.4\t6\t258\t110\t3.08\t3.215\t19.44\t1\t0\t3\t1&quot;</span>  </span><br><span class="line"> <span class="punctuation">[</span><span class="number">6</span><span class="punctuation">]</span> <span class="string">&quot;Hornet Sportabout\t18.7\t8\t360\t175\t3.15\t3.44\t17.02\t0\t0\t3\t2&quot;</span>    </span><br></pre></td></tr></table></figure>
<p>总结：可以通过<code>read.table(&quot;clipboard&quot;,header = T, sep = &quot;\t&quot;)</code>来读取剪贴板中的表格数据；或者通过<code>readClipboard</code>函数也可以直接读取。</p>
<p>R也可以直接读取压缩文件：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> read.table<span class="punctuation">(</span>gzfile<span class="punctuation">(</span><span class="string">&quot;input.txt.gz&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果遇到不标准的文件格式，可以通过<code>readLines</code>函数和<code>scan</code>函数来处理，根据每一行甚至每一单元来读取文件。<code>readLines</code>通过字符串的形式显示访问结果。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readLines<span class="punctuation">(</span><span class="string">&quot;input.csv&quot;</span><span class="punctuation">,</span>n<span class="operator">=</span><span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>其中<code>n</code>表示读入的最大行数</p>
<p><code>scan</code>每读取一个单元，根据指令进行处理，第一个参数为文件的地址，用来描述<code>scan</code>所期望输入文件的单元，第二个参数为<code>what</code>，指定读写数据的类型，是数值型、整型还是逻辑型，scan函数可以重复执行指定的模式，直到读取所有需要的数据。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> scan<span class="punctuation">(</span><span class="string">&quot;scan.txt&quot;</span><span class="punctuation">,</span>what <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>X1 <span class="operator">=</span> character<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>X2 <span class="operator">=</span> numeric<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>X3 <span class="operator">=</span> numeric<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">Read <span class="number">20</span> records</span><br><span class="line"><span class="operator">$</span>X1</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">18</span><span class="punctuation">]</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>X2</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>X3</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span></span><br></pre></td></tr></table></figure>
<p>这里<code>character</code>表示首先读取3个字符串内容，然后再分别读取两次数值，因为给定的数据呈现一个规律：第一列先是一个字符，然后两列数字，后面第四列往后也是同样的规律。</p>
<p><img src="https://vip2.loli.io/2023/03/13/WpJtvNFPCf1R7rY.png" alt="image-20220807191906338"></p>
<h3 id="3-3-写入文件">3.3 写入文件</h3>
<p>写入文件有两种方法，分别为write和cat，write是将数据写入文件中，而cat是将数据显示在屏幕上。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">write<span class="punctuation">(</span>x<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;x.txt&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>也可以将文件保存某个存在的目录中，因为R不能够创建不存在的目录。如果不设定目录，就会自动保存在当前目录中。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> write.table<span class="punctuation">(</span>x<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;newfile.txt&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> write.table<span class="punctuation">(</span>x<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;f:/Learning/R语言入门与数据分析/RData/newnew.txt&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> write.table<span class="punctuation">(</span>x<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;f:/Learning/R语言入门与数据分析/RData/newnew.csv&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;,&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>写入的时候会自动添加行号，可以设定<code>write.table</code>函数中的参数<code>row.names</code>为FALSE，这样写入的文档就不会包含行号：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> write.table<span class="punctuation">(</span>x<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;f:/Learning/R语言入门与数据分析/RData/newnew.txt&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;,&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>写入文件为<code>txt</code>格式时，会默认会添加双引号，如果不需要，可以设定<code>write.table</code>函数中的参数<code>quote</code>为FALSE。</p>
<p>默认如果写入的是同名的文件，R会覆盖掉原来的文件，如果要将数据写入同一个文件，可以设定<code>write.table</code>函数中的参数<code>append</code>为TRUE，数据会写入文件的结尾；如果为FALSE会覆盖掉原来的文件，和R语言默认相同。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> write.table<span class="punctuation">(</span>iris<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;f:/Learning/R语言入门与数据分析/RData/newnew.txt&quot;</span><span class="punctuation">,</span> append <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line">In write.table<span class="punctuation">(</span>iris<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&quot;f:/Learning/R语言入门与数据分析/RData/newnew.txt&quot;</span><span class="punctuation">,</span>  <span class="operator">:</span></span><br><span class="line">  给文件加列名</span><br></pre></td></tr></table></figure>
<p>虽然有警告，但是已经成功将数据追加到<code>newnew.txt</code>文件后面。</p>
<p>R也支持写入压缩文件：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">write.table<span class="punctuation">(</span>mtcars<span class="punctuation">,</span>gzfile<span class="punctuation">(</span><span class="string">&quot;newfile.txt.gz&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果想将数据结果写为其他软件的数据格式，可以通过<code>foreign</code>包来学习保存什么格式：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">help<span class="punctuation">(</span>package <span class="operator">=</span> <span class="string">&quot;foreign&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="3-4-读Excel文件">3.4 读Excel文件</h3>
<p>如果涉及到<code>xlsx</code>文件格式，需要安装<code>XLConnect</code>包</p>
<p>读入Excel文件：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&quot;mtcars.csv&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">                     X  mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line"><span class="number">1</span>            Mazda RX4 <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">2</span>        Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">3</span>           Datsun <span class="number">710</span> <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line"><span class="number">30</span>        Ferrari Dino <span class="number">19.7</span>   <span class="number">6</span> <span class="number">145.0</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.770</span> <span class="number">15.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line"><span class="number">31</span>       Maserati Bora <span class="number">15.0</span>   <span class="number">8</span> <span class="number">301.0</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line"><span class="number">32</span>          Volvo <span class="number">142</span>E <span class="number">21.4</span>   <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>也可以复制表格中相应的内容，然后读取剪贴板内容：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&quot;clipboard&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">                  X  mpg cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line"><span class="number">1</span>         Mazda RX4 <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">2</span>     Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">3</span>        Datsun <span class="number">710</span> <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line"><span class="number">4</span>    Hornet <span class="number">4</span> Drive <span class="number">21.4</span>   <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line"><span class="number">5</span> Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>如果涉及到<code>xlsx</code>文件格式，需要加载<code>XLConnect</code>包</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>XLConnect<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>一步法</strong>：通过<code>readWorksheetFromFile</code>函数进行操作。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> readWorksheetFromFile<span class="punctuation">(</span><span class="string">&quot;data.xlsx&quot;</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">                  Col1  mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line"><span class="number">1</span>            Mazda RX4 <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">2</span>        Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">3</span>           Datsun <span class="number">710</span> <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line"><span class="number">30</span>        Ferrari Dino <span class="number">19.7</span>   <span class="number">6</span> <span class="number">145.0</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.770</span> <span class="number">15.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line"><span class="number">31</span>       Maserati Bora <span class="number">15.0</span>   <span class="number">8</span> <span class="number">301.0</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line"><span class="number">32</span>          Volvo <span class="number">142</span>E <span class="number">21.4</span>   <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>其中数字<code>1</code>表示第几个工作簿。</p>
<p><strong>两步法</strong>：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> ex <span class="operator">&lt;-</span> loadWorkbook<span class="punctuation">(</span><span class="string">&quot;data.xlsx&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> edata <span class="operator">&lt;-</span> readWorksheet<span class="punctuation">(</span>ex<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>edata<span class="punctuation">)</span></span><br><span class="line">               Col1  mpg cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line"><span class="number">1</span>         Mazda RX4 <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">2</span>     Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">3</span>        Datsun <span class="number">710</span> <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line"><span class="number">4</span>    Hornet <span class="number">4</span> Drive <span class="number">21.4</span>   <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line"><span class="number">5</span> Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line"><span class="number">6</span>           Valiant <span class="number">18.1</span>   <span class="number">6</span>  <span class="number">225</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p><code>loadWorkbook</code>表示读取的是<code>xlsx</code>文件，通过<code>readWorksheet</code>函数读取<code>ex</code>的第1个工作表。</p>
<p>可以使用<code>header</code>函数查看是否有问题。</p>
<p>也可以通过<code>readWorksheet</code>函数指定工作表的范围，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> readWorksheet<span class="punctuation">(</span>ex<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span>startRow <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span>startCol <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> endRow <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> endCol <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">               Col1  mpg cyl</span><br><span class="line"><span class="number">1</span>         Mazda RX4 <span class="number">21.0</span>   <span class="number">6</span></span><br><span class="line"><span class="number">2</span>     Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span></span><br><span class="line"><span class="number">3</span>        Datsun <span class="number">710</span> <span class="number">22.8</span>   <span class="number">4</span></span><br><span class="line"><span class="number">4</span>    Hornet <span class="number">4</span> Drive <span class="number">21.4</span>   <span class="number">6</span></span><br><span class="line"><span class="number">5</span> Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span></span><br><span class="line"><span class="number">6</span>           Valiant <span class="number">18.1</span>   <span class="number">6</span></span><br><span class="line"><span class="number">7</span>        Duster <span class="number">360</span> <span class="number">14.3</span>   <span class="number">8</span></span><br><span class="line"><span class="number">8</span>         Merc <span class="number">240</span>D <span class="number">24.4</span>   <span class="number">4</span></span><br><span class="line"><span class="number">9</span>          Merc <span class="number">230</span> <span class="number">22.8</span>   <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p><code>header</code>表示是否读取表头，如果为TRUE，表示读取表头。</p>
<h3 id="3-5-写Excel文件">3.5 写Excel文件</h3>
<p><strong>一步法</strong>：通过<code>writeWorksheetToFile</code>函数即可完成。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> writeWorksheetToFile<span class="punctuation">(</span><span class="string">&quot;file.xlsx&quot;</span><span class="punctuation">,</span>data <span class="operator">=</span> mtcars<span class="punctuation">,</span> sheet <span class="operator">=</span> <span class="string">&quot;sheet 1&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>这里<code>file.xlsx</code>为写入的文件名，<code>data</code>为写入的数据，<code>sheet</code>为工作簿编号。<code>data</code>和<code>sheet</code>都支持列表的数据格式。</p>
<p><strong>四步法</strong>：</p>
<ol>
<li>使用<code>loadWorkbook</code>创建一个工作表，即一个文件；</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> wb <span class="operator">=</span> loadWorkbook<span class="punctuation">(</span><span class="string">&quot;file.xlsx&quot;</span><span class="punctuation">,</span>create <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>使用<code>createSheet</code>函数在工作表中创建工作簿；</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> createSheet<span class="punctuation">(</span>wb<span class="punctuation">,</span><span class="string">&quot;Sheet 1&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>使用<code>writeWorksheet</code>函数将数据保存到工作簿中；</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> writeWorksheet<span class="punctuation">(</span>wb<span class="punctuation">,</span>data<span class="operator">=</span>mtcars<span class="punctuation">,</span>sheet <span class="operator">=</span> <span class="string">&quot;sheet 1&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>使用<code>saveWorkbook</code>函数将工作表存储为Excel文件。</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> saveWorkbook<span class="punctuation">(</span>wb<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>更多内容可以查看这个包的帮助文档<code>vignette</code>，可以通过以下命令查看：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> vignette<span class="punctuation">(</span><span class="string">&quot;XLConnect&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果只是简单读写Excel文件，也可以用<code>xlsl</code>包。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">install.packages<span class="punctuation">(</span><span class="string">&quot;xlsx&quot;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>xlsx<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>可以通过<code>help(package=xlsx)</code>进行查看相关使用方法。</p>
<p>示例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> read.xlsx<span class="punctuation">(</span><span class="string">&quot;data.xlsx&quot;</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span>startRow <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>endRow <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> write.xlsx<span class="punctuation">(</span>x<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;rdata.xlsx&quot;</span><span class="punctuation">,</span>sheetName <span class="operator">=</span> <span class="string">&quot;Sheet 1&quot;</span><span class="punctuation">,</span>append <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="3-6-读写R格式文件">3.6 读写R格式文件</h3>
<p>RDS文件可以存储单个R对象，而RData可以保存多个R对象。RDS文件和RData文件不能保存图形，只能单独保存图片。</p>
<p>存储为R文件有很多优势，R会对存储为内部文件格式的数据进行自动压缩处理，并且会存储所有与待存储对象相关的R元数据。如果数据中包含了因子，日期和时间或者类的属性等信息。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> saveRDS<span class="punctuation">(</span>iris<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;iris.RDS&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>saveRDS</code>函数将数据保存为RDS文件。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> readRDS<span class="punctuation">(</span><span class="string">&quot;iris.RDS&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>readRDS</code>是读取RDS文件的函数。</p>
<p>可以通过<code>load</code>函数载入RData文件，例如：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">load<span class="punctuation">(</span><span class="string">&quot;ch03.R&quot;</span><span class="punctuation">)</span></span><br><span class="line">load<span class="punctuation">(</span><span class="string">&quot;.RData&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>注意：如果需要载入的对象和当前R工作空间中的对象重名，会将当前工作空间中的对象数据进行覆盖。在加载文件之前需要对文件内容有所了解，如果打开新的文件，就不用担心这些问题了。</p>
<p>保存为RData文件直接使用save函数即可：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> save<span class="punctuation">(</span>iris<span class="punctuation">,</span>iris3<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;newiris.Rdata&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>前几个是保存的对象名称，file为保存的文件地址。</p>
<p>如果想保存当前工作空间中所有对象，直接通过<code>save.image</code>函数即可。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">save.image<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h2 id="4-数据转换">4 数据转换</h2>
<p>数据转换是对R进行数据操作的核心内容。</p>
<h3 id="4-1-数据格式转换">4.1 数据格式转换</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>xlsx<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> cars32 <span class="operator">&lt;-</span> read.xlsx<span class="punctuation">(</span><span class="string">&quot;mtcars.xlsx&quot;</span><span class="punctuation">,</span>sheetIndex <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> cars32</span><br><span class="line">                   NA.  mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line"><span class="number">1</span>            Mazda RX4 <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">2</span>        Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">...</span><br><span class="line"><span class="number">30</span>        Ferrari Dino <span class="number">19.7</span>   <span class="number">6</span> <span class="number">145.0</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.770</span> <span class="number">15.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line"><span class="number">31</span>       Maserati Bora <span class="number">15.0</span>   <span class="number">8</span> <span class="number">301.0</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line"><span class="number">32</span>          Volvo <span class="number">142</span>E <span class="number">21.4</span>   <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> is.data.frame<span class="punctuation">(</span>cars32<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">TRUE</span></span><br><span class="line"><span class="operator">&gt;</span> state.x77</span><br><span class="line">               Population Income Illiteracy Life Exp Murder HS Grad Frost   Area</span><br><span class="line">Alabama              <span class="number">3615</span>   <span class="number">3624</span>        <span class="number">2.1</span>    <span class="number">69.05</span>   <span class="number">15.1</span>    <span class="number">41.3</span>    <span class="number">20</span>  <span class="number">50708</span></span><br><span class="line">Alaska                <span class="number">365</span>   <span class="number">6315</span>        <span class="number">1.5</span>    <span class="number">69.31</span>   <span class="number">11.3</span>    <span class="number">66.7</span>   <span class="number">152</span> <span class="number">566432</span></span><br><span class="line">Arizona              <span class="number">2212</span>   <span class="number">4530</span>        <span class="number">1.8</span>    <span class="number">70.55</span>    <span class="number">7.8</span>    <span class="number">58.1</span>    <span class="number">15</span> <span class="number">113417</span></span><br><span class="line">...</span><br><span class="line">West Virginia        <span class="number">1799</span>   <span class="number">3617</span>        <span class="number">1.4</span>    <span class="number">69.48</span>    <span class="number">6.7</span>    <span class="number">41.6</span>   <span class="number">100</span>  <span class="number">24070</span></span><br><span class="line">Wisconsin            <span class="number">4589</span>   <span class="number">4468</span>        <span class="number">0.7</span>    <span class="number">72.48</span>    <span class="number">3.0</span>    <span class="number">54.5</span>   <span class="number">149</span>  <span class="number">54464</span></span><br><span class="line">Wyoming               <span class="number">376</span>   <span class="number">4566</span>        <span class="number">0.6</span>    <span class="number">70.29</span>    <span class="number">6.9</span>    <span class="number">62.9</span>   <span class="number">173</span>  <span class="number">97203</span></span><br><span class="line"><span class="operator">&gt;</span> is.data.frame<span class="punctuation">(</span>state.x77<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="operator">&gt;</span> dstate.x77 <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>state.x77<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> is.data.frame<span class="punctuation">(</span>dstate.x77<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">TRUE</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>is.data.frame</code>函数可以判断对象是否为数据框，<code>as.data.frame</code>可以将对象强制转换成数据框的结构。上面的示例为矩阵转为数据框。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> data.frame<span class="punctuation">(</span>state.region<span class="punctuation">,</span>state.x77<span class="punctuation">)</span></span><br><span class="line">                state.region Population Income Illiteracy Life.Exp Murder HS.Grad Frost   Area</span><br><span class="line">Alabama                South       <span class="number">3615</span>   <span class="number">3624</span>        <span class="number">2.1</span>    <span class="number">69.05</span>   <span class="number">15.1</span>    <span class="number">41.3</span>    <span class="number">20</span>  <span class="number">50708</span></span><br><span class="line">Alaska                  West        <span class="number">365</span>   <span class="number">6315</span>        <span class="number">1.5</span>    <span class="number">69.31</span>   <span class="number">11.3</span>    <span class="number">66.7</span>   <span class="number">152</span> <span class="number">566432</span></span><br><span class="line">Arizona                 West       <span class="number">2212</span>   <span class="number">4530</span>        <span class="number">1.8</span>    <span class="number">70.55</span>    <span class="number">7.8</span>    <span class="number">58.1</span>    <span class="number">15</span> <span class="number">113417</span></span><br><span class="line">...</span><br><span class="line">West Virginia          South       <span class="number">1799</span>   <span class="number">3617</span>        <span class="number">1.4</span>    <span class="number">69.48</span>    <span class="number">6.7</span>    <span class="number">41.6</span>   <span class="number">100</span>  <span class="number">24070</span></span><br><span class="line">Wisconsin      North Central       <span class="number">4589</span>   <span class="number">4468</span>        <span class="number">0.7</span>    <span class="number">72.48</span>    <span class="number">3.0</span>    <span class="number">54.5</span>   <span class="number">149</span>  <span class="number">54464</span></span><br><span class="line">Wyoming                 West        <span class="number">376</span>   <span class="number">4566</span>        <span class="number">0.6</span>    <span class="number">70.29</span>    <span class="number">6.9</span>    <span class="number">62.9</span>   <span class="number">173</span>  <span class="number">97203</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> as.matrix<span class="punctuation">(</span>data.frame<span class="punctuation">(</span>state.region<span class="punctuation">,</span>state.x77<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">               state.region    Population Income Illiteracy Life.Exp Murder HS.Grad Frost Area    </span><br><span class="line">Alabama        <span class="string">&quot;South&quot;</span>         <span class="string">&quot; 3615&quot;</span>    <span class="string">&quot;3624&quot;</span> <span class="string">&quot;2.1&quot;</span>      <span class="string">&quot;69.05&quot;</span>  <span class="string">&quot;15.1&quot;</span> <span class="string">&quot;41.3&quot;</span>  <span class="string">&quot; 20&quot;</span> <span class="string">&quot; 50708&quot;</span></span><br><span class="line">Alaska         <span class="string">&quot;West&quot;</span>          <span class="string">&quot;  365&quot;</span>    <span class="string">&quot;6315&quot;</span> <span class="string">&quot;1.5&quot;</span>      <span class="string">&quot;69.31&quot;</span>  <span class="string">&quot;11.3&quot;</span> <span class="string">&quot;66.7&quot;</span>  <span class="string">&quot;152&quot;</span> <span class="string">&quot;566432&quot;</span></span><br><span class="line">Arizona        <span class="string">&quot;West&quot;</span>          <span class="string">&quot; 2212&quot;</span>    <span class="string">&quot;4530&quot;</span> <span class="string">&quot;1.8&quot;</span>      <span class="string">&quot;70.55&quot;</span>  <span class="string">&quot; 7.8&quot;</span> <span class="string">&quot;58.1&quot;</span>  <span class="string">&quot; 15&quot;</span> <span class="string">&quot;113417&quot;</span></span><br><span class="line">...</span><br><span class="line">West Virginia  <span class="string">&quot;South&quot;</span>         <span class="string">&quot; 1799&quot;</span>    <span class="string">&quot;3617&quot;</span> <span class="string">&quot;1.4&quot;</span>      <span class="string">&quot;69.48&quot;</span>  <span class="string">&quot; 6.7&quot;</span> <span class="string">&quot;41.6&quot;</span>  <span class="string">&quot;100&quot;</span> <span class="string">&quot; 24070&quot;</span></span><br><span class="line">Wisconsin      <span class="string">&quot;North Central&quot;</span> <span class="string">&quot; 4589&quot;</span>    <span class="string">&quot;4468&quot;</span> <span class="string">&quot;0.7&quot;</span>      <span class="string">&quot;72.48&quot;</span>  <span class="string">&quot; 3.0&quot;</span> <span class="string">&quot;54.5&quot;</span>  <span class="string">&quot;149&quot;</span> <span class="string">&quot; 54464&quot;</span></span><br><span class="line">Wyoming        <span class="string">&quot;West&quot;</span>          <span class="string">&quot;  376&quot;</span>    <span class="string">&quot;4566&quot;</span> <span class="string">&quot;0.6&quot;</span>      <span class="string">&quot;70.29&quot;</span>  <span class="string">&quot; 6.9&quot;</span> <span class="string">&quot;62.9&quot;</span>  <span class="string">&quot;173&quot;</span> <span class="string">&quot; 97203&quot;</span></span><br></pre></td></tr></table></figure>
<p>总结：如果数据框中存在字符串，在将数据框转换成矩阵时，会将数值也转换成字符串进行处理。</p>
<blockquote>
<p>注意：并不是所有的数据转换都起作用，有些无法进行转换。</p>
</blockquote>
<p>更多示例可以通过<code>methods</code>函数查看示例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">methods<span class="punctuation">(</span>is<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>R中最基础的就是向量，可以转换成多种数据格式：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> state.abb</span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;AL&quot;</span> <span class="string">&quot;AK&quot;</span> <span class="string">&quot;AZ&quot;</span> <span class="string">&quot;AR&quot;</span> <span class="string">&quot;CA&quot;</span> <span class="string">&quot;CO&quot;</span> <span class="string">&quot;CT&quot;</span> <span class="string">&quot;DE&quot;</span> <span class="string">&quot;FL&quot;</span> <span class="string">&quot;GA&quot;</span> <span class="string">&quot;HI&quot;</span> <span class="string">&quot;ID&quot;</span> <span class="string">&quot;IL&quot;</span> <span class="string">&quot;IN&quot;</span> <span class="string">&quot;IA&quot;</span> <span class="string">&quot;KS&quot;</span> <span class="string">&quot;KY&quot;</span> <span class="string">&quot;LA&quot;</span> <span class="string">&quot;ME&quot;</span> <span class="string">&quot;MD&quot;</span> <span class="string">&quot;MA&quot;</span> <span class="string">&quot;MI&quot;</span> <span class="string">&quot;MN&quot;</span> <span class="string">&quot;MS&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span> <span class="string">&quot;MO&quot;</span> <span class="string">&quot;MT&quot;</span> <span class="string">&quot;NE&quot;</span> <span class="string">&quot;NV&quot;</span> <span class="string">&quot;NH&quot;</span> <span class="string">&quot;NJ&quot;</span> <span class="string">&quot;NM&quot;</span> <span class="string">&quot;NY&quot;</span> <span class="string">&quot;NC&quot;</span> <span class="string">&quot;ND&quot;</span> <span class="string">&quot;OH&quot;</span> <span class="string">&quot;OK&quot;</span> <span class="string">&quot;OR&quot;</span> <span class="string">&quot;PA&quot;</span> <span class="string">&quot;RI&quot;</span> <span class="string">&quot;SC&quot;</span> <span class="string">&quot;SD&quot;</span> <span class="string">&quot;TN&quot;</span> <span class="string">&quot;TX&quot;</span> <span class="string">&quot;UT&quot;</span> <span class="string">&quot;VT&quot;</span> <span class="string">&quot;VA&quot;</span> <span class="string">&quot;WA&quot;</span> <span class="string">&quot;WV&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span> <span class="string">&quot;WI&quot;</span> <span class="string">&quot;WY&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">dim</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">9</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;AL&quot;</span> <span class="string">&quot;CO&quot;</span> <span class="string">&quot;HI&quot;</span> <span class="string">&quot;KS&quot;</span> <span class="string">&quot;MA&quot;</span> <span class="string">&quot;MT&quot;</span> <span class="string">&quot;NM&quot;</span> <span class="string">&quot;OK&quot;</span> <span class="string">&quot;SD&quot;</span> <span class="string">&quot;VA&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;AK&quot;</span> <span class="string">&quot;CT&quot;</span> <span class="string">&quot;ID&quot;</span> <span class="string">&quot;KY&quot;</span> <span class="string">&quot;MI&quot;</span> <span class="string">&quot;NE&quot;</span> <span class="string">&quot;NY&quot;</span> <span class="string">&quot;OR&quot;</span> <span class="string">&quot;TN&quot;</span> <span class="string">&quot;WA&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;AZ&quot;</span> <span class="string">&quot;DE&quot;</span> <span class="string">&quot;IL&quot;</span> <span class="string">&quot;LA&quot;</span> <span class="string">&quot;MN&quot;</span> <span class="string">&quot;NV&quot;</span> <span class="string">&quot;NC&quot;</span> <span class="string">&quot;PA&quot;</span> <span class="string">&quot;TX&quot;</span> <span class="string">&quot;WV&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;AR&quot;</span> <span class="string">&quot;FL&quot;</span> <span class="string">&quot;IN&quot;</span> <span class="string">&quot;ME&quot;</span> <span class="string">&quot;MS&quot;</span> <span class="string">&quot;NH&quot;</span> <span class="string">&quot;ND&quot;</span> <span class="string">&quot;RI&quot;</span> <span class="string">&quot;UT&quot;</span> <span class="string">&quot;WI&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">5</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;CA&quot;</span> <span class="string">&quot;GA&quot;</span> <span class="string">&quot;IA&quot;</span> <span class="string">&quot;MD&quot;</span> <span class="string">&quot;MO&quot;</span> <span class="string">&quot;NJ&quot;</span> <span class="string">&quot;OH&quot;</span> <span class="string">&quot;SC&quot;</span> <span class="string">&quot;VT&quot;</span> <span class="string">&quot;WY&quot;</span> </span><br><span class="line"><span class="operator">&gt;</span> as.factor<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> AL AK AZ AR CA CO CT DE FL GA HI ID IL IN IA KS KY LA ME MD MA MI MN MS MO MT NE NV NH NJ NM NY NC ND OH OK OR PA RI SC SD</span><br><span class="line"><span class="punctuation">[</span><span class="number">42</span><span class="punctuation">]</span> TN TX UT VT VA WA WV WI WY</span><br><span class="line"><span class="number">50</span> Levels<span class="operator">:</span> AK AL AR AZ CA CO CT DE FL GA HI IA ID IL IN KS KY LA MA MD ME MI MN MO MS MT NC ND NE NH NJ NM NV NY OH OK ... WY</span><br><span class="line"><span class="operator">&gt;</span> as.list<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;AL&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;AK&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;AZ&quot;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">48</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;WV&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">49</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;WI&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">50</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;WY&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> state <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>x<span class="punctuation">,</span>state.region<span class="punctuation">,</span>state.x77<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> state<span class="operator">$</span>Income</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3624</span> <span class="number">6315</span> <span class="number">4530</span> <span class="number">3378</span> <span class="number">5114</span> <span class="number">4884</span> <span class="number">5348</span> <span class="number">4809</span> <span class="number">4815</span> <span class="number">4091</span> <span class="number">4963</span> <span class="number">4119</span> <span class="number">5107</span> <span class="number">4458</span> <span class="number">4628</span> <span class="number">4669</span> <span class="number">3712</span> <span class="number">3545</span> <span class="number">3694</span> <span class="number">5299</span> <span class="number">4755</span> <span class="number">4751</span> <span class="number">4675</span> <span class="number">3098</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span> <span class="number">4254</span> <span class="number">4347</span> <span class="number">4508</span> <span class="number">5149</span> <span class="number">4281</span> <span class="number">5237</span> <span class="number">3601</span> <span class="number">4903</span> <span class="number">3875</span> <span class="number">5087</span> <span class="number">4561</span> <span class="number">3983</span> <span class="number">4660</span> <span class="number">4449</span> <span class="number">4558</span> <span class="number">3635</span> <span class="number">4167</span> <span class="number">3821</span> <span class="number">4188</span> <span class="number">4022</span> <span class="number">3907</span> <span class="number">4701</span> <span class="number">4864</span> <span class="number">3617</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span> <span class="number">4468</span> <span class="number">4566</span></span><br><span class="line"><span class="operator">&gt;</span> state<span class="punctuation">[</span><span class="string">&quot;Nevada&quot;</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">       X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 state.region Population Income Illiteracy Life.Exp Murder HS.Grad Frost   Area</span><br><span class="line">Nevada AZ DE IL LA MN NV NC PA TX  WV         West        <span class="number">590</span>   <span class="number">5149</span>        <span class="number">0.5</span>    <span class="number">69.03</span>   <span class="number">11.5</span>    <span class="number">65.2</span>   <span class="number">188</span> <span class="number">109889</span></span><br><span class="line"><span class="operator">&gt;</span> is.data.frame<span class="punctuation">(</span>state<span class="punctuation">[</span><span class="string">&quot;Nevada&quot;</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">TRUE</span></span><br><span class="line"><span class="operator">&gt;</span> y <span class="operator">&lt;-</span> state<span class="punctuation">[</span><span class="string">&quot;Nevada&quot;</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> y</span><br><span class="line">       X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 state.region Population Income Illiteracy Life.Exp Murder HS.Grad Frost   Area</span><br><span class="line">Nevada AZ DE IL LA MN NV NC PA TX  WV         West        <span class="number">590</span>   <span class="number">5149</span>        <span class="number">0.5</span>    <span class="number">69.03</span>   <span class="number">11.5</span>    <span class="number">65.2</span>   <span class="number">188</span> <span class="number">109889</span></span><br><span class="line"><span class="operator">&gt;</span> unname<span class="punctuation">(</span>y<span class="punctuation">)</span></span><br><span class="line">                                                                                 </span><br><span class="line">Nevada AZ DE IL LA MN NV NC PA TX WV West <span class="number">590</span> <span class="number">5149</span> <span class="number">0.5</span> <span class="number">69.03</span> <span class="number">11.5</span> <span class="number">65.2</span> <span class="number">188</span> <span class="number">109889</span></span><br><span class="line"><span class="operator">&gt;</span> unlist<span class="punctuation">(</span>y<span class="punctuation">)</span></span><br><span class="line">          X1           X2           X3           X4           X5           X6           X7           X8           X9 </span><br><span class="line">        <span class="string">&quot;AZ&quot;</span>         <span class="string">&quot;DE&quot;</span>         <span class="string">&quot;IL&quot;</span>         <span class="string">&quot;LA&quot;</span>         <span class="string">&quot;MN&quot;</span>         <span class="string">&quot;NV&quot;</span>         <span class="string">&quot;NC&quot;</span>         <span class="string">&quot;PA&quot;</span>         <span class="string">&quot;TX&quot;</span> </span><br><span class="line">         X10 state.region   Population       Income   Illiteracy     Life.Exp       Murder      HS.Grad        Frost </span><br><span class="line">        <span class="string">&quot;WV&quot;</span>          <span class="string">&quot;4&quot;</span>        <span class="string">&quot;590&quot;</span>       <span class="string">&quot;5149&quot;</span>        <span class="string">&quot;0.5&quot;</span>      <span class="string">&quot;69.03&quot;</span>       <span class="string">&quot;11.5&quot;</span>       <span class="string">&quot;65.2&quot;</span>        <span class="string">&quot;188&quot;</span> </span><br><span class="line">        Area </span><br><span class="line">    <span class="string">&quot;109889&quot;</span> </span><br></pre></td></tr></table></figure>
<p>数据框取出列可以用<code>$</code>符号，取出行用<code>state[&quot;Nevada&quot;,]</code>，注意不要忘记逗号。如果想去除列名，可以通过<code>unname</code>函数。如果想将其转换成向量，可以使用<code>unlist</code>函数。</p>
<h3 id="4-2-数据部分提取">4.2 数据部分提取</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> who <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&quot;WHO.csv&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> who1 <span class="operator">&lt;-</span> who<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">50</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> who2 <span class="operator">&lt;-</span> who<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">14</span><span class="punctuation">,</span><span class="number">16</span><span class="punctuation">,</span><span class="number">18</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> who3 <span class="operator">&lt;-</span> who<span class="punctuation">[</span>which<span class="punctuation">(</span>who<span class="operator">$</span>Continent<span class="operator">==</span><span class="number">7</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> who4 <span class="operator">&lt;-</span> who<span class="punctuation">[</span>which<span class="punctuation">(</span>who<span class="operator">$</span>CountryID<span class="operator">&gt;</span><span class="number">50</span> <span class="operator">&amp;</span> who<span class="operator">$</span>CountryID<span class="operator">&lt;=</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>总结：可以提取连续的部分内容，如who1；也可以提取零散的部分内容，如who2；也可以根据逻辑值进行提取，如who3；也可以取某个范围的值，如who4。</p>
<p>取子集也可以用<code>subset</code>函数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> who4 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>who<span class="punctuation">,</span>who<span class="operator">$</span>CountryID<span class="operator">&gt;</span><span class="number">50</span> <span class="operator">&amp;</span> who<span class="operator">$</span>CountryID<span class="operator">&lt;=</span><span class="number">100</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>在数学挖掘和机器学习领域，从更大的数据集中抽样是常见的做法，例如随机抽取两个样本，一个样本用来建模，另一类样本用来验证有效性。R中可以用sample函数用来随机抽样。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">100</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span>  <span class="number">24</span>  <span class="number">25</span>  <span class="number">26</span>  <span class="number">27</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">28</span><span class="punctuation">]</span>  <span class="number">28</span>  <span class="number">29</span>  <span class="number">30</span>  <span class="number">31</span>  <span class="number">32</span>  <span class="number">33</span>  <span class="number">34</span>  <span class="number">35</span>  <span class="number">36</span>  <span class="number">37</span>  <span class="number">38</span>  <span class="number">39</span>  <span class="number">40</span>  <span class="number">41</span>  <span class="number">42</span>  <span class="number">43</span>  <span class="number">44</span>  <span class="number">45</span>  <span class="number">46</span>  <span class="number">47</span>  <span class="number">48</span>  <span class="number">49</span>  <span class="number">50</span>  <span class="number">51</span>  <span class="number">52</span>  <span class="number">53</span>  <span class="number">54</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">55</span><span class="punctuation">]</span>  <span class="number">55</span>  <span class="number">56</span>  <span class="number">57</span>  <span class="number">58</span>  <span class="number">59</span>  <span class="number">60</span>  <span class="number">61</span>  <span class="number">62</span>  <span class="number">63</span>  <span class="number">64</span>  <span class="number">65</span>  <span class="number">66</span>  <span class="number">67</span>  <span class="number">68</span>  <span class="number">69</span>  <span class="number">70</span>  <span class="number">71</span>  <span class="number">72</span>  <span class="number">73</span>  <span class="number">74</span>  <span class="number">75</span>  <span class="number">76</span>  <span class="number">77</span>  <span class="number">78</span>  <span class="number">79</span>  <span class="number">80</span>  <span class="number">81</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">82</span><span class="punctuation">]</span>  <span class="number">82</span>  <span class="number">83</span>  <span class="number">84</span>  <span class="number">85</span>  <span class="number">86</span>  <span class="number">87</span>  <span class="number">88</span>  <span class="number">89</span>  <span class="number">90</span>  <span class="number">91</span>  <span class="number">92</span>  <span class="number">93</span>  <span class="number">94</span>  <span class="number">95</span>  <span class="number">96</span>  <span class="number">97</span>  <span class="number">98</span>  <span class="number">99</span> <span class="number">100</span></span><br><span class="line"><span class="operator">&gt;</span> sample<span class="punctuation">(</span>x<span class="punctuation">,</span><span class="number">60</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">97</span>   <span class="number">8</span>   <span class="number">5</span>  <span class="number">33</span>  <span class="number">88</span>  <span class="number">28</span>  <span class="number">48</span>  <span class="number">34</span>  <span class="number">39</span>  <span class="number">69</span>  <span class="number">35</span>  <span class="number">82</span>  <span class="number">81</span>  <span class="number">50</span>  <span class="number">92</span>  <span class="number">12</span>  <span class="number">16</span>  <span class="number">87</span>  <span class="number">17</span>  <span class="number">76</span>  <span class="number">98</span>  <span class="number">40</span>  <span class="number">74</span>  <span class="number">75</span>  <span class="number">19</span>  <span class="number">54</span>  <span class="number">11</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">28</span><span class="punctuation">]</span>  <span class="number">49</span>  <span class="number">30</span>  <span class="number">32</span>  <span class="number">89</span>  <span class="number">70</span>  <span class="number">37</span>  <span class="number">13</span>  <span class="number">96</span>  <span class="number">72</span>  <span class="number">25</span>   <span class="number">1</span>  <span class="number">78</span>  <span class="number">14</span>  <span class="number">60</span>  <span class="number">57</span>  <span class="number">58</span>  <span class="number">23</span>  <span class="number">95</span>  <span class="number">90</span>  <span class="number">15</span>  <span class="number">83</span>  <span class="number">52</span> <span class="number">100</span>  <span class="number">64</span>  <span class="number">38</span>  <span class="number">86</span>  <span class="number">51</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">55</span><span class="punctuation">]</span>  <span class="number">45</span>   <span class="number">3</span>  <span class="number">99</span>   <span class="number">2</span>  <span class="number">93</span>  <span class="number">27</span></span><br><span class="line"><span class="operator">&gt;</span> sample<span class="punctuation">(</span>x<span class="punctuation">,</span><span class="number">60</span><span class="punctuation">,</span>replace <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">41</span>  <span class="number">57</span>  <span class="number">24</span>   <span class="number">1</span>  <span class="number">67</span>  <span class="number">25</span>  <span class="number">41</span>  <span class="number">64</span>  <span class="number">23</span>   <span class="number">6</span>  <span class="number">65</span>  <span class="number">72</span>  <span class="number">65</span>  <span class="number">68</span>  <span class="number">29</span>  <span class="number">37</span>  <span class="number">78</span>  <span class="number">72</span>  <span class="number">26</span>  <span class="number">55</span>  <span class="number">86</span>  <span class="number">25</span>   <span class="number">2</span>  <span class="number">69</span>  <span class="number">93</span>  <span class="number">58</span>  <span class="number">68</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">28</span><span class="punctuation">]</span>  <span class="number">92</span>  <span class="number">26</span>  <span class="number">69</span>  <span class="number">64</span>  <span class="number">72</span>  <span class="number">54</span>  <span class="number">77</span>  <span class="number">65</span>  <span class="number">75</span>  <span class="number">25</span>  <span class="number">45</span>  <span class="number">68</span>  <span class="number">53</span>  <span class="number">60</span>  <span class="number">20</span>  <span class="number">95</span>  <span class="number">94</span>  <span class="number">28</span>  <span class="number">18</span>  <span class="number">99</span>  <span class="number">22</span>   <span class="number">8</span>  <span class="number">90</span>  <span class="number">82</span>  <span class="number">14</span>  <span class="number">95</span>  <span class="number">32</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">55</span><span class="punctuation">]</span>  <span class="number">42</span>  <span class="number">88</span>  <span class="number">76</span>  <span class="number">78</span> <span class="number">100</span>  <span class="number">25</span></span><br><span class="line"><span class="operator">&gt;</span> sort<span class="punctuation">(</span>sample<span class="punctuation">(</span>x<span class="punctuation">,</span><span class="number">60</span><span class="punctuation">,</span>replace <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">4</span>  <span class="number">8</span>  <span class="number">8</span>  <span class="number">9</span>  <span class="number">9</span> <span class="number">14</span> <span class="number">14</span> <span class="number">17</span> <span class="number">19</span> <span class="number">21</span> <span class="number">26</span> <span class="number">26</span> <span class="number">27</span> <span class="number">27</span> <span class="number">28</span> <span class="number">29</span> <span class="number">30</span> <span class="number">30</span> <span class="number">32</span> <span class="number">34</span> <span class="number">34</span> <span class="number">39</span> <span class="number">41</span> <span class="number">44</span> <span class="number">50</span> <span class="number">50</span> <span class="number">51</span> <span class="number">53</span> <span class="number">56</span> <span class="number">56</span> <span class="number">57</span> <span class="number">58</span> <span class="number">59</span> <span class="number">59</span> <span class="number">60</span> <span class="number">64</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">37</span><span class="punctuation">]</span> <span class="number">66</span> <span class="number">67</span> <span class="number">68</span> <span class="number">71</span> <span class="number">71</span> <span class="number">72</span> <span class="number">72</span> <span class="number">75</span> <span class="number">75</span> <span class="number">76</span> <span class="number">76</span> <span class="number">81</span> <span class="number">85</span> <span class="number">86</span> <span class="number">87</span> <span class="number">88</span> <span class="number">90</span> <span class="number">90</span> <span class="number">92</span> <span class="number">93</span> <span class="number">93</span> <span class="number">96</span> <span class="number">96</span> <span class="number">98</span></span><br><span class="line"><span class="operator">&gt;</span> who <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&quot;WHO.csv&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> who<span class="punctuation">[</span>sample<span class="punctuation">(</span>who<span class="operator">$</span>CountryID<span class="punctuation">,</span><span class="number">30</span><span class="punctuation">,</span>replace <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>sample</code>抽样默认是无返回抽样，如果<code>sample</code>函数中<code>replace</code>逻辑值设为T，则为有放回抽样。</p>
<p>删除固定行，最简单的方式就是负索引的方式：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mtcars</span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive      <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout   <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant             <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Duster <span class="number">360</span>          <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">240</span>D           <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">...</span><br><span class="line">Ferrari Dino        <span class="number">19.7</span>   <span class="number">6</span> <span class="number">145.0</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.770</span> <span class="number">15.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line">Maserati Bora       <span class="number">15.0</span>   <span class="number">8</span> <span class="number">301.0</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line">Volvo <span class="number">142</span>E          <span class="number">21.4</span>   <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> mtcars<span class="punctuation">[</span><span class="operator">-</span><span class="number">1</span><span class="operator">:</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Valiant             <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Duster <span class="number">360</span>          <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">240</span>D           <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">...</span><br><span class="line">Ferrari Dino        <span class="number">19.7</span>   <span class="number">6</span> <span class="number">145.0</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.770</span> <span class="number">15.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line">Maserati Bora       <span class="number">15.0</span>   <span class="number">8</span> <span class="number">301.0</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line">Volvo <span class="number">142</span>E          <span class="number">21.4</span>   <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> mtcars<span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">1</span><span class="operator">:</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line">                       wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive      <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout   <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant             <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Duster <span class="number">360</span>          <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">240</span>D           <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">...</span><br><span class="line">Ferrari Dino        <span class="number">2.770</span> <span class="number">15.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line">Maserati Bora       <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line">Volvo <span class="number">142</span>E          <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过负索引的方式进行删除相应的行或列。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mtcars<span class="operator">$</span>mpg <span class="operator">&lt;-</span><span class="literal">NULL</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line">                  cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive      <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant             <span class="number">6</span>  <span class="number">225</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>总结：也可以通过置空来进行删除相应的列，例如<code>mtcars$mpg &lt;-NULL</code>。注意NULL要大写。</p>
<h3 id="4-3-数据合并与去重">4.3 数据合并与去重</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> USArrests</span><br><span class="line">               Murder Assault UrbanPop Rape</span><br><span class="line">Alabama          <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span></span><br><span class="line">Alaska           <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span></span><br><span class="line">Arizona           <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span></span><br><span class="line">...</span><br><span class="line">West Virginia     <span class="number">5.7</span>      <span class="number">81</span>       <span class="number">39</span>  <span class="number">9.3</span></span><br><span class="line">Wisconsin         <span class="number">2.6</span>      <span class="number">53</span>       <span class="number">66</span> <span class="number">10.8</span></span><br><span class="line">Wyoming           <span class="number">6.8</span>     <span class="number">161</span>       <span class="number">60</span> <span class="number">15.6</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> state.division</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> East South Central Pacific            Mountain           West South Central Pacific           </span><br><span class="line"> <span class="punctuation">[</span><span class="number">6</span><span class="punctuation">]</span> Mountain           New England        South Atlantic     South Atlantic     South Atlantic    </span><br><span class="line"><span class="punctuation">[</span><span class="number">11</span><span class="punctuation">]</span> Pacific            Mountain           East North Central East North Central West North Central</span><br><span class="line"><span class="punctuation">[</span><span class="number">16</span><span class="punctuation">]</span> West North Central East South Central West South Central New England        South Atlantic    </span><br><span class="line"><span class="punctuation">[</span><span class="number">21</span><span class="punctuation">]</span> New England        East North Central West North Central East South Central West North Central</span><br><span class="line"><span class="punctuation">[</span><span class="number">26</span><span class="punctuation">]</span> Mountain           West North Central Mountain           New England        Middle Atlantic   </span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> Mountain           Middle Atlantic    South Atlantic     West North Central East North Central</span><br><span class="line"><span class="punctuation">[</span><span class="number">36</span><span class="punctuation">]</span> West South Central Pacific            Middle Atlantic    New England        South Atlantic    </span><br><span class="line"><span class="punctuation">[</span><span class="number">41</span><span class="punctuation">]</span> West North Central East South Central West South Central Mountain           New England       </span><br><span class="line"><span class="punctuation">[</span><span class="number">46</span><span class="punctuation">]</span> South Atlantic     Pacific            South Atlantic     East North Central Mountain          </span><br><span class="line"><span class="number">9</span> Levels<span class="operator">:</span> New England Middle Atlantic South Atlantic East South Central ... Pacific</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> data.frame<span class="punctuation">(</span>USArrests<span class="punctuation">,</span>state.division<span class="punctuation">)</span></span><br><span class="line">               Murder Assault UrbanPop Rape     state.division</span><br><span class="line">Alabama          <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span> East South Central</span><br><span class="line">Alaska           <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span>            Pacific</span><br><span class="line">Arizona           <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span>           Mountain</span><br><span class="line">...</span><br><span class="line">West Virginia     <span class="number">5.7</span>      <span class="number">81</span>       <span class="number">39</span>  <span class="number">9.3</span>     South Atlantic</span><br><span class="line">Wisconsin         <span class="number">2.6</span>      <span class="number">53</span>       <span class="number">66</span> <span class="number">10.8</span> East North Central</span><br><span class="line">Wyoming           <span class="number">6.8</span>     <span class="number">161</span>       <span class="number">60</span> <span class="number">15.6</span>           Mountain</span><br></pre></td></tr></table></figure>
<p>总结：<code>data.frame</code>函数可以来合并两个对象为数据框。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> cbind<span class="punctuation">(</span>USArrests<span class="punctuation">,</span>state.division<span class="punctuation">)</span></span><br><span class="line">               Murder Assault UrbanPop Rape     state.division</span><br><span class="line">Alabama          <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span> East South Central</span><br><span class="line">Alaska           <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span>            Pacific</span><br><span class="line">Arizona           <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span>           Mountain</span><br><span class="line">...</span><br><span class="line">West Virginia     <span class="number">5.7</span>      <span class="number">81</span>       <span class="number">39</span>  <span class="number">9.3</span>     South Atlantic</span><br><span class="line">Wisconsin         <span class="number">2.6</span>      <span class="number">53</span>       <span class="number">66</span> <span class="number">10.8</span> East North Central</span><br><span class="line">Wyoming           <span class="number">6.8</span>     <span class="number">161</span>       <span class="number">60</span> <span class="number">15.6</span>           Mountain</span><br><span class="line"><span class="operator">&gt;</span> data1 <span class="operator">&lt;-</span>head<span class="punctuation">(</span>USArrests<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> data1</span><br><span class="line">        Murder Assault UrbanPop Rape</span><br><span class="line">Alabama   <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span></span><br><span class="line">Alaska    <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span></span><br><span class="line"><span class="operator">&gt;</span> data2 <span class="operator">&lt;-</span>tail<span class="punctuation">(</span>USArrests<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> data2</span><br><span class="line">          Murder Assault UrbanPop Rape</span><br><span class="line">Wisconsin    <span class="number">2.6</span>      <span class="number">53</span>       <span class="number">66</span> <span class="number">10.8</span></span><br><span class="line">Wyoming      <span class="number">6.8</span>     <span class="number">161</span>       <span class="number">60</span> <span class="number">15.6</span></span><br><span class="line"><span class="operator">&gt;</span> rbind<span class="punctuation">(</span>data1<span class="punctuation">,</span>data2<span class="punctuation">)</span></span><br><span class="line">          Murder Assault UrbanPop Rape</span><br><span class="line">Alabama     <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span></span><br><span class="line">Alaska      <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span></span><br><span class="line">Wisconsin    <span class="number">2.6</span>      <span class="number">53</span>       <span class="number">66</span> <span class="number">10.8</span></span><br><span class="line">Wyoming      <span class="number">6.8</span>     <span class="number">161</span>       <span class="number">60</span> <span class="number">15.6</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过<code>cbind</code>和<code>rbind</code>函数进行列合并和行合并，合并列很容易，合并行需要有相同的列名。<code>cbind</code>和<code>rbind</code>也可以用于矩阵合并。在使用<code>cbind</code>和<code>rbind</code>中需要有相同的行数和列数，否则会出现问题。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> datadata1 <span class="operator">&lt;-</span> USArrests<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> datadata1</span><br><span class="line">           Murder Assault UrbanPop Rape</span><br><span class="line">Alabama      <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span></span><br><span class="line">Alaska       <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span></span><br><span class="line">Arizona       <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span></span><br><span class="line">Arkansas      <span class="number">8.8</span>     <span class="number">190</span>       <span class="number">50</span> <span class="number">19.5</span></span><br><span class="line">California    <span class="number">9.0</span>     <span class="number">276</span>       <span class="number">91</span> <span class="number">40.6</span></span><br><span class="line"><span class="operator">&gt;</span> datadata2 <span class="operator">&lt;-</span> USArrests<span class="punctuation">[</span><span class="number">3</span><span class="operator">:</span><span class="number">8</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> datadata2</span><br><span class="line">            Murder Assault UrbanPop Rape</span><br><span class="line">Arizona        <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span></span><br><span class="line">Arkansas       <span class="number">8.8</span>     <span class="number">190</span>       <span class="number">50</span> <span class="number">19.5</span></span><br><span class="line">California     <span class="number">9.0</span>     <span class="number">276</span>       <span class="number">91</span> <span class="number">40.6</span></span><br><span class="line">Colorado       <span class="number">7.9</span>     <span class="number">204</span>       <span class="number">78</span> <span class="number">38.7</span></span><br><span class="line">Connecticut    <span class="number">3.3</span>     <span class="number">110</span>       <span class="number">77</span> <span class="number">11.1</span></span><br><span class="line">Delaware       <span class="number">5.9</span>     <span class="number">238</span>       <span class="number">72</span> <span class="number">15.8</span></span><br><span class="line"><span class="operator">&gt;</span> datadata3 <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>datadata1<span class="punctuation">,</span>datadata2<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> datadata3</span><br><span class="line">            Murder Assault UrbanPop Rape</span><br><span class="line">Alabama       <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span></span><br><span class="line">Alaska        <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span></span><br><span class="line">Arizona        <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span></span><br><span class="line">Arkansas       <span class="number">8.8</span>     <span class="number">190</span>       <span class="number">50</span> <span class="number">19.5</span></span><br><span class="line">California     <span class="number">9.0</span>     <span class="number">276</span>       <span class="number">91</span> <span class="number">40.6</span></span><br><span class="line">Arizona1       <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span></span><br><span class="line">Arkansas1      <span class="number">8.8</span>     <span class="number">190</span>       <span class="number">50</span> <span class="number">19.5</span></span><br><span class="line">California1    <span class="number">9.0</span>     <span class="number">276</span>       <span class="number">91</span> <span class="number">40.6</span></span><br><span class="line">Colorado       <span class="number">7.9</span>     <span class="number">204</span>       <span class="number">78</span> <span class="number">38.7</span></span><br><span class="line">Connecticut    <span class="number">3.3</span>     <span class="number">110</span>       <span class="number">77</span> <span class="number">11.1</span></span><br><span class="line">Delaware       <span class="number">5.9</span>     <span class="number">238</span>       <span class="number">72</span> <span class="number">15.8</span></span><br><span class="line"><span class="operator">&gt;</span> duplicated<span class="punctuation">(</span>datadata3<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line"> <span class="operator">&gt;</span> datadata3<span class="punctuation">[</span>duplicated<span class="punctuation">(</span>datadata3<span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">            Murder Assault UrbanPop Rape</span><br><span class="line">Arizona1       <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span></span><br><span class="line">Arkansas1      <span class="number">8.8</span>     <span class="number">190</span>       <span class="number">50</span> <span class="number">19.5</span></span><br><span class="line">California1    <span class="number">9.0</span>     <span class="number">276</span>       <span class="number">91</span> <span class="number">40.6</span></span><br><span class="line"><span class="operator">&gt;</span> datadata3<span class="punctuation">[</span><span class="operator">!</span>duplicated<span class="punctuation">(</span>datadata3<span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">            Murder Assault UrbanPop Rape</span><br><span class="line">Alabama       <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span></span><br><span class="line">Alaska        <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span></span><br><span class="line">Arizona        <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span></span><br><span class="line">Arkansas       <span class="number">8.8</span>     <span class="number">190</span>       <span class="number">50</span> <span class="number">19.5</span></span><br><span class="line">California     <span class="number">9.0</span>     <span class="number">276</span>       <span class="number">91</span> <span class="number">40.6</span></span><br><span class="line">Colorado       <span class="number">7.9</span>     <span class="number">204</span>       <span class="number">78</span> <span class="number">38.7</span></span><br><span class="line">Connecticut    <span class="number">3.3</span>     <span class="number">110</span>       <span class="number">77</span> <span class="number">11.1</span></span><br><span class="line">Delaware       <span class="number">5.9</span>     <span class="number">238</span>       <span class="number">72</span> <span class="number">15.8</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">length</span><span class="punctuation">(</span>rownames<span class="punctuation">(</span>datadata3<span class="punctuation">[</span><span class="operator">!</span>duplicated<span class="punctuation">(</span>datadata3<span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">8</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>rbind</code>合并并不会去除重复，可以通过行名来判断是否重复。可以通过<code>duplicated</code>来判断是否重复，还可以通过<code>datadata3[duplicated(datadata3),]</code>来提取重复的部分，且重复的行名后面自动添加了<code>1</code>。如果加上取反符号<code>!</code>则取出非重复的部分。这里使用逻辑值对函数进行索引。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> unique<span class="punctuation">(</span>datadata3<span class="punctuation">)</span></span><br><span class="line">            Murder Assault UrbanPop Rape</span><br><span class="line">Alabama       <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span></span><br><span class="line">Alaska        <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span></span><br><span class="line">Arizona        <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span></span><br><span class="line">Arkansas       <span class="number">8.8</span>     <span class="number">190</span>       <span class="number">50</span> <span class="number">19.5</span></span><br><span class="line">California     <span class="number">9.0</span>     <span class="number">276</span>       <span class="number">91</span> <span class="number">40.6</span></span><br><span class="line">Colorado       <span class="number">7.9</span>     <span class="number">204</span>       <span class="number">78</span> <span class="number">38.7</span></span><br><span class="line">Connecticut    <span class="number">3.3</span>     <span class="number">110</span>       <span class="number">77</span> <span class="number">11.1</span></span><br><span class="line">Delaware       <span class="number">5.9</span>     <span class="number">238</span>       <span class="number">72</span> <span class="number">15.8</span></span><br></pre></td></tr></table></figure>
<p>总结：也可以用<code>unique</code>函数直接去除重复的行。</p>
<h3 id="4-4-数据翻转">4.4 数据翻转</h3>
<p>翻转操作：将所有的行和列进行翻转</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> newdata <span class="operator">&lt;-</span> USArrests<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> newdata</span><br><span class="line">           Murder Assault UrbanPop Rape</span><br><span class="line">Alabama      <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span></span><br><span class="line">Alaska       <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span></span><br><span class="line">Arizona       <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span></span><br><span class="line">Arkansas      <span class="number">8.8</span>     <span class="number">190</span>       <span class="number">50</span> <span class="number">19.5</span></span><br><span class="line">California    <span class="number">9.0</span>     <span class="number">276</span>       <span class="number">91</span> <span class="number">40.6</span></span><br><span class="line"><span class="operator">&gt;</span> scractm_newdata <span class="operator">&lt;-</span> t<span class="punctuation">(</span>newdata<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> scractm_newdata</span><br><span class="line">         Alabama Alaska Arizona Arkansas California</span><br><span class="line">Murder      <span class="number">13.2</span>   <span class="number">10.0</span>     <span class="number">8.1</span>      <span class="number">8.8</span>        <span class="number">9.0</span></span><br><span class="line">Assault    <span class="number">236.0</span>  <span class="number">263.0</span>   <span class="number">294.0</span>    <span class="number">190.0</span>      <span class="number">276.0</span></span><br><span class="line">UrbanPop    <span class="number">58.0</span>   <span class="number">48.0</span>    <span class="number">80.0</span>     <span class="number">50.0</span>       <span class="number">91.0</span></span><br><span class="line">Rape        <span class="number">21.2</span>   <span class="number">44.5</span>    <span class="number">31.0</span>     <span class="number">19.5</span>       <span class="number">40.6</span></span><br></pre></td></tr></table></figure>
<p>单独进行某一行或者列进行反向，即进行前后顺序调换</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">letters</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;a&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;c&quot;</span> <span class="string">&quot;d&quot;</span> <span class="string">&quot;e&quot;</span> <span class="string">&quot;f&quot;</span> <span class="string">&quot;g&quot;</span> <span class="string">&quot;h&quot;</span> <span class="string">&quot;i&quot;</span> <span class="string">&quot;j&quot;</span> <span class="string">&quot;k&quot;</span> <span class="string">&quot;l&quot;</span> <span class="string">&quot;m&quot;</span> <span class="string">&quot;n&quot;</span> <span class="string">&quot;o&quot;</span> <span class="string">&quot;p&quot;</span> <span class="string">&quot;q&quot;</span> <span class="string">&quot;r&quot;</span> <span class="string">&quot;s&quot;</span> <span class="string">&quot;t&quot;</span> <span class="string">&quot;u&quot;</span> <span class="string">&quot;v&quot;</span> <span class="string">&quot;w&quot;</span> <span class="string">&quot;x&quot;</span> <span class="string">&quot;y&quot;</span> <span class="string">&quot;z&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> rev<span class="punctuation">(</span><span class="built_in">letters</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;z&quot;</span> <span class="string">&quot;y&quot;</span> <span class="string">&quot;x&quot;</span> <span class="string">&quot;w&quot;</span> <span class="string">&quot;v&quot;</span> <span class="string">&quot;u&quot;</span> <span class="string">&quot;t&quot;</span> <span class="string">&quot;s&quot;</span> <span class="string">&quot;r&quot;</span> <span class="string">&quot;q&quot;</span> <span class="string">&quot;p&quot;</span> <span class="string">&quot;o&quot;</span> <span class="string">&quot;n&quot;</span> <span class="string">&quot;m&quot;</span> <span class="string">&quot;l&quot;</span> <span class="string">&quot;k&quot;</span> <span class="string">&quot;j&quot;</span> <span class="string">&quot;i&quot;</span> <span class="string">&quot;h&quot;</span> <span class="string">&quot;g&quot;</span> <span class="string">&quot;f&quot;</span> <span class="string">&quot;e&quot;</span> <span class="string">&quot;d&quot;</span> <span class="string">&quot;c&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> women</span><br><span class="line">   height weight</span><br><span class="line"><span class="number">1</span>      <span class="number">58</span>    <span class="number">115</span></span><br><span class="line"><span class="number">2</span>      <span class="number">59</span>    <span class="number">117</span></span><br><span class="line"><span class="number">3</span>      <span class="number">60</span>    <span class="number">120</span></span><br><span class="line">...</span><br><span class="line"><span class="number">13</span>     <span class="number">70</span>    <span class="number">154</span></span><br><span class="line"><span class="number">14</span>     <span class="number">71</span>    <span class="number">159</span></span><br><span class="line"><span class="number">15</span>     <span class="number">72</span>    <span class="number">164</span></span><br><span class="line"><span class="operator">&gt;</span> rownames<span class="punctuation">(</span>women<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;1&quot;</span>  <span class="string">&quot;2&quot;</span>  <span class="string">&quot;3&quot;</span>  <span class="string">&quot;4&quot;</span>  <span class="string">&quot;5&quot;</span>  <span class="string">&quot;6&quot;</span>  <span class="string">&quot;7&quot;</span>  <span class="string">&quot;8&quot;</span>  <span class="string">&quot;9&quot;</span>  <span class="string">&quot;10&quot;</span> <span class="string">&quot;11&quot;</span> <span class="string">&quot;12&quot;</span> <span class="string">&quot;13&quot;</span> <span class="string">&quot;14&quot;</span> <span class="string">&quot;15&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> rev<span class="punctuation">(</span>rownames<span class="punctuation">(</span>women<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;15&quot;</span> <span class="string">&quot;14&quot;</span> <span class="string">&quot;13&quot;</span> <span class="string">&quot;12&quot;</span> <span class="string">&quot;11&quot;</span> <span class="string">&quot;10&quot;</span> <span class="string">&quot;9&quot;</span>  <span class="string">&quot;8&quot;</span>  <span class="string">&quot;7&quot;</span>  <span class="string">&quot;6&quot;</span>  <span class="string">&quot;5&quot;</span>  <span class="string">&quot;4&quot;</span>  <span class="string">&quot;3&quot;</span>  <span class="string">&quot;2&quot;</span>  <span class="string">&quot;1&quot;</span> </span><br><span class="line"><span class="operator">&gt;</span> women<span class="punctuation">[</span>rev<span class="punctuation">(</span>rownames<span class="punctuation">(</span>women<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">   height weight</span><br><span class="line"><span class="number">15</span>     <span class="number">72</span>    <span class="number">164</span></span><br><span class="line"><span class="number">14</span>     <span class="number">71</span>    <span class="number">159</span></span><br><span class="line"><span class="number">13</span>     <span class="number">70</span>    <span class="number">154</span></span><br><span class="line">...</span><br><span class="line"><span class="number">3</span>      <span class="number">60</span>    <span class="number">120</span></span><br><span class="line"><span class="number">2</span>      <span class="number">59</span>    <span class="number">117</span></span><br><span class="line"><span class="number">1</span>      <span class="number">58</span>    <span class="number">115</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过<code>rev</code>函数进行前后顺序翻转。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> data.frame<span class="punctuation">(</span>women<span class="operator">$</span>height<span class="operator">*</span><span class="number">2.54</span><span class="punctuation">,</span>women<span class="operator">$</span>weight<span class="punctuation">)</span></span><br><span class="line">   women.height...2.54 women.weight</span><br><span class="line"><span class="number">1</span>               <span class="number">147.32</span>          <span class="number">115</span></span><br><span class="line"><span class="number">2</span>               <span class="number">149.86</span>          <span class="number">117</span></span><br><span class="line"><span class="number">3</span>               <span class="number">152.40</span>          <span class="number">120</span></span><br><span class="line">...</span><br><span class="line"><span class="number">13</span>              <span class="number">177.80</span>          <span class="number">154</span></span><br><span class="line"><span class="number">14</span>              <span class="number">180.34</span>          <span class="number">159</span></span><br><span class="line"><span class="number">15</span>              <span class="number">182.88</span>          <span class="number">164</span></span><br><span class="line"><span class="operator">&gt;</span> data.frame<span class="punctuation">(</span>height <span class="operator">=</span> women<span class="operator">$</span>height<span class="operator">*</span><span class="number">2.54</span><span class="punctuation">,</span>weight <span class="operator">=</span> women<span class="operator">$</span>weight<span class="punctuation">)</span></span><br><span class="line">   height weight</span><br><span class="line"><span class="number">1</span>  <span class="number">147.32</span>    <span class="number">115</span></span><br><span class="line"><span class="number">2</span>  <span class="number">149.86</span>    <span class="number">117</span></span><br><span class="line"><span class="number">3</span>  <span class="number">152.40</span>    <span class="number">120</span></span><br><span class="line">...</span><br><span class="line"><span class="number">13</span> <span class="number">177.80</span>    <span class="number">154</span></span><br><span class="line"><span class="number">14</span> <span class="number">180.34</span>    <span class="number">159</span></span><br><span class="line"><span class="number">15</span> <span class="number">182.88</span>    <span class="number">164</span></span><br><span class="line"><span class="operator">&gt;</span> transform<span class="punctuation">(</span>women<span class="punctuation">,</span>height<span class="operator">=</span>height<span class="operator">*</span><span class="number">2.54</span><span class="punctuation">)</span></span><br><span class="line">   height weight</span><br><span class="line"><span class="number">1</span>  <span class="number">147.32</span>    <span class="number">115</span></span><br><span class="line"><span class="number">2</span>  <span class="number">149.86</span>    <span class="number">117</span></span><br><span class="line"><span class="number">3</span>  <span class="number">152.40</span>    <span class="number">120</span></span><br><span class="line">...</span><br><span class="line"><span class="number">13</span> <span class="number">177.80</span>    <span class="number">154</span></span><br><span class="line"><span class="number">14</span> <span class="number">180.34</span>    <span class="number">159</span></span><br><span class="line"><span class="number">15</span> <span class="number">182.88</span>    <span class="number">164</span></span><br><span class="line"><span class="operator">&gt;</span> transform<span class="punctuation">(</span>women<span class="punctuation">,</span>cm<span class="operator">=</span>height<span class="operator">*</span><span class="number">2.54</span><span class="punctuation">)</span></span><br><span class="line">   height weight     cm</span><br><span class="line"><span class="number">1</span>      <span class="number">58</span>    <span class="number">115</span> <span class="number">147.32</span></span><br><span class="line"><span class="number">2</span>      <span class="number">59</span>    <span class="number">117</span> <span class="number">149.86</span></span><br><span class="line"><span class="number">3</span>      <span class="number">60</span>    <span class="number">120</span> <span class="number">152.40</span></span><br><span class="line">...</span><br><span class="line"><span class="number">13</span>     <span class="number">70</span>    <span class="number">154</span> <span class="number">177.80</span></span><br><span class="line"><span class="number">14</span>     <span class="number">71</span>    <span class="number">159</span> <span class="number">180.34</span></span><br><span class="line"><span class="number">15</span>     <span class="number">72</span>    <span class="number">164</span> <span class="number">182.88</span></span><br></pre></td></tr></table></figure>
<p>总结：如果想修改某一行或者某一列的数据，可以通过<code>data.frame</code>进行重新组合，也可以采用更高效的方法，通过<code>transform</code>函数进行修改，也可以新增加一列。</p>
<h3 id="4-5-数据排序">4.5 数据排序</h3>
<p>数据排序有三种函数：<code>sort</code>、<code>order</code>、<code>rank</code></p>
<p>sort是对向量进行排序，返回值是排序后的结果向量。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> rivers</span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">735</span>  <span class="number">320</span>  <span class="number">325</span>  <span class="number">392</span>  <span class="number">524</span>  <span class="number">450</span> <span class="number">1459</span>  <span class="number">135</span>  <span class="number">465</span>  <span class="number">600</span>  <span class="number">330</span>  <span class="number">336</span>  <span class="number">280</span>  <span class="number">315</span>  <span class="number">870</span>  <span class="number">906</span>  <span class="number">202</span>  <span class="number">329</span>  <span class="number">290</span> <span class="number">1000</span>  <span class="number">600</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">22</span><span class="punctuation">]</span>  <span class="number">505</span> <span class="number">1450</span>  <span class="number">840</span> <span class="number">1243</span>  <span class="number">890</span>  <span class="number">350</span>  <span class="number">407</span>  <span class="number">286</span>  <span class="number">280</span>  <span class="number">525</span>  <span class="number">720</span>  <span class="number">390</span>  <span class="number">250</span>  <span class="number">327</span>  <span class="number">230</span>  <span class="number">265</span>  <span class="number">850</span>  <span class="number">210</span>  <span class="number">630</span>  <span class="number">260</span>  <span class="number">230</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">43</span><span class="punctuation">]</span>  <span class="number">360</span>  <span class="number">730</span>  <span class="number">600</span>  <span class="number">306</span>  <span class="number">390</span>  <span class="number">420</span>  <span class="number">291</span>  <span class="number">710</span>  <span class="number">340</span>  <span class="number">217</span>  <span class="number">281</span>  <span class="number">352</span>  <span class="number">259</span>  <span class="number">250</span>  <span class="number">470</span>  <span class="number">680</span>  <span class="number">570</span>  <span class="number">350</span>  <span class="number">300</span>  <span class="number">560</span>  <span class="number">900</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">64</span><span class="punctuation">]</span>  <span class="number">625</span>  <span class="number">332</span> <span class="number">2348</span> <span class="number">1171</span> <span class="number">3710</span> <span class="number">2315</span> <span class="number">2533</span>  <span class="number">780</span>  <span class="number">280</span>  <span class="number">410</span>  <span class="number">460</span>  <span class="number">260</span>  <span class="number">255</span>  <span class="number">431</span>  <span class="number">350</span>  <span class="number">760</span>  <span class="number">618</span>  <span class="number">338</span>  <span class="number">981</span> <span class="number">1306</span>  <span class="number">500</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">85</span><span class="punctuation">]</span>  <span class="number">696</span>  <span class="number">605</span>  <span class="number">250</span>  <span class="number">411</span> <span class="number">1054</span>  <span class="number">735</span>  <span class="number">233</span>  <span class="number">435</span>  <span class="number">490</span>  <span class="number">310</span>  <span class="number">460</span>  <span class="number">383</span>  <span class="number">375</span> <span class="number">1270</span>  <span class="number">545</span>  <span class="number">445</span> <span class="number">1885</span>  <span class="number">380</span>  <span class="number">300</span>  <span class="number">380</span>  <span class="number">377</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">106</span><span class="punctuation">]</span>  <span class="number">425</span>  <span class="number">276</span>  <span class="number">210</span>  <span class="number">800</span>  <span class="number">420</span>  <span class="number">350</span>  <span class="number">360</span>  <span class="number">538</span> <span class="number">1100</span> <span class="number">1205</span>  <span class="number">314</span>  <span class="number">237</span>  <span class="number">610</span>  <span class="number">360</span>  <span class="number">540</span> <span class="number">1038</span>  <span class="number">424</span>  <span class="number">310</span>  <span class="number">300</span>  <span class="number">444</span>  <span class="number">301</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">127</span><span class="punctuation">]</span>  <span class="number">268</span>  <span class="number">620</span>  <span class="number">215</span>  <span class="number">652</span>  <span class="number">900</span>  <span class="number">525</span>  <span class="number">246</span>  <span class="number">360</span>  <span class="number">529</span>  <span class="number">500</span>  <span class="number">720</span>  <span class="number">270</span>  <span class="number">430</span>  <span class="number">671</span> <span class="number">1770</span></span><br><span class="line"><span class="operator">&gt;</span> sort<span class="punctuation">(</span>rivers<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">135</span>  <span class="number">202</span>  <span class="number">210</span>  <span class="number">210</span>  <span class="number">215</span>  <span class="number">217</span>  <span class="number">230</span>  <span class="number">230</span>  <span class="number">233</span>  <span class="number">237</span>  <span class="number">246</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">255</span>  <span class="number">259</span>  <span class="number">260</span>  <span class="number">260</span>  <span class="number">265</span>  <span class="number">268</span>  <span class="number">270</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">22</span><span class="punctuation">]</span>  <span class="number">276</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">281</span>  <span class="number">286</span>  <span class="number">290</span>  <span class="number">291</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">301</span>  <span class="number">306</span>  <span class="number">310</span>  <span class="number">310</span>  <span class="number">314</span>  <span class="number">315</span>  <span class="number">320</span>  <span class="number">325</span>  <span class="number">327</span>  <span class="number">329</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">43</span><span class="punctuation">]</span>  <span class="number">330</span>  <span class="number">332</span>  <span class="number">336</span>  <span class="number">338</span>  <span class="number">340</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">352</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">375</span>  <span class="number">377</span>  <span class="number">380</span>  <span class="number">380</span>  <span class="number">383</span>  <span class="number">390</span>  <span class="number">390</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">64</span><span class="punctuation">]</span>  <span class="number">392</span>  <span class="number">407</span>  <span class="number">410</span>  <span class="number">411</span>  <span class="number">420</span>  <span class="number">420</span>  <span class="number">424</span>  <span class="number">425</span>  <span class="number">430</span>  <span class="number">431</span>  <span class="number">435</span>  <span class="number">444</span>  <span class="number">445</span>  <span class="number">450</span>  <span class="number">460</span>  <span class="number">460</span>  <span class="number">465</span>  <span class="number">470</span>  <span class="number">490</span>  <span class="number">500</span>  <span class="number">500</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">85</span><span class="punctuation">]</span>  <span class="number">505</span>  <span class="number">524</span>  <span class="number">525</span>  <span class="number">525</span>  <span class="number">529</span>  <span class="number">538</span>  <span class="number">540</span>  <span class="number">545</span>  <span class="number">560</span>  <span class="number">570</span>  <span class="number">600</span>  <span class="number">600</span>  <span class="number">600</span>  <span class="number">605</span>  <span class="number">610</span>  <span class="number">618</span>  <span class="number">620</span>  <span class="number">625</span>  <span class="number">630</span>  <span class="number">652</span>  <span class="number">671</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">106</span><span class="punctuation">]</span>  <span class="number">680</span>  <span class="number">696</span>  <span class="number">710</span>  <span class="number">720</span>  <span class="number">720</span>  <span class="number">730</span>  <span class="number">735</span>  <span class="number">735</span>  <span class="number">760</span>  <span class="number">780</span>  <span class="number">800</span>  <span class="number">840</span>  <span class="number">850</span>  <span class="number">870</span>  <span class="number">890</span>  <span class="number">900</span>  <span class="number">900</span>  <span class="number">906</span>  <span class="number">981</span> <span class="number">1000</span> <span class="number">1038</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">127</span><span class="punctuation">]</span> <span class="number">1054</span> <span class="number">1100</span> <span class="number">1171</span> <span class="number">1205</span> <span class="number">1243</span> <span class="number">1270</span> <span class="number">1306</span> <span class="number">1450</span> <span class="number">1459</span> <span class="number">1770</span> <span class="number">1885</span> <span class="number">2315</span> <span class="number">2348</span> <span class="number">2533</span> <span class="number">3710</span></span><br><span class="line"><span class="operator">&gt;</span> rev<span class="punctuation">(</span>sort<span class="punctuation">(</span>rivers<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3710</span> <span class="number">2533</span> <span class="number">2348</span> <span class="number">2315</span> <span class="number">1885</span> <span class="number">1770</span> <span class="number">1459</span> <span class="number">1450</span> <span class="number">1306</span> <span class="number">1270</span> <span class="number">1243</span> <span class="number">1205</span> <span class="number">1171</span> <span class="number">1100</span> <span class="number">1054</span> <span class="number">1038</span> <span class="number">1000</span>  <span class="number">981</span>  <span class="number">906</span>  <span class="number">900</span>  <span class="number">900</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">22</span><span class="punctuation">]</span>  <span class="number">890</span>  <span class="number">870</span>  <span class="number">850</span>  <span class="number">840</span>  <span class="number">800</span>  <span class="number">780</span>  <span class="number">760</span>  <span class="number">735</span>  <span class="number">735</span>  <span class="number">730</span>  <span class="number">720</span>  <span class="number">720</span>  <span class="number">710</span>  <span class="number">696</span>  <span class="number">680</span>  <span class="number">671</span>  <span class="number">652</span>  <span class="number">630</span>  <span class="number">625</span>  <span class="number">620</span>  <span class="number">618</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">43</span><span class="punctuation">]</span>  <span class="number">610</span>  <span class="number">605</span>  <span class="number">600</span>  <span class="number">600</span>  <span class="number">600</span>  <span class="number">570</span>  <span class="number">560</span>  <span class="number">545</span>  <span class="number">540</span>  <span class="number">538</span>  <span class="number">529</span>  <span class="number">525</span>  <span class="number">525</span>  <span class="number">524</span>  <span class="number">505</span>  <span class="number">500</span>  <span class="number">500</span>  <span class="number">490</span>  <span class="number">470</span>  <span class="number">465</span>  <span class="number">460</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">64</span><span class="punctuation">]</span>  <span class="number">460</span>  <span class="number">450</span>  <span class="number">445</span>  <span class="number">444</span>  <span class="number">435</span>  <span class="number">431</span>  <span class="number">430</span>  <span class="number">425</span>  <span class="number">424</span>  <span class="number">420</span>  <span class="number">420</span>  <span class="number">411</span>  <span class="number">410</span>  <span class="number">407</span>  <span class="number">392</span>  <span class="number">390</span>  <span class="number">390</span>  <span class="number">383</span>  <span class="number">380</span>  <span class="number">380</span>  <span class="number">377</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">85</span><span class="punctuation">]</span>  <span class="number">375</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">352</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">340</span>  <span class="number">338</span>  <span class="number">336</span>  <span class="number">332</span>  <span class="number">330</span>  <span class="number">329</span>  <span class="number">327</span>  <span class="number">325</span>  <span class="number">320</span>  <span class="number">315</span>  <span class="number">314</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">106</span><span class="punctuation">]</span>  <span class="number">310</span>  <span class="number">310</span>  <span class="number">306</span>  <span class="number">301</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">291</span>  <span class="number">290</span>  <span class="number">286</span>  <span class="number">281</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">276</span>  <span class="number">270</span>  <span class="number">268</span>  <span class="number">265</span>  <span class="number">260</span>  <span class="number">260</span>  <span class="number">259</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">127</span><span class="punctuation">]</span>  <span class="number">255</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">246</span>  <span class="number">237</span>  <span class="number">233</span>  <span class="number">230</span>  <span class="number">230</span>  <span class="number">217</span>  <span class="number">215</span>  <span class="number">210</span>  <span class="number">210</span>  <span class="number">202</span>  <span class="number">135</span></span><br><span class="line"><span class="operator">&gt;</span> sort<span class="punctuation">(</span>state.name<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Alabama&quot;</span>        <span class="string">&quot;Alaska&quot;</span>         <span class="string">&quot;Arizona&quot;</span>        <span class="string">&quot;Arkansas&quot;</span>       <span class="string">&quot;California&quot;</span>     <span class="string">&quot;Colorado&quot;</span>      </span><br><span class="line"> <span class="punctuation">[</span><span class="number">7</span><span class="punctuation">]</span> <span class="string">&quot;Connecticut&quot;</span>    <span class="string">&quot;Delaware&quot;</span>       <span class="string">&quot;Florida&quot;</span>        <span class="string">&quot;Georgia&quot;</span>        <span class="string">&quot;Hawaii&quot;</span>         <span class="string">&quot;Idaho&quot;</span>         </span><br><span class="line"><span class="punctuation">[</span><span class="number">13</span><span class="punctuation">]</span> <span class="string">&quot;Illinois&quot;</span>       <span class="string">&quot;Indiana&quot;</span>        <span class="string">&quot;Iowa&quot;</span>           <span class="string">&quot;Kansas&quot;</span>         <span class="string">&quot;Kentucky&quot;</span>       <span class="string">&quot;Louisiana&quot;</span>     </span><br><span class="line"><span class="punctuation">[</span><span class="number">19</span><span class="punctuation">]</span> <span class="string">&quot;Maine&quot;</span>          <span class="string">&quot;Maryland&quot;</span>       <span class="string">&quot;Massachusetts&quot;</span>  <span class="string">&quot;Michigan&quot;</span>       <span class="string">&quot;Minnesota&quot;</span>      <span class="string">&quot;Mississippi&quot;</span>   </span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span> <span class="string">&quot;Missouri&quot;</span>       <span class="string">&quot;Montana&quot;</span>        <span class="string">&quot;Nebraska&quot;</span>       <span class="string">&quot;Nevada&quot;</span>         <span class="string">&quot;New Hampshire&quot;</span>  <span class="string">&quot;New Jersey&quot;</span>    </span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> <span class="string">&quot;New Mexico&quot;</span>     <span class="string">&quot;New York&quot;</span>       <span class="string">&quot;North Carolina&quot;</span> <span class="string">&quot;North Dakota&quot;</span>   <span class="string">&quot;Ohio&quot;</span>           <span class="string">&quot;Oklahoma&quot;</span>      </span><br><span class="line"><span class="punctuation">[</span><span class="number">37</span><span class="punctuation">]</span> <span class="string">&quot;Oregon&quot;</span>         <span class="string">&quot;Pennsylvania&quot;</span>   <span class="string">&quot;Rhode Island&quot;</span>   <span class="string">&quot;South Carolina&quot;</span> <span class="string">&quot;South Dakota&quot;</span>   <span class="string">&quot;Tennessee&quot;</span>     </span><br><span class="line"><span class="punctuation">[</span><span class="number">43</span><span class="punctuation">]</span> <span class="string">&quot;Texas&quot;</span>          <span class="string">&quot;Utah&quot;</span>           <span class="string">&quot;Vermont&quot;</span>        <span class="string">&quot;Virginia&quot;</span>       <span class="string">&quot;Washington&quot;</span>     <span class="string">&quot;West Virginia&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span> <span class="string">&quot;Wisconsin&quot;</span>      <span class="string">&quot;Wyoming&quot;</span>       </span><br></pre></td></tr></table></figure>
<p>总结：<code>sort</code>默认从小到大排列。字符串是按照ASCII码值顺序。如果需要从大到小排序，可以通过<code>rev</code>函数组合使用。sort只能用于向量，不能用于数据框的排序。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mtcars<span class="punctuation">[</span>sort<span class="punctuation">(</span>rownames<span class="punctuation">(</span>mtcars<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">                    cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">AMC Javelin           <span class="number">8</span> <span class="number">304.0</span> <span class="number">150</span> <span class="number">3.15</span> <span class="number">3.435</span> <span class="number">17.30</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Cadillac Fleetwood    <span class="number">8</span> <span class="number">472.0</span> <span class="number">205</span> <span class="number">2.93</span> <span class="number">5.250</span> <span class="number">17.98</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Camaro Z28            <span class="number">8</span> <span class="number">350.0</span> <span class="number">245</span> <span class="number">3.73</span> <span class="number">3.840</span> <span class="number">15.41</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">...</span><br><span class="line">Toyota Corona         <span class="number">4</span> <span class="number">120.1</span>  <span class="number">97</span> <span class="number">3.70</span> <span class="number">2.465</span> <span class="number">20.01</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Valiant               <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Volvo <span class="number">142</span>E            <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>总结：可以根据行的名称进行排序。</p>
<p>order排序：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> sort<span class="punctuation">(</span>rivers<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">135</span>  <span class="number">202</span>  <span class="number">210</span>  <span class="number">210</span>  <span class="number">215</span>  <span class="number">217</span>  <span class="number">230</span>  <span class="number">230</span>  <span class="number">233</span>  <span class="number">237</span>  <span class="number">246</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">255</span>  <span class="number">259</span>  <span class="number">260</span>  <span class="number">260</span>  <span class="number">265</span>  <span class="number">268</span>  <span class="number">270</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">22</span><span class="punctuation">]</span>  <span class="number">276</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">281</span>  <span class="number">286</span>  <span class="number">290</span>  <span class="number">291</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">301</span>  <span class="number">306</span>  <span class="number">310</span>  <span class="number">310</span>  <span class="number">314</span>  <span class="number">315</span>  <span class="number">320</span>  <span class="number">325</span>  <span class="number">327</span>  <span class="number">329</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">43</span><span class="punctuation">]</span>  <span class="number">330</span>  <span class="number">332</span>  <span class="number">336</span>  <span class="number">338</span>  <span class="number">340</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">352</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">375</span>  <span class="number">377</span>  <span class="number">380</span>  <span class="number">380</span>  <span class="number">383</span>  <span class="number">390</span>  <span class="number">390</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">64</span><span class="punctuation">]</span>  <span class="number">392</span>  <span class="number">407</span>  <span class="number">410</span>  <span class="number">411</span>  <span class="number">420</span>  <span class="number">420</span>  <span class="number">424</span>  <span class="number">425</span>  <span class="number">430</span>  <span class="number">431</span>  <span class="number">435</span>  <span class="number">444</span>  <span class="number">445</span>  <span class="number">450</span>  <span class="number">460</span>  <span class="number">460</span>  <span class="number">465</span>  <span class="number">470</span>  <span class="number">490</span>  <span class="number">500</span>  <span class="number">500</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">85</span><span class="punctuation">]</span>  <span class="number">505</span>  <span class="number">524</span>  <span class="number">525</span>  <span class="number">525</span>  <span class="number">529</span>  <span class="number">538</span>  <span class="number">540</span>  <span class="number">545</span>  <span class="number">560</span>  <span class="number">570</span>  <span class="number">600</span>  <span class="number">600</span>  <span class="number">600</span>  <span class="number">605</span>  <span class="number">610</span>  <span class="number">618</span>  <span class="number">620</span>  <span class="number">625</span>  <span class="number">630</span>  <span class="number">652</span>  <span class="number">671</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">106</span><span class="punctuation">]</span>  <span class="number">680</span>  <span class="number">696</span>  <span class="number">710</span>  <span class="number">720</span>  <span class="number">720</span>  <span class="number">730</span>  <span class="number">735</span>  <span class="number">735</span>  <span class="number">760</span>  <span class="number">780</span>  <span class="number">800</span>  <span class="number">840</span>  <span class="number">850</span>  <span class="number">870</span>  <span class="number">890</span>  <span class="number">900</span>  <span class="number">900</span>  <span class="number">906</span>  <span class="number">981</span> <span class="number">1000</span> <span class="number">1038</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">127</span><span class="punctuation">]</span> <span class="number">1054</span> <span class="number">1100</span> <span class="number">1171</span> <span class="number">1205</span> <span class="number">1243</span> <span class="number">1270</span> <span class="number">1306</span> <span class="number">1450</span> <span class="number">1459</span> <span class="number">1770</span> <span class="number">1885</span> <span class="number">2315</span> <span class="number">2348</span> <span class="number">2533</span> <span class="number">3710</span></span><br><span class="line"><span class="operator">&gt;</span> rivers</span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">735</span>  <span class="number">320</span>  <span class="number">325</span>  <span class="number">392</span>  <span class="number">524</span>  <span class="number">450</span> <span class="number">1459</span>  <span class="number">135</span>  <span class="number">465</span>  <span class="number">600</span>  <span class="number">330</span>  <span class="number">336</span>  <span class="number">280</span>  <span class="number">315</span>  <span class="number">870</span>  <span class="number">906</span>  <span class="number">202</span>  <span class="number">329</span>  <span class="number">290</span> <span class="number">1000</span>  <span class="number">600</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">22</span><span class="punctuation">]</span>  <span class="number">505</span> <span class="number">1450</span>  <span class="number">840</span> <span class="number">1243</span>  <span class="number">890</span>  <span class="number">350</span>  <span class="number">407</span>  <span class="number">286</span>  <span class="number">280</span>  <span class="number">525</span>  <span class="number">720</span>  <span class="number">390</span>  <span class="number">250</span>  <span class="number">327</span>  <span class="number">230</span>  <span class="number">265</span>  <span class="number">850</span>  <span class="number">210</span>  <span class="number">630</span>  <span class="number">260</span>  <span class="number">230</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">43</span><span class="punctuation">]</span>  <span class="number">360</span>  <span class="number">730</span>  <span class="number">600</span>  <span class="number">306</span>  <span class="number">390</span>  <span class="number">420</span>  <span class="number">291</span>  <span class="number">710</span>  <span class="number">340</span>  <span class="number">217</span>  <span class="number">281</span>  <span class="number">352</span>  <span class="number">259</span>  <span class="number">250</span>  <span class="number">470</span>  <span class="number">680</span>  <span class="number">570</span>  <span class="number">350</span>  <span class="number">300</span>  <span class="number">560</span>  <span class="number">900</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">64</span><span class="punctuation">]</span>  <span class="number">625</span>  <span class="number">332</span> <span class="number">2348</span> <span class="number">1171</span> <span class="number">3710</span> <span class="number">2315</span> <span class="number">2533</span>  <span class="number">780</span>  <span class="number">280</span>  <span class="number">410</span>  <span class="number">460</span>  <span class="number">260</span>  <span class="number">255</span>  <span class="number">431</span>  <span class="number">350</span>  <span class="number">760</span>  <span class="number">618</span>  <span class="number">338</span>  <span class="number">981</span> <span class="number">1306</span>  <span class="number">500</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">85</span><span class="punctuation">]</span>  <span class="number">696</span>  <span class="number">605</span>  <span class="number">250</span>  <span class="number">411</span> <span class="number">1054</span>  <span class="number">735</span>  <span class="number">233</span>  <span class="number">435</span>  <span class="number">490</span>  <span class="number">310</span>  <span class="number">460</span>  <span class="number">383</span>  <span class="number">375</span> <span class="number">1270</span>  <span class="number">545</span>  <span class="number">445</span> <span class="number">1885</span>  <span class="number">380</span>  <span class="number">300</span>  <span class="number">380</span>  <span class="number">377</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">106</span><span class="punctuation">]</span>  <span class="number">425</span>  <span class="number">276</span>  <span class="number">210</span>  <span class="number">800</span>  <span class="number">420</span>  <span class="number">350</span>  <span class="number">360</span>  <span class="number">538</span> <span class="number">1100</span> <span class="number">1205</span>  <span class="number">314</span>  <span class="number">237</span>  <span class="number">610</span>  <span class="number">360</span>  <span class="number">540</span> <span class="number">1038</span>  <span class="number">424</span>  <span class="number">310</span>  <span class="number">300</span>  <span class="number">444</span>  <span class="number">301</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">127</span><span class="punctuation">]</span>  <span class="number">268</span>  <span class="number">620</span>  <span class="number">215</span>  <span class="number">652</span>  <span class="number">900</span>  <span class="number">525</span>  <span class="number">246</span>  <span class="number">360</span>  <span class="number">529</span>  <span class="number">500</span>  <span class="number">720</span>  <span class="number">270</span>  <span class="number">430</span>  <span class="number">671</span> <span class="number">1770</span></span><br><span class="line"><span class="operator">&gt;</span> order<span class="punctuation">(</span>rivers<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">8</span>  <span class="number">17</span>  <span class="number">39</span> <span class="number">108</span> <span class="number">129</span>  <span class="number">52</span>  <span class="number">36</span>  <span class="number">42</span>  <span class="number">91</span> <span class="number">117</span> <span class="number">133</span>  <span class="number">34</span>  <span class="number">56</span>  <span class="number">87</span>  <span class="number">76</span>  <span class="number">55</span>  <span class="number">41</span>  <span class="number">75</span>  <span class="number">37</span> <span class="number">127</span> <span class="number">138</span> <span class="number">107</span>  <span class="number">13</span>  <span class="number">30</span>  <span class="number">72</span>  <span class="number">53</span>  <span class="number">29</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">28</span><span class="punctuation">]</span>  <span class="number">19</span>  <span class="number">49</span>  <span class="number">61</span> <span class="number">103</span> <span class="number">124</span> <span class="number">126</span>  <span class="number">46</span>  <span class="number">94</span> <span class="number">123</span> <span class="number">116</span>  <span class="number">14</span>   <span class="number">2</span>   <span class="number">3</span>  <span class="number">35</span>  <span class="number">18</span>  <span class="number">11</span>  <span class="number">65</span>  <span class="number">12</span>  <span class="number">81</span>  <span class="number">51</span>  <span class="number">27</span>  <span class="number">60</span>  <span class="number">78</span> <span class="number">111</span>  <span class="number">54</span>  <span class="number">43</span> <span class="number">112</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">55</span><span class="punctuation">]</span> <span class="number">119</span> <span class="number">134</span>  <span class="number">97</span> <span class="number">105</span> <span class="number">102</span> <span class="number">104</span>  <span class="number">96</span>  <span class="number">33</span>  <span class="number">47</span>   <span class="number">4</span>  <span class="number">28</span>  <span class="number">73</span>  <span class="number">88</span>  <span class="number">48</span> <span class="number">110</span> <span class="number">122</span> <span class="number">106</span> <span class="number">139</span>  <span class="number">77</span>  <span class="number">92</span> <span class="number">125</span> <span class="number">100</span>   <span class="number">6</span>  <span class="number">74</span>  <span class="number">95</span>   <span class="number">9</span>  <span class="number">57</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">82</span><span class="punctuation">]</span>  <span class="number">93</span>  <span class="number">84</span> <span class="number">136</span>  <span class="number">22</span>   <span class="number">5</span>  <span class="number">31</span> <span class="number">132</span> <span class="number">135</span> <span class="number">113</span> <span class="number">120</span>  <span class="number">99</span>  <span class="number">62</span>  <span class="number">59</span>  <span class="number">10</span>  <span class="number">21</span>  <span class="number">45</span>  <span class="number">86</span> <span class="number">118</span>  <span class="number">80</span> <span class="number">128</span>  <span class="number">64</span>  <span class="number">40</span> <span class="number">130</span> <span class="number">140</span>  <span class="number">58</span>  <span class="number">85</span>  <span class="number">50</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">109</span><span class="punctuation">]</span>  <span class="number">32</span> <span class="number">137</span>  <span class="number">44</span>   <span class="number">1</span>  <span class="number">90</span>  <span class="number">79</span>  <span class="number">71</span> <span class="number">109</span>  <span class="number">24</span>  <span class="number">38</span>  <span class="number">15</span>  <span class="number">26</span>  <span class="number">63</span> <span class="number">131</span>  <span class="number">16</span>  <span class="number">82</span>  <span class="number">20</span> <span class="number">121</span>  <span class="number">89</span> <span class="number">114</span>  <span class="number">67</span> <span class="number">115</span>  <span class="number">25</span>  <span class="number">98</span>  <span class="number">83</span>  <span class="number">23</span>   <span class="number">7</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">136</span><span class="punctuation">]</span> <span class="number">141</span> <span class="number">101</span>  <span class="number">69</span>  <span class="number">66</span>  <span class="number">70</span>  <span class="number">68</span></span><br><span class="line"><span class="operator">&gt;</span> mtcars<span class="punctuation">[</span>order<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Cadillac Fleetwood  <span class="number">10.4</span>   <span class="number">8</span> <span class="number">472.0</span> <span class="number">205</span> <span class="number">2.93</span> <span class="number">5.250</span> <span class="number">17.98</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Lincoln Continental <span class="number">10.4</span>   <span class="number">8</span> <span class="number">460.0</span> <span class="number">215</span> <span class="number">3.00</span> <span class="number">5.424</span> <span class="number">17.82</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Camaro Z28          <span class="number">13.3</span>   <span class="number">8</span> <span class="number">350.0</span> <span class="number">245</span> <span class="number">3.73</span> <span class="number">3.840</span> <span class="number">15.41</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Duster <span class="number">360</span>          <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Chrysler Imperial   <span class="number">14.7</span>   <span class="number">8</span> <span class="number">440.0</span> <span class="number">230</span> <span class="number">3.23</span> <span class="number">5.345</span> <span class="number">17.42</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">...</span><br><span class="line">Fiat X1<span class="operator">-</span><span class="number">9</span>           <span class="number">27.3</span>   <span class="number">4</span>  <span class="number">79.0</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">1.935</span> <span class="number">18.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Honda Civic         <span class="number">30.4</span>   <span class="number">4</span>  <span class="number">75.7</span>  <span class="number">52</span> <span class="number">4.93</span> <span class="number">1.615</span> <span class="number">18.52</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Lotus Europa        <span class="number">30.4</span>   <span class="number">4</span>  <span class="number">95.1</span> <span class="number">113</span> <span class="number">3.77</span> <span class="number">1.513</span> <span class="number">16.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">2</span></span><br><span class="line">Fiat <span class="number">128</span>            <span class="number">32.4</span>   <span class="number">4</span>  <span class="number">78.7</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.200</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Toyota Corolla      <span class="number">33.9</span>   <span class="number">4</span>  <span class="number">71.1</span>  <span class="number">65</span> <span class="number">4.22</span> <span class="number">1.835</span> <span class="number">19.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> mtcars<span class="punctuation">[</span>order<span class="punctuation">(</span><span class="operator">-</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Toyota Corolla      <span class="number">33.9</span>   <span class="number">4</span>  <span class="number">71.1</span>  <span class="number">65</span> <span class="number">4.22</span> <span class="number">1.835</span> <span class="number">19.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Fiat <span class="number">128</span>            <span class="number">32.4</span>   <span class="number">4</span>  <span class="number">78.7</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.200</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Honda Civic         <span class="number">30.4</span>   <span class="number">4</span>  <span class="number">75.7</span>  <span class="number">52</span> <span class="number">4.93</span> <span class="number">1.615</span> <span class="number">18.52</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Lotus Europa        <span class="number">30.4</span>   <span class="number">4</span>  <span class="number">95.1</span> <span class="number">113</span> <span class="number">3.77</span> <span class="number">1.513</span> <span class="number">16.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">2</span></span><br><span class="line">Fiat X1<span class="operator">-</span><span class="number">9</span>           <span class="number">27.3</span>   <span class="number">4</span>  <span class="number">79.0</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">1.935</span> <span class="number">18.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line">Chrysler Imperial   <span class="number">14.7</span>   <span class="number">8</span> <span class="number">440.0</span> <span class="number">230</span> <span class="number">3.23</span> <span class="number">5.345</span> <span class="number">17.42</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Duster <span class="number">360</span>          <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Camaro Z28          <span class="number">13.3</span>   <span class="number">8</span> <span class="number">350.0</span> <span class="number">245</span> <span class="number">3.73</span> <span class="number">3.840</span> <span class="number">15.41</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Cadillac Fleetwood  <span class="number">10.4</span>   <span class="number">8</span> <span class="number">472.0</span> <span class="number">205</span> <span class="number">2.93</span> <span class="number">5.250</span> <span class="number">17.98</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Lincoln Continental <span class="number">10.4</span>   <span class="number">8</span> <span class="number">460.0</span> <span class="number">215</span> <span class="number">3.00</span> <span class="number">5.424</span> <span class="number">17.82</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>order</code>也可以进行排序，返回的值是排序的位置，而不是排序后的结果。如果使<code>order</code>排序从大到小，需要在<code>order</code>参数中添加<code>-</code>号。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mtcars<span class="punctuation">[</span>order<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">,</span>mtcars<span class="operator">$</span>disp<span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Lincoln Continental <span class="number">10.4</span>   <span class="number">8</span> <span class="number">460.0</span> <span class="number">215</span> <span class="number">3.00</span> <span class="number">5.424</span> <span class="number">17.82</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Cadillac Fleetwood  <span class="number">10.4</span>   <span class="number">8</span> <span class="number">472.0</span> <span class="number">205</span> <span class="number">2.93</span> <span class="number">5.250</span> <span class="number">17.98</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Camaro Z28          <span class="number">13.3</span>   <span class="number">8</span> <span class="number">350.0</span> <span class="number">245</span> <span class="number">3.73</span> <span class="number">3.840</span> <span class="number">15.41</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Duster <span class="number">360</span>          <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Chrysler Imperial   <span class="number">14.7</span>   <span class="number">8</span> <span class="number">440.0</span> <span class="number">230</span> <span class="number">3.23</span> <span class="number">5.345</span> <span class="number">17.42</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">...</span><br><span class="line">Fiat X1<span class="operator">-</span><span class="number">9</span>           <span class="number">27.3</span>   <span class="number">4</span>  <span class="number">79.0</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">1.935</span> <span class="number">18.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Honda Civic         <span class="number">30.4</span>   <span class="number">4</span>  <span class="number">75.7</span>  <span class="number">52</span> <span class="number">4.93</span> <span class="number">1.615</span> <span class="number">18.52</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Lotus Europa        <span class="number">30.4</span>   <span class="number">4</span>  <span class="number">95.1</span> <span class="number">113</span> <span class="number">3.77</span> <span class="number">1.513</span> <span class="number">16.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">2</span></span><br><span class="line">Fiat <span class="number">128</span>            <span class="number">32.4</span>   <span class="number">4</span>  <span class="number">78.7</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.200</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Toyota Corolla      <span class="number">33.9</span>   <span class="number">4</span>  <span class="number">71.1</span>  <span class="number">65</span> <span class="number">4.22</span> <span class="number">1.835</span> <span class="number">19.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>总结：也可以通过多个条件进行排序，比如在<code>mpg</code>相同时，<code>disp</code>越小的排在前面。</p>
<p><code>rank</code>和<code>sort</code>、<code>order</code>不同，它是求秩的函数，它的返回值是这个向量对应元素的排名，具体操作不做介绍，可以通过<code>?rank</code>查看帮助文档。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="operator">?</span>rank</span><br></pre></td></tr></table></figure>
<h3 id="4-6-数据统计">4.6 数据统计</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> WorldPhones</span><br><span class="line">     N.Amer Europe Asia S.Amer Oceania Africa Mid.Amer</span><br><span class="line"><span class="number">1951</span>  <span class="number">45939</span>  <span class="number">21574</span> <span class="number">2876</span>   <span class="number">1815</span>    <span class="number">1646</span>     <span class="number">89</span>      <span class="number">555</span></span><br><span class="line"><span class="number">1956</span>  <span class="number">60423</span>  <span class="number">29990</span> <span class="number">4708</span>   <span class="number">2568</span>    <span class="number">2366</span>   <span class="number">1411</span>      <span class="number">733</span></span><br><span class="line"><span class="number">1957</span>  <span class="number">64721</span>  <span class="number">32510</span> <span class="number">5230</span>   <span class="number">2695</span>    <span class="number">2526</span>   <span class="number">1546</span>      <span class="number">773</span></span><br><span class="line"><span class="number">1958</span>  <span class="number">68484</span>  <span class="number">35218</span> <span class="number">6662</span>   <span class="number">2845</span>    <span class="number">2691</span>   <span class="number">1663</span>      <span class="number">836</span></span><br><span class="line"><span class="number">1959</span>  <span class="number">71799</span>  <span class="number">37598</span> <span class="number">6856</span>   <span class="number">3000</span>    <span class="number">2868</span>   <span class="number">1769</span>      <span class="number">911</span></span><br><span class="line"><span class="number">1960</span>  <span class="number">76036</span>  <span class="number">40341</span> <span class="number">8220</span>   <span class="number">3145</span>    <span class="number">3054</span>   <span class="number">1905</span>     <span class="number">1008</span></span><br><span class="line"><span class="number">1961</span>  <span class="number">79831</span>  <span class="number">43173</span> <span class="number">9053</span>   <span class="number">3338</span>    <span class="number">3224</span>   <span class="number">2005</span>     <span class="number">1076</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> worldphone <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>WorldPhones<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> worldphone</span><br><span class="line">     N.Amer Europe Asia S.Amer Oceania Africa Mid.Amer</span><br><span class="line"><span class="number">1951</span>  <span class="number">45939</span>  <span class="number">21574</span> <span class="number">2876</span>   <span class="number">1815</span>    <span class="number">1646</span>     <span class="number">89</span>      <span class="number">555</span></span><br><span class="line"><span class="number">1956</span>  <span class="number">60423</span>  <span class="number">29990</span> <span class="number">4708</span>   <span class="number">2568</span>    <span class="number">2366</span>   <span class="number">1411</span>      <span class="number">733</span></span><br><span class="line"><span class="number">1957</span>  <span class="number">64721</span>  <span class="number">32510</span> <span class="number">5230</span>   <span class="number">2695</span>    <span class="number">2526</span>   <span class="number">1546</span>      <span class="number">773</span></span><br><span class="line"><span class="number">1958</span>  <span class="number">68484</span>  <span class="number">35218</span> <span class="number">6662</span>   <span class="number">2845</span>    <span class="number">2691</span>   <span class="number">1663</span>      <span class="number">836</span></span><br><span class="line"><span class="number">1959</span>  <span class="number">71799</span>  <span class="number">37598</span> <span class="number">6856</span>   <span class="number">3000</span>    <span class="number">2868</span>   <span class="number">1769</span>      <span class="number">911</span></span><br><span class="line"><span class="number">1960</span>  <span class="number">76036</span>  <span class="number">40341</span> <span class="number">8220</span>   <span class="number">3145</span>    <span class="number">3054</span>   <span class="number">1905</span>     <span class="number">1008</span></span><br><span class="line"><span class="number">1961</span>  <span class="number">79831</span>  <span class="number">43173</span> <span class="number">9053</span>   <span class="number">3338</span>    <span class="number">3224</span>   <span class="number">2005</span>     <span class="number">1076</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> rs <span class="operator">&lt;-</span> rowSums<span class="punctuation">(</span>worldphone<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> rs</span><br><span class="line">  <span class="number">1951</span>   <span class="number">1956</span>   <span class="number">1957</span>   <span class="number">1958</span>   <span class="number">1959</span>   <span class="number">1960</span>   <span class="number">1961</span> </span><br><span class="line"> <span class="number">74494</span> <span class="number">102199</span> <span class="number">110001</span> <span class="number">118399</span> <span class="number">124801</span> <span class="number">133709</span> <span class="number">141700</span> </span><br><span class="line"> </span><br><span class="line"><span class="operator">&gt;</span> cm <span class="operator">&lt;-</span> colMeans<span class="punctuation">(</span>worldphone<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> cm</span><br><span class="line">    N.Amer     Europe       Asia     S.Amer    Oceania     Africa   Mid.Amer </span><br><span class="line"><span class="number">66747.5714</span> <span class="number">34343.4286</span>  <span class="number">6229.2857</span>  <span class="number">2772.2857</span>  <span class="number">2625.0000</span>  <span class="number">1484.0000</span>   <span class="number">841.7143</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> total <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>worldphone<span class="punctuation">,</span>Total<span class="operator">=</span>rs<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> total</span><br><span class="line">     N.Amer Europe Asia S.Amer Oceania Africa Mid.Amer  Total</span><br><span class="line"><span class="number">1951</span>  <span class="number">45939</span>  <span class="number">21574</span> <span class="number">2876</span>   <span class="number">1815</span>    <span class="number">1646</span>     <span class="number">89</span>      <span class="number">555</span>  <span class="number">74494</span></span><br><span class="line"><span class="number">1956</span>  <span class="number">60423</span>  <span class="number">29990</span> <span class="number">4708</span>   <span class="number">2568</span>    <span class="number">2366</span>   <span class="number">1411</span>      <span class="number">733</span> <span class="number">102199</span></span><br><span class="line"><span class="number">1957</span>  <span class="number">64721</span>  <span class="number">32510</span> <span class="number">5230</span>   <span class="number">2695</span>    <span class="number">2526</span>   <span class="number">1546</span>      <span class="number">773</span> <span class="number">110001</span></span><br><span class="line"><span class="number">1958</span>  <span class="number">68484</span>  <span class="number">35218</span> <span class="number">6662</span>   <span class="number">2845</span>    <span class="number">2691</span>   <span class="number">1663</span>      <span class="number">836</span> <span class="number">118399</span></span><br><span class="line"><span class="number">1959</span>  <span class="number">71799</span>  <span class="number">37598</span> <span class="number">6856</span>   <span class="number">3000</span>    <span class="number">2868</span>   <span class="number">1769</span>      <span class="number">911</span> <span class="number">124801</span></span><br><span class="line"><span class="number">1960</span>  <span class="number">76036</span>  <span class="number">40341</span> <span class="number">8220</span>   <span class="number">3145</span>    <span class="number">3054</span>   <span class="number">1905</span>     <span class="number">1008</span> <span class="number">133709</span></span><br><span class="line"><span class="number">1961</span>  <span class="number">79831</span>  <span class="number">43173</span> <span class="number">9053</span>   <span class="number">3338</span>    <span class="number">3224</span>   <span class="number">2005</span>     <span class="number">1076</span> <span class="number">141700</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> rbind<span class="punctuation">(</span>total<span class="punctuation">,</span>Mean <span class="operator">=</span> cm<span class="punctuation">)</span></span><br><span class="line">       N.Amer   Europe     Asia   S.Amer Oceania Africa  Mid.Amer     Total</span><br><span class="line"><span class="number">1951</span> <span class="number">45939.00</span> <span class="number">21574.00</span> <span class="number">2876.000</span> <span class="number">1815.000</span>    <span class="number">1646</span>     <span class="number">89</span>  <span class="number">555.0000</span>  <span class="number">74494.00</span></span><br><span class="line"><span class="number">1956</span> <span class="number">60423.00</span> <span class="number">29990.00</span> <span class="number">4708.000</span> <span class="number">2568.000</span>    <span class="number">2366</span>   <span class="number">1411</span>  <span class="number">733.0000</span> <span class="number">102199.00</span></span><br><span class="line"><span class="number">1957</span> <span class="number">64721.00</span> <span class="number">32510.00</span> <span class="number">5230.000</span> <span class="number">2695.000</span>    <span class="number">2526</span>   <span class="number">1546</span>  <span class="number">773.0000</span> <span class="number">110001.00</span></span><br><span class="line"><span class="number">1958</span> <span class="number">68484.00</span> <span class="number">35218.00</span> <span class="number">6662.000</span> <span class="number">2845.000</span>    <span class="number">2691</span>   <span class="number">1663</span>  <span class="number">836.0000</span> <span class="number">118399.00</span></span><br><span class="line"><span class="number">1959</span> <span class="number">71799.00</span> <span class="number">37598.00</span> <span class="number">6856.000</span> <span class="number">3000.000</span>    <span class="number">2868</span>   <span class="number">1769</span>  <span class="number">911.0000</span> <span class="number">124801.00</span></span><br><span class="line"><span class="number">1960</span> <span class="number">76036.00</span> <span class="number">40341.00</span> <span class="number">8220.000</span> <span class="number">3145.000</span>    <span class="number">3054</span>   <span class="number">1905</span> <span class="number">1008.0000</span> <span class="number">133709.00</span></span><br><span class="line"><span class="number">1961</span> <span class="number">79831.00</span> <span class="number">43173.00</span> <span class="number">9053.000</span> <span class="number">3338.000</span>    <span class="number">3224</span>   <span class="number">2005</span> <span class="number">1076.0000</span> <span class="number">141700.00</span></span><br><span class="line">Mean <span class="number">66747.57</span> <span class="number">34343.43</span> <span class="number">6229.286</span> <span class="number">2772.286</span>    <span class="number">2625</span>   <span class="number">1484</span>  <span class="number">841.7143</span>  <span class="number">66747.57</span></span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line">In rbind<span class="punctuation">(</span>deparse.level<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="operator">:</span></span><br><span class="line">  number of columns of result<span class="punctuation">,</span> <span class="number">8</span><span class="punctuation">,</span> is not a multiple of vector <span class="built_in">length</span> <span class="number">7</span> of arg <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>也可以通过如下方式计算：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> apply<span class="punctuation">(</span>WorldPhones<span class="punctuation">,</span>MARGIN <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>FUN<span class="operator">=</span><span class="built_in">sum</span><span class="punctuation">)</span></span><br><span class="line">  <span class="number">1951</span>   <span class="number">1956</span>   <span class="number">1957</span>   <span class="number">1958</span>   <span class="number">1959</span>   <span class="number">1960</span>   <span class="number">1961</span> </span><br><span class="line"> <span class="number">74494</span> <span class="number">102199</span> <span class="number">110001</span> <span class="number">118399</span> <span class="number">124801</span> <span class="number">133709</span> <span class="number">141700</span> </span><br><span class="line"><span class="operator">&gt;</span> apply<span class="punctuation">(</span>WorldPhones<span class="punctuation">,</span>MARGIN <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span>FUN<span class="operator">=</span>mean<span class="punctuation">)</span></span><br><span class="line">    N.Amer     Europe       Asia     S.Amer    Oceania     Africa   Mid.Amer </span><br><span class="line"><span class="number">66747.5714</span> <span class="number">34343.4286</span>  <span class="number">6229.2857</span>  <span class="number">2772.2857</span>  <span class="number">2625.0000</span>  <span class="number">1484.0000</span>   <span class="number">841.7143</span> </span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> state.center</span><br><span class="line"><span class="operator">$</span>x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="operator">-</span><span class="number">86.7509</span> <span class="operator">-</span><span class="number">127.2500</span> <span class="operator">-</span><span class="number">111.6250</span>  <span class="operator">-</span><span class="number">92.2992</span> <span class="operator">-</span><span class="number">119.7730</span> <span class="operator">-</span><span class="number">105.5130</span>  <span class="operator">-</span><span class="number">72.3573</span>  <span class="operator">-</span><span class="number">74.9841</span>  <span class="operator">-</span><span class="number">81.6850</span>  <span class="operator">-</span><span class="number">83.3736</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">11</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">126.2500</span> <span class="operator">-</span><span class="number">113.9300</span>  <span class="operator">-</span><span class="number">89.3776</span>  <span class="operator">-</span><span class="number">86.0808</span>  <span class="operator">-</span><span class="number">93.3714</span>  <span class="operator">-</span><span class="number">98.1156</span>  <span class="operator">-</span><span class="number">84.7674</span>  <span class="operator">-</span><span class="number">92.2724</span>  <span class="operator">-</span><span class="number">68.9801</span>  <span class="operator">-</span><span class="number">76.6459</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">21</span><span class="punctuation">]</span>  <span class="operator">-</span><span class="number">71.5800</span>  <span class="operator">-</span><span class="number">84.6870</span>  <span class="operator">-</span><span class="number">94.6043</span>  <span class="operator">-</span><span class="number">89.8065</span>  <span class="operator">-</span><span class="number">92.5137</span> <span class="operator">-</span><span class="number">109.3200</span>  <span class="operator">-</span><span class="number">99.5898</span> <span class="operator">-</span><span class="number">116.8510</span>  <span class="operator">-</span><span class="number">71.3924</span>  <span class="operator">-</span><span class="number">74.2336</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">105.9420</span>  <span class="operator">-</span><span class="number">75.1449</span>  <span class="operator">-</span><span class="number">78.4686</span> <span class="operator">-</span><span class="number">100.0990</span>  <span class="operator">-</span><span class="number">82.5963</span>  <span class="operator">-</span><span class="number">97.1239</span> <span class="operator">-</span><span class="number">120.0680</span>  <span class="operator">-</span><span class="number">77.4500</span>  <span class="operator">-</span><span class="number">71.1244</span>  <span class="operator">-</span><span class="number">80.5056</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">41</span><span class="punctuation">]</span>  <span class="operator">-</span><span class="number">99.7238</span>  <span class="operator">-</span><span class="number">86.4560</span>  <span class="operator">-</span><span class="number">98.7857</span> <span class="operator">-</span><span class="number">111.3300</span>  <span class="operator">-</span><span class="number">72.5450</span>  <span class="operator">-</span><span class="number">78.2005</span> <span class="operator">-</span><span class="number">119.7460</span>  <span class="operator">-</span><span class="number">80.6665</span>  <span class="operator">-</span><span class="number">89.9941</span> <span class="operator">-</span><span class="number">107.2560</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>y</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">32.5901</span> <span class="number">49.2500</span> <span class="number">34.2192</span> <span class="number">34.7336</span> <span class="number">36.5341</span> <span class="number">38.6777</span> <span class="number">41.5928</span> <span class="number">38.6777</span> <span class="number">27.8744</span> <span class="number">32.3329</span> <span class="number">31.7500</span> <span class="number">43.5648</span> <span class="number">40.0495</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">14</span><span class="punctuation">]</span> <span class="number">40.0495</span> <span class="number">41.9358</span> <span class="number">38.4204</span> <span class="number">37.3915</span> <span class="number">30.6181</span> <span class="number">45.6226</span> <span class="number">39.2778</span> <span class="number">42.3645</span> <span class="number">43.1361</span> <span class="number">46.3943</span> <span class="number">32.6758</span> <span class="number">38.3347</span> <span class="number">46.8230</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">27</span><span class="punctuation">]</span> <span class="number">41.3356</span> <span class="number">39.1063</span> <span class="number">43.3934</span> <span class="number">39.9637</span> <span class="number">34.4764</span> <span class="number">43.1361</span> <span class="number">35.4195</span> <span class="number">47.2517</span> <span class="number">40.2210</span> <span class="number">35.5053</span> <span class="number">43.9078</span> <span class="number">40.9069</span> <span class="number">41.5928</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">40</span><span class="punctuation">]</span> <span class="number">33.6190</span> <span class="number">44.3365</span> <span class="number">35.6767</span> <span class="number">31.3897</span> <span class="number">39.1063</span> <span class="number">44.2508</span> <span class="number">37.5630</span> <span class="number">47.4231</span> <span class="number">38.4204</span> <span class="number">44.5937</span> <span class="number">43.0504</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> lapply<span class="punctuation">(</span>state.center<span class="punctuation">,</span>FUN<span class="operator">=</span><span class="built_in">length</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>x</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>y</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">50</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>lapply<span class="punctuation">(</span>state.center<span class="punctuation">,</span>FUN<span class="operator">=</span><span class="built_in">length</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;list&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>sapply<span class="punctuation">(</span>state.center<span class="punctuation">,</span>FUN<span class="operator">=</span><span class="built_in">length</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;integer&quot;</span></span><br></pre></td></tr></table></figure>
<p>下面是通过<code>tapply</code>统计每个区有几个州：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> state.name</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Alabama&quot;</span>        <span class="string">&quot;Alaska&quot;</span>         <span class="string">&quot;Arizona&quot;</span>        <span class="string">&quot;Arkansas&quot;</span>       <span class="string">&quot;California&quot;</span>     <span class="string">&quot;Colorado&quot;</span>      </span><br><span class="line"> <span class="punctuation">[</span><span class="number">7</span><span class="punctuation">]</span> <span class="string">&quot;Connecticut&quot;</span>    <span class="string">&quot;Delaware&quot;</span>       <span class="string">&quot;Florida&quot;</span>        <span class="string">&quot;Georgia&quot;</span>        <span class="string">&quot;Hawaii&quot;</span>         <span class="string">&quot;Idaho&quot;</span>         </span><br><span class="line"><span class="punctuation">[</span><span class="number">13</span><span class="punctuation">]</span> <span class="string">&quot;Illinois&quot;</span>       <span class="string">&quot;Indiana&quot;</span>        <span class="string">&quot;Iowa&quot;</span>           <span class="string">&quot;Kansas&quot;</span>         <span class="string">&quot;Kentucky&quot;</span>       <span class="string">&quot;Louisiana&quot;</span>     </span><br><span class="line"><span class="punctuation">[</span><span class="number">19</span><span class="punctuation">]</span> <span class="string">&quot;Maine&quot;</span>          <span class="string">&quot;Maryland&quot;</span>       <span class="string">&quot;Massachusetts&quot;</span>  <span class="string">&quot;Michigan&quot;</span>       <span class="string">&quot;Minnesota&quot;</span>      <span class="string">&quot;Mississippi&quot;</span>   </span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span> <span class="string">&quot;Missouri&quot;</span>       <span class="string">&quot;Montana&quot;</span>        <span class="string">&quot;Nebraska&quot;</span>       <span class="string">&quot;Nevada&quot;</span>         <span class="string">&quot;New Hampshire&quot;</span>  <span class="string">&quot;New Jersey&quot;</span>    </span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> <span class="string">&quot;New Mexico&quot;</span>     <span class="string">&quot;New York&quot;</span>       <span class="string">&quot;North Carolina&quot;</span> <span class="string">&quot;North Dakota&quot;</span>   <span class="string">&quot;Ohio&quot;</span>           <span class="string">&quot;Oklahoma&quot;</span>      </span><br><span class="line"><span class="punctuation">[</span><span class="number">37</span><span class="punctuation">]</span> <span class="string">&quot;Oregon&quot;</span>         <span class="string">&quot;Pennsylvania&quot;</span>   <span class="string">&quot;Rhode Island&quot;</span>   <span class="string">&quot;South Carolina&quot;</span> <span class="string">&quot;South Dakota&quot;</span>   <span class="string">&quot;Tennessee&quot;</span>     </span><br><span class="line"><span class="punctuation">[</span><span class="number">43</span><span class="punctuation">]</span> <span class="string">&quot;Texas&quot;</span>          <span class="string">&quot;Utah&quot;</span>           <span class="string">&quot;Vermont&quot;</span>        <span class="string">&quot;Virginia&quot;</span>       <span class="string">&quot;Washington&quot;</span>     <span class="string">&quot;West Virginia&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span> <span class="string">&quot;Wisconsin&quot;</span>      <span class="string">&quot;Wyoming&quot;</span>  </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> state.division</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> East South Central Pacific            Mountain           West South Central Pacific           </span><br><span class="line"> <span class="punctuation">[</span><span class="number">6</span><span class="punctuation">]</span> Mountain           New England        South Atlantic     South Atlantic     South Atlantic    </span><br><span class="line"><span class="punctuation">[</span><span class="number">11</span><span class="punctuation">]</span> Pacific            Mountain           East North Central East North Central West North Central</span><br><span class="line"><span class="punctuation">[</span><span class="number">16</span><span class="punctuation">]</span> West North Central East South Central West South Central New England        South Atlantic    </span><br><span class="line"><span class="punctuation">[</span><span class="number">21</span><span class="punctuation">]</span> New England        East North Central West North Central East South Central West North Central</span><br><span class="line"><span class="punctuation">[</span><span class="number">26</span><span class="punctuation">]</span> Mountain           West North Central Mountain           New England        Middle Atlantic   </span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> Mountain           Middle Atlantic    South Atlantic     West North Central East North Central</span><br><span class="line"><span class="punctuation">[</span><span class="number">36</span><span class="punctuation">]</span> West South Central Pacific            Middle Atlantic    New England        South Atlantic    </span><br><span class="line"><span class="punctuation">[</span><span class="number">41</span><span class="punctuation">]</span> West North Central East South Central West South Central Mountain           New England       </span><br><span class="line"><span class="punctuation">[</span><span class="number">46</span><span class="punctuation">]</span> South Atlantic     Pacific            South Atlantic     East North Central Mountain          </span><br><span class="line"><span class="number">9</span> Levels<span class="operator">:</span> New England Middle Atlantic South Atlantic East South Central ... Pacific</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> tapply<span class="punctuation">(</span>state.name<span class="punctuation">,</span>state.division<span class="punctuation">,</span>FUN<span class="operator">=</span><span class="built_in">length</span><span class="punctuation">)</span></span><br><span class="line">       New England    Middle Atlantic     South Atlantic East South Central West South Central </span><br><span class="line">                 <span class="number">6</span>                  <span class="number">3</span>                  <span class="number">8</span>                  <span class="number">4</span>                  <span class="number">4</span> </span><br><span class="line">East North Central West North Central           Mountain            Pacific </span><br><span class="line">                 <span class="number">5</span>                  <span class="number">7</span>                  <span class="number">8</span>                  <span class="number">5</span> </span><br></pre></td></tr></table></figure>
<blockquote>
<p>总结：</p>
<ol>
<li>
<p><code>apply</code>适用于数据框或矩阵。</p>
</li>
<li>
<p><code>lapply</code>和<code>sapply</code>返回值的形式不同，<code>lapply</code>返回的是列表的形式，<code>sapply</code>返回的是向量或矩阵，比列表简单。列表没有行和列之分，不需要边界MARGIN参数。FUN函数可以是自带的函数，也可以是自定义函数。</p>
</li>
<li>
<p><code>tapply</code>是用来处理因子数据，根据因子来分组，然后对每组分别处理。和apply类似，第一个参数为数据集，第二个必须为因子数据类型，通过因子对第一个参数进行分组，第三个参数FUN为要使用的函数。</p>
</li>
</ol>
</blockquote>
<p>还有相关函数的用法：</p>
<p><img src="https://vip2.loli.io/2023/03/13/LVNn98HXzgwG4EB.jpg" alt="微信图片_20220808165937"></p>
<h3 id="4-7-数据的中心化与标准化">4.7 数据的中心化与标准化</h3>
<p>数据中心化：是指数据集中的各项数据减去数据集的均值。</p>
<p>数据标准化：是指在中心化之后再除以数据集的标准差，即数据集中的各项数据减去数据集的均值再除以数据集的标准差。</p>
<p>标准差计算用<code>sd</code>函数，例如某个向量标准化处理后如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> mean<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> sd<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1.870829</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="punctuation">(</span>x<span class="operator">-</span>mean<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">/</span>sd<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">1.0690450</span> <span class="operator">-</span><span class="number">0.5345225</span>  <span class="number">0.0000000</span>  <span class="number">1.6035675</span>  <span class="number">0.0000000</span></span><br></pre></td></tr></table></figure>
<p>可以看出，标准化处理后的值之间相差变小。</p>
<p>R实现中心化和标准化可以使用scale函数：<code>scale(x, center = TRUE, scale = TRUE)</code>。如果center为TRUE，则为中心化处理，如果scale为TRUE，则为标准化处理。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>state.x77<span class="punctuation">)</span></span><br><span class="line">           Population Income Illiteracy Life Exp Murder HS Grad Frost   Area</span><br><span class="line">Alabama          <span class="number">3615</span>   <span class="number">3624</span>        <span class="number">2.1</span>    <span class="number">69.05</span>   <span class="number">15.1</span>    <span class="number">41.3</span>    <span class="number">20</span>  <span class="number">50708</span></span><br><span class="line">Alaska            <span class="number">365</span>   <span class="number">6315</span>        <span class="number">1.5</span>    <span class="number">69.31</span>   <span class="number">11.3</span>    <span class="number">66.7</span>   <span class="number">152</span> <span class="number">566432</span></span><br><span class="line">Arizona          <span class="number">2212</span>   <span class="number">4530</span>        <span class="number">1.8</span>    <span class="number">70.55</span>    <span class="number">7.8</span>    <span class="number">58.1</span>    <span class="number">15</span> <span class="number">113417</span></span><br><span class="line">Arkansas         <span class="number">2110</span>   <span class="number">3378</span>        <span class="number">1.9</span>    <span class="number">70.66</span>   <span class="number">10.1</span>    <span class="number">39.9</span>    <span class="number">65</span>  <span class="number">51945</span></span><br><span class="line">California      <span class="number">21198</span>   <span class="number">5114</span>        <span class="number">1.1</span>    <span class="number">71.71</span>   <span class="number">10.3</span>    <span class="number">62.6</span>    <span class="number">20</span> <span class="number">156361</span></span><br><span class="line">Colorado         <span class="number">2541</span>   <span class="number">4884</span>        <span class="number">0.7</span>    <span class="number">72.06</span>    <span class="number">6.8</span>    <span class="number">63.9</span>   <span class="number">166</span> <span class="number">103766</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> xcenter <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>state.x77<span class="punctuation">,</span>center <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>xcenter<span class="punctuation">)</span></span><br><span class="line">           Population     Income Illiteracy   Life Exp     Murder    HS Grad      Frost       Area</span><br><span class="line">Alabama    <span class="operator">-</span><span class="number">0.1414316</span> <span class="operator">-</span><span class="number">1.3211387</span>   <span class="number">1.525758</span> <span class="operator">-</span><span class="number">1.3621937</span>  <span class="number">2.0918101</span> <span class="operator">-</span><span class="number">1.4619293</span> <span class="operator">-</span><span class="number">1.6248292</span> <span class="operator">-</span><span class="number">0.2347183</span></span><br><span class="line">Alaska     <span class="operator">-</span><span class="number">0.8693980</span>  <span class="number">3.0582456</span>   <span class="number">0.541398</span> <span class="operator">-</span><span class="number">1.1685098</span>  <span class="number">1.0624293</span>  <span class="number">1.6828035</span>  <span class="number">0.9145676</span>  <span class="number">5.8093497</span></span><br><span class="line">Arizona    <span class="operator">-</span><span class="number">0.4556891</span>  <span class="number">0.1533029</span>   <span class="number">1.033578</span> <span class="operator">-</span><span class="number">0.2447866</span>  <span class="number">0.1143154</span>  <span class="number">0.6180514</span> <span class="operator">-</span><span class="number">1.7210185</span>  <span class="number">0.5002047</span></span><br><span class="line">Arkansas   <span class="operator">-</span><span class="number">0.4785360</span> <span class="operator">-</span><span class="number">1.7214837</span>   <span class="number">1.197638</span> <span class="operator">-</span><span class="number">0.1628435</span>  <span class="number">0.7373617</span> <span class="operator">-</span><span class="number">1.6352611</span> <span class="operator">-</span><span class="number">0.7591257</span> <span class="operator">-</span><span class="number">0.2202212</span></span><br><span class="line">California  <span class="number">3.7969790</span>  <span class="number">1.1037155</span>  <span class="operator">-</span><span class="number">0.114842</span>  <span class="number">0.6193415</span>  <span class="number">0.7915396</span>  <span class="number">1.1751891</span> <span class="operator">-</span><span class="number">1.6248292</span>  <span class="number">1.0034903</span></span><br><span class="line">Colorado   <span class="operator">-</span><span class="number">0.3819965</span>  <span class="number">0.7294092</span>  <span class="operator">-</span><span class="number">0.771082</span>  <span class="number">0.8800698</span> <span class="operator">-</span><span class="number">0.1565742</span>  <span class="number">1.3361400</span>  <span class="number">1.1838976</span>  <span class="number">0.3870991</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> xcenter <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>state.x77<span class="punctuation">,</span>center <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>scale <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>xcenter<span class="punctuation">)</span></span><br><span class="line">           Population  Income Illiteracy Life Exp Murder HS Grad  Frost      Area</span><br><span class="line">Alabama       <span class="operator">-</span><span class="number">631.42</span>  <span class="operator">-</span><span class="number">811.8</span>       <span class="number">0.93</span>  <span class="operator">-</span><span class="number">1.8286</span>  <span class="number">7.722</span> <span class="operator">-</span><span class="number">11.808</span> <span class="operator">-</span><span class="number">84.46</span> <span class="operator">-</span><span class="number">20027.88</span></span><br><span class="line">Alaska       <span class="operator">-</span><span class="number">3881.42</span>  <span class="number">1879.2</span>       <span class="number">0.33</span>  <span class="operator">-</span><span class="number">1.5686</span>  <span class="number">3.922</span>  <span class="number">13.592</span>  <span class="number">47.54</span> <span class="number">495696.12</span></span><br><span class="line">Arizona      <span class="operator">-</span><span class="number">2034.42</span>    <span class="number">94.2</span>       <span class="number">0.63</span>  <span class="operator">-</span><span class="number">0.3286</span>  <span class="number">0.422</span>   <span class="number">4.992</span> <span class="operator">-</span><span class="number">89.46</span>  <span class="number">42681.12</span></span><br><span class="line">Arkansas     <span class="operator">-</span><span class="number">2136.42</span> <span class="operator">-</span><span class="number">1057.8</span>       <span class="number">0.73</span>  <span class="operator">-</span><span class="number">0.2186</span>  <span class="number">2.722</span> <span class="operator">-</span><span class="number">13.208</span> <span class="operator">-</span><span class="number">39.46</span> <span class="operator">-</span><span class="number">18790.88</span></span><br><span class="line">California   <span class="number">16951.58</span>   <span class="number">678.2</span>      <span class="operator">-</span><span class="number">0.07</span>   <span class="number">0.8314</span>  <span class="number">2.922</span>   <span class="number">9.492</span> <span class="operator">-</span><span class="number">84.46</span>  <span class="number">85625.12</span></span><br><span class="line">Colorado     <span class="operator">-</span><span class="number">1705.42</span>   <span class="number">448.2</span>      <span class="operator">-</span><span class="number">0.47</span>   <span class="number">1.1814</span> <span class="operator">-</span><span class="number">0.578</span>  <span class="number">10.792</span>  <span class="number">61.54</span>  <span class="number">33030.12</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> xcale <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>state.x77<span class="punctuation">,</span>center <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>scale <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>xcale<span class="punctuation">)</span></span><br><span class="line">           Population     Income Illiteracy   Life Exp     Murder    HS Grad      Frost       Area</span><br><span class="line">Alabama    <span class="operator">-</span><span class="number">0.1414316</span> <span class="operator">-</span><span class="number">1.3211387</span>   <span class="number">1.525758</span> <span class="operator">-</span><span class="number">1.3621937</span>  <span class="number">2.0918101</span> <span class="operator">-</span><span class="number">1.4619293</span> <span class="operator">-</span><span class="number">1.6248292</span> <span class="operator">-</span><span class="number">0.2347183</span></span><br><span class="line">Alaska     <span class="operator">-</span><span class="number">0.8693980</span>  <span class="number">3.0582456</span>   <span class="number">0.541398</span> <span class="operator">-</span><span class="number">1.1685098</span>  <span class="number">1.0624293</span>  <span class="number">1.6828035</span>  <span class="number">0.9145676</span>  <span class="number">5.8093497</span></span><br><span class="line">Arizona    <span class="operator">-</span><span class="number">0.4556891</span>  <span class="number">0.1533029</span>   <span class="number">1.033578</span> <span class="operator">-</span><span class="number">0.2447866</span>  <span class="number">0.1143154</span>  <span class="number">0.6180514</span> <span class="operator">-</span><span class="number">1.7210185</span>  <span class="number">0.5002047</span></span><br><span class="line">Arkansas   <span class="operator">-</span><span class="number">0.4785360</span> <span class="operator">-</span><span class="number">1.7214837</span>   <span class="number">1.197638</span> <span class="operator">-</span><span class="number">0.1628435</span>  <span class="number">0.7373617</span> <span class="operator">-</span><span class="number">1.6352611</span> <span class="operator">-</span><span class="number">0.7591257</span> <span class="operator">-</span><span class="number">0.2202212</span></span><br><span class="line">California  <span class="number">3.7969790</span>  <span class="number">1.1037155</span>  <span class="operator">-</span><span class="number">0.114842</span>  <span class="number">0.6193415</span>  <span class="number">0.7915396</span>  <span class="number">1.1751891</span> <span class="operator">-</span><span class="number">1.6248292</span>  <span class="number">1.0034903</span></span><br><span class="line">Colorado   <span class="operator">-</span><span class="number">0.3819965</span>  <span class="number">0.7294092</span>  <span class="operator">-</span><span class="number">0.771082</span>  <span class="number">0.8800698</span> <span class="operator">-</span><span class="number">0.1565742</span>  <span class="number">1.3361400</span>  <span class="number">1.1838976</span>  <span class="number">0.3870991</span></span><br><span class="line"><span class="operator">&gt;</span> heatmap<span class="punctuation">(</span>xcale<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>总结：可以通过标准化处理后，就能够进行绘制热图。否则，列之间的数据大小相差太多，无法看出实际效果。</p>
<p>中心化处理后：</p>
<p><img src="https://vip2.loli.io/2023/03/13/kVx7F1sNgCMrmU6.png" alt="image-20220808173232695"></p>
<p>未中心化处理和中心化处理后的效果相同，所有的值之间还是相差很多。</p>
<p>标准化处理后：</p>
<p><img src="https://vip2.loli.io/2023/03/13/1Wcl5L36GSNJHBf.png" alt="image-20220808172849327"></p>
<p>标准化处理后，可以看出之间的差异，虽然进行标准化处理，但是并不影响每一列之间的差异。</p>
<h3 id="4-8-merge函数">4.8 merge函数</h3>
<p>定义：Merge two data frames by common columns or row names</p>
<p>merge函数会将相同的部分进行组合：</p>
<p>参数：merge(x, y, by = intersect(names(x), names(y)),<br>
by.x = by, by.y = by, all = FALSE, all.x = all, all.y = all,<br>
sort = TRUE, suffixes = c(“.x”,“.y”), no.dups = TRUE,<br>
incomparables = NULL, …)</p>
<p>x,y：要合并的数据框</p>
<p>by，by.x，by.y：指定依据什么合并数据框，默认为相同colname的列</p>
<p>all，all.x，all.y：指定x和y的行是否应该全部输出</p>
<p>sort by：by后指定的列是否排序</p>
<p>suffixes：指定不用于合并的列中拥有相同列名的后缀</p>
<p>incomparables：指定合并的列中，哪些值不需要进行合并（NULL or NA or 其他）</p>
<p>当两个数据框有相同的观测量（rowname或colname相同），但观测量下的观测值不同时，使用merge函数进行合并。通过“by=观测因子”，得到共有的观测值对应的其他观测量。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>k1 <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span><span class="literal">NA</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span> k2 <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="literal">NA</span><span class="punctuation">,</span><span class="literal">NA</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span>data <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">  k1 k2 data</span><br><span class="line"><span class="number">1</span> <span class="literal">NA</span>  <span class="number">1</span>    <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="literal">NA</span> <span class="literal">NA</span>    <span class="number">2</span></span><br><span class="line"><span class="number">3</span>  <span class="number">3</span> <span class="literal">NA</span>    <span class="number">3</span></span><br><span class="line"><span class="number">4</span>  <span class="number">4</span>  <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">5</span>  <span class="number">5</span>  <span class="number">5</span>    <span class="number">5</span></span><br><span class="line"><span class="operator">&gt;</span> y <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>k1 <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="literal">NA</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span> k2 <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span><span class="literal">NA</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span>data <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> y</span><br><span class="line">  k1 k2 data</span><br><span class="line"><span class="number">1</span> <span class="literal">NA</span> <span class="literal">NA</span>    <span class="number">1</span></span><br><span class="line"><span class="number">2</span>  <span class="number">2</span> <span class="literal">NA</span>    <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="literal">NA</span>  <span class="number">3</span>    <span class="number">3</span></span><br><span class="line"><span class="number">4</span>  <span class="number">4</span>  <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">5</span>  <span class="number">5</span>  <span class="number">5</span>    <span class="number">5</span></span><br><span class="line"><span class="operator">&gt;</span> rbind<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">)</span></span><br><span class="line">   k1 k2 data</span><br><span class="line"><span class="number">1</span>  <span class="literal">NA</span>  <span class="number">1</span>    <span class="number">1</span></span><br><span class="line"><span class="number">2</span>  <span class="literal">NA</span> <span class="literal">NA</span>    <span class="number">2</span></span><br><span class="line"><span class="number">3</span>   <span class="number">3</span> <span class="literal">NA</span>    <span class="number">3</span></span><br><span class="line"><span class="number">4</span>   <span class="number">4</span>  <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">5</span>   <span class="number">5</span>  <span class="number">5</span>    <span class="number">5</span></span><br><span class="line"><span class="number">6</span>  <span class="literal">NA</span> <span class="literal">NA</span>    <span class="number">1</span></span><br><span class="line"><span class="number">7</span>   <span class="number">2</span> <span class="literal">NA</span>    <span class="number">2</span></span><br><span class="line"><span class="number">8</span>  <span class="literal">NA</span>  <span class="number">3</span>    <span class="number">3</span></span><br><span class="line"><span class="number">9</span>   <span class="number">4</span>  <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">10</span>  <span class="number">5</span>  <span class="number">5</span>    <span class="number">5</span></span><br><span class="line"><span class="operator">&gt;</span> merge<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;k1&quot;</span><span class="punctuation">)</span></span><br><span class="line">  k1 k2.x data.x k2.y data.y</span><br><span class="line"><span class="number">1</span>  <span class="number">4</span>    <span class="number">4</span>      <span class="number">4</span>    <span class="number">4</span>      <span class="number">4</span></span><br><span class="line"><span class="number">2</span>  <span class="number">5</span>    <span class="number">5</span>      <span class="number">5</span>    <span class="number">5</span>      <span class="number">5</span></span><br><span class="line"><span class="number">3</span> <span class="literal">NA</span>    <span class="number">1</span>      <span class="number">1</span>   <span class="literal">NA</span>      <span class="number">1</span></span><br><span class="line"><span class="number">4</span> <span class="literal">NA</span>    <span class="number">1</span>      <span class="number">1</span>    <span class="number">3</span>      <span class="number">3</span></span><br><span class="line"><span class="number">5</span> <span class="literal">NA</span>   <span class="literal">NA</span>      <span class="number">2</span>   <span class="literal">NA</span>      <span class="number">1</span></span><br><span class="line"><span class="number">6</span> <span class="literal">NA</span>   <span class="literal">NA</span>      <span class="number">2</span>    <span class="number">3</span>      <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> merge<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;k2&quot;</span><span class="punctuation">)</span></span><br><span class="line">  k2 k1.x data.x k1.y data.y</span><br><span class="line"><span class="number">1</span>  <span class="number">4</span>    <span class="number">4</span>      <span class="number">4</span>    <span class="number">4</span>      <span class="number">4</span></span><br><span class="line"><span class="number">2</span>  <span class="number">5</span>    <span class="number">5</span>      <span class="number">5</span>    <span class="number">5</span>      <span class="number">5</span></span><br><span class="line"><span class="number">3</span> <span class="literal">NA</span>   <span class="literal">NA</span>      <span class="number">2</span>   <span class="literal">NA</span>      <span class="number">1</span></span><br><span class="line"><span class="number">4</span> <span class="literal">NA</span>   <span class="literal">NA</span>      <span class="number">2</span>    <span class="number">2</span>      <span class="number">2</span></span><br><span class="line"><span class="number">5</span> <span class="literal">NA</span>    <span class="number">3</span>      <span class="number">3</span>   <span class="literal">NA</span>      <span class="number">1</span></span><br><span class="line"><span class="number">6</span> <span class="literal">NA</span>    <span class="number">3</span>      <span class="number">3</span>    <span class="number">2</span>      <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> merge<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;k2&quot;</span><span class="punctuation">,</span>incomparables <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">  k2 k1.x data.x k1.y data.y</span><br><span class="line"><span class="number">1</span>  <span class="number">4</span>    <span class="number">4</span>      <span class="number">4</span>    <span class="number">4</span>      <span class="number">4</span></span><br><span class="line"><span class="number">2</span>  <span class="number">5</span>    <span class="number">5</span>      <span class="number">5</span>    <span class="number">5</span>      <span class="number">5</span></span><br><span class="line"><span class="number">3</span> <span class="literal">NA</span>   <span class="literal">NA</span>      <span class="number">2</span>   <span class="literal">NA</span>      <span class="number">1</span></span><br><span class="line"><span class="number">4</span> <span class="literal">NA</span>   <span class="literal">NA</span>      <span class="number">2</span>    <span class="number">2</span>      <span class="number">2</span></span><br><span class="line"><span class="number">5</span> <span class="literal">NA</span>    <span class="number">3</span>      <span class="number">3</span>   <span class="literal">NA</span>      <span class="number">1</span></span><br><span class="line"><span class="number">6</span> <span class="literal">NA</span>    <span class="number">3</span>      <span class="number">3</span>    <span class="number">2</span>      <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> merge<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">,</span>by<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;k1&quot;</span><span class="punctuation">,</span><span class="string">&quot;k2&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  k1 k2 data.x data.y</span><br><span class="line"><span class="number">1</span>  <span class="number">4</span>  <span class="number">4</span>      <span class="number">4</span>      <span class="number">4</span></span><br><span class="line"><span class="number">2</span>  <span class="number">5</span>  <span class="number">5</span>      <span class="number">5</span>      <span class="number">5</span></span><br><span class="line"><span class="number">3</span> <span class="literal">NA</span> <span class="literal">NA</span>      <span class="number">2</span>      <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>总结：merge会组合合并，<code>merge(x,y,by=&quot;k2&quot;,incomparables = T)</code>表示根据<code>k2</code>进行合并，<code>incomparables</code>表示丢掉NA的情况。<code>merge(x,y,by=c(&quot;k1&quot;,&quot;k2&quot;))</code>表示同时合并<code>k1</code>，<code>k2</code>。</p>
<p>不推荐使用merge函数。</p>
<h3 id="4-9-reshape2包">4.9 reshape2包</h3>
<p><code>reshape2</code>包功能更强大，学习难度大。</p>
<p>需要安装<code>reshape2</code>包。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> install.packages<span class="punctuation">(</span><span class="string">&quot;reshape2&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>重塑数据，首先把宽数据融合（melt），以使每一行都只表示一个变量，然后把数据重塑（cast）为想要的任何形状。在重塑过程中，可以使用任何函数对数据进行整合，也可以把长格式转换为宽格式，这种操作类似于Excel的透视和逆透视。</p>
<p>在同一行，标识变量（一列或多列）能够唯一标识两个或多个变量的值，这种数据显示叫做数据的<strong>宽格式，也叫做宽数据</strong>。</p>
<h4 id="4-9-1-melt函数">4.9.1 melt函数</h4>
<p>使用方法：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">melt<span class="punctuation">(</span>data<span class="punctuation">,</span>id.vars<span class="punctuation">,</span>measure.vars<span class="punctuation">,</span>variable.name<span class="operator">=</span><span class="string">&#x27;variable&#x27;</span><span class="punctuation">,</span>...<span class="punctuation">,</span>na.rm<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span>value.name<span class="operator">=</span><span class="string">&#x27;value&#x27;</span><span class="punctuation">,</span>factorAsStrings<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>参数注释：</p>
<ul>
<li>
<p>data：融合的数据框</p>
</li>
<li>
<p>id.vars：由标识变量构成的向量，用于标识观测的变量</p>
</li>
<li>
<p>measure.vars ：由观测变量构成的向量</p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="http://variable.name">variable.name</a>：用于保存原始变量名的变量的名称</p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="http://value.name">value.name</a>：用于保存原始值的名称</p>
</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> newdata <span class="operator">&lt;-</span> airquality<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> newdata</span><br><span class="line">   ozone solar.r wind temp month day</span><br><span class="line"><span class="number">1</span>     <span class="number">41</span>     <span class="number">190</span>  <span class="number">7.4</span>   <span class="number">67</span>     <span class="number">5</span>   <span class="number">1</span></span><br><span class="line"><span class="number">2</span>     <span class="number">36</span>     <span class="number">118</span>  <span class="number">8.0</span>   <span class="number">72</span>     <span class="number">5</span>   <span class="number">2</span></span><br><span class="line"><span class="number">3</span>     <span class="number">12</span>     <span class="number">149</span> <span class="number">12.6</span>   <span class="number">74</span>     <span class="number">5</span>   <span class="number">3</span></span><br><span class="line"><span class="number">4</span>     <span class="number">18</span>     <span class="number">313</span> <span class="number">11.5</span>   <span class="number">62</span>     <span class="number">5</span>   <span class="number">4</span></span><br><span class="line"><span class="number">5</span>     <span class="literal">NA</span>      <span class="literal">NA</span> <span class="number">14.3</span>   <span class="number">56</span>     <span class="number">5</span>   <span class="number">5</span></span><br><span class="line"><span class="number">6</span>     <span class="number">28</span>      <span class="literal">NA</span> <span class="number">14.9</span>   <span class="number">66</span>     <span class="number">5</span>   <span class="number">6</span></span><br><span class="line"><span class="number">7</span>     <span class="number">23</span>     <span class="number">299</span>  <span class="number">8.6</span>   <span class="number">65</span>     <span class="number">5</span>   <span class="number">7</span></span><br><span class="line"><span class="number">8</span>     <span class="number">19</span>      <span class="number">99</span> <span class="number">13.8</span>   <span class="number">59</span>     <span class="number">5</span>   <span class="number">8</span></span><br><span class="line"><span class="number">9</span>      <span class="number">8</span>      <span class="number">19</span> <span class="number">20.1</span>   <span class="number">61</span>     <span class="number">5</span>   <span class="number">9</span></span><br><span class="line"><span class="number">10</span>    <span class="literal">NA</span>     <span class="number">194</span>  <span class="number">8.6</span>   <span class="number">69</span>     <span class="number">5</span>  <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> melt<span class="punctuation">(</span>newdata<span class="punctuation">)</span></span><br><span class="line">No id variables; using <span class="built_in">all</span> as measure variables</span><br><span class="line">   variable value</span><br><span class="line"><span class="number">1</span>     ozone  <span class="number">41.0</span></span><br><span class="line"><span class="number">2</span>     ozone  <span class="number">36.0</span></span><br><span class="line"><span class="number">3</span>     ozone  <span class="number">12.0</span></span><br><span class="line"><span class="number">4</span>     ozone  <span class="number">18.0</span></span><br><span class="line"><span class="number">5</span>     ozone    <span class="literal">NA</span></span><br><span class="line"><span class="number">6</span>     ozone  <span class="number">28.0</span></span><br><span class="line"><span class="number">7</span>     ozone  <span class="number">23.0</span></span><br><span class="line"><span class="number">8</span>     ozone  <span class="number">19.0</span></span><br><span class="line"><span class="number">9</span>     ozone   <span class="number">8.0</span></span><br><span class="line"><span class="number">10</span>    ozone    <span class="literal">NA</span></span><br><span class="line"><span class="number">11</span>  solar.r <span class="number">190.0</span></span><br><span class="line"><span class="number">12</span>  solar.r <span class="number">118.0</span></span><br><span class="line"><span class="number">13</span>  solar.r <span class="number">149.0</span></span><br><span class="line"><span class="number">14</span>  solar.r <span class="number">313.0</span></span><br><span class="line"><span class="number">15</span>  solar.r    <span class="literal">NA</span></span><br><span class="line"><span class="number">16</span>  solar.r    <span class="literal">NA</span></span><br><span class="line"><span class="number">17</span>  solar.r <span class="number">299.0</span></span><br><span class="line"><span class="number">18</span>  solar.r  <span class="number">99.0</span></span><br><span class="line"><span class="number">19</span>  solar.r  <span class="number">19.0</span></span><br><span class="line"><span class="number">20</span>  solar.r <span class="number">194.0</span></span><br><span class="line"><span class="number">21</span>     wind   <span class="number">7.4</span></span><br><span class="line"><span class="number">22</span>     wind   <span class="number">8.0</span></span><br><span class="line"><span class="number">23</span>     wind  <span class="number">12.6</span></span><br><span class="line"><span class="number">24</span>     wind  <span class="number">11.5</span></span><br><span class="line"><span class="number">25</span>     wind  <span class="number">14.3</span></span><br><span class="line"><span class="number">26</span>     wind  <span class="number">14.9</span></span><br><span class="line"><span class="number">27</span>     wind   <span class="number">8.6</span></span><br><span class="line"><span class="number">28</span>     wind  <span class="number">13.8</span></span><br><span class="line"><span class="number">29</span>     wind  <span class="number">20.1</span></span><br><span class="line"><span class="number">30</span>     wind   <span class="number">8.6</span></span><br><span class="line"><span class="number">31</span>     temp  <span class="number">67.0</span></span><br><span class="line"><span class="number">32</span>     temp  <span class="number">72.0</span></span><br><span class="line"><span class="number">33</span>     temp  <span class="number">74.0</span></span><br><span class="line"><span class="number">34</span>     temp  <span class="number">62.0</span></span><br><span class="line"><span class="number">35</span>     temp  <span class="number">56.0</span></span><br><span class="line"><span class="number">36</span>     temp  <span class="number">66.0</span></span><br><span class="line"><span class="number">37</span>     temp  <span class="number">65.0</span></span><br><span class="line"><span class="number">38</span>     temp  <span class="number">59.0</span></span><br><span class="line"><span class="number">39</span>     temp  <span class="number">61.0</span></span><br><span class="line"><span class="number">40</span>     temp  <span class="number">69.0</span></span><br><span class="line"><span class="number">41</span>    month   <span class="number">5.0</span></span><br><span class="line"><span class="number">42</span>    month   <span class="number">5.0</span></span><br><span class="line"><span class="number">43</span>    month   <span class="number">5.0</span></span><br><span class="line"><span class="number">44</span>    month   <span class="number">5.0</span></span><br><span class="line"><span class="number">45</span>    month   <span class="number">5.0</span></span><br><span class="line"><span class="number">46</span>    month   <span class="number">5.0</span></span><br><span class="line"><span class="number">47</span>    month   <span class="number">5.0</span></span><br><span class="line"><span class="number">48</span>    month   <span class="number">5.0</span></span><br><span class="line"><span class="number">49</span>    month   <span class="number">5.0</span></span><br><span class="line"><span class="number">50</span>    month   <span class="number">5.0</span></span><br><span class="line"><span class="number">51</span>      day   <span class="number">1.0</span></span><br><span class="line"><span class="number">52</span>      day   <span class="number">2.0</span></span><br><span class="line"><span class="number">53</span>      day   <span class="number">3.0</span></span><br><span class="line"><span class="number">54</span>      day   <span class="number">4.0</span></span><br><span class="line"><span class="number">55</span>      day   <span class="number">5.0</span></span><br><span class="line"><span class="number">56</span>      day   <span class="number">6.0</span></span><br><span class="line"><span class="number">57</span>      day   <span class="number">7.0</span></span><br><span class="line"><span class="number">58</span>      day   <span class="number">8.0</span></span><br><span class="line"><span class="number">59</span>      day   <span class="number">9.0</span></span><br><span class="line"><span class="number">60</span>      day  <span class="number">10.0</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>melt</code>函数将所有的向量在一列表示。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> melt<span class="punctuation">(</span>newdata<span class="punctuation">,</span>id.vars <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;month&quot;</span><span class="punctuation">,</span><span class="string">&quot;day&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">   month day variable value</span><br><span class="line"><span class="number">1</span>      <span class="number">5</span>   <span class="number">1</span>    ozone  <span class="number">41.0</span></span><br><span class="line"><span class="number">2</span>      <span class="number">5</span>   <span class="number">2</span>    ozone  <span class="number">36.0</span></span><br><span class="line"><span class="number">3</span>      <span class="number">5</span>   <span class="number">3</span>    ozone  <span class="number">12.0</span></span><br><span class="line"><span class="number">4</span>      <span class="number">5</span>   <span class="number">4</span>    ozone  <span class="number">18.0</span></span><br><span class="line"><span class="number">5</span>      <span class="number">5</span>   <span class="number">5</span>    ozone    <span class="literal">NA</span></span><br><span class="line"><span class="number">6</span>      <span class="number">5</span>   <span class="number">6</span>    ozone  <span class="number">28.0</span></span><br><span class="line"><span class="number">7</span>      <span class="number">5</span>   <span class="number">7</span>    ozone  <span class="number">23.0</span></span><br><span class="line"><span class="number">8</span>      <span class="number">5</span>   <span class="number">8</span>    ozone  <span class="number">19.0</span></span><br><span class="line"><span class="number">9</span>      <span class="number">5</span>   <span class="number">9</span>    ozone   <span class="number">8.0</span></span><br><span class="line"><span class="number">10</span>     <span class="number">5</span>  <span class="number">10</span>    ozone    <span class="literal">NA</span></span><br><span class="line"><span class="number">11</span>     <span class="number">5</span>   <span class="number">1</span>  solar.r <span class="number">190.0</span></span><br><span class="line"><span class="number">12</span>     <span class="number">5</span>   <span class="number">2</span>  solar.r <span class="number">118.0</span></span><br><span class="line"><span class="number">13</span>     <span class="number">5</span>   <span class="number">3</span>  solar.r <span class="number">149.0</span></span><br><span class="line"><span class="number">14</span>     <span class="number">5</span>   <span class="number">4</span>  solar.r <span class="number">313.0</span></span><br><span class="line"><span class="number">15</span>     <span class="number">5</span>   <span class="number">5</span>  solar.r    <span class="literal">NA</span></span><br><span class="line"><span class="number">16</span>     <span class="number">5</span>   <span class="number">6</span>  solar.r    <span class="literal">NA</span></span><br><span class="line"><span class="number">17</span>     <span class="number">5</span>   <span class="number">7</span>  solar.r <span class="number">299.0</span></span><br><span class="line"><span class="number">18</span>     <span class="number">5</span>   <span class="number">8</span>  solar.r  <span class="number">99.0</span></span><br><span class="line"><span class="number">19</span>     <span class="number">5</span>   <span class="number">9</span>  solar.r  <span class="number">19.0</span></span><br><span class="line"><span class="number">20</span>     <span class="number">5</span>  <span class="number">10</span>  solar.r <span class="number">194.0</span></span><br><span class="line"><span class="number">21</span>     <span class="number">5</span>   <span class="number">1</span>     wind   <span class="number">7.4</span></span><br><span class="line"><span class="number">22</span>     <span class="number">5</span>   <span class="number">2</span>     wind   <span class="number">8.0</span></span><br><span class="line"><span class="number">23</span>     <span class="number">5</span>   <span class="number">3</span>     wind  <span class="number">12.6</span></span><br><span class="line"><span class="number">24</span>     <span class="number">5</span>   <span class="number">4</span>     wind  <span class="number">11.5</span></span><br><span class="line"><span class="number">25</span>     <span class="number">5</span>   <span class="number">5</span>     wind  <span class="number">14.3</span></span><br><span class="line"><span class="number">26</span>     <span class="number">5</span>   <span class="number">6</span>     wind  <span class="number">14.9</span></span><br><span class="line"><span class="number">27</span>     <span class="number">5</span>   <span class="number">7</span>     wind   <span class="number">8.6</span></span><br><span class="line"><span class="number">28</span>     <span class="number">5</span>   <span class="number">8</span>     wind  <span class="number">13.8</span></span><br><span class="line"><span class="number">29</span>     <span class="number">5</span>   <span class="number">9</span>     wind  <span class="number">20.1</span></span><br><span class="line"><span class="number">30</span>     <span class="number">5</span>  <span class="number">10</span>     wind   <span class="number">8.6</span></span><br><span class="line"><span class="number">31</span>     <span class="number">5</span>   <span class="number">1</span>     temp  <span class="number">67.0</span></span><br><span class="line"><span class="number">32</span>     <span class="number">5</span>   <span class="number">2</span>     temp  <span class="number">72.0</span></span><br><span class="line"><span class="number">33</span>     <span class="number">5</span>   <span class="number">3</span>     temp  <span class="number">74.0</span></span><br><span class="line"><span class="number">34</span>     <span class="number">5</span>   <span class="number">4</span>     temp  <span class="number">62.0</span></span><br><span class="line"><span class="number">35</span>     <span class="number">5</span>   <span class="number">5</span>     temp  <span class="number">56.0</span></span><br><span class="line"><span class="number">36</span>     <span class="number">5</span>   <span class="number">6</span>     temp  <span class="number">66.0</span></span><br><span class="line"><span class="number">37</span>     <span class="number">5</span>   <span class="number">7</span>     temp  <span class="number">65.0</span></span><br><span class="line"><span class="number">38</span>     <span class="number">5</span>   <span class="number">8</span>     temp  <span class="number">59.0</span></span><br><span class="line"><span class="number">39</span>     <span class="number">5</span>   <span class="number">9</span>     temp  <span class="number">61.0</span></span><br><span class="line"><span class="number">40</span>     <span class="number">5</span>  <span class="number">10</span>     temp  <span class="number">69.0</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>melt</code>中参数<code>id.vars</code>表示不合并哪些列。</p>
<p>此外还有dcast、acast函数</p>
<p>reshape2包比较复杂，tidyr包和dplyr包两者组合可以替换reshape2包，相对来说更简单。</p>
<h3 id="4-10-tidyr包">4.10 tidyr包</h3>
<p>需要安装<code>tidyr</code>包</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> install.packages<span class="punctuation">(</span><span class="string">&quot;tidyr&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>tidyr<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>Tidy data数据指的是可以根据一个行名和一个列名可以确定一个值。</p>
<p>gather函数类似于melt函数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> tdata <span class="operator">&lt;-</span> mtcars<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> tdata</span><br><span class="line">                   mpg cyl  disp</span><br><span class="line">Mazda RX4         <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span></span><br><span class="line">Mazda RX4 Wag     <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span></span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span></span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span></span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span></span><br><span class="line">Duster <span class="number">360</span>        <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span></span><br><span class="line">Merc <span class="number">240</span>D         <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span></span><br><span class="line">Merc <span class="number">230</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">140.8</span></span><br><span class="line">Merc <span class="number">280</span>          <span class="number">19.2</span>   <span class="number">6</span> <span class="number">167.6</span></span><br><span class="line"><span class="operator">&gt;</span> tdata <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span><span class="built_in">names</span><span class="operator">=</span>rownames<span class="punctuation">(</span>tdata<span class="punctuation">)</span><span class="punctuation">,</span>tdata<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> tdata</span><br><span class="line">                              <span class="built_in">names</span>  mpg cyl  disp</span><br><span class="line">Mazda RX4                 Mazda RX4 <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span></span><br><span class="line">Mazda RX4 Wag         Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span></span><br><span class="line">Datsun <span class="number">710</span>               Datsun <span class="number">710</span> <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span></span><br><span class="line">Hornet <span class="number">4</span> Drive       Hornet <span class="number">4</span> Drive <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span></span><br><span class="line">Hornet Sportabout Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span></span><br><span class="line">Valiant                     Valiant <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span></span><br><span class="line">Duster <span class="number">360</span>               Duster <span class="number">360</span> <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span></span><br><span class="line">Merc <span class="number">240</span>D                 Merc <span class="number">240</span>D <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span></span><br><span class="line">Merc <span class="number">230</span>                   Merc <span class="number">230</span> <span class="number">22.8</span>   <span class="number">4</span> <span class="number">140.8</span></span><br><span class="line">Merc <span class="number">280</span>                   Merc <span class="number">280</span> <span class="number">19.2</span>   <span class="number">6</span> <span class="number">167.6</span></span><br><span class="line"><span class="operator">&gt;</span> gather<span class="punctuation">(</span>tdata<span class="punctuation">,</span>key <span class="operator">=</span> <span class="string">&quot;Key&quot;</span><span class="punctuation">,</span>value <span class="operator">=</span> <span class="string">&quot;Value&quot;</span><span class="punctuation">,</span>cyl<span class="punctuation">,</span>disp<span class="punctuation">,</span><span class="operator">-</span>mpg<span class="punctuation">)</span></span><br><span class="line">               <span class="built_in">names</span>  mpg  Key Value</span><br><span class="line"><span class="number">1</span>          Mazda RX4 <span class="number">21.0</span>  cyl   <span class="number">6.0</span></span><br><span class="line"><span class="number">2</span>      Mazda RX4 Wag <span class="number">21.0</span>  cyl   <span class="number">6.0</span></span><br><span class="line"><span class="number">3</span>         Datsun <span class="number">710</span> <span class="number">22.8</span>  cyl   <span class="number">4.0</span></span><br><span class="line"><span class="number">4</span>     Hornet <span class="number">4</span> Drive <span class="number">21.4</span>  cyl   <span class="number">6.0</span></span><br><span class="line"><span class="number">5</span>  Hornet Sportabout <span class="number">18.7</span>  cyl   <span class="number">8.0</span></span><br><span class="line"><span class="number">6</span>            Valiant <span class="number">18.1</span>  cyl   <span class="number">6.0</span></span><br><span class="line"><span class="number">7</span>         Duster <span class="number">360</span> <span class="number">14.3</span>  cyl   <span class="number">8.0</span></span><br><span class="line"><span class="number">8</span>          Merc <span class="number">240</span>D <span class="number">24.4</span>  cyl   <span class="number">4.0</span></span><br><span class="line"><span class="number">9</span>           Merc <span class="number">230</span> <span class="number">22.8</span>  cyl   <span class="number">4.0</span></span><br><span class="line"><span class="number">10</span>          Merc <span class="number">280</span> <span class="number">19.2</span>  cyl   <span class="number">6.0</span></span><br><span class="line"><span class="number">11</span>         Mazda RX4 <span class="number">21.0</span> disp <span class="number">160.0</span></span><br><span class="line"><span class="number">12</span>     Mazda RX4 Wag <span class="number">21.0</span> disp <span class="number">160.0</span></span><br><span class="line"><span class="number">13</span>        Datsun <span class="number">710</span> <span class="number">22.8</span> disp <span class="number">108.0</span></span><br><span class="line"><span class="number">14</span>    Hornet <span class="number">4</span> Drive <span class="number">21.4</span> disp <span class="number">258.0</span></span><br><span class="line"><span class="number">15</span> Hornet Sportabout <span class="number">18.7</span> disp <span class="number">360.0</span></span><br><span class="line"><span class="number">16</span>           Valiant <span class="number">18.1</span> disp <span class="number">225.0</span></span><br><span class="line"><span class="number">17</span>        Duster <span class="number">360</span> <span class="number">14.3</span> disp <span class="number">360.0</span></span><br><span class="line"><span class="number">18</span>         Merc <span class="number">240</span>D <span class="number">24.4</span> disp <span class="number">146.7</span></span><br><span class="line"><span class="number">19</span>          Merc <span class="number">230</span> <span class="number">22.8</span> disp <span class="number">140.8</span></span><br><span class="line"><span class="number">20</span>          Merc <span class="number">280</span> <span class="number">19.2</span> disp <span class="number">167.6</span></span><br></pre></td></tr></table></figure>
<p>总结：<code>mpg</code>前面的符号<code>-</code>表示不需要转换的列，如果列的名字容易出错，可以直接写列的编号，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> gather<span class="punctuation">(</span>tdata<span class="punctuation">,</span>key <span class="operator">=</span> <span class="string">&quot;Key&quot;</span><span class="punctuation">,</span>value <span class="operator">=</span> <span class="string">&quot;Value&quot;</span><span class="punctuation">,</span><span class="number">3</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> gather<span class="punctuation">(</span>tdata<span class="punctuation">,</span>key <span class="operator">=</span> <span class="string">&quot;Key&quot;</span><span class="punctuation">,</span>value <span class="operator">=</span> <span class="string">&quot;Value&quot;</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><code>spread</code>函数和<code>gather</code>函数作用正好相反。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> gdata <span class="operator">&lt;-</span> gather<span class="punctuation">(</span>tdata<span class="punctuation">,</span>key <span class="operator">=</span> <span class="string">&quot;Key&quot;</span><span class="punctuation">,</span>value <span class="operator">=</span> <span class="string">&quot;Value&quot;</span><span class="punctuation">,</span><span class="number">2</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> gdata</span><br><span class="line">               <span class="built_in">names</span>  Key Value</span><br><span class="line"><span class="number">1</span>          Mazda RX4  mpg  <span class="number">21.0</span></span><br><span class="line"><span class="number">2</span>      Mazda RX4 Wag  mpg  <span class="number">21.0</span></span><br><span class="line"><span class="number">3</span>         Datsun <span class="number">710</span>  mpg  <span class="number">22.8</span></span><br><span class="line"><span class="number">4</span>     Hornet <span class="number">4</span> Drive  mpg  <span class="number">21.4</span></span><br><span class="line"><span class="number">5</span>  Hornet Sportabout  mpg  <span class="number">18.7</span></span><br><span class="line"><span class="number">6</span>            Valiant  mpg  <span class="number">18.1</span></span><br><span class="line"><span class="number">7</span>         Duster <span class="number">360</span>  mpg  <span class="number">14.3</span></span><br><span class="line"><span class="number">8</span>          Merc <span class="number">240</span>D  mpg  <span class="number">24.4</span></span><br><span class="line"><span class="number">9</span>           Merc <span class="number">230</span>  mpg  <span class="number">22.8</span></span><br><span class="line"><span class="number">10</span>          Merc <span class="number">280</span>  mpg  <span class="number">19.2</span></span><br><span class="line"><span class="number">11</span>         Mazda RX4  cyl   <span class="number">6.0</span></span><br><span class="line"><span class="number">12</span>     Mazda RX4 Wag  cyl   <span class="number">6.0</span></span><br><span class="line"><span class="number">13</span>        Datsun <span class="number">710</span>  cyl   <span class="number">4.0</span></span><br><span class="line"><span class="number">14</span>    Hornet <span class="number">4</span> Drive  cyl   <span class="number">6.0</span></span><br><span class="line"><span class="number">15</span> Hornet Sportabout  cyl   <span class="number">8.0</span></span><br><span class="line"><span class="number">16</span>           Valiant  cyl   <span class="number">6.0</span></span><br><span class="line"><span class="number">17</span>        Duster <span class="number">360</span>  cyl   <span class="number">8.0</span></span><br><span class="line"><span class="number">18</span>         Merc <span class="number">240</span>D  cyl   <span class="number">4.0</span></span><br><span class="line"><span class="number">19</span>          Merc <span class="number">230</span>  cyl   <span class="number">4.0</span></span><br><span class="line"><span class="number">20</span>          Merc <span class="number">280</span>  cyl   <span class="number">6.0</span></span><br><span class="line"><span class="number">21</span>         Mazda RX4 disp <span class="number">160.0</span></span><br><span class="line"><span class="number">22</span>     Mazda RX4 Wag disp <span class="number">160.0</span></span><br><span class="line"><span class="number">23</span>        Datsun <span class="number">710</span> disp <span class="number">108.0</span></span><br><span class="line"><span class="number">24</span>    Hornet <span class="number">4</span> Drive disp <span class="number">258.0</span></span><br><span class="line"><span class="number">25</span> Hornet Sportabout disp <span class="number">360.0</span></span><br><span class="line"><span class="number">26</span>           Valiant disp <span class="number">225.0</span></span><br><span class="line"><span class="number">27</span>        Duster <span class="number">360</span> disp <span class="number">360.0</span></span><br><span class="line"><span class="number">28</span>         Merc <span class="number">240</span>D disp <span class="number">146.7</span></span><br><span class="line"><span class="number">29</span>          Merc <span class="number">230</span> disp <span class="number">140.8</span></span><br><span class="line"><span class="number">30</span>          Merc <span class="number">280</span> disp <span class="number">167.6</span></span><br><span class="line"><span class="operator">&gt;</span> spread<span class="punctuation">(</span>gdata<span class="punctuation">,</span>key <span class="operator">=</span> <span class="string">&quot;Key&quot;</span><span class="punctuation">,</span>value <span class="operator">=</span> <span class="string">&quot;Value&quot;</span><span class="punctuation">)</span></span><br><span class="line">               <span class="built_in">names</span> cyl  disp  mpg</span><br><span class="line"><span class="number">1</span>         Datsun <span class="number">710</span>   <span class="number">4</span> <span class="number">108.0</span> <span class="number">22.8</span></span><br><span class="line"><span class="number">2</span>         Duster <span class="number">360</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">14.3</span></span><br><span class="line"><span class="number">3</span>     Hornet <span class="number">4</span> Drive   <span class="number">6</span> <span class="number">258.0</span> <span class="number">21.4</span></span><br><span class="line"><span class="number">4</span>  Hornet Sportabout   <span class="number">8</span> <span class="number">360.0</span> <span class="number">18.7</span></span><br><span class="line"><span class="number">5</span>          Mazda RX4   <span class="number">6</span> <span class="number">160.0</span> <span class="number">21.0</span></span><br><span class="line"><span class="number">6</span>      Mazda RX4 Wag   <span class="number">6</span> <span class="number">160.0</span> <span class="number">21.0</span></span><br><span class="line"><span class="number">7</span>           Merc <span class="number">230</span>   <span class="number">4</span> <span class="number">140.8</span> <span class="number">22.8</span></span><br><span class="line"><span class="number">8</span>          Merc <span class="number">240</span>D   <span class="number">4</span> <span class="number">146.7</span> <span class="number">24.4</span></span><br><span class="line"><span class="number">9</span>           Merc <span class="number">280</span>   <span class="number">6</span> <span class="number">167.6</span> <span class="number">19.2</span></span><br><span class="line"><span class="number">10</span>           Valiant   <span class="number">6</span> <span class="number">225.0</span> <span class="number">18.1</span></span><br></pre></td></tr></table></figure>
<p>separate函数和unite函数对应，separate函数根据列进行分割，可以将一列拆分成多列，而unite函数则是合并列，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> df <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>x<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span><span class="string">&quot;a.b&quot;</span><span class="punctuation">,</span><span class="string">&quot;a.d&quot;</span><span class="punctuation">,</span><span class="string">&quot;b.c&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> df</span><br><span class="line">     x</span><br><span class="line"><span class="number">1</span> <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span></span><br><span class="line"><span class="number">2</span>  a.b</span><br><span class="line"><span class="number">3</span>  a.d</span><br><span class="line"><span class="number">4</span>  b.c</span><br><span class="line"><span class="operator">&gt;</span> separate<span class="punctuation">(</span>df<span class="punctuation">,</span>col<span class="operator">=</span>x<span class="punctuation">,</span>into <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span><span class="string">&quot;B&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">     A    B</span><br><span class="line"><span class="number">1</span> <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span> <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span></span><br><span class="line"><span class="number">2</span>    a    b</span><br><span class="line"><span class="number">3</span>    a    d</span><br><span class="line"><span class="number">4</span>    b    <span class="built_in">c</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> ddf <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>x<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span><span class="string">&quot;a.b-c&quot;</span><span class="punctuation">,</span><span class="string">&quot;a-d&quot;</span><span class="punctuation">,</span><span class="string">&quot;b-c&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> ddf</span><br><span class="line">      x</span><br><span class="line"><span class="number">1</span>  <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span></span><br><span class="line"><span class="number">2</span> a.b<span class="operator">-</span><span class="built_in">c</span></span><br><span class="line"><span class="number">3</span>   a<span class="operator">-</span>d</span><br><span class="line"><span class="number">4</span>   b<span class="operator">-</span><span class="built_in">c</span></span><br><span class="line"><span class="operator">&gt;</span> separate<span class="punctuation">(</span>ddf<span class="punctuation">,</span>col<span class="operator">=</span>x<span class="punctuation">,</span>into <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span><span class="string">&quot;B&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">     A    B</span><br><span class="line"><span class="number">1</span> <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span> <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span></span><br><span class="line"><span class="number">2</span>    a    b</span><br><span class="line"><span class="number">3</span>    a    d</span><br><span class="line"><span class="number">4</span>    b    <span class="built_in">c</span></span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line">Expected <span class="number">2</span> pieces. Additional pieces discarded <span class="keyword">in</span> <span class="number">1</span> rows <span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span>. </span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> separate<span class="punctuation">(</span>ddf<span class="punctuation">,</span>col<span class="operator">=</span>x<span class="punctuation">,</span>into <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span><span class="string">&quot;B&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;-&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">     A    B</span><br><span class="line"><span class="number">1</span> <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span> <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span></span><br><span class="line"><span class="number">2</span>  a.b    <span class="built_in">c</span></span><br><span class="line"><span class="number">3</span>    a    d</span><br><span class="line"><span class="number">4</span>    b    <span class="built_in">c</span></span><br><span class="line"><span class="operator">&gt;</span> unite<span class="punctuation">(</span>x<span class="punctuation">,</span>col <span class="operator">=</span> <span class="string">&quot;AB&quot;</span><span class="punctuation">,</span>A<span class="punctuation">,</span>B<span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;-&quot;</span><span class="punctuation">)</span></span><br><span class="line">     AB</span><br><span class="line"><span class="number">1</span> <span class="literal">NA</span><span class="operator">-</span><span class="literal">NA</span></span><br><span class="line"><span class="number">2</span> a.b<span class="operator">-</span><span class="built_in">c</span></span><br><span class="line"><span class="number">3</span>   a<span class="operator">-</span>d</span><br><span class="line"><span class="number">4</span>   b<span class="operator">-</span><span class="built_in">c</span></span><br></pre></td></tr></table></figure>
<h3 id="4-11-dplyr包">4.11 dplyr包</h3>
<p>需要安装<code>dplyr</code>包</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> install.packages<span class="punctuation">(</span><span class="string">&quot;dplyr&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><code>dplyr</code>包功能强大，很多数据转换都可以用<code>dplyr</code>轻松完成，不仅可以对单个表格进行操作，也可以对双表格进行操作。可以通过<code>ls</code>函数查看<code>dplyr</code>包中的函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> ls<span class="punctuation">(</span><span class="string">&quot;package:dplyr&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>由于<code>dplyr</code>包的函数太多，为了避免和其他包重名，需要在函数前面加上包的名字，例如：<code>dplyr::filter</code>。</p>
<p><code>filter</code>函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>iris<span class="punctuation">,</span>Sepal.Length<span class="operator">&gt;</span><span class="number">7</span><span class="punctuation">)</span>  <span class="comment">#表示筛选出Sepal.Length大于7的鸢尾花，iris为鸢尾花数据集</span></span><br><span class="line">   Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span><br><span class="line"><span class="number">1</span>           <span class="number">7.1</span>         <span class="number">3.0</span>          <span class="number">5.9</span>         <span class="number">2.1</span> virginica</span><br><span class="line"><span class="number">2</span>           <span class="number">7.6</span>         <span class="number">3.0</span>          <span class="number">6.6</span>         <span class="number">2.1</span> virginica</span><br><span class="line"><span class="number">3</span>           <span class="number">7.3</span>         <span class="number">2.9</span>          <span class="number">6.3</span>         <span class="number">1.8</span> virginica</span><br><span class="line"><span class="number">4</span>           <span class="number">7.2</span>         <span class="number">3.6</span>          <span class="number">6.1</span>         <span class="number">2.5</span> virginica</span><br><span class="line"><span class="number">5</span>           <span class="number">7.7</span>         <span class="number">3.8</span>          <span class="number">6.7</span>         <span class="number">2.2</span> virginica</span><br><span class="line"><span class="number">6</span>           <span class="number">7.7</span>         <span class="number">2.6</span>          <span class="number">6.9</span>         <span class="number">2.3</span> virginica</span><br><span class="line"><span class="number">7</span>           <span class="number">7.7</span>         <span class="number">2.8</span>          <span class="number">6.7</span>         <span class="number">2.0</span> virginica</span><br><span class="line"><span class="number">8</span>           <span class="number">7.2</span>         <span class="number">3.2</span>          <span class="number">6.0</span>         <span class="number">1.8</span> virginica</span><br><span class="line"><span class="number">9</span>           <span class="number">7.2</span>         <span class="number">3.0</span>          <span class="number">5.8</span>         <span class="number">1.6</span> virginica</span><br><span class="line"><span class="number">10</span>          <span class="number">7.4</span>         <span class="number">2.8</span>          <span class="number">6.1</span>         <span class="number">1.9</span> virginica</span><br><span class="line"><span class="number">11</span>          <span class="number">7.9</span>         <span class="number">3.8</span>          <span class="number">6.4</span>         <span class="number">2.0</span> virginica</span><br><span class="line"><span class="number">12</span>          <span class="number">7.7</span>         <span class="number">3.0</span>          <span class="number">6.1</span>         <span class="number">2.3</span> virginica</span><br></pre></td></tr></table></figure>
<p><code>distinct</code>表示去除重复行，类似于<code>unique</code>的功能。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>distinct<span class="punctuation">(</span>rbind<span class="punctuation">(</span>iris<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span>iris<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">15</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># rbind是合并行函数</span></span><br><span class="line">   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line"><span class="number">1</span>           <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">2</span>           <span class="number">4.9</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">3</span>           <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">4</span>           <span class="number">4.6</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">5</span>           <span class="number">5.0</span>         <span class="number">3.6</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">6</span>           <span class="number">5.4</span>         <span class="number">3.9</span>          <span class="number">1.7</span>         <span class="number">0.4</span>  setosa</span><br><span class="line"><span class="number">7</span>           <span class="number">4.6</span>         <span class="number">3.4</span>          <span class="number">1.4</span>         <span class="number">0.3</span>  setosa</span><br><span class="line"><span class="number">8</span>           <span class="number">5.0</span>         <span class="number">3.4</span>          <span class="number">1.5</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">9</span>           <span class="number">4.4</span>         <span class="number">2.9</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">10</span>          <span class="number">4.9</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.1</span>  setosa</span><br><span class="line"><span class="number">11</span>          <span class="number">5.4</span>         <span class="number">3.7</span>          <span class="number">1.5</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">12</span>          <span class="number">4.8</span>         <span class="number">3.4</span>          <span class="number">1.6</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">13</span>          <span class="number">4.8</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.1</span>  setosa</span><br><span class="line"><span class="number">14</span>          <span class="number">4.3</span>         <span class="number">3.0</span>          <span class="number">1.1</span>         <span class="number">0.1</span>  setosa</span><br><span class="line"><span class="number">15</span>          <span class="number">5.8</span>         <span class="number">4.0</span>          <span class="number">1.2</span>         <span class="number">0.2</span>  setosa</span><br></pre></td></tr></table></figure>
<p><code>slice</code>函数表示取出某些行：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>slice<span class="punctuation">(</span>iris<span class="punctuation">,</span><span class="number">10</span><span class="operator">:</span><span class="number">15</span><span class="punctuation">)</span> <span class="comment"># 取出10-15行</span></span><br><span class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line"><span class="number">1</span>          <span class="number">4.9</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.1</span>  setosa</span><br><span class="line"><span class="number">2</span>          <span class="number">5.4</span>         <span class="number">3.7</span>          <span class="number">1.5</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">3</span>          <span class="number">4.8</span>         <span class="number">3.4</span>          <span class="number">1.6</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">4</span>          <span class="number">4.8</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.1</span>  setosa</span><br><span class="line"><span class="number">5</span>          <span class="number">4.3</span>         <span class="number">3.0</span>          <span class="number">1.1</span>         <span class="number">0.1</span>  setosa</span><br><span class="line"><span class="number">6</span>          <span class="number">5.8</span>         <span class="number">4.0</span>          <span class="number">1.2</span>         <span class="number">0.2</span>  setosa</span><br></pre></td></tr></table></figure>
<p>sample_n函数表示随机取样，随机抽取某些行：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>sample_n<span class="punctuation">(</span>iris<span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span><br><span class="line"><span class="number">1</span>           <span class="number">4.8</span>         <span class="number">3.4</span>          <span class="number">1.6</span>         <span class="number">0.2</span>     setosa</span><br><span class="line"><span class="number">2</span>           <span class="number">6.9</span>         <span class="number">3.2</span>          <span class="number">5.7</span>         <span class="number">2.3</span>  virginica</span><br><span class="line"><span class="number">3</span>           <span class="number">5.1</span>         <span class="number">3.3</span>          <span class="number">1.7</span>         <span class="number">0.5</span>     setosa</span><br><span class="line"><span class="number">4</span>           <span class="number">7.0</span>         <span class="number">3.2</span>          <span class="number">4.7</span>         <span class="number">1.4</span> versicolor</span><br><span class="line"><span class="number">5</span>           <span class="number">6.4</span>         <span class="number">3.2</span>          <span class="number">4.5</span>         <span class="number">1.5</span> versicolor</span><br><span class="line"><span class="number">6</span>           <span class="number">5.8</span>         <span class="number">2.7</span>          <span class="number">5.1</span>         <span class="number">1.9</span>  virginica</span><br><span class="line"><span class="number">7</span>           <span class="number">5.0</span>         <span class="number">3.2</span>          <span class="number">1.2</span>         <span class="number">0.2</span>     setosa</span><br><span class="line"><span class="number">8</span>           <span class="number">4.6</span>         <span class="number">3.4</span>          <span class="number">1.4</span>         <span class="number">0.3</span>     setosa</span><br><span class="line"><span class="number">9</span>           <span class="number">6.0</span>         <span class="number">2.2</span>          <span class="number">5.0</span>         <span class="number">1.5</span>  virginica</span><br><span class="line"><span class="number">10</span>          <span class="number">6.3</span>         <span class="number">2.8</span>          <span class="number">5.1</span>         <span class="number">1.5</span>  virginica</span><br></pre></td></tr></table></figure>
<p><code>sample_frac</code>表示按比例随机选取：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>sample_frac<span class="punctuation">(</span>iris<span class="punctuation">,</span><span class="number">0.1</span><span class="punctuation">)</span></span><br><span class="line">   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span><br><span class="line"><span class="number">1</span>           <span class="number">6.6</span>         <span class="number">3.0</span>          <span class="number">4.4</span>         <span class="number">1.4</span> versicolor</span><br><span class="line"><span class="number">2</span>           <span class="number">6.3</span>         <span class="number">2.5</span>          <span class="number">5.0</span>         <span class="number">1.9</span>  virginica</span><br><span class="line"><span class="number">3</span>           <span class="number">5.2</span>         <span class="number">3.5</span>          <span class="number">1.5</span>         <span class="number">0.2</span>     setosa</span><br><span class="line"><span class="number">4</span>           <span class="number">4.4</span>         <span class="number">3.0</span>          <span class="number">1.3</span>         <span class="number">0.2</span>     setosa</span><br><span class="line"><span class="number">5</span>           <span class="number">6.6</span>         <span class="number">2.9</span>          <span class="number">4.6</span>         <span class="number">1.3</span> versicolor</span><br><span class="line"><span class="number">6</span>           <span class="number">4.9</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.2</span>     setosa</span><br><span class="line"><span class="number">7</span>           <span class="number">4.9</span>         <span class="number">2.5</span>          <span class="number">4.5</span>         <span class="number">1.7</span>  virginica</span><br><span class="line"><span class="number">8</span>           <span class="number">4.9</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.1</span>     setosa</span><br><span class="line"><span class="number">9</span>           <span class="number">5.9</span>         <span class="number">3.2</span>          <span class="number">4.8</span>         <span class="number">1.8</span> versicolor</span><br><span class="line"><span class="number">10</span>          <span class="number">6.1</span>         <span class="number">3.0</span>          <span class="number">4.6</span>         <span class="number">1.4</span> versicolor</span><br><span class="line"><span class="number">11</span>          <span class="number">6.1</span>         <span class="number">2.8</span>          <span class="number">4.7</span>         <span class="number">1.2</span> versicolor</span><br><span class="line"><span class="number">12</span>          <span class="number">6.9</span>         <span class="number">3.2</span>          <span class="number">5.7</span>         <span class="number">2.3</span>  virginica</span><br><span class="line"><span class="number">13</span>          <span class="number">5.5</span>         <span class="number">4.2</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa</span><br><span class="line"><span class="number">14</span>          <span class="number">5.7</span>         <span class="number">3.0</span>          <span class="number">4.2</span>         <span class="number">1.2</span> versicolor</span><br><span class="line"><span class="number">15</span>          <span class="number">5.8</span>         <span class="number">4.0</span>          <span class="number">1.2</span>         <span class="number">0.2</span>     setosa</span><br></pre></td></tr></table></figure>
<p><code>arrange</code>函数用于排序，默认从小到大进行排序：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>dplyr<span class="operator">::</span>arrange<span class="punctuation">(</span>iris<span class="punctuation">,</span>Sepal.Length<span class="punctuation">)</span><span class="punctuation">)</span>   <span class="comment"># 按照花萼长度进行排序</span></span><br><span class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line"><span class="number">1</span>          <span class="number">4.3</span>         <span class="number">3.0</span>          <span class="number">1.1</span>         <span class="number">0.1</span>  setosa</span><br><span class="line"><span class="number">2</span>          <span class="number">4.4</span>         <span class="number">2.9</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">3</span>          <span class="number">4.4</span>         <span class="number">3.0</span>          <span class="number">1.3</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">4</span>          <span class="number">4.4</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">5</span>          <span class="number">4.5</span>         <span class="number">2.3</span>          <span class="number">1.3</span>         <span class="number">0.3</span>  setosa</span><br><span class="line"><span class="number">6</span>          <span class="number">4.6</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.2</span>  setosa</span><br></pre></td></tr></table></figure>
<p>如果加上<code>desc</code>表示根据从大到小进行排序：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>dplyr<span class="operator">::</span>arrange<span class="punctuation">(</span>iris<span class="punctuation">,</span>desc<span class="punctuation">(</span>Sepal.Length<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span><br><span class="line"><span class="number">1</span>          <span class="number">7.9</span>         <span class="number">3.8</span>          <span class="number">6.4</span>         <span class="number">2.0</span> virginica</span><br><span class="line"><span class="number">2</span>          <span class="number">7.7</span>         <span class="number">3.8</span>          <span class="number">6.7</span>         <span class="number">2.2</span> virginica</span><br><span class="line"><span class="number">3</span>          <span class="number">7.7</span>         <span class="number">2.6</span>          <span class="number">6.9</span>         <span class="number">2.3</span> virginica</span><br><span class="line"><span class="number">4</span>          <span class="number">7.7</span>         <span class="number">2.8</span>          <span class="number">6.7</span>         <span class="number">2.0</span> virginica</span><br><span class="line"><span class="number">5</span>          <span class="number">7.7</span>         <span class="number">3.0</span>          <span class="number">6.1</span>         <span class="number">2.3</span> virginica</span><br><span class="line"><span class="number">6</span>          <span class="number">7.6</span>         <span class="number">3.0</span>          <span class="number">6.6</span>         <span class="number">2.1</span> virginica</span><br></pre></td></tr></table></figure>
<p><code>dplyr</code>包也有数据框取子集的功能，可以利用<code>select</code>函数，相关示例通过<code>?select</code>命令查看。</p>
<p><code>summarise</code>函数用来统计：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summarise<span class="punctuation">(</span>iris<span class="punctuation">,</span>avg<span class="operator">=</span>mean<span class="punctuation">(</span>Sepal.Length<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">       avg</span><br><span class="line"><span class="number">1</span> <span class="number">5.843333</span></span><br><span class="line"><span class="operator">&gt;</span> summarise<span class="punctuation">(</span>iris<span class="punctuation">,</span><span class="built_in">sum</span><span class="operator">=</span><span class="built_in">sum</span><span class="punctuation">(</span>Sepal.Length<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">    <span class="built_in">sum</span></span><br><span class="line"><span class="number">1</span> <span class="number">876.5</span></span><br></pre></td></tr></table></figure>
<p><strong>链式操作符</strong></p>
<p>两个百分号中间夹着一个大于号，称为链式操作符，它功能是用于实现将一个函数的输出传递给下一个函数，作为下一个函数的输入。</p>
<p>在Rstudio中可以使用<code>ctrl + shift + M</code>快捷键输出出来。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>mtcars<span class="punctuation">,</span><span class="number">20</span><span class="punctuation">)</span>   <span class="comment"># 取出前20行</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive      <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout   <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant             <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Duster <span class="number">360</span>          <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">240</span>D           <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Merc <span class="number">230</span>            <span class="number">22.8</span>   <span class="number">4</span> <span class="number">140.8</span>  <span class="number">95</span> <span class="number">3.92</span> <span class="number">3.150</span> <span class="number">22.90</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Merc <span class="number">280</span>            <span class="number">19.2</span>   <span class="number">6</span> <span class="number">167.6</span> <span class="number">123</span> <span class="number">3.92</span> <span class="number">3.440</span> <span class="number">18.30</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">280</span>C           <span class="number">17.8</span>   <span class="number">6</span> <span class="number">167.6</span> <span class="number">123</span> <span class="number">3.92</span> <span class="number">3.440</span> <span class="number">18.90</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">450</span>SE          <span class="number">16.4</span>   <span class="number">8</span> <span class="number">275.8</span> <span class="number">180</span> <span class="number">3.07</span> <span class="number">4.070</span> <span class="number">17.40</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">3</span></span><br><span class="line">Merc <span class="number">450</span>SL          <span class="number">17.3</span>   <span class="number">8</span> <span class="number">275.8</span> <span class="number">180</span> <span class="number">3.07</span> <span class="number">3.730</span> <span class="number">17.60</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">3</span></span><br><span class="line">Merc <span class="number">450</span>SLC         <span class="number">15.2</span>   <span class="number">8</span> <span class="number">275.8</span> <span class="number">180</span> <span class="number">3.07</span> <span class="number">3.780</span> <span class="number">18.00</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">3</span></span><br><span class="line">Cadillac Fleetwood  <span class="number">10.4</span>   <span class="number">8</span> <span class="number">472.0</span> <span class="number">205</span> <span class="number">2.93</span> <span class="number">5.250</span> <span class="number">17.98</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Lincoln Continental <span class="number">10.4</span>   <span class="number">8</span> <span class="number">460.0</span> <span class="number">215</span> <span class="number">3.00</span> <span class="number">5.424</span> <span class="number">17.82</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Chrysler Imperial   <span class="number">14.7</span>   <span class="number">8</span> <span class="number">440.0</span> <span class="number">230</span> <span class="number">3.23</span> <span class="number">5.345</span> <span class="number">17.42</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Fiat <span class="number">128</span>            <span class="number">32.4</span>   <span class="number">4</span>  <span class="number">78.7</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.200</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Honda Civic         <span class="number">30.4</span>   <span class="number">4</span>  <span class="number">75.7</span>  <span class="number">52</span> <span class="number">4.93</span> <span class="number">1.615</span> <span class="number">18.52</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Toyota Corolla      <span class="number">33.9</span>   <span class="number">4</span>  <span class="number">71.1</span>  <span class="number">65</span> <span class="number">4.22</span> <span class="number">1.835</span> <span class="number">19.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>mtcars<span class="punctuation">,</span><span class="number">20</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> tail<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span>   <span class="comment"># 取出前20行中的后10行</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Merc <span class="number">280</span>C           <span class="number">17.8</span>   <span class="number">6</span> <span class="number">167.6</span> <span class="number">123</span> <span class="number">3.92</span> <span class="number">3.440</span> <span class="number">18.90</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">450</span>SE          <span class="number">16.4</span>   <span class="number">8</span> <span class="number">275.8</span> <span class="number">180</span> <span class="number">3.07</span> <span class="number">4.070</span> <span class="number">17.40</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">3</span></span><br><span class="line">Merc <span class="number">450</span>SL          <span class="number">17.3</span>   <span class="number">8</span> <span class="number">275.8</span> <span class="number">180</span> <span class="number">3.07</span> <span class="number">3.730</span> <span class="number">17.60</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">3</span></span><br><span class="line">Merc <span class="number">450</span>SLC         <span class="number">15.2</span>   <span class="number">8</span> <span class="number">275.8</span> <span class="number">180</span> <span class="number">3.07</span> <span class="number">3.780</span> <span class="number">18.00</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">3</span></span><br><span class="line">Cadillac Fleetwood  <span class="number">10.4</span>   <span class="number">8</span> <span class="number">472.0</span> <span class="number">205</span> <span class="number">2.93</span> <span class="number">5.250</span> <span class="number">17.98</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Lincoln Continental <span class="number">10.4</span>   <span class="number">8</span> <span class="number">460.0</span> <span class="number">215</span> <span class="number">3.00</span> <span class="number">5.424</span> <span class="number">17.82</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Chrysler Imperial   <span class="number">14.7</span>   <span class="number">8</span> <span class="number">440.0</span> <span class="number">230</span> <span class="number">3.23</span> <span class="number">5.345</span> <span class="number">17.42</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Fiat <span class="number">128</span>            <span class="number">32.4</span>   <span class="number">4</span>  <span class="number">78.7</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.200</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Honda Civic         <span class="number">30.4</span>   <span class="number">4</span>  <span class="number">75.7</span>  <span class="number">52</span> <span class="number">4.93</span> <span class="number">1.615</span> <span class="number">18.52</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Toyota Corolla      <span class="number">33.9</span>   <span class="number">4</span>  <span class="number">71.1</span>  <span class="number">65</span> <span class="number">4.22</span> <span class="number">1.835</span> <span class="number">19.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p><code>group_by</code>函数可以对函数进行分组：通过Species这一列对鸢尾花进行分组，分为三组：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>group_by<span class="punctuation">(</span>iris<span class="punctuation">,</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 150 × 5</span></span><br><span class="line"><span class="comment"># Groups:   Species [3]  </span></span><br><span class="line">   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line">          <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>       <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>        <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>       <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>fct<span class="operator">&gt;</span>  </span><br><span class="line"> <span class="number">1</span>          <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">2</span>          <span class="number">4.9</span>         <span class="number">3</span>            <span class="number">1.4</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">3</span>          <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">4</span>          <span class="number">4.6</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">5</span>          <span class="number">5</span>           <span class="number">3.6</span>          <span class="number">1.4</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">6</span>          <span class="number">5.4</span>         <span class="number">3.9</span>          <span class="number">1.7</span>         <span class="number">0.4</span> setosa </span><br><span class="line"> <span class="number">7</span>          <span class="number">4.6</span>         <span class="number">3.4</span>          <span class="number">1.4</span>         <span class="number">0.3</span> setosa </span><br><span class="line"> <span class="number">8</span>          <span class="number">5</span>           <span class="number">3.4</span>          <span class="number">1.5</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">9</span>          <span class="number">4.4</span>         <span class="number">2.9</span>          <span class="number">1.4</span>         <span class="number">0.2</span> setosa </span><br><span class="line"><span class="number">10</span>          <span class="number">4.9</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.1</span> setosa </span><br><span class="line"><span class="comment"># … with 140 more rows</span></span><br><span class="line"><span class="comment"># ℹ Use `print(n = ...)` to see more rows</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> iris <span class="operator">%&gt;%</span> group_by<span class="punctuation">(</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 150 × 5</span></span><br><span class="line"><span class="comment"># Groups:   Species [3]</span></span><br><span class="line">   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line">          <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>       <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>        <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>       <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>fct<span class="operator">&gt;</span>  </span><br><span class="line"> <span class="number">1</span>          <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">2</span>          <span class="number">4.9</span>         <span class="number">3</span>            <span class="number">1.4</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">3</span>          <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">4</span>          <span class="number">4.6</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">5</span>          <span class="number">5</span>           <span class="number">3.6</span>          <span class="number">1.4</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">6</span>          <span class="number">5.4</span>         <span class="number">3.9</span>          <span class="number">1.7</span>         <span class="number">0.4</span> setosa </span><br><span class="line"> <span class="number">7</span>          <span class="number">4.6</span>         <span class="number">3.4</span>          <span class="number">1.4</span>         <span class="number">0.3</span> setosa </span><br><span class="line"> <span class="number">8</span>          <span class="number">5</span>           <span class="number">3.4</span>          <span class="number">1.5</span>         <span class="number">0.2</span> setosa </span><br><span class="line"> <span class="number">9</span>          <span class="number">4.4</span>         <span class="number">2.9</span>          <span class="number">1.4</span>         <span class="number">0.2</span> setosa </span><br><span class="line"><span class="number">10</span>          <span class="number">4.9</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.1</span> setosa </span><br><span class="line"><span class="comment"># … with 140 more rows</span></span><br><span class="line"><span class="comment"># ℹ Use `print(n = ...)` to see more rows</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> iris <span class="operator">%&gt;%</span> group_by<span class="punctuation">(</span>Species<span class="punctuation">)</span> <span class="operator">%&gt;%</span> summarise<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 3 × 1</span></span><br><span class="line">  Species   </span><br><span class="line">  <span class="operator">&lt;</span>fct<span class="operator">&gt;</span>     </span><br><span class="line"><span class="number">1</span> setosa    </span><br><span class="line"><span class="number">2</span> versicolor</span><br><span class="line"><span class="number">3</span> virginica </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> iris <span class="operator">%&gt;%</span> group_by<span class="punctuation">(</span>Species<span class="punctuation">)</span> <span class="operator">%&gt;%</span> summarise<span class="punctuation">(</span>avg<span class="operator">=</span>mean<span class="punctuation">(</span>Sepal.Width<span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># </span></span><br><span class="line"><span class="comment"># A tibble: 3 × 2</span></span><br><span class="line">  Species      avg</span><br><span class="line">  <span class="operator">&lt;</span>fct<span class="operator">&gt;</span>      <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span></span><br><span class="line"><span class="number">1</span> setosa      <span class="number">3.43</span></span><br><span class="line"><span class="number">2</span> versicolor  <span class="number">2.77</span></span><br><span class="line"><span class="number">3</span> virginica   <span class="number">2.97</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> iris <span class="operator">%&gt;%</span> group_by<span class="punctuation">(</span>Species<span class="punctuation">)</span> <span class="operator">%&gt;%</span> summarise<span class="punctuation">(</span>avg<span class="operator">=</span>mean<span class="punctuation">(</span>Sepal.Width<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> arrange<span class="punctuation">(</span>avg<span class="punctuation">)</span> <span class="comment"># 在上面的基础上进行排序</span></span><br><span class="line"><span class="comment"># A tibble: 3 × 2</span></span><br><span class="line">  Species      avg</span><br><span class="line">  <span class="operator">&lt;</span>fct<span class="operator">&gt;</span>      <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span></span><br><span class="line"><span class="number">1</span> versicolor  <span class="number">2.77</span></span><br><span class="line"><span class="number">2</span> virginica   <span class="number">2.97</span></span><br><span class="line"><span class="number">3</span> setosa      <span class="number">3.43</span></span><br></pre></td></tr></table></figure>
<p><code>mutate</code>函数可以添加新的变量：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>dplyr<span class="operator">::</span>mutate<span class="punctuation">(</span>iris<span class="punctuation">,</span>new <span class="operator">=</span> Sepal.Length<span class="operator">+</span>Petal.Length<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species new</span><br><span class="line"><span class="number">1</span>          <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa <span class="number">6.5</span></span><br><span class="line"><span class="number">2</span>          <span class="number">4.9</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa <span class="number">6.3</span></span><br><span class="line"><span class="number">3</span>          <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>  setosa <span class="number">6.0</span></span><br><span class="line"><span class="number">4</span>          <span class="number">4.6</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.2</span>  setosa <span class="number">6.1</span></span><br><span class="line"><span class="number">5</span>          <span class="number">5.0</span>         <span class="number">3.6</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa <span class="number">6.4</span></span><br><span class="line"><span class="number">6</span>          <span class="number">5.4</span>         <span class="number">3.9</span>          <span class="number">1.7</span>         <span class="number">0.4</span>  setosa <span class="number">7.1</span></span><br></pre></td></tr></table></figure>
<p>下面对双表格进行操作：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> a<span class="operator">=</span>data.frame<span class="punctuation">(</span>x1<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span><span class="string">&quot;B&quot;</span><span class="punctuation">,</span><span class="string">&quot;C&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>x2<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> a</span><br><span class="line">  x1 x2</span><br><span class="line"><span class="number">1</span>  A  <span class="number">1</span></span><br><span class="line"><span class="number">2</span>  B  <span class="number">2</span></span><br><span class="line"><span class="number">3</span>  C  <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> b<span class="operator">=</span>data.frame<span class="punctuation">(</span>x1<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span><span class="string">&quot;B&quot;</span><span class="punctuation">,</span><span class="string">&quot;D&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>x3<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> b</span><br><span class="line">  x1    x3</span><br><span class="line"><span class="number">1</span>  A  <span class="literal">TRUE</span></span><br><span class="line"><span class="number">2</span>  B <span class="literal">FALSE</span></span><br><span class="line"><span class="number">3</span>  D  <span class="literal">TRUE</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>left_join<span class="punctuation">(</span>a<span class="punctuation">,</span>b<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;x1&quot;</span><span class="punctuation">)</span> <span class="comment"># 左链接，以左边的行名为基准</span></span><br><span class="line">  x1 x2    x3</span><br><span class="line"><span class="number">1</span>  A  <span class="number">1</span>  <span class="literal">TRUE</span></span><br><span class="line"><span class="number">2</span>  B  <span class="number">2</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="number">3</span>  C  <span class="number">3</span>    <span class="literal">NA</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>right_join<span class="punctuation">(</span>a<span class="punctuation">,</span>b<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;x1&quot;</span><span class="punctuation">)</span> <span class="comment"># 右链接，以右边的行名为基准</span></span><br><span class="line">  x1 x2    x3</span><br><span class="line"><span class="number">1</span>  A  <span class="number">1</span>  <span class="literal">TRUE</span></span><br><span class="line"><span class="number">2</span>  B  <span class="number">2</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="number">3</span>  D <span class="literal">NA</span>  <span class="literal">TRUE</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>full_join<span class="punctuation">(</span>a<span class="punctuation">,</span>b<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;x1&quot;</span><span class="punctuation">)</span> <span class="comment"># 全链接，取a和b的并集</span></span><br><span class="line">  x1 x2    x3</span><br><span class="line"><span class="number">1</span>  A  <span class="number">1</span>  <span class="literal">TRUE</span></span><br><span class="line"><span class="number">2</span>  B  <span class="number">2</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="number">3</span>  C  <span class="number">3</span>    <span class="literal">NA</span></span><br><span class="line"><span class="number">4</span>  D <span class="literal">NA</span>  <span class="literal">TRUE</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>semi_join<span class="punctuation">(</span>a<span class="punctuation">,</span>b<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;x1&quot;</span><span class="punctuation">)</span> <span class="comment"># 半链接：取a和b的交集部分</span></span><br><span class="line">  x1 x2</span><br><span class="line"><span class="number">1</span>  A  <span class="number">1</span></span><br><span class="line"><span class="number">2</span>  B  <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>anti_join<span class="punctuation">(</span>a<span class="punctuation">,</span>b<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;x1&quot;</span><span class="punctuation">)</span> <span class="comment"># 反链接：取a和b的补集部分</span></span><br><span class="line">  x1 x2</span><br><span class="line"><span class="number">1</span>  C  <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>anti_join<span class="punctuation">(</span>b<span class="punctuation">,</span>a<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;x1&quot;</span><span class="punctuation">)</span> <span class="comment"># 反链接：取a和b的补集部分</span></span><br><span class="line">  x1   x3</span><br><span class="line"><span class="number">1</span>  D <span class="literal">TRUE</span></span><br></pre></td></tr></table></figure>
<p><code>intersect</code>函数用来取交集：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mtcars <span class="operator">&lt;-</span> mutate<span class="punctuation">(</span>mtcars<span class="punctuation">,</span>Model<span class="operator">=</span>rownames<span class="punctuation">(</span>mtcars<span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 由于没有行名，增加一列显示行名</span></span><br><span class="line"><span class="operator">&gt;</span> first <span class="operator">&lt;-</span> slice<span class="punctuation">(</span>mtcars<span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">6</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> first</span><br><span class="line">                   mpg cyl disp  hp drat    wt  qsec vs am gear carb             Model</span><br><span class="line">Mazda RX4         <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span>         Mazda RX4</span><br><span class="line">Mazda RX4 Wag     <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span>     Mazda RX4 Wag</span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span>        Datsun <span class="number">710</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>    Hornet <span class="number">4</span> Drive</span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span> Hornet Sportabout</span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span>  <span class="number">225</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>           Valiant</span><br><span class="line"><span class="operator">&gt;</span> second <span class="operator">&lt;-</span> slice<span class="punctuation">(</span>mtcars<span class="punctuation">,</span><span class="number">5</span><span class="operator">:</span><span class="number">15</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> second <span class="operator">&lt;-</span> slice<span class="punctuation">(</span>mtcars<span class="punctuation">,</span><span class="number">4</span><span class="operator">:</span><span class="number">9</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> second</span><br><span class="line">                   mpg cyl  disp  hp drat    wt  qsec vs am gear carb             Model</span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>    Hornet <span class="number">4</span> Drive</span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span> Hornet Sportabout</span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>           Valiant</span><br><span class="line">Duster <span class="number">360</span>        <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span>        Duster <span class="number">360</span></span><br><span class="line">Merc <span class="number">240</span>D         <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span>         Merc <span class="number">240</span>D</span><br><span class="line">Merc <span class="number">230</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">140.8</span>  <span class="number">95</span> <span class="number">3.92</span> <span class="number">3.150</span> <span class="number">22.90</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span>          Merc <span class="number">230</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> intersect<span class="punctuation">(</span>first<span class="punctuation">,</span>second<span class="punctuation">)</span> <span class="comment"># intersect函数用来取交集</span></span><br><span class="line">                   mpg cyl disp  hp drat    wt  qsec vs am gear carb             Model</span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>    Hornet <span class="number">4</span> Drive</span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span> Hornet Sportabout</span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span>  <span class="number">225</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>           Valiant</span><br></pre></td></tr></table></figure>
<p><code>union</code>取非冗余的并集，即自动剔除冗余部分。<code>union_all</code>只是简单的并集，不会提出冗余部分。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>union_all<span class="punctuation">(</span>first<span class="punctuation">,</span>second<span class="punctuation">)</span></span><br><span class="line">                       mpg cyl  disp  hp drat    wt  qsec vs am gear carb             Model</span><br><span class="line">Mazda RX4             <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span>         Mazda RX4</span><br><span class="line">Mazda RX4 Wag         <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span>     Mazda RX4 Wag</span><br><span class="line">Datsun <span class="number">710</span>            <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span>        Datsun <span class="number">710</span></span><br><span class="line">Hornet <span class="number">4</span> Drive...4    <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>    Hornet <span class="number">4</span> Drive</span><br><span class="line">Hornet Sportabout...5 <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span> Hornet Sportabout</span><br><span class="line">Valiant...6           <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>           Valiant</span><br><span class="line">Hornet <span class="number">4</span> Drive...7    <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>    Hornet <span class="number">4</span> Drive</span><br><span class="line">Hornet Sportabout...8 <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span> Hornet Sportabout</span><br><span class="line">Valiant...9           <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>           Valiant</span><br><span class="line">Duster <span class="number">360</span>            <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span>        Duster <span class="number">360</span></span><br><span class="line">Merc <span class="number">240</span>D             <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span>         Merc <span class="number">240</span>D</span><br><span class="line">Merc <span class="number">230</span>              <span class="number">22.8</span>   <span class="number">4</span> <span class="number">140.8</span>  <span class="number">95</span> <span class="number">3.92</span> <span class="number">3.150</span> <span class="number">22.90</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span>          Merc <span class="number">230</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>union<span class="punctuation">(</span>first<span class="punctuation">,</span>second<span class="punctuation">)</span></span><br><span class="line">                   mpg cyl  disp  hp drat    wt  qsec vs am gear carb             Model</span><br><span class="line">Mazda RX4         <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span>         Mazda RX4</span><br><span class="line">Mazda RX4 Wag     <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span>     Mazda RX4 Wag</span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span>        Datsun <span class="number">710</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>    Hornet <span class="number">4</span> Drive</span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span> Hornet Sportabout</span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span>           Valiant</span><br><span class="line">Duster <span class="number">360</span>        <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span>        Duster <span class="number">360</span></span><br><span class="line">Merc <span class="number">240</span>D         <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span>         Merc <span class="number">240</span>D</span><br><span class="line">Merc <span class="number">230</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">140.8</span>  <span class="number">95</span> <span class="number">3.92</span> <span class="number">3.150</span> <span class="number">22.90</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span>          Merc <span class="number">230</span></span><br></pre></td></tr></table></figure>
<p><code>setdiff</code>取第一个参数的补集</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> setdiff<span class="punctuation">(</span>first<span class="punctuation">,</span>second<span class="punctuation">)</span></span><br><span class="line">               mpg cyl disp  hp drat    wt  qsec vs am gear carb         Model</span><br><span class="line">Mazda RX4     <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span>     Mazda RX4</span><br><span class="line">Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span> Mazda RX4 Wag</span><br><span class="line">Datsun <span class="number">710</span>    <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span>    Datsun <span class="number">710</span></span><br><span class="line"><span class="operator">&gt;</span> setdiff<span class="punctuation">(</span>second<span class="punctuation">,</span>first<span class="punctuation">)</span></span><br><span class="line">            mpg cyl  disp  hp drat   wt  qsec vs am gear carb      Model</span><br><span class="line">Duster <span class="number">360</span> <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.57</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span> Duster <span class="number">360</span></span><br><span class="line">Merc <span class="number">240</span>D  <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.19</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span>  Merc <span class="number">240</span>D</span><br><span class="line">Merc <span class="number">230</span>   <span class="number">22.8</span>   <span class="number">4</span> <span class="number">140.8</span>  <span class="number">95</span> <span class="number">3.92</span> <span class="number">3.15</span> <span class="number">22.90</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span>   Merc <span class="number">230</span></span><br></pre></td></tr></table></figure>
<h2 id="5-R函数">5 R函数</h2>
<p>R函数是R语言重要组成部分</p>
<p>比如用<code>lm</code>函数进行线性回归分析：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> state <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Murder&quot;</span><span class="punctuation">,</span><span class="string">&quot;Population&quot;</span><span class="punctuation">,</span><span class="string">&quot;Illiteracy&quot;</span><span class="punctuation">,</span><span class="string">&quot;Income&quot;</span><span class="punctuation">,</span><span class="string">&quot;Frost&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit<span class="operator">&lt;-</span> lm <span class="punctuation">(</span>Murder <span class="operator">~</span> Population<span class="operator">+</span>Illiteracy<span class="operator">+</span>Income<span class="operator">+</span>Frost<span class="punctuation">,</span>data<span class="operator">=</span>state<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit</span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Murder <span class="operator">~</span> Population <span class="operator">+</span> Illiteracy <span class="operator">+</span> Income <span class="operator">+</span> Frost<span class="punctuation">,</span> </span><br><span class="line">    data <span class="operator">=</span> state<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>   Population   Illiteracy       Income        Frost  </span><br><span class="line">  <span class="number">1.235e+00</span>    <span class="number">2.237e-04</span>    <span class="number">4.143e+00</span>    <span class="number">6.442e-05</span>    <span class="number">5.813e-04</span>  </span><br><span class="line">  <span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Murder <span class="operator">~</span> Population <span class="operator">+</span> Illiteracy <span class="operator">+</span> Income <span class="operator">+</span> Frost<span class="punctuation">,</span> </span><br><span class="line">    data <span class="operator">=</span> state<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">    Min      <span class="number">1</span>Q  Median      <span class="number">3</span>Q     Max </span><br><span class="line"><span class="operator">-</span><span class="number">4.7960</span> <span class="operator">-</span><span class="number">1.6495</span> <span class="operator">-</span><span class="number">0.0811</span>  <span class="number">1.4815</span>  <span class="number">7.6210</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">1.235e+00</span>  <span class="number">3.866e+00</span>   <span class="number">0.319</span>   <span class="number">0.7510</span>    </span><br><span class="line">Population  <span class="number">2.237e-04</span>  <span class="number">9.052e-05</span>   <span class="number">2.471</span>   <span class="number">0.0173</span> <span class="operator">*</span>  </span><br><span class="line">Illiteracy  <span class="number">4.143e+00</span>  <span class="number">8.744e-01</span>   <span class="number">4.738</span> <span class="number">2.19e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Income      <span class="number">6.442e-05</span>  <span class="number">6.837e-04</span>   <span class="number">0.094</span>   <span class="number">0.9253</span>    </span><br><span class="line">Frost       <span class="number">5.813e-04</span>  <span class="number">1.005e-02</span>   <span class="number">0.058</span>   <span class="number">0.9541</span>    </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">2.535</span> on <span class="number">45</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.567</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.5285</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">14.73</span> on <span class="number">4</span> and <span class="number">45</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">9.133e-08</span></span><br></pre></td></tr></table></figure>
<p>绘图过程中，如果是向量和向量绘制的就是散点图，如果是向量和因子绘制的就是条形图。</p>
<p>输入数据类型：</p>
<p>向量：sum、mean、sd、range、median、sort、order</p>
<p>矩阵或数据框：cbind、rbind</p>
<p>数字矩阵：heatmap</p>
<h3 id="5-1-选项参数">5.1 选项参数</h3>
<ol>
<li>输入控制部分；</li>
<li>输出控制部分；</li>
<li>调节部分。</li>
</ol>
<p>file：接一个文件；</p>
<p>data：一般指要输入一个数据框；</p>
<p>x：表示单独的一个对象，一般都是向量，也可以是矩阵或者列表；</p>
<p>x和y：函数需要两个输入变量；</p>
<p>x，y，z：函数需要三个输入变量；</p>
<p>formula：公式；<code>y ~ x</code>表示x和y相关。</p>
<p>na.rm：删除缺失值；</p>
<p>……</p>
<p>有时候会存在三个点<code>…</code>，表示和其他函数功能重合，功能通用。有时候三个点在前面表示可以合并任意的对象，比如<code>data.frame</code>函数：</p>
<p><img src="https://vip2.loli.io/2023/03/13/gYTx9FwBNWusz21.png" alt="image-20220810195008019"></p>
<p><img src="https://vip2.loli.io/2023/03/13/sFb4gHV9DXBSGKq.png" alt="image-20220810195920151"></p>
<p><strong>调节参数</strong>：</p>
<p>color：选项和明显用来控制颜色</p>
<p>select：与选择有关</p>
<p>font：与字体有关</p>
<p>font.axis：就是坐标轴的字体</p>
<p>lty：是line type，线型</p>
<p>lwd：是line width，线宽</p>
<p>method：软件算法</p>
<p>……</p>
<p><strong>选项接受哪些参数</strong>：</p>
<p>main：字符串，不能是向量</p>
<p>na.rm：TRUE或者FALSE</p>
<p>axis：side参数只能是1到4，控制坐标轴的方向</p>
<p>fig：包含四个元素的向量，控制图形区域的位置</p>
<p>……</p>
<h3 id="5-2-数学统计函数">5.2 数学统计函数</h3>
<p><strong>概率论</strong></p>
<p>概率论是统计学的基础，R有许多用于处理概率，概率分布以及随机变量的函数。R对每一个概率分布都有一个简称，这个名称用于识别与分布相联系的函数。这部分涉及到很多统计学基础的理论知识，比如随机试验，样本空间，对立与互斥，随机事件与必然事件，概率密度，概率分布等。</p>
<p>d：概率密度函数</p>
<p>p：分布函数</p>
<p>q：分布函数的反函数</p>
<p>r：产生相同分布的随机数</p>
<p>比如正态分布：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dnorm<span class="punctuation">(</span>x<span class="punctuation">,</span> mean <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> <span class="built_in">log</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">pnorm<span class="punctuation">(</span>q<span class="punctuation">,</span> mean <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> lower.tail <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> log.p <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">qnorm<span class="punctuation">(</span>p<span class="punctuation">,</span> mean <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> lower.tail <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> log.p <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">rnorm<span class="punctuation">(</span>n<span class="punctuation">,</span> mean <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><code>rnorm(n, mean = 0, sd = 1)</code>表示产生n个均值为0，方差为1的随机数。</p>
<p>在每个函数前面加上d、p、q、r就构成了函数名。</p>
<table>
<thead>
<tr>
<th>分布名称</th>
<th>分布</th>
<th>R中的名称</th>
<th>附加参数</th>
</tr>
</thead>
<tbody>
<tr>
<td>Beta分布</td>
<td>beta</td>
<td>beta</td>
<td>shape1, shape2, ncp</td>
</tr>
<tr>
<td>二项分布</td>
<td>binomial</td>
<td>binom</td>
<td>size, prob</td>
</tr>
<tr>
<td>柯西分布</td>
<td>Cauchy</td>
<td>cauchy</td>
<td>location, scale</td>
</tr>
<tr>
<td>（非中心）卡方分布</td>
<td>chi-squared</td>
<td>chisq</td>
<td>df, ncp</td>
</tr>
<tr>
<td>指数分布</td>
<td>exponential</td>
<td>exp</td>
<td>rate</td>
</tr>
<tr>
<td>F分布</td>
<td>F分布</td>
<td>F</td>
<td>f</td>
</tr>
<tr>
<td>Gamma分布</td>
<td>gamma</td>
<td>gamma</td>
<td>shape, scale</td>
</tr>
<tr>
<td>几何分布</td>
<td>geometric</td>
<td>geom</td>
<td>prob</td>
</tr>
<tr>
<td>超几何分布</td>
<td>hypergeometric</td>
<td>hyper</td>
<td>m, n, k</td>
</tr>
<tr>
<td>对数正态分布</td>
<td>log-normal</td>
<td>lnorm</td>
<td>meanlog, sdlog</td>
</tr>
<tr>
<td>Logistic分布</td>
<td>logistic</td>
<td>logis</td>
<td>location, scale</td>
</tr>
<tr>
<td>负二项分布</td>
<td>negative binomial</td>
<td>nbinom</td>
<td>size, prob</td>
</tr>
<tr>
<td>正态分布</td>
<td>normal</td>
<td>norm</td>
<td>mean, sd</td>
</tr>
<tr>
<td>泊松分布</td>
<td>Poisson</td>
<td>pois</td>
<td>lambda</td>
</tr>
<tr>
<td>t分布</td>
<td>Student’s t</td>
<td>t</td>
<td>df, ncp</td>
</tr>
<tr>
<td>均匀分布</td>
<td>uniform</td>
<td>unif</td>
<td>min, max</td>
</tr>
<tr>
<td>Weibull分布</td>
<td>Weibull</td>
<td>weibull</td>
<td>shape, scale</td>
</tr>
<tr>
<td>Wilcoxon秩和分布</td>
<td>Wilcoxon</td>
<td>wilcox</td>
<td>m, n</td>
</tr>
<tr>
<td>Wilcoxon符号秩分布</td>
<td>SignRank</td>
<td>signrank</td>
<td>n</td>
</tr>
<tr>
<td>对数正态分布</td>
<td>Lognormal</td>
<td>lnorm</td>
<td>meanlog, sdlog</td>
</tr>
</tbody>
</table>
<p><code>runif</code>：生成0-1之间的随机数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> runif<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="built_in">min</span><span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span><span class="built_in">max</span><span class="operator">=</span><span class="number">100</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">36.846837</span>  <span class="number">5.020477</span> <span class="number">21.099430</span> <span class="number">97.208172</span> <span class="number">18.753216</span> <span class="number">78.498546</span> <span class="number">79.735780</span> <span class="number">48.014668</span> <span class="number">74.315821</span> <span class="number">36.491041</span></span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> rnorm<span class="punctuation">(</span>n<span class="operator">=</span><span class="number">10</span><span class="punctuation">,</span> mean<span class="operator">=</span><span class="number">15</span><span class="punctuation">,</span> sd<span class="operator">=</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">15.50968</span> <span class="number">15.79180</span> <span class="number">14.99966</span> <span class="number">17.11203</span> <span class="number">15.27945</span> <span class="number">17.26010</span> <span class="number">13.09434</span> <span class="number">13.34831</span> <span class="number">12.28590</span> <span class="number">14.21707</span></span><br></pre></td></tr></table></figure>
<p>通过<code>set.seed</code>则每次运行状态和上次使用set.seed后同样次数下的运行结果相同：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> set.seed<span class="punctuation">(</span><span class="number">666</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> runif<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.77436849</span> <span class="number">0.19722419</span> <span class="number">0.97801384</span> <span class="number">0.20132735</span> <span class="number">0.36124443</span> <span class="number">0.74261194</span> <span class="number">0.97872844</span> <span class="number">0.49811371</span> <span class="number">0.01331584</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="number">0.25994613</span></span><br><span class="line"><span class="operator">&gt;</span> runif<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.77589308</span> <span class="number">0.01637905</span> <span class="number">0.09574478</span> <span class="number">0.14216354</span> <span class="number">0.21112624</span> <span class="number">0.81125644</span> <span class="number">0.03654720</span> <span class="number">0.89163741</span> <span class="number">0.48323641</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="number">0.46666453</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> set.seed<span class="punctuation">(</span><span class="number">666</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> runif<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span> <span class="comment"># 和上次第一次运行结果相同</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.77436849</span> <span class="number">0.19722419</span> <span class="number">0.97801384</span> <span class="number">0.20132735</span> <span class="number">0.36124443</span> <span class="number">0.74261194</span> <span class="number">0.97872844</span> <span class="number">0.49811371</span> <span class="number">0.01331584</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="number">0.25994613</span></span><br><span class="line"><span class="operator">&gt;</span> runif<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span> <span class="comment"># 和上次第二次运行结果相同</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.77589308</span> <span class="number">0.01637905</span> <span class="number">0.09574478</span> <span class="number">0.14216354</span> <span class="number">0.21112624</span> <span class="number">0.81125644</span> <span class="number">0.03654720</span> <span class="number">0.89163741</span> <span class="number">0.48323641</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="number">0.46666453</span></span><br></pre></td></tr></table></figure>
<h3 id="5-3-描述性统计函数">5.3 描述性统计函数</h3>
<h4 id="5-3-1-整体描述函数">5.3.1 整体描述函数</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> myvars <span class="operator">&lt;-</span> mtcars<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;mpg&quot;</span><span class="punctuation">,</span><span class="string">&quot;hp&quot;</span><span class="punctuation">,</span><span class="string">&quot;wt&quot;</span><span class="punctuation">,</span><span class="string">&quot;am&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>myvars<span class="punctuation">)</span></span><br><span class="line">      mpg              hp              wt              am        </span><br><span class="line"> Min.   <span class="operator">:</span><span class="number">10.40</span>   Min.   <span class="operator">:</span> <span class="number">52.0</span>   Min.   <span class="operator">:</span><span class="number">1.513</span>   Min.   <span class="operator">:</span><span class="number">0.0000</span>  </span><br><span class="line"> <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">15.43</span>   <span class="number">1</span>st Qu.<span class="operator">:</span> <span class="number">96.5</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">2.581</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">0.0000</span>  </span><br><span class="line"> Median <span class="operator">:</span><span class="number">19.20</span>   Median <span class="operator">:</span><span class="number">123.0</span>   Median <span class="operator">:</span><span class="number">3.325</span>   Median <span class="operator">:</span><span class="number">0.0000</span>  </span><br><span class="line"> Mean   <span class="operator">:</span><span class="number">20.09</span>   Mean   <span class="operator">:</span><span class="number">146.7</span>   Mean   <span class="operator">:</span><span class="number">3.217</span>   Mean   <span class="operator">:</span><span class="number">0.4062</span>  </span><br><span class="line"> <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">22.80</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">180.0</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">3.610</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">1.0000</span>  </span><br><span class="line"> Max.   <span class="operator">:</span><span class="number">33.90</span>   Max.   <span class="operator">:</span><span class="number">335.0</span>   Max.   <span class="operator">:</span><span class="number">5.424</span>   Max.   <span class="operator">:</span><span class="number">1.0000</span>  </span><br><span class="line"><span class="operator">&gt;</span> fivenum<span class="punctuation">(</span>myvars<span class="operator">$</span>hp<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">52</span>  <span class="number">96</span> <span class="number">123</span> <span class="number">180</span> <span class="number">335</span></span><br></pre></td></tr></table></figure>
<p>总结：通过<code>summary</code>函数可以进行最大值，最小值，均值等的统计。<code>fivenum</code>和<code>summary</code>类似，返回最小值、lower-hinge, 中位数, upper-hinge, 最大值。</p>
<p>类似的包还有<code>Hmisc</code>包中的<code>describe</code>函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> describe<span class="punctuation">(</span>myvars<span class="punctuation">)</span></span><br><span class="line">myvars </span><br><span class="line"></span><br><span class="line"> <span class="number">4</span>  Variables      <span class="number">32</span>  Observations</span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">mpg </span><br><span class="line">       n  <span class="built_in">missing</span> distinct     Info     Mean      Gmd      <span class="number">.05</span>      <span class="number">.10</span>      <span class="number">.25</span>      <span class="number">.50</span>      <span class="number">.75</span>      <span class="number">.90</span> </span><br><span class="line">      <span class="number">32</span>        <span class="number">0</span>       <span class="number">25</span>    <span class="number">0.999</span>    <span class="number">20.09</span>    <span class="number">6.796</span>    <span class="number">12.00</span>    <span class="number">14.34</span>    <span class="number">15.43</span>    <span class="number">19.20</span>    <span class="number">22.80</span>    <span class="number">30.09</span> </span><br><span class="line">     <span class="number">.95</span> </span><br><span class="line">   <span class="number">31.30</span> </span><br><span class="line"></span><br><span class="line">lowest <span class="operator">:</span> <span class="number">10.4</span> <span class="number">13.3</span> <span class="number">14.3</span> <span class="number">14.7</span> <span class="number">15.0</span><span class="punctuation">,</span> highest<span class="operator">:</span> <span class="number">26.0</span> <span class="number">27.3</span> <span class="number">30.4</span> <span class="number">32.4</span> <span class="number">33.9</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">hp </span><br><span class="line">       n  <span class="built_in">missing</span> distinct     Info     Mean      Gmd      <span class="number">.05</span>      <span class="number">.10</span>      <span class="number">.25</span>      <span class="number">.50</span>      <span class="number">.75</span>      <span class="number">.90</span> </span><br><span class="line">      <span class="number">32</span>        <span class="number">0</span>       <span class="number">22</span>    <span class="number">0.997</span>    <span class="number">146.7</span>    <span class="number">77.04</span>    <span class="number">63.65</span>    <span class="number">66.00</span>    <span class="number">96.50</span>   <span class="number">123.00</span>   <span class="number">180.00</span>   <span class="number">243.50</span> </span><br><span class="line">     <span class="number">.95</span> </span><br><span class="line">  <span class="number">253.55</span> </span><br><span class="line"></span><br><span class="line">lowest <span class="operator">:</span>  <span class="number">52</span>  <span class="number">62</span>  <span class="number">65</span>  <span class="number">66</span>  <span class="number">91</span><span class="punctuation">,</span> highest<span class="operator">:</span> <span class="number">215</span> <span class="number">230</span> <span class="number">245</span> <span class="number">264</span> <span class="number">335</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">wt </span><br><span class="line">       n  <span class="built_in">missing</span> distinct     Info     Mean      Gmd      <span class="number">.05</span>      <span class="number">.10</span>      <span class="number">.25</span>      <span class="number">.50</span>      <span class="number">.75</span>      <span class="number">.90</span> </span><br><span class="line">      <span class="number">32</span>        <span class="number">0</span>       <span class="number">29</span>    <span class="number">0.999</span>    <span class="number">3.217</span>    <span class="number">1.089</span>    <span class="number">1.736</span>    <span class="number">1.956</span>    <span class="number">2.581</span>    <span class="number">3.325</span>    <span class="number">3.610</span>    <span class="number">4.048</span> </span><br><span class="line">     <span class="number">.95</span> </span><br><span class="line">   <span class="number">5.293</span> </span><br><span class="line"></span><br><span class="line">lowest <span class="operator">:</span> <span class="number">1.513</span> <span class="number">1.615</span> <span class="number">1.835</span> <span class="number">1.935</span> <span class="number">2.140</span><span class="punctuation">,</span> highest<span class="operator">:</span> <span class="number">3.845</span> <span class="number">4.070</span> <span class="number">5.250</span> <span class="number">5.345</span> <span class="number">5.424</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">am </span><br><span class="line">       n  <span class="built_in">missing</span> distinct     Info      Sum     Mean      Gmd </span><br><span class="line">      <span class="number">32</span>        <span class="number">0</span>        <span class="number">2</span>    <span class="number">0.724</span>       <span class="number">13</span>   <span class="number">0.4062</span>    <span class="number">0.498</span> </span><br><span class="line"></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br></pre></td></tr></table></figure>
<p>可以返回观测的数量、缺失值和唯一值的数目、以及平均值、分位数，五个最大值和五个最小值</p>
<p>再比如<code>pastecs</code>包中的<code>desc</code>函数</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> stat.desc<span class="punctuation">(</span>myvars<span class="punctuation">)</span></span><br><span class="line">                     mpg           hp          wt          am</span><br><span class="line">nbr.val       <span class="number">32.0000000</span>   <span class="number">32.0000000</span>  <span class="number">32.0000000</span> <span class="number">32.00000000</span></span><br><span class="line">nbr.null       <span class="number">0.0000000</span>    <span class="number">0.0000000</span>   <span class="number">0.0000000</span> <span class="number">19.00000000</span></span><br><span class="line">nbr.na         <span class="number">0.0000000</span>    <span class="number">0.0000000</span>   <span class="number">0.0000000</span>  <span class="number">0.00000000</span></span><br><span class="line"><span class="built_in">min</span>           <span class="number">10.4000000</span>   <span class="number">52.0000000</span>   <span class="number">1.5130000</span>  <span class="number">0.00000000</span></span><br><span class="line"><span class="built_in">max</span>           <span class="number">33.9000000</span>  <span class="number">335.0000000</span>   <span class="number">5.4240000</span>  <span class="number">1.00000000</span></span><br><span class="line"><span class="built_in">range</span>         <span class="number">23.5000000</span>  <span class="number">283.0000000</span>   <span class="number">3.9110000</span>  <span class="number">1.00000000</span></span><br><span class="line"><span class="built_in">sum</span>          <span class="number">642.9000000</span> <span class="number">4694.0000000</span> <span class="number">102.9520000</span> <span class="number">13.00000000</span></span><br><span class="line">median        <span class="number">19.2000000</span>  <span class="number">123.0000000</span>   <span class="number">3.3250000</span>  <span class="number">0.00000000</span></span><br><span class="line">mean          <span class="number">20.0906250</span>  <span class="number">146.6875000</span>   <span class="number">3.2172500</span>  <span class="number">0.40625000</span></span><br><span class="line">SE.mean        <span class="number">1.0654240</span>   <span class="number">12.1203173</span>   <span class="number">0.1729685</span>  <span class="number">0.08820997</span></span><br><span class="line">CI.mean.0.95   <span class="number">2.1729465</span>   <span class="number">24.7195501</span>   <span class="number">0.3527715</span>  <span class="number">0.17990541</span></span><br><span class="line">var           <span class="number">36.3241028</span> <span class="number">4700.8669355</span>   <span class="number">0.9573790</span>  <span class="number">0.24899194</span></span><br><span class="line">std.dev        <span class="number">6.0269481</span>   <span class="number">68.5628685</span>   <span class="number">0.9784574</span>  <span class="number">0.49899092</span></span><br><span class="line">coef.var       <span class="number">0.2999881</span>    <span class="number">0.4674077</span>   <span class="number">0.3041285</span>  <span class="number">1.22828533</span></span><br><span class="line"><span class="operator">&gt;</span> stat.desc<span class="punctuation">(</span>myvars<span class="punctuation">,</span>basic <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># basic = T表示用来计算基本值</span></span><br><span class="line">                     mpg           hp          wt          am</span><br><span class="line">nbr.val       <span class="number">32.0000000</span>   <span class="number">32.0000000</span>  <span class="number">32.0000000</span> <span class="number">32.00000000</span></span><br><span class="line">nbr.null       <span class="number">0.0000000</span>    <span class="number">0.0000000</span>   <span class="number">0.0000000</span> <span class="number">19.00000000</span></span><br><span class="line">nbr.na         <span class="number">0.0000000</span>    <span class="number">0.0000000</span>   <span class="number">0.0000000</span>  <span class="number">0.00000000</span></span><br><span class="line"><span class="built_in">min</span>           <span class="number">10.4000000</span>   <span class="number">52.0000000</span>   <span class="number">1.5130000</span>  <span class="number">0.00000000</span></span><br><span class="line"><span class="built_in">max</span>           <span class="number">33.9000000</span>  <span class="number">335.0000000</span>   <span class="number">5.4240000</span>  <span class="number">1.00000000</span></span><br><span class="line"><span class="built_in">range</span>         <span class="number">23.5000000</span>  <span class="number">283.0000000</span>   <span class="number">3.9110000</span>  <span class="number">1.00000000</span></span><br><span class="line"><span class="built_in">sum</span>          <span class="number">642.9000000</span> <span class="number">4694.0000000</span> <span class="number">102.9520000</span> <span class="number">13.00000000</span></span><br><span class="line">median        <span class="number">19.2000000</span>  <span class="number">123.0000000</span>   <span class="number">3.3250000</span>  <span class="number">0.00000000</span></span><br><span class="line">mean          <span class="number">20.0906250</span>  <span class="number">146.6875000</span>   <span class="number">3.2172500</span>  <span class="number">0.40625000</span></span><br><span class="line">SE.mean        <span class="number">1.0654240</span>   <span class="number">12.1203173</span>   <span class="number">0.1729685</span>  <span class="number">0.08820997</span></span><br><span class="line">CI.mean.0.95   <span class="number">2.1729465</span>   <span class="number">24.7195501</span>   <span class="number">0.3527715</span>  <span class="number">0.17990541</span></span><br><span class="line">var           <span class="number">36.3241028</span> <span class="number">4700.8669355</span>   <span class="number">0.9573790</span>  <span class="number">0.24899194</span></span><br><span class="line">std.dev        <span class="number">6.0269481</span>   <span class="number">68.5628685</span>   <span class="number">0.9784574</span>  <span class="number">0.49899092</span></span><br><span class="line">coef.var       <span class="number">0.2999881</span>    <span class="number">0.4674077</span>   <span class="number">0.3041285</span>  <span class="number">1.22828533</span></span><br><span class="line"><span class="operator">&gt;</span> stat.desc<span class="punctuation">(</span>myvars<span class="punctuation">,</span>desc <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># 计算一些描述值，中位数，平均数，平均置信度为95%的置信空间</span></span><br><span class="line">                     mpg           hp          wt          am</span><br><span class="line">nbr.val       <span class="number">32.0000000</span>   <span class="number">32.0000000</span>  <span class="number">32.0000000</span> <span class="number">32.00000000</span></span><br><span class="line">nbr.null       <span class="number">0.0000000</span>    <span class="number">0.0000000</span>   <span class="number">0.0000000</span> <span class="number">19.00000000</span></span><br><span class="line">nbr.na         <span class="number">0.0000000</span>    <span class="number">0.0000000</span>   <span class="number">0.0000000</span>  <span class="number">0.00000000</span></span><br><span class="line"><span class="built_in">min</span>           <span class="number">10.4000000</span>   <span class="number">52.0000000</span>   <span class="number">1.5130000</span>  <span class="number">0.00000000</span></span><br><span class="line"><span class="built_in">max</span>           <span class="number">33.9000000</span>  <span class="number">335.0000000</span>   <span class="number">5.4240000</span>  <span class="number">1.00000000</span></span><br><span class="line"><span class="built_in">range</span>         <span class="number">23.5000000</span>  <span class="number">283.0000000</span>   <span class="number">3.9110000</span>  <span class="number">1.00000000</span></span><br><span class="line"><span class="built_in">sum</span>          <span class="number">642.9000000</span> <span class="number">4694.0000000</span> <span class="number">102.9520000</span> <span class="number">13.00000000</span></span><br><span class="line">median        <span class="number">19.2000000</span>  <span class="number">123.0000000</span>   <span class="number">3.3250000</span>  <span class="number">0.00000000</span></span><br><span class="line">mean          <span class="number">20.0906250</span>  <span class="number">146.6875000</span>   <span class="number">3.2172500</span>  <span class="number">0.40625000</span></span><br><span class="line">SE.mean        <span class="number">1.0654240</span>   <span class="number">12.1203173</span>   <span class="number">0.1729685</span>  <span class="number">0.08820997</span></span><br><span class="line">CI.mean.0.95   <span class="number">2.1729465</span>   <span class="number">24.7195501</span>   <span class="number">0.3527715</span>  <span class="number">0.17990541</span></span><br><span class="line">var           <span class="number">36.3241028</span> <span class="number">4700.8669355</span>   <span class="number">0.9573790</span>  <span class="number">0.24899194</span></span><br><span class="line">std.dev        <span class="number">6.0269481</span>   <span class="number">68.5628685</span>   <span class="number">0.9784574</span>  <span class="number">0.49899092</span></span><br><span class="line">coef.var       <span class="number">0.2999881</span>    <span class="number">0.4674077</span>   <span class="number">0.3041285</span>  <span class="number">1.22828533</span></span><br><span class="line"><span class="operator">&gt;</span> stat.desc<span class="punctuation">(</span>myvars<span class="punctuation">,</span>norm <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment">#计算一些统计值，包括正态分布统计量、偏度和峰度等。</span></span><br><span class="line">                     mpg            hp           wt            am</span><br><span class="line">nbr.val       <span class="number">32.0000000</span>   <span class="number">32.00000000</span>  <span class="number">32.00000000</span>  <span class="number">3.200000e+01</span></span><br><span class="line">nbr.null       <span class="number">0.0000000</span>    <span class="number">0.00000000</span>   <span class="number">0.00000000</span>  <span class="number">1.900000e+01</span></span><br><span class="line">nbr.na         <span class="number">0.0000000</span>    <span class="number">0.00000000</span>   <span class="number">0.00000000</span>  <span class="number">0.000000e+00</span></span><br><span class="line"><span class="built_in">min</span>           <span class="number">10.4000000</span>   <span class="number">52.00000000</span>   <span class="number">1.51300000</span>  <span class="number">0.000000e+00</span></span><br><span class="line"><span class="built_in">max</span>           <span class="number">33.9000000</span>  <span class="number">335.00000000</span>   <span class="number">5.42400000</span>  <span class="number">1.000000e+00</span></span><br><span class="line"><span class="built_in">range</span>         <span class="number">23.5000000</span>  <span class="number">283.00000000</span>   <span class="number">3.91100000</span>  <span class="number">1.000000e+00</span></span><br><span class="line"><span class="built_in">sum</span>          <span class="number">642.9000000</span> <span class="number">4694.00000000</span> <span class="number">102.95200000</span>  <span class="number">1.300000e+01</span></span><br><span class="line">median        <span class="number">19.2000000</span>  <span class="number">123.00000000</span>   <span class="number">3.32500000</span>  <span class="number">0.000000e+00</span></span><br><span class="line">mean          <span class="number">20.0906250</span>  <span class="number">146.68750000</span>   <span class="number">3.21725000</span>  <span class="number">4.062500e-01</span></span><br><span class="line">SE.mean        <span class="number">1.0654240</span>   <span class="number">12.12031731</span>   <span class="number">0.17296847</span>  <span class="number">8.820997e-02</span></span><br><span class="line">CI.mean.0.95   <span class="number">2.1729465</span>   <span class="number">24.71955013</span>   <span class="number">0.35277153</span>  <span class="number">1.799054e-01</span></span><br><span class="line">var           <span class="number">36.3241028</span> <span class="number">4700.86693548</span>   <span class="number">0.95737897</span>  <span class="number">2.489919e-01</span></span><br><span class="line">std.dev        <span class="number">6.0269481</span>   <span class="number">68.56286849</span>   <span class="number">0.97845744</span>  <span class="number">4.989909e-01</span></span><br><span class="line">coef.var       <span class="number">0.2999881</span>    <span class="number">0.46740771</span>   <span class="number">0.30412851</span>  <span class="number">1.228285e+00</span></span><br><span class="line">skewness       <span class="number">0.6106550</span>    <span class="number">0.72602366</span>   <span class="number">0.42314646</span>  <span class="number">3.640159e-01</span></span><br><span class="line">skew.2SE       <span class="number">0.7366922</span>    <span class="number">0.87587259</span>   <span class="number">0.51048252</span>  <span class="number">4.391476e-01</span></span><br><span class="line">kurtosis      <span class="operator">-</span><span class="number">0.3727660</span>   <span class="operator">-</span><span class="number">0.13555112</span>  <span class="operator">-</span><span class="number">0.02271075</span> <span class="operator">-</span><span class="number">1.924741e+00</span></span><br><span class="line">kurt.2SE      <span class="operator">-</span><span class="number">0.2302812</span>   <span class="operator">-</span><span class="number">0.08373853</span>  <span class="operator">-</span><span class="number">0.01402987</span> <span class="operator">-</span><span class="number">1.189035e+00</span></span><br><span class="line">normtest.W     <span class="number">0.9475647</span>    <span class="number">0.93341934</span>   <span class="number">0.94325772</span>  <span class="number">6.250744e-01</span></span><br><span class="line">normtest.p     <span class="number">0.1228814</span>    <span class="number">0.04880824</span>   <span class="number">0.09265499</span>  <span class="number">7.836354e-08</span></span><br></pre></td></tr></table></figure>
<p>在<code>psych</code>包中，同样包含describe函数，可以计算非缺失值的数量。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> describe<span class="punctuation">(</span>myvars<span class="punctuation">)</span></span><br><span class="line">    vars  n   mean    sd median trimmed   mad   <span class="built_in">min</span>    <span class="built_in">max</span>  <span class="built_in">range</span> skew kurtosis    se</span><br><span class="line">mpg    <span class="number">1</span> <span class="number">32</span>  <span class="number">20.09</span>  <span class="number">6.03</span>  <span class="number">19.20</span>   <span class="number">19.70</span>  <span class="number">5.41</span> <span class="number">10.40</span>  <span class="number">33.90</span>  <span class="number">23.50</span> <span class="number">0.61</span>    <span class="operator">-</span><span class="number">0.37</span>  <span class="number">1.07</span></span><br><span class="line">hp     <span class="number">2</span> <span class="number">32</span> <span class="number">146.69</span> <span class="number">68.56</span> <span class="number">123.00</span>  <span class="number">141.19</span> <span class="number">77.10</span> <span class="number">52.00</span> <span class="number">335.00</span> <span class="number">283.00</span> <span class="number">0.73</span>    <span class="operator">-</span><span class="number">0.14</span> <span class="number">12.12</span></span><br><span class="line">wt     <span class="number">3</span> <span class="number">32</span>   <span class="number">3.22</span>  <span class="number">0.98</span>   <span class="number">3.33</span>    <span class="number">3.15</span>  <span class="number">0.77</span>  <span class="number">1.51</span>   <span class="number">5.42</span>   <span class="number">3.91</span> <span class="number">0.42</span>    <span class="operator">-</span><span class="number">0.02</span>  <span class="number">0.17</span></span><br><span class="line">am     <span class="number">4</span> <span class="number">32</span>   <span class="number">0.41</span>  <span class="number">0.50</span>   <span class="number">0.00</span>    <span class="number">0.38</span>  <span class="number">0.00</span>  <span class="number">0.00</span>   <span class="number">1.00</span>   <span class="number">1.00</span> <span class="number">0.36</span>    <span class="operator">-</span><span class="number">1.92</span>  <span class="number">0.09</span></span><br><span class="line"><span class="operator">&gt;</span> describe<span class="punctuation">(</span>myvars<span class="punctuation">,</span>trim <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">)</span></span><br><span class="line">    vars  n   mean    sd median trimmed   mad   <span class="built_in">min</span>    <span class="built_in">max</span>  <span class="built_in">range</span> skew kurtosis    se</span><br><span class="line">mpg    <span class="number">1</span> <span class="number">32</span>  <span class="number">20.09</span>  <span class="number">6.03</span>  <span class="number">19.20</span>   <span class="number">19.70</span>  <span class="number">5.41</span> <span class="number">10.40</span>  <span class="number">33.90</span>  <span class="number">23.50</span> <span class="number">0.61</span>    <span class="operator">-</span><span class="number">0.37</span>  <span class="number">1.07</span></span><br><span class="line">hp     <span class="number">2</span> <span class="number">32</span> <span class="number">146.69</span> <span class="number">68.56</span> <span class="number">123.00</span>  <span class="number">141.19</span> <span class="number">77.10</span> <span class="number">52.00</span> <span class="number">335.00</span> <span class="number">283.00</span> <span class="number">0.73</span>    <span class="operator">-</span><span class="number">0.14</span> <span class="number">12.12</span></span><br><span class="line">wt     <span class="number">3</span> <span class="number">32</span>   <span class="number">3.22</span>  <span class="number">0.98</span>   <span class="number">3.33</span>    <span class="number">3.15</span>  <span class="number">0.77</span>  <span class="number">1.51</span>   <span class="number">5.42</span>   <span class="number">3.91</span> <span class="number">0.42</span>    <span class="operator">-</span><span class="number">0.02</span>  <span class="number">0.17</span></span><br><span class="line">am     <span class="number">4</span> <span class="number">32</span>   <span class="number">0.41</span>  <span class="number">0.50</span>   <span class="number">0.00</span>    <span class="number">0.38</span>  <span class="number">0.00</span>  <span class="number">0.00</span>   <span class="number">1.00</span>   <span class="number">1.00</span> <span class="number">0.36</span>    <span class="operator">-</span><span class="number">1.92</span>  <span class="number">0.09</span></span><br></pre></td></tr></table></figure>
<p>同样可以计算非缺失值的数量、平均数、中位数、最大值、最小值等。<code>trim = 0.1</code>表示去掉最低和最高10%的部分。</p>
<p>后载入的包中如果函数名字和前面载入的包中函数名字重复，会将前面载入的包的函数覆盖，如果想重新使用前面载入的包的函数，可以选择重新载入前面载入的包。也可以使用<code>包名::函数名</code>的方法使用前面的包中的函数。</p>
<h4 id="5-3-2-分组描述函数">5.3.2 分组描述函数</h4>
<p><code>stats</code>包中可以通过<code>aggregate</code>进行分组描述数据：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>Cars93<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Min.Price&quot;</span><span class="punctuation">,</span><span class="string">&quot;Price&quot;</span><span class="punctuation">,</span><span class="string">&quot;Max.Price&quot;</span><span class="punctuation">,</span><span class="string">&quot;MPG.city&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span>by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>Cars93<span class="operator">$</span>Origin<span class="punctuation">)</span><span class="punctuation">,</span>mean<span class="punctuation">)</span></span><br><span class="line">  Group.1 Min.Price    Price Max.Price MPG.city</span><br><span class="line"><span class="number">1</span>     USA  <span class="number">16.53542</span> <span class="number">18.57292</span>  <span class="number">20.62708</span> <span class="number">20.95833</span></span><br><span class="line"><span class="number">2</span> non<span class="operator">-</span>USA  <span class="number">17.75556</span> <span class="number">20.50889</span>  <span class="number">23.25556</span> <span class="number">23.86667</span></span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>Cars93<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Min.Price&quot;</span><span class="punctuation">,</span><span class="string">&quot;Price&quot;</span><span class="punctuation">,</span><span class="string">&quot;Max.Price&quot;</span><span class="punctuation">,</span><span class="string">&quot;MPG.city&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span>by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>Origin<span class="operator">=</span>Cars93<span class="operator">$</span>Origin<span class="punctuation">,</span>Manufacturer<span class="operator">=</span>Cars93<span class="operator">$</span>Manufacturer<span class="punctuation">)</span><span class="punctuation">,</span>mean<span class="punctuation">)</span>  <span class="comment"># 也可以同时设定多个条件</span></span><br><span class="line">    Origin  Manufacturer Min.Price    Price Max.Price MPG.city</span><br><span class="line"><span class="number">1</span>  non<span class="operator">-</span>USA         Acura  <span class="number">21.05000</span> <span class="number">24.90000</span>    <span class="number">28.750</span> <span class="number">21.50000</span></span><br><span class="line"><span class="number">2</span>  non<span class="operator">-</span>USA          Audi  <span class="number">28.35000</span> <span class="number">33.40000</span>    <span class="number">38.450</span> <span class="number">19.50000</span></span><br><span class="line"><span class="number">3</span>  non<span class="operator">-</span>USA           BMW  <span class="number">23.70000</span> <span class="number">30.00000</span>    <span class="number">36.200</span> <span class="number">22.00000</span></span><br><span class="line"><span class="number">4</span>      USA         Buick  <span class="number">20.75000</span> <span class="number">21.62500</span>    <span class="number">22.550</span> <span class="number">19.00000</span></span><br><span class="line"><span class="number">5</span>      USA      Cadillac  <span class="number">35.25000</span> <span class="number">37.40000</span>    <span class="number">39.500</span> <span class="number">16.00000</span></span><br><span class="line">...</span><br><span class="line"><span class="number">26</span> non<span class="operator">-</span>USA          Saab  <span class="number">20.30000</span> <span class="number">28.70000</span>    <span class="number">37.100</span> <span class="number">20.00000</span></span><br><span class="line"><span class="number">27</span>     USA        Saturn   <span class="number">9.20000</span> <span class="number">11.10000</span>    <span class="number">12.900</span> <span class="number">28.00000</span></span><br><span class="line"><span class="number">28</span> non<span class="operator">-</span>USA        Subaru  <span class="number">11.36667</span> <span class="number">12.93333</span>    <span class="number">14.500</span> <span class="number">27.00000</span></span><br><span class="line"><span class="number">29</span> non<span class="operator">-</span>USA        Suzuki   <span class="number">7.30000</span>  <span class="number">8.60000</span>    <span class="number">10.000</span> <span class="number">39.00000</span></span><br><span class="line"><span class="number">30</span> non<span class="operator">-</span>USA        Toyota  <span class="number">14.02500</span> <span class="number">17.27500</span>    <span class="number">20.550</span> <span class="number">24.25000</span></span><br><span class="line"><span class="number">31</span> non<span class="operator">-</span>USA    Volkswagen  <span class="number">16.45000</span> <span class="number">18.02500</span>    <span class="number">19.575</span> <span class="number">20.25000</span></span><br><span class="line"><span class="number">32</span> non<span class="operator">-</span>USA         Volvo  <span class="number">23.30000</span> <span class="number">24.70000</span>    <span class="number">26.000</span> <span class="number">20.50000</span></span><br></pre></td></tr></table></figure>
<p><code>doBy</code>包中<code>summaryBy</code>函数也可以进行分组描述数据：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>doBy<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summaryBy<span class="punctuation">(</span>mpg<span class="operator">+</span>hp<span class="operator">+</span>wt <span class="operator">~</span> am<span class="punctuation">,</span>data<span class="operator">=</span>myvars<span class="punctuation">,</span>FUN<span class="operator">=</span>mean<span class="punctuation">)</span></span><br><span class="line">  am mpg.mean  hp.mean  wt.mean</span><br><span class="line"><span class="number">1</span>  <span class="number">0</span> <span class="number">17.14737</span> <span class="number">160.2632</span> <span class="number">3.768895</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1</span> <span class="number">24.39231</span> <span class="number">126.8462</span> <span class="number">2.411000</span></span><br></pre></td></tr></table></figure>
<p><code>psych</code>包中的<code>describeBy</code>函数可以进行分组描述数据，但是给出的统计值都是自定义不变的，无法给出自定义的函数的统计值。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> describeBy<span class="punctuation">(</span>myvars<span class="punctuation">,</span><span class="built_in">list</span><span class="punctuation">(</span>am<span class="operator">=</span>mtcars<span class="operator">$</span>am<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"> Descriptive statistics by group </span><br><span class="line">am<span class="operator">:</span> <span class="number">0</span></span><br><span class="line">    vars  n   mean    sd median trimmed   mad   <span class="built_in">min</span>    <span class="built_in">max</span>  <span class="built_in">range</span>  skew kurtosis    se</span><br><span class="line">mpg    <span class="number">1</span> <span class="number">19</span>  <span class="number">17.15</span>  <span class="number">3.83</span>  <span class="number">17.30</span>   <span class="number">17.12</span>  <span class="number">3.11</span> <span class="number">10.40</span>  <span class="number">24.40</span>  <span class="number">14.00</span>  <span class="number">0.01</span>    <span class="operator">-</span><span class="number">0.80</span>  <span class="number">0.88</span></span><br><span class="line">hp     <span class="number">2</span> <span class="number">19</span> <span class="number">160.26</span> <span class="number">53.91</span> <span class="number">175.00</span>  <span class="number">161.06</span> <span class="number">77.10</span> <span class="number">62.00</span> <span class="number">245.00</span> <span class="number">183.00</span> <span class="operator">-</span><span class="number">0.01</span>    <span class="operator">-</span><span class="number">1.21</span> <span class="number">12.37</span></span><br><span class="line">wt     <span class="number">3</span> <span class="number">19</span>   <span class="number">3.77</span>  <span class="number">0.78</span>   <span class="number">3.52</span>    <span class="number">3.75</span>  <span class="number">0.45</span>  <span class="number">2.46</span>   <span class="number">5.42</span>   <span class="number">2.96</span>  <span class="number">0.98</span>     <span class="number">0.14</span>  <span class="number">0.18</span></span><br><span class="line">am     <span class="number">4</span> <span class="number">19</span>   <span class="number">0.00</span>  <span class="number">0.00</span>   <span class="number">0.00</span>    <span class="number">0.00</span>  <span class="number">0.00</span>  <span class="number">0.00</span>   <span class="number">0.00</span>   <span class="number">0.00</span>   <span class="literal">NaN</span>      <span class="literal">NaN</span>  <span class="number">0.00</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span> </span><br><span class="line">am<span class="operator">:</span> <span class="number">1</span></span><br><span class="line">    vars  n   mean    sd median trimmed   mad   <span class="built_in">min</span>    <span class="built_in">max</span>  <span class="built_in">range</span> skew kurtosis    se</span><br><span class="line">mpg    <span class="number">1</span> <span class="number">13</span>  <span class="number">24.39</span>  <span class="number">6.17</span>  <span class="number">22.80</span>   <span class="number">24.38</span>  <span class="number">6.67</span> <span class="number">15.00</span>  <span class="number">33.90</span>  <span class="number">18.90</span> <span class="number">0.05</span>    <span class="operator">-</span><span class="number">1.46</span>  <span class="number">1.71</span></span><br><span class="line">hp     <span class="number">2</span> <span class="number">13</span> <span class="number">126.85</span> <span class="number">84.06</span> <span class="number">109.00</span>  <span class="number">114.73</span> <span class="number">63.75</span> <span class="number">52.00</span> <span class="number">335.00</span> <span class="number">283.00</span> <span class="number">1.36</span>     <span class="number">0.56</span> <span class="number">23.31</span></span><br><span class="line">wt     <span class="number">3</span> <span class="number">13</span>   <span class="number">2.41</span>  <span class="number">0.62</span>   <span class="number">2.32</span>    <span class="number">2.39</span>  <span class="number">0.68</span>  <span class="number">1.51</span>   <span class="number">3.57</span>   <span class="number">2.06</span> <span class="number">0.21</span>    <span class="operator">-</span><span class="number">1.17</span>  <span class="number">0.17</span></span><br><span class="line">am     <span class="number">4</span> <span class="number">13</span>   <span class="number">1.00</span>  <span class="number">0.00</span>   <span class="number">1.00</span>    <span class="number">1.00</span>  <span class="number">0.00</span>  <span class="number">1.00</span>   <span class="number">1.00</span>   <span class="number">0.00</span>  <span class="literal">NaN</span>      <span class="literal">NaN</span>  <span class="number">0.00</span></span><br></pre></td></tr></table></figure>
<h3 id="5-4-频数统计函数">5.4 频数统计函数</h3>
<p>因子是专门用来分组的，分组后才能进行频数的统计。</p>
<p>如果数据本身就是因子，则直接可以进行分组。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mtcars<span class="operator">$</span>cyl <span class="operator">&lt;-</span> as.factor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> mtcars<span class="operator">$</span>cyl</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6</span> <span class="number">6</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">6</span> <span class="number">6</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span></span><br><span class="line">Levels<span class="operator">:</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span></span><br><span class="line"><span class="operator">&gt;</span> mtcars</span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb               Model</span><br><span class="line">Mazda RX4           <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span>           Mazda RX4</span><br><span class="line">Mazda RX4 Wag       <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span>       Mazda RX4 Wag</span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span>          Datsun <span class="number">710</span></span><br><span class="line">...</span><br><span class="line">Ferrari Dino        <span class="number">19.7</span>   <span class="number">6</span> <span class="number">145.0</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.770</span> <span class="number">15.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span>        Ferrari Dino</span><br><span class="line">Maserati Bora       <span class="number">15.0</span>   <span class="number">8</span> <span class="number">301.0</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span>       Maserati Bora</span><br><span class="line">Volvo <span class="number">142</span>E          <span class="number">21.4</span>   <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span>          Volvo <span class="number">142</span>E</span><br><span class="line"><span class="operator">&gt;</span> split<span class="punctuation">(</span>mtcars<span class="punctuation">,</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>`<span class="number">4</span>`</span><br><span class="line">                mpg cyl  disp  hp drat    wt  qsec vs am gear carb          Model</span><br><span class="line">Datsun 710     22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1     Datsun 710</span><br><span class="line">Merc 240D      24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2      Merc 240D</span><br><span class="line">Merc 230       22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2       Merc 230</span><br><span class="line">Fiat 128       32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1       Fiat 128</span><br><span class="line">Honda Civic    30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2    Honda Civic</span><br><span class="line">Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1 Toyota Corolla</span><br><span class="line">Toyota Corona  21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1  Toyota Corona</span><br><span class="line">Fiat X1-9      27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1      Fiat X1-9</span><br><span class="line">Porsche 914-2  26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2  Porsche 914-2</span><br><span class="line">Lotus Europa   30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2   Lotus Europa</span><br><span class="line">Volvo 142E     21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2     Volvo 142E</span><br><span class="line"></span><br><span class="line">$`6`</span><br><span class="line">                mpg cyl  disp  hp drat    wt  qsec vs am gear carb          Model</span><br><span class="line">Mazda RX4      21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4      Mazda RX4</span><br><span class="line">Mazda RX4 Wag  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4  Mazda RX4 Wag</span><br><span class="line">Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1 Hornet 4 Drive</span><br><span class="line">Valiant        18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1        Valiant</span><br><span class="line">Merc 280       19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4       Merc 280</span><br><span class="line">Merc 280C      17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4      Merc 280C</span><br><span class="line">Ferrari Dino   19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6   Ferrari Dino</span><br><span class="line"></span><br><span class="line">$`8`</span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb               Model</span><br><span class="line">Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2   Hornet Sportabout</span><br><span class="line">Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4          Duster 360</span><br><span class="line">Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3          Merc 450SE</span><br><span class="line">Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3          Merc 450SL</span><br><span class="line">Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3         Merc 450SLC</span><br><span class="line">Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4  Cadillac Fleetwood</span><br><span class="line">Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4 Lincoln Continental</span><br><span class="line">Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4   Chrysler Imperial</span><br><span class="line">Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2    Dodge Challenger</span><br><span class="line">AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2         AMC Javelin</span><br><span class="line">Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4          Camaro Z28</span><br><span class="line">Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2    Pontiac Firebird</span><br><span class="line">Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4      Ford Pantera L</span><br><span class="line">Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8       Maserati Bora</span><br></pre></td></tr></table></figure>
<p>如果不是明显的因子，可以使用cut函数进行切割：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> cut<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 从10-50切割，每个切割块是10</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">14</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">27</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span></span><br><span class="line">Levels<span class="operator">:</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>cut<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span> </span><br><span class="line">     <span class="number">18</span>      <span class="number">10</span>       <span class="number">4</span>       <span class="number">0</span> </span><br><span class="line">     </span><br><span class="line"><span class="operator">&gt;</span> prop.table<span class="punctuation">(</span>table<span class="punctuation">(</span>cut<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">30</span><span class="punctuation">,</span><span class="number">40</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">40</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">]</span> </span><br><span class="line"> <span class="number">0.5625</span>  <span class="number">0.3125</span>  <span class="number">0.1250</span>  <span class="number">0.0000</span> </span><br></pre></td></tr></table></figure>
<p>也可以对二维数据表进行描述，比如给table函数输入两个因子，就可以计算二维的列联表。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> Arthritis</span><br><span class="line">   ID Treatment    Sex Age Improved</span><br><span class="line"><span class="number">1</span>  <span class="number">57</span>   Treated   Male  <span class="number">27</span>     Some</span><br><span class="line"><span class="number">2</span>  <span class="number">46</span>   Treated   Male  <span class="number">29</span>     None</span><br><span class="line"><span class="number">3</span>  <span class="number">77</span>   Treated   Male  <span class="number">30</span>     None</span><br><span class="line">...</span><br><span class="line"><span class="number">82</span> <span class="number">15</span>   Placebo Female  <span class="number">66</span>     Some</span><br><span class="line"><span class="number">83</span> <span class="number">71</span>   Placebo Female  <span class="number">68</span>     Some</span><br><span class="line"><span class="number">84</span>  <span class="number">1</span>   Placebo Female  <span class="number">74</span>   Marked</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>Arthritis<span class="operator">$</span>Treatment<span class="punctuation">,</span>Arthritis<span class="operator">$</span>Improved<span class="punctuation">)</span></span><br><span class="line">          None Some Marked</span><br><span class="line">  Placebo   <span class="number">29</span>    <span class="number">7</span>      <span class="number">7</span></span><br><span class="line">  Treated   <span class="number">13</span>    <span class="number">7</span>     <span class="number">21</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> with<span class="punctuation">(</span>data <span class="operator">=</span> Arthritis<span class="punctuation">,</span><span class="punctuation">&#123;</span>table<span class="punctuation">(</span>Treatment<span class="punctuation">,</span>Improved<span class="punctuation">)</span><span class="punctuation">&#125;</span><span class="punctuation">)</span> <span class="comment"># 如果变量太多，可以用with先加载数据</span></span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   <span class="number">29</span>    <span class="number">7</span>      <span class="number">7</span></span><br><span class="line">  Treated   <span class="number">13</span>    <span class="number">7</span>     <span class="number">21</span></span><br></pre></td></tr></table></figure>
<p>如果变量太多，可以用<code>with</code>先加载数据。</p>
<p>处理列联表还可以使用<code>xtabs</code>函数</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> xtabs<span class="punctuation">(</span><span class="operator">~</span> Treatment<span class="operator">+</span>Improved<span class="punctuation">,</span>data <span class="operator">=</span> Arthritis<span class="punctuation">)</span> <span class="comment"># ~ 位置可以是公式，也可以省略。</span></span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   <span class="number">29</span>    <span class="number">7</span>      <span class="number">7</span></span><br><span class="line">  Treated   <span class="number">13</span>    <span class="number">7</span>     <span class="number">21</span></span><br></pre></td></tr></table></figure>
<p><code>~</code>位置可以是公式，也可以省略。</p>
<p><code>margin.table</code>函数可以单独根据一行或一列进行频数统计。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> xtabs<span class="punctuation">(</span><span class="operator">~</span> Treatment<span class="operator">+</span>Improved<span class="punctuation">,</span>data <span class="operator">=</span> Arthritis<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   <span class="number">29</span>    <span class="number">7</span>      <span class="number">7</span></span><br><span class="line">  Treated   <span class="number">13</span>    <span class="number">7</span>     <span class="number">21</span></span><br><span class="line"><span class="operator">&gt;</span> margin.table<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">84</span></span><br><span class="line"><span class="operator">&gt;</span> margin.table<span class="punctuation">(</span>x<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span> <span class="comment"># 求出每行的频数和</span></span><br><span class="line">Treatment</span><br><span class="line">Placebo Treated </span><br><span class="line">     <span class="number">43</span>      <span class="number">41</span> </span><br><span class="line"><span class="operator">&gt;</span> margin.table<span class="punctuation">(</span>x<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span> <span class="comment"># 求出每列的频数和</span></span><br><span class="line">Improved</span><br><span class="line">  None   Some Marked </span><br><span class="line">    <span class="number">42</span>     <span class="number">14</span>     <span class="number">28</span> </span><br><span class="line"><span class="operator">&gt;</span> prop.table<span class="punctuation">(</span>x<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span> <span class="comment"># 得到行的频数比例</span></span><br><span class="line">         Improved</span><br><span class="line">Treatment      None      Some    Marked</span><br><span class="line">  Placebo <span class="number">0.6744186</span> <span class="number">0.1627907</span> <span class="number">0.1627907</span></span><br><span class="line">  Treated <span class="number">0.3170732</span> <span class="number">0.1707317</span> <span class="number">0.5121951</span></span><br><span class="line"><span class="operator">&gt;</span> addmargins<span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="comment"># 将频数的和添加到频数表中，既有行也有列</span></span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked Sum</span><br><span class="line">  Placebo   <span class="number">29</span>    <span class="number">7</span>      <span class="number">7</span>  <span class="number">43</span></span><br><span class="line">  Treated   <span class="number">13</span>    <span class="number">7</span>     <span class="number">21</span>  <span class="number">41</span></span><br><span class="line">  Sum       <span class="number">42</span>   <span class="number">14</span>     <span class="number">28</span>  <span class="number">84</span></span><br><span class="line"><span class="operator">&gt;</span> addmargins<span class="punctuation">(</span>x<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span> <span class="comment"># 只添加频数的和到列中</span></span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   <span class="number">29</span>    <span class="number">7</span>      <span class="number">7</span></span><br><span class="line">  Treated   <span class="number">13</span>    <span class="number">7</span>     <span class="number">21</span></span><br><span class="line">  Sum       <span class="number">42</span>   <span class="number">14</span>     <span class="number">28</span></span><br><span class="line"><span class="operator">&gt;</span> addmargins<span class="punctuation">(</span>x<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span> <span class="comment"># 只添加频数的和到列中</span></span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked Sum</span><br><span class="line">  Placebo   <span class="number">29</span>    <span class="number">7</span>      <span class="number">7</span>  <span class="number">43</span></span><br><span class="line">  Treated   <span class="number">13</span>    <span class="number">7</span>     <span class="number">21</span>  <span class="number">41</span></span><br></pre></td></tr></table></figure>
<p>也可以进行三维列联表统计：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> y <span class="operator">&lt;-</span> xtabs<span class="punctuation">(</span><span class="operator">~</span> Treatment<span class="operator">+</span>Improved<span class="operator">+</span>Sex<span class="punctuation">,</span>data <span class="operator">=</span> Arthritis<span class="punctuation">)</span> <span class="comment"># 三维列联表频数统计</span></span><br><span class="line"><span class="operator">&gt;</span> y</span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> Sex <span class="operator">=</span> Female</span><br><span class="line"></span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   <span class="number">19</span>    <span class="number">7</span>      <span class="number">6</span></span><br><span class="line">  Treated    <span class="number">6</span>    <span class="number">5</span>     <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> Sex <span class="operator">=</span> Male</span><br><span class="line"></span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   <span class="number">10</span>    <span class="number">0</span>      <span class="number">1</span></span><br><span class="line">  Treated    <span class="number">7</span>    <span class="number">2</span>      <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> ftable<span class="punctuation">(</span>y<span class="punctuation">)</span>  <span class="comment"># 可以将结果转换成平铺式的列联表。</span></span><br><span class="line">                   Sex Female Male</span><br><span class="line">Treatment Improved                </span><br><span class="line">Placebo   None             <span class="number">19</span>   <span class="number">10</span></span><br><span class="line">          Some              <span class="number">7</span>    <span class="number">0</span></span><br><span class="line">          Marked            <span class="number">6</span>    <span class="number">1</span></span><br><span class="line">Treated   None              <span class="number">6</span>    <span class="number">7</span></span><br><span class="line">          Some              <span class="number">5</span>    <span class="number">2</span></span><br><span class="line">          Marked           <span class="number">16</span>    <span class="number">5</span></span><br></pre></td></tr></table></figure>
<h3 id="5-5-独立性检验函数">5.5 独立性检验函数</h3>
<p>独立性检验是根据频数信息判断两类因子彼此相关或相互独立的假设检验。所谓独立性就是指变量之间是独立的，没有关系。</p>
<p>三种独立性检验方法：</p>
<ul>
<li>卡方检验</li>
<li>Fisher检验</li>
<li>Cochran-Mantel-Haenszel检验</li>
</ul>
<p>假设检验（Hypothesis Testing）是数理统计学中根据一定假设条件由样本推断总体的一种方法。</p>
<p>原假设—没有发生；</p>
<p>备择假设—发生了；</p>
<p>具体作法是：根据问题的需要对所研究的总体作某种假设，记作H0；选取合适的统计量，这个统计量的选取要使得在假设H0成立时，其分布为已知；由实测的样本，计算出统计量的值，并根据预先给定的显著性水平进行检验，作出拒绝或接受假设H0的判断。</p>
<p>p-value就是Probability的值，它是一个通过计算得到的概率值，也就是在原假设为真时，得到最大的或者超出所得到的检验统计量值的概率。</p>
<p>一般将p值定位到0.05，当p&lt;0.05拒绝原假设，p&gt;0.05，不拒绝原假设。如果数据噪音比较大，可以放松限制条件，将p值设定为0.1，如果数据比较精确，可以设定为0.01。</p>
<p><code>vcd</code>包中的<code>chisq.test</code>函数可以进行卡方独立检验：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mytable <span class="operator">&lt;-</span> table<span class="punctuation">(</span>Arthritis<span class="operator">$</span>Treatment<span class="punctuation">,</span>Arthritis<span class="operator">$</span>Improved<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> chisq.test<span class="punctuation">(</span>mytable<span class="punctuation">)</span>  <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">	Pearson<span class="string">&#x27;s Chi-squared test</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">data:  mytable</span></span><br><span class="line"><span class="string">X-squared = 13.055, df = 2, p-value = 0.001463</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; mytable &lt;- table(Arthritis$Sex,Arthritis$Improved)</span></span><br><span class="line"><span class="string">&gt; chisq.test(mytable)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	Pearson&#x27;</span>s Chi<span class="operator">-</span>squared test</span><br><span class="line"></span><br><span class="line">data<span class="operator">:</span>  mytable</span><br><span class="line">X<span class="operator">-</span>squared <span class="operator">=</span> <span class="number">4.8407</span><span class="punctuation">,</span> df <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> p<span class="operator">-</span>value <span class="operator">=</span> <span class="number">0.08889</span></span><br><span class="line"></span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line">In chisq.test<span class="punctuation">(</span>mytable<span class="punctuation">)</span> <span class="operator">:</span> Chi<span class="operator">-</span>squared近似算法有可能不准</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> mytable <span class="operator">&lt;-</span> table<span class="punctuation">(</span>Arthritis<span class="operator">$</span>Improved<span class="punctuation">,</span>Arthritis<span class="operator">$</span>Sex<span class="punctuation">)</span> <span class="comment"># Improved和Sex二者在table中的顺序对结果无影响</span></span><br><span class="line"><span class="operator">&gt;</span> chisq.test<span class="punctuation">(</span>mytable<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">	Pearson<span class="string">&#x27;s Chi-squared test</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">data:  mytable</span></span><br><span class="line"><span class="string">X-squared = 4.8407, df = 2, p-value = 0.08889</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Warning message:</span></span><br><span class="line"><span class="string">In chisq.test(mytable) : Chi-squared近似算法有可能不准</span></span><br></pre></td></tr></table></figure>
<p>通过Fisher检验：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mytable <span class="operator">&lt;-</span> xtabs<span class="punctuation">(</span><span class="operator">~</span>Treatment<span class="operator">+</span>Improved<span class="punctuation">,</span> data<span class="operator">=</span>Arthritis<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fisher.test<span class="punctuation">(</span>mytable<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">	Fisher<span class="string">&#x27;s Exact Test for Count Data</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">data:  mytable</span></span><br><span class="line"><span class="string">p-value = 0.001393</span></span><br><span class="line"><span class="string">alternative hypothesis: two.sided</span></span><br></pre></td></tr></table></figure>
<p>p值都小于0.05说明变量不独立。</p>
<p>Cochran-Mantel-Haenszel检验：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mytable <span class="operator">&lt;-</span> xtabs<span class="punctuation">(</span><span class="operator">~</span>Treatment<span class="operator">+</span>Improved<span class="operator">+</span>Sex<span class="punctuation">,</span> data<span class="operator">=</span>Arthritis<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> mytable</span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> Sex <span class="operator">=</span> Female</span><br><span class="line"></span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   <span class="number">19</span>    <span class="number">7</span>      <span class="number">6</span></span><br><span class="line">  Treated    <span class="number">6</span>    <span class="number">5</span>     <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> Sex <span class="operator">=</span> Male</span><br><span class="line"></span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   <span class="number">10</span>    <span class="number">0</span>      <span class="number">1</span></span><br><span class="line">  Treated    <span class="number">7</span>    <span class="number">2</span>      <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> mantelhaen.test<span class="punctuation">(</span>mytable<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">	Cochran<span class="operator">-</span>Mantel<span class="operator">-</span>Haenszel test</span><br><span class="line"></span><br><span class="line">data<span class="operator">:</span>  mytable</span><br><span class="line">Cochran<span class="operator">-</span>Mantel<span class="operator">-</span>Haenszel M<span class="operator">^</span><span class="number">2</span> <span class="operator">=</span> <span class="number">14.632</span><span class="punctuation">,</span> df <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> p<span class="operator">-</span>value <span class="operator">=</span> <span class="number">0.0006647</span></span><br></pre></td></tr></table></figure>
<p><code>Treatment</code>、<code>Sex</code>和<code>Improved</code>参数的先后位置很重要，比如下面的这个示例对比上面的示例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mytable <span class="operator">&lt;-</span> xtabs<span class="punctuation">(</span><span class="operator">~</span>Treatment<span class="operator">+</span>Sex<span class="operator">+</span>Improved<span class="punctuation">,</span> data<span class="operator">=</span>Arthritis<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> mytable</span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> Improved <span class="operator">=</span> None</span><br><span class="line"></span><br><span class="line">         Sex</span><br><span class="line">Treatment Female Male</span><br><span class="line">  Placebo     <span class="number">19</span>   <span class="number">10</span></span><br><span class="line">  Treated      <span class="number">6</span>    <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> Improved <span class="operator">=</span> Some</span><br><span class="line"></span><br><span class="line">         Sex</span><br><span class="line">Treatment Female Male</span><br><span class="line">  Placebo      <span class="number">7</span>    <span class="number">0</span></span><br><span class="line">  Treated      <span class="number">5</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> Improved <span class="operator">=</span> Marked</span><br><span class="line"></span><br><span class="line">         Sex</span><br><span class="line">Treatment Female Male</span><br><span class="line">  Placebo      <span class="number">6</span>    <span class="number">1</span></span><br><span class="line">  Treated     <span class="number">16</span>    <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> mantelhaen.test<span class="punctuation">(</span>mytable<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">	Mantel<span class="operator">-</span>Haenszel chi<span class="operator">-</span>squared test with continuity correction</span><br><span class="line"></span><br><span class="line">data<span class="operator">:</span>  mytable</span><br><span class="line">Mantel<span class="operator">-</span>Haenszel X<span class="operator">-</span>squared <span class="operator">=</span> <span class="number">2.0863</span><span class="punctuation">,</span> df <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> p<span class="operator">-</span>value <span class="operator">=</span> <span class="number">0.1486</span></span><br><span class="line">alternative hypothesis<span class="operator">:</span> true common odds ratio is not equal to <span class="number">1</span></span><br><span class="line"><span class="number">95</span> percent confidence interval<span class="operator">:</span></span><br><span class="line"> <span class="number">0.8566711</span> <span class="number">8.0070521</span></span><br><span class="line">sample estimates<span class="operator">:</span></span><br><span class="line">common odds ratio </span><br><span class="line">         <span class="number">2.619048</span> </span><br></pre></td></tr></table></figure>
<h3 id="5-6-相关性分析函数">5.6 相关性分析函数</h3>
<p>相关性分析是指对两个或多个具备相关性的变量元素进行分析，从而衡量两个变量因素的相关密切程度。相关性的元素之间需要存在一定的联系或者概率才可以进行相关性分析。简单来说就是变量之间是否有关系。</p>
<p>相关性衡量指标：</p>
<ul>
<li>Pearson相关系数</li>
<li>Spearman相关系数</li>
<li>Kendall相关系数</li>
<li>偏相关系数</li>
<li>多分格（polychoric）相关系数</li>
<li>多系列（polyserial）相关系数</li>
</ul>
<p>相关性中每种方法都没有独立的函数，均使用同一个函数<code>cor</code>。<code>cor</code>可以计算三种相关系数，包括Pearson、Spearman和Kendall，具体使用哪种算法可以通过method参数指定，默认使用Pearson系数。其他的相关系数：偏相关系数、多分格相关系数、多系列相关系数可以通过R的相关拓展包实现。比如<code>ggm</code>包中的<code>pcor</code>可以用来计算偏相关系数。</p>
<p><code>cor</code>函数中的<code>use</code>参数表示如何对待缺失值，是不处理还是删除，可选的选项有&quot;everything&quot;, “all.obs”, “complete.obs”, “na.or.complete”, 或 “pairwise.complete.obs”。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> cor<span class="punctuation">(</span>state.x77<span class="punctuation">)</span></span><br><span class="line">            Population     Income  Illiteracy    Life Exp     Murder     HS Grad      Frost        Area</span><br><span class="line">Population  <span class="number">1.00000000</span>  <span class="number">0.2082276</span>  <span class="number">0.10762237</span> <span class="operator">-</span><span class="number">0.06805195</span>  <span class="number">0.3436428</span> <span class="operator">-</span><span class="number">0.09848975</span> <span class="operator">-</span><span class="number">0.3321525</span>  <span class="number">0.02254384</span></span><br><span class="line">Income      <span class="number">0.20822756</span>  <span class="number">1.0000000</span> <span class="operator">-</span><span class="number">0.43707519</span>  <span class="number">0.34025534</span> <span class="operator">-</span><span class="number">0.2300776</span>  <span class="number">0.61993232</span>  <span class="number">0.2262822</span>  <span class="number">0.36331544</span></span><br><span class="line">Illiteracy  <span class="number">0.10762237</span> <span class="operator">-</span><span class="number">0.4370752</span>  <span class="number">1.00000000</span> <span class="operator">-</span><span class="number">0.58847793</span>  <span class="number">0.7029752</span> <span class="operator">-</span><span class="number">0.65718861</span> <span class="operator">-</span><span class="number">0.6719470</span>  <span class="number">0.07726113</span></span><br><span class="line">Life Exp   <span class="operator">-</span><span class="number">0.06805195</span>  <span class="number">0.3402553</span> <span class="operator">-</span><span class="number">0.58847793</span>  <span class="number">1.00000000</span> <span class="operator">-</span><span class="number">0.7808458</span>  <span class="number">0.58221620</span>  <span class="number">0.2620680</span> <span class="operator">-</span><span class="number">0.10733194</span></span><br><span class="line">Murder      <span class="number">0.34364275</span> <span class="operator">-</span><span class="number">0.2300776</span>  <span class="number">0.70297520</span> <span class="operator">-</span><span class="number">0.78084575</span>  <span class="number">1.0000000</span> <span class="operator">-</span><span class="number">0.48797102</span> <span class="operator">-</span><span class="number">0.5388834</span>  <span class="number">0.22839021</span></span><br><span class="line">HS Grad    <span class="operator">-</span><span class="number">0.09848975</span>  <span class="number">0.6199323</span> <span class="operator">-</span><span class="number">0.65718861</span>  <span class="number">0.58221620</span> <span class="operator">-</span><span class="number">0.4879710</span>  <span class="number">1.00000000</span>  <span class="number">0.3667797</span>  <span class="number">0.33354187</span></span><br><span class="line">Frost      <span class="operator">-</span><span class="number">0.33215245</span>  <span class="number">0.2262822</span> <span class="operator">-</span><span class="number">0.67194697</span>  <span class="number">0.26206801</span> <span class="operator">-</span><span class="number">0.5388834</span>  <span class="number">0.36677970</span>  <span class="number">1.0000000</span>  <span class="number">0.05922910</span></span><br><span class="line">Area        <span class="number">0.02254384</span>  <span class="number">0.3633154</span>  <span class="number">0.07726113</span> <span class="operator">-</span><span class="number">0.10733194</span>  <span class="number">0.2283902</span>  <span class="number">0.33354187</span>  <span class="number">0.0592291</span>  <span class="number">1.00000000</span></span><br></pre></td></tr></table></figure>
<p>这是对角矩阵，对角位置的数值为1，说明自己和自己的相关性为1，一般相关系数在0到1之间，正负号为正相关和负相关。</p>
<p><code>cov</code>可以用来计算协方差，协方差可以用来计算两个变量的总体误差。在计算偏方差时需要用到协方差的结果。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> cov<span class="punctuation">(</span>state.x77<span class="punctuation">)</span></span><br><span class="line">              Population        Income   Illiteracy      Life Exp       Murder       HS Grad        Frost</span><br><span class="line">Population <span class="number">19931683.7588</span>   <span class="number">571229.7796</span>  <span class="number">292.8679592</span> <span class="operator">-</span><span class="number">4.078425e+02</span>  <span class="number">5663.523714</span>  <span class="operator">-</span><span class="number">3551.509551</span> <span class="operator">-</span><span class="number">77081.97265</span></span><br><span class="line">Income       <span class="number">571229.7796</span>   <span class="number">377573.3061</span> <span class="operator">-</span><span class="number">163.7020408</span>  <span class="number">2.806632e+02</span>  <span class="operator">-</span><span class="number">521.894286</span>   <span class="number">3076.768980</span>   <span class="number">7227.60408</span></span><br><span class="line">Illiteracy      <span class="number">292.8680</span>     <span class="operator">-</span><span class="number">163.7020</span>    <span class="number">0.3715306</span> <span class="operator">-</span><span class="number">4.815122e-01</span>     <span class="number">1.581776</span>     <span class="operator">-</span><span class="number">3.235469</span>    <span class="operator">-</span><span class="number">21.29000</span></span><br><span class="line">Life Exp       <span class="operator">-</span><span class="number">407.8425</span>      <span class="number">280.6632</span>   <span class="operator">-</span><span class="number">0.4815122</span>  <span class="number">1.802020e+00</span>    <span class="operator">-</span><span class="number">3.869480</span>      <span class="number">6.312685</span>     <span class="number">18.28678</span></span><br><span class="line">Murder         <span class="number">5663.5237</span>     <span class="operator">-</span><span class="number">521.8943</span>    <span class="number">1.5817755</span> <span class="operator">-</span><span class="number">3.869480e+00</span>    <span class="number">13.627465</span>    <span class="operator">-</span><span class="number">14.549616</span>   <span class="operator">-</span><span class="number">103.40600</span></span><br><span class="line">HS Grad       <span class="operator">-</span><span class="number">3551.5096</span>     <span class="number">3076.7690</span>   <span class="operator">-</span><span class="number">3.2354694</span>  <span class="number">6.312685e+00</span>   <span class="operator">-</span><span class="number">14.549616</span>     <span class="number">65.237894</span>    <span class="number">153.99216</span></span><br><span class="line">Frost        <span class="operator">-</span><span class="number">77081.9727</span>     <span class="number">7227.6041</span>  <span class="operator">-</span><span class="number">21.2900000</span>  <span class="number">1.828678e+01</span>  <span class="operator">-</span><span class="number">103.406000</span>    <span class="number">153.992163</span>   <span class="number">2702.00857</span></span><br><span class="line">Area        <span class="number">8587916.9494</span> <span class="number">19049013.7510</span> <span class="number">4018.3371429</span> <span class="operator">-</span><span class="number">1.229410e+04</span> <span class="number">71940.429959</span> <span class="number">229873.192816</span> <span class="number">262703.89306</span></span><br><span class="line">                    Area</span><br><span class="line">Population  <span class="number">8.587917e+06</span></span><br><span class="line">Income      <span class="number">1.904901e+07</span></span><br><span class="line">Illiteracy  <span class="number">4.018337e+03</span></span><br><span class="line">Life Exp   <span class="operator">-</span><span class="number">1.229410e+04</span></span><br><span class="line">Murder      <span class="number">7.194043e+04</span></span><br><span class="line">HS Grad     <span class="number">2.298732e+05</span></span><br><span class="line">Frost       <span class="number">2.627039e+05</span></span><br><span class="line">Area        <span class="number">7.280748e+09</span></span><br></pre></td></tr></table></figure>
<p>如果想计算一组变量和另一组变量之间的关系，而不是所有变量两两之间的关系。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> y <span class="operator">&lt;-</span> state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">           Population Income Illiteracy HS Grad</span><br><span class="line">Alabama          <span class="number">3615</span>   <span class="number">3624</span>        <span class="number">2.1</span>    <span class="number">41.3</span></span><br><span class="line">Alaska            <span class="number">365</span>   <span class="number">6315</span>        <span class="number">1.5</span>    <span class="number">66.7</span></span><br><span class="line">Arizona          <span class="number">2212</span>   <span class="number">4530</span>        <span class="number">1.8</span>    <span class="number">58.1</span></span><br><span class="line">Arkansas         <span class="number">2110</span>   <span class="number">3378</span>        <span class="number">1.9</span>    <span class="number">39.9</span></span><br><span class="line">California      <span class="number">21198</span>   <span class="number">5114</span>        <span class="number">1.1</span>    <span class="number">62.6</span></span><br><span class="line">Colorado         <span class="number">2541</span>   <span class="number">4884</span>        <span class="number">0.7</span>    <span class="number">63.9</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>y<span class="punctuation">)</span></span><br><span class="line">           Life Exp Murder</span><br><span class="line">Alabama       <span class="number">69.05</span>   <span class="number">15.1</span></span><br><span class="line">Alaska        <span class="number">69.31</span>   <span class="number">11.3</span></span><br><span class="line">Arizona       <span class="number">70.55</span>    <span class="number">7.8</span></span><br><span class="line">Arkansas      <span class="number">70.66</span>   <span class="number">10.1</span></span><br><span class="line">California    <span class="number">71.71</span>   <span class="number">10.3</span></span><br><span class="line">Colorado      <span class="number">72.06</span>    <span class="number">6.8</span></span><br><span class="line"><span class="operator">&gt;</span> cor<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">)</span></span><br><span class="line">              Life Exp     Murder</span><br><span class="line">Population <span class="operator">-</span><span class="number">0.06805195</span>  <span class="number">0.3436428</span></span><br><span class="line">Income      <span class="number">0.34025534</span> <span class="operator">-</span><span class="number">0.2300776</span></span><br><span class="line">Illiteracy <span class="operator">-</span><span class="number">0.58847793</span>  <span class="number">0.7029752</span></span><br><span class="line">HS Grad     <span class="number">0.58221620</span> <span class="operator">-</span><span class="number">0.4879710</span></span><br></pre></td></tr></table></figure>
<p><code>ggm</code>包中<code>pcor</code>函数用来计算偏相关系数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> pcor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span>cov<span class="punctuation">(</span>state.x77<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.3132774</span></span><br></pre></td></tr></table></figure>
<p><code>pcor(u, S)</code>说明<code>pcor</code>需要两个重要参数，第一个参数是数值向量，前两个数值为要计算相关系数的下标，其余的数值为条件变量的下标，第二个参数为计算出来的协方差结果。</p>
<h3 id="5-7-相关性检验函数">5.7 相关性检验函数</h3>
<p>即使通过<code>cor</code>计算出很高的相关系数，仍然需要进行相关性检验</p>
<p>相关性检验用相关性检验函数<code>cor.test</code>，<code>cor.test</code>函数中<code>alternative</code>可以选择&quot;two.sided&quot;, “less”, &quot;greater&quot;分别表示正负相关性、负相关和正相关，<code>method</code>可以选择哪种相关性分析方法。<code>cor.test</code>每次只能检测一组变量，使用起来麻烦一点。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cor.test<span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">,</span></span><br><span class="line">         alternative <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;two.sided&quot;</span><span class="punctuation">,</span> <span class="string">&quot;less&quot;</span><span class="punctuation">,</span> <span class="string">&quot;greater&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         method <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;pearson&quot;</span><span class="punctuation">,</span> <span class="string">&quot;kendall&quot;</span><span class="punctuation">,</span> <span class="string">&quot;spearman&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         exact <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> conf.level <span class="operator">=</span> <span class="number">0.95</span><span class="punctuation">,</span> continuity <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> cor.test<span class="punctuation">(</span>state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">,</span>state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">	Pearson<span class="string">&#x27;s product-moment correlation</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">data:  state.x77[, 3] and state.x77[, 5]</span></span><br><span class="line"><span class="string">t = 6.8479, df = 48, p-value = 1.258e-08  # p-value的值远小于0.05</span></span><br><span class="line"><span class="string">alternative hypothesis: true correlation is not equal to 0</span></span><br><span class="line"><span class="string">95 percent confidence interval:</span></span><br><span class="line"><span class="string"> 0.5279280 0.8207295</span></span><br><span class="line"><span class="string">sample estimates:</span></span><br><span class="line"><span class="string">      cor </span></span><br><span class="line"><span class="string">0.7029752</span></span><br></pre></td></tr></table></figure>
<p>可以看出p-value的值远小于0.05，所以拒绝了原假设（即两个变量之间无关）</p>
<p>置信区间：confidence interval，是指由样本统计量所构成的总体参数的估计区间。在统计学中，一个概率样本的置信区间是对这个样本的某个总体参数的区间估计。置信区间展现的是这个参数的真实值有一定概率落在测量结果的周围的程度。置信区间给出的是被测量参数的测量指的可信程度。</p>
<p>示例：如果在一次大选中某人的支持率为55%，而置信水平0.95以上的置信区间是（50%，60%），那么他的真实支持率有百分之九十五的机率，落在百分之五十和百分之六十之间，因此他的真实支持率不足一半的可能性小于百分之5。</p>
<p>在<code>psych</code>包中<code>corr.test</code>函数可以进行多个变量之间的计算，也可以进行递归处理。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> corr.test<span class="punctuation">(</span>state.x77<span class="punctuation">)</span></span><br><span class="line">Call<span class="operator">:</span>corr.test<span class="punctuation">(</span>x <span class="operator">=</span> state.x77<span class="punctuation">)</span></span><br><span class="line">Correlation matrix </span><br><span class="line">           Population Income Illiteracy Life Exp Murder HS Grad Frost  Area</span><br><span class="line">Population       <span class="number">1.00</span>   <span class="number">0.21</span>       <span class="number">0.11</span>    <span class="operator">-</span><span class="number">0.07</span>   <span class="number">0.34</span>   <span class="operator">-</span><span class="number">0.10</span> <span class="operator">-</span><span class="number">0.33</span>  <span class="number">0.02</span></span><br><span class="line">Income           <span class="number">0.21</span>   <span class="number">1.00</span>      <span class="operator">-</span><span class="number">0.44</span>     <span class="number">0.34</span>  <span class="operator">-</span><span class="number">0.23</span>    <span class="number">0.62</span>  <span class="number">0.23</span>  <span class="number">0.36</span></span><br><span class="line">Illiteracy       <span class="number">0.11</span>  <span class="operator">-</span><span class="number">0.44</span>       <span class="number">1.00</span>    <span class="operator">-</span><span class="number">0.59</span>   <span class="number">0.70</span>   <span class="operator">-</span><span class="number">0.66</span> <span class="operator">-</span><span class="number">0.67</span>  <span class="number">0.08</span></span><br><span class="line">Life Exp        <span class="operator">-</span><span class="number">0.07</span>   <span class="number">0.34</span>      <span class="operator">-</span><span class="number">0.59</span>     <span class="number">1.00</span>  <span class="operator">-</span><span class="number">0.78</span>    <span class="number">0.58</span>  <span class="number">0.26</span> <span class="operator">-</span><span class="number">0.11</span></span><br><span class="line">Murder           <span class="number">0.34</span>  <span class="operator">-</span><span class="number">0.23</span>       <span class="number">0.70</span>    <span class="operator">-</span><span class="number">0.78</span>   <span class="number">1.00</span>   <span class="operator">-</span><span class="number">0.49</span> <span class="operator">-</span><span class="number">0.54</span>  <span class="number">0.23</span></span><br><span class="line">HS Grad         <span class="operator">-</span><span class="number">0.10</span>   <span class="number">0.62</span>      <span class="operator">-</span><span class="number">0.66</span>     <span class="number">0.58</span>  <span class="operator">-</span><span class="number">0.49</span>    <span class="number">1.00</span>  <span class="number">0.37</span>  <span class="number">0.33</span></span><br><span class="line">Frost           <span class="operator">-</span><span class="number">0.33</span>   <span class="number">0.23</span>      <span class="operator">-</span><span class="number">0.67</span>     <span class="number">0.26</span>  <span class="operator">-</span><span class="number">0.54</span>    <span class="number">0.37</span>  <span class="number">1.00</span>  <span class="number">0.06</span></span><br><span class="line">Area             <span class="number">0.02</span>   <span class="number">0.36</span>       <span class="number">0.08</span>    <span class="operator">-</span><span class="number">0.11</span>   <span class="number">0.23</span>    <span class="number">0.33</span>  <span class="number">0.06</span>  <span class="number">1.00</span></span><br><span class="line">Sample Size </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">50</span></span><br><span class="line">Probability values <span class="punctuation">(</span>Entries above the diagonal are adjusted <span class="keyword">for</span> multiple tests.<span class="punctuation">)</span> </span><br><span class="line">           Population Income Illiteracy Life Exp Murder HS Grad Frost Area</span><br><span class="line">Population       <span class="number">0.00</span>   <span class="number">1.00</span>       <span class="number">1.00</span>     <span class="number">1.00</span>   <span class="number">0.23</span>    <span class="number">1.00</span>  <span class="number">0.25</span> <span class="number">1.00</span></span><br><span class="line">Income           <span class="number">0.15</span>   <span class="number">0.00</span>       <span class="number">0.03</span>     <span class="number">0.23</span>   <span class="number">1.00</span>    <span class="number">0.00</span>  <span class="number">1.00</span> <span class="number">0.16</span></span><br><span class="line">Illiteracy       <span class="number">0.46</span>   <span class="number">0.00</span>       <span class="number">0.00</span>     <span class="number">0.00</span>   <span class="number">0.00</span>    <span class="number">0.00</span>  <span class="number">0.00</span> <span class="number">1.00</span></span><br><span class="line">Life Exp         <span class="number">0.64</span>   <span class="number">0.02</span>       <span class="number">0.00</span>     <span class="number">0.00</span>   <span class="number">0.00</span>    <span class="number">0.00</span>  <span class="number">0.79</span> <span class="number">1.00</span></span><br><span class="line">Murder           <span class="number">0.01</span>   <span class="number">0.11</span>       <span class="number">0.00</span>     <span class="number">0.00</span>   <span class="number">0.00</span>    <span class="number">0.01</span>  <span class="number">0.00</span> <span class="number">1.00</span></span><br><span class="line">HS Grad          <span class="number">0.50</span>   <span class="number">0.00</span>       <span class="number">0.00</span>     <span class="number">0.00</span>   <span class="number">0.00</span>    <span class="number">0.00</span>  <span class="number">0.16</span> <span class="number">0.25</span></span><br><span class="line">Frost            <span class="number">0.02</span>   <span class="number">0.11</span>       <span class="number">0.00</span>     <span class="number">0.07</span>   <span class="number">0.00</span>    <span class="number">0.01</span>  <span class="number">0.00</span> <span class="number">1.00</span></span><br><span class="line">Area             <span class="number">0.88</span>   <span class="number">0.01</span>       <span class="number">0.59</span>     <span class="number">0.46</span>   <span class="number">0.11</span>    <span class="number">0.02</span>  <span class="number">0.68</span> <span class="number">0.00</span></span><br><span class="line"></span><br><span class="line"> To see confidence intervals of the correlations<span class="punctuation">,</span> print with the short<span class="operator">=</span><span class="literal">FALSE</span> option</span><br></pre></td></tr></table></figure>
<p>如果想进行偏相关的检验，可以通过<code>ggm</code>包中的<code>pcor.test</code>函数进行相关检验：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> pcor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span>cov<span class="punctuation">(</span>state.x77<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.3132774</span></span><br><span class="line"><span class="operator">&gt;</span> pcor.test<span class="punctuation">(</span>x<span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>tval</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2.212924</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>df</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">45</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>pvalue</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.03201783</span></span><br></pre></td></tr></table></figure>
<p>x为偏相关计算的相关系数，3为返回的变量数，50为样本数</p>
<p>返回三个值：t检验、自由度和p-value</p>
<p>t检验是用t分布理论推论差异发生的概率，从而比较两个平均数的差异是否显著，主要用于样本量小，一般小于30个，总体标准差未知的标准正态分布数据。</p>
<p>UScrime数据集为美国47个州的犯罪制度对犯罪率的影响信息。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> UScrime</span><br><span class="line">     M So  Ed Po1 Po2  LF  M.F Pop  NW  U1 U2 GDP Ineq     Prob    Time    y</span><br><span class="line"><span class="number">1</span>  <span class="number">151</span>  <span class="number">1</span>  <span class="number">91</span>  <span class="number">58</span>  <span class="number">56</span> <span class="number">510</span>  <span class="number">950</span>  <span class="number">33</span> <span class="number">301</span> <span class="number">108</span> <span class="number">41</span> <span class="number">394</span>  <span class="number">261</span> <span class="number">0.084602</span> <span class="number">26.2011</span>  <span class="number">791</span></span><br><span class="line"><span class="number">2</span>  <span class="number">143</span>  <span class="number">0</span> <span class="number">113</span> <span class="number">103</span>  <span class="number">95</span> <span class="number">583</span> <span class="number">1012</span>  <span class="number">13</span> <span class="number">102</span>  <span class="number">96</span> <span class="number">36</span> <span class="number">557</span>  <span class="number">194</span> <span class="number">0.029599</span> <span class="number">25.2999</span> <span class="number">1635</span></span><br><span class="line"><span class="number">3</span>  <span class="number">142</span>  <span class="number">1</span>  <span class="number">89</span>  <span class="number">45</span>  <span class="number">44</span> <span class="number">533</span>  <span class="number">969</span>  <span class="number">18</span> <span class="number">219</span>  <span class="number">94</span> <span class="number">33</span> <span class="number">318</span>  <span class="number">250</span> <span class="number">0.083401</span> <span class="number">24.3006</span>  <span class="number">578</span></span><br><span class="line"><span class="number">4</span>  <span class="number">136</span>  <span class="number">0</span> <span class="number">121</span> <span class="number">149</span> <span class="number">141</span> <span class="number">577</span>  <span class="number">994</span> <span class="number">157</span>  <span class="number">80</span> <span class="number">102</span> <span class="number">39</span> <span class="number">673</span>  <span class="number">167</span> <span class="number">0.015801</span> <span class="number">29.9012</span> <span class="number">1969</span></span><br><span class="line"><span class="number">5</span>  <span class="number">141</span>  <span class="number">0</span> <span class="number">121</span> <span class="number">109</span> <span class="number">101</span> <span class="number">591</span>  <span class="number">985</span>  <span class="number">18</span>  <span class="number">30</span>  <span class="number">91</span> <span class="number">20</span> <span class="number">578</span>  <span class="number">174</span> <span class="number">0.041399</span> <span class="number">21.2998</span> <span class="number">1234</span></span><br><span class="line"><span class="number">6</span>  <span class="number">121</span>  <span class="number">0</span> <span class="number">110</span> <span class="number">118</span> <span class="number">115</span> <span class="number">547</span>  <span class="number">964</span>  <span class="number">25</span>  <span class="number">44</span>  <span class="number">84</span> <span class="number">29</span> <span class="number">689</span>  <span class="number">126</span> <span class="number">0.034201</span> <span class="number">20.9995</span>  <span class="number">682</span></span><br><span class="line"><span class="number">7</span>  <span class="number">127</span>  <span class="number">1</span> <span class="number">111</span>  <span class="number">82</span>  <span class="number">79</span> <span class="number">519</span>  <span class="number">982</span>   <span class="number">4</span> <span class="number">139</span>  <span class="number">97</span> <span class="number">38</span> <span class="number">620</span>  <span class="number">168</span> <span class="number">0.042100</span> <span class="number">20.6993</span>  <span class="number">963</span></span><br><span class="line"><span class="number">8</span>  <span class="number">131</span>  <span class="number">1</span> <span class="number">109</span> <span class="number">115</span> <span class="number">109</span> <span class="number">542</span>  <span class="number">969</span>  <span class="number">50</span> <span class="number">179</span>  <span class="number">79</span> <span class="number">35</span> <span class="number">472</span>  <span class="number">206</span> <span class="number">0.040099</span> <span class="number">24.5988</span> <span class="number">1555</span></span><br><span class="line"><span class="number">9</span>  <span class="number">157</span>  <span class="number">1</span>  <span class="number">90</span>  <span class="number">65</span>  <span class="number">62</span> <span class="number">553</span>  <span class="number">955</span>  <span class="number">39</span> <span class="number">286</span>  <span class="number">81</span> <span class="number">28</span> <span class="number">421</span>  <span class="number">239</span> <span class="number">0.071697</span> <span class="number">29.4001</span>  <span class="number">856</span></span><br><span class="line"><span class="number">10</span> <span class="number">140</span>  <span class="number">0</span> <span class="number">118</span>  <span class="number">71</span>  <span class="number">68</span> <span class="number">632</span> <span class="number">1029</span>   <span class="number">7</span>  <span class="number">15</span> <span class="number">100</span> <span class="number">24</span> <span class="number">526</span>  <span class="number">174</span> <span class="number">0.044498</span> <span class="number">19.5994</span>  <span class="number">705</span></span><br><span class="line"><span class="number">11</span> <span class="number">124</span>  <span class="number">0</span> <span class="number">105</span> <span class="number">121</span> <span class="number">116</span> <span class="number">580</span>  <span class="number">966</span> <span class="number">101</span> <span class="number">106</span>  <span class="number">77</span> <span class="number">35</span> <span class="number">657</span>  <span class="number">170</span> <span class="number">0.016201</span> <span class="number">41.6000</span> <span class="number">1674</span></span><br><span class="line"><span class="number">12</span> <span class="number">134</span>  <span class="number">0</span> <span class="number">108</span>  <span class="number">75</span>  <span class="number">71</span> <span class="number">595</span>  <span class="number">972</span>  <span class="number">47</span>  <span class="number">59</span>  <span class="number">83</span> <span class="number">31</span> <span class="number">580</span>  <span class="number">172</span> <span class="number">0.031201</span> <span class="number">34.2984</span>  <span class="number">849</span></span><br><span class="line"><span class="number">13</span> <span class="number">128</span>  <span class="number">0</span> <span class="number">113</span>  <span class="number">67</span>  <span class="number">60</span> <span class="number">624</span>  <span class="number">972</span>  <span class="number">28</span>  <span class="number">10</span>  <span class="number">77</span> <span class="number">25</span> <span class="number">507</span>  <span class="number">206</span> <span class="number">0.045302</span> <span class="number">36.2993</span>  <span class="number">511</span></span><br><span class="line"><span class="number">14</span> <span class="number">135</span>  <span class="number">0</span> <span class="number">117</span>  <span class="number">62</span>  <span class="number">61</span> <span class="number">595</span>  <span class="number">986</span>  <span class="number">22</span>  <span class="number">46</span>  <span class="number">77</span> <span class="number">27</span> <span class="number">529</span>  <span class="number">190</span> <span class="number">0.053200</span> <span class="number">21.5010</span>  <span class="number">664</span></span><br><span class="line"><span class="number">15</span> <span class="number">152</span>  <span class="number">1</span>  <span class="number">87</span>  <span class="number">57</span>  <span class="number">53</span> <span class="number">530</span>  <span class="number">986</span>  <span class="number">30</span>  <span class="number">72</span>  <span class="number">92</span> <span class="number">43</span> <span class="number">405</span>  <span class="number">264</span> <span class="number">0.069100</span> <span class="number">22.7008</span>  <span class="number">798</span></span><br><span class="line"><span class="number">16</span> <span class="number">142</span>  <span class="number">1</span>  <span class="number">88</span>  <span class="number">81</span>  <span class="number">77</span> <span class="number">497</span>  <span class="number">956</span>  <span class="number">33</span> <span class="number">321</span> <span class="number">116</span> <span class="number">47</span> <span class="number">427</span>  <span class="number">247</span> <span class="number">0.052099</span> <span class="number">26.0991</span>  <span class="number">946</span></span><br><span class="line"><span class="number">17</span> <span class="number">143</span>  <span class="number">0</span> <span class="number">110</span>  <span class="number">66</span>  <span class="number">63</span> <span class="number">537</span>  <span class="number">977</span>  <span class="number">10</span>   <span class="number">6</span> <span class="number">114</span> <span class="number">35</span> <span class="number">487</span>  <span class="number">166</span> <span class="number">0.076299</span> <span class="number">19.1002</span>  <span class="number">539</span></span><br><span class="line"><span class="number">18</span> <span class="number">135</span>  <span class="number">1</span> <span class="number">104</span> <span class="number">123</span> <span class="number">115</span> <span class="number">537</span>  <span class="number">978</span>  <span class="number">31</span> <span class="number">170</span>  <span class="number">89</span> <span class="number">34</span> <span class="number">631</span>  <span class="number">165</span> <span class="number">0.119804</span> <span class="number">18.1996</span>  <span class="number">929</span></span><br><span class="line"><span class="number">19</span> <span class="number">130</span>  <span class="number">0</span> <span class="number">116</span> <span class="number">128</span> <span class="number">128</span> <span class="number">536</span>  <span class="number">934</span>  <span class="number">51</span>  <span class="number">24</span>  <span class="number">78</span> <span class="number">34</span> <span class="number">627</span>  <span class="number">135</span> <span class="number">0.019099</span> <span class="number">24.9008</span>  <span class="number">750</span></span><br><span class="line"><span class="number">20</span> <span class="number">125</span>  <span class="number">0</span> <span class="number">108</span> <span class="number">113</span> <span class="number">105</span> <span class="number">567</span>  <span class="number">985</span>  <span class="number">78</span>  <span class="number">94</span> <span class="number">130</span> <span class="number">58</span> <span class="number">626</span>  <span class="number">166</span> <span class="number">0.034801</span> <span class="number">26.4010</span> <span class="number">1225</span></span><br><span class="line"><span class="number">21</span> <span class="number">126</span>  <span class="number">0</span> <span class="number">108</span>  <span class="number">74</span>  <span class="number">67</span> <span class="number">602</span>  <span class="number">984</span>  <span class="number">34</span>  <span class="number">12</span> <span class="number">102</span> <span class="number">33</span> <span class="number">557</span>  <span class="number">195</span> <span class="number">0.022800</span> <span class="number">37.5998</span>  <span class="number">742</span></span><br><span class="line"><span class="number">22</span> <span class="number">157</span>  <span class="number">1</span>  <span class="number">89</span>  <span class="number">47</span>  <span class="number">44</span> <span class="number">512</span>  <span class="number">962</span>  <span class="number">22</span> <span class="number">423</span>  <span class="number">97</span> <span class="number">34</span> <span class="number">288</span>  <span class="number">276</span> <span class="number">0.089502</span> <span class="number">37.0994</span>  <span class="number">439</span></span><br><span class="line"><span class="number">23</span> <span class="number">132</span>  <span class="number">0</span>  <span class="number">96</span>  <span class="number">87</span>  <span class="number">83</span> <span class="number">564</span>  <span class="number">953</span>  <span class="number">43</span>  <span class="number">92</span>  <span class="number">83</span> <span class="number">32</span> <span class="number">513</span>  <span class="number">227</span> <span class="number">0.030700</span> <span class="number">25.1989</span> <span class="number">1216</span></span><br><span class="line"><span class="number">24</span> <span class="number">131</span>  <span class="number">0</span> <span class="number">116</span>  <span class="number">78</span>  <span class="number">73</span> <span class="number">574</span> <span class="number">1038</span>   <span class="number">7</span>  <span class="number">36</span> <span class="number">142</span> <span class="number">42</span> <span class="number">540</span>  <span class="number">176</span> <span class="number">0.041598</span> <span class="number">17.6000</span>  <span class="number">968</span></span><br><span class="line"><span class="number">25</span> <span class="number">130</span>  <span class="number">0</span> <span class="number">116</span>  <span class="number">63</span>  <span class="number">57</span> <span class="number">641</span>  <span class="number">984</span>  <span class="number">14</span>  <span class="number">26</span>  <span class="number">70</span> <span class="number">21</span> <span class="number">486</span>  <span class="number">196</span> <span class="number">0.069197</span> <span class="number">21.9003</span>  <span class="number">523</span></span><br><span class="line"><span class="number">26</span> <span class="number">131</span>  <span class="number">0</span> <span class="number">121</span> <span class="number">160</span> <span class="number">143</span> <span class="number">631</span> <span class="number">1071</span>   <span class="number">3</span>  <span class="number">77</span> <span class="number">102</span> <span class="number">41</span> <span class="number">674</span>  <span class="number">152</span> <span class="number">0.041698</span> <span class="number">22.1005</span> <span class="number">1993</span></span><br><span class="line"><span class="number">27</span> <span class="number">135</span>  <span class="number">0</span> <span class="number">109</span>  <span class="number">69</span>  <span class="number">71</span> <span class="number">540</span>  <span class="number">965</span>   <span class="number">6</span>   <span class="number">4</span>  <span class="number">80</span> <span class="number">22</span> <span class="number">564</span>  <span class="number">139</span> <span class="number">0.036099</span> <span class="number">28.4999</span>  <span class="number">342</span></span><br><span class="line"><span class="number">28</span> <span class="number">152</span>  <span class="number">0</span> <span class="number">112</span>  <span class="number">82</span>  <span class="number">76</span> <span class="number">571</span> <span class="number">1018</span>  <span class="number">10</span>  <span class="number">79</span> <span class="number">103</span> <span class="number">28</span> <span class="number">537</span>  <span class="number">215</span> <span class="number">0.038201</span> <span class="number">25.8006</span> <span class="number">1216</span></span><br><span class="line"><span class="number">29</span> <span class="number">119</span>  <span class="number">0</span> <span class="number">107</span> <span class="number">166</span> <span class="number">157</span> <span class="number">521</span>  <span class="number">938</span> <span class="number">168</span>  <span class="number">89</span>  <span class="number">92</span> <span class="number">36</span> <span class="number">637</span>  <span class="number">154</span> <span class="number">0.023400</span> <span class="number">36.7009</span> <span class="number">1043</span></span><br><span class="line"><span class="number">30</span> <span class="number">166</span>  <span class="number">1</span>  <span class="number">89</span>  <span class="number">58</span>  <span class="number">54</span> <span class="number">521</span>  <span class="number">973</span>  <span class="number">46</span> <span class="number">254</span>  <span class="number">72</span> <span class="number">26</span> <span class="number">396</span>  <span class="number">237</span> <span class="number">0.075298</span> <span class="number">28.3011</span>  <span class="number">696</span></span><br><span class="line"><span class="number">31</span> <span class="number">140</span>  <span class="number">0</span>  <span class="number">93</span>  <span class="number">55</span>  <span class="number">54</span> <span class="number">535</span> <span class="number">1045</span>   <span class="number">6</span>  <span class="number">20</span> <span class="number">135</span> <span class="number">40</span> <span class="number">453</span>  <span class="number">200</span> <span class="number">0.041999</span> <span class="number">21.7998</span>  <span class="number">373</span></span><br><span class="line"><span class="number">32</span> <span class="number">125</span>  <span class="number">0</span> <span class="number">109</span>  <span class="number">90</span>  <span class="number">81</span> <span class="number">586</span>  <span class="number">964</span>  <span class="number">97</span>  <span class="number">82</span> <span class="number">105</span> <span class="number">43</span> <span class="number">617</span>  <span class="number">163</span> <span class="number">0.042698</span> <span class="number">30.9014</span>  <span class="number">754</span></span><br><span class="line"><span class="number">33</span> <span class="number">147</span>  <span class="number">1</span> <span class="number">104</span>  <span class="number">63</span>  <span class="number">64</span> <span class="number">560</span>  <span class="number">972</span>  <span class="number">23</span>  <span class="number">95</span>  <span class="number">76</span> <span class="number">24</span> <span class="number">462</span>  <span class="number">233</span> <span class="number">0.049499</span> <span class="number">25.5005</span> <span class="number">1072</span></span><br><span class="line"><span class="number">34</span> <span class="number">126</span>  <span class="number">0</span> <span class="number">118</span>  <span class="number">97</span>  <span class="number">97</span> <span class="number">542</span>  <span class="number">990</span>  <span class="number">18</span>  <span class="number">21</span> <span class="number">102</span> <span class="number">35</span> <span class="number">589</span>  <span class="number">166</span> <span class="number">0.040799</span> <span class="number">21.6997</span>  <span class="number">923</span></span><br><span class="line"><span class="number">35</span> <span class="number">123</span>  <span class="number">0</span> <span class="number">102</span>  <span class="number">97</span>  <span class="number">87</span> <span class="number">526</span>  <span class="number">948</span> <span class="number">113</span>  <span class="number">76</span> <span class="number">124</span> <span class="number">50</span> <span class="number">572</span>  <span class="number">158</span> <span class="number">0.020700</span> <span class="number">37.4011</span>  <span class="number">653</span></span><br><span class="line"><span class="number">36</span> <span class="number">150</span>  <span class="number">0</span> <span class="number">100</span> <span class="number">109</span>  <span class="number">98</span> <span class="number">531</span>  <span class="number">964</span>   <span class="number">9</span>  <span class="number">24</span>  <span class="number">87</span> <span class="number">38</span> <span class="number">559</span>  <span class="number">153</span> <span class="number">0.006900</span> <span class="number">44.0004</span> <span class="number">1272</span></span><br><span class="line"><span class="number">37</span> <span class="number">177</span>  <span class="number">1</span>  <span class="number">87</span>  <span class="number">58</span>  <span class="number">56</span> <span class="number">638</span>  <span class="number">974</span>  <span class="number">24</span> <span class="number">349</span>  <span class="number">76</span> <span class="number">28</span> <span class="number">382</span>  <span class="number">254</span> <span class="number">0.045198</span> <span class="number">31.6995</span>  <span class="number">831</span></span><br><span class="line"><span class="number">38</span> <span class="number">133</span>  <span class="number">0</span> <span class="number">104</span>  <span class="number">51</span>  <span class="number">47</span> <span class="number">599</span> <span class="number">1024</span>   <span class="number">7</span>  <span class="number">40</span>  <span class="number">99</span> <span class="number">27</span> <span class="number">425</span>  <span class="number">225</span> <span class="number">0.053998</span> <span class="number">16.6999</span>  <span class="number">566</span></span><br><span class="line"><span class="number">39</span> <span class="number">149</span>  <span class="number">1</span>  <span class="number">88</span>  <span class="number">61</span>  <span class="number">54</span> <span class="number">515</span>  <span class="number">953</span>  <span class="number">36</span> <span class="number">165</span>  <span class="number">86</span> <span class="number">35</span> <span class="number">395</span>  <span class="number">251</span> <span class="number">0.047099</span> <span class="number">27.3004</span>  <span class="number">826</span></span><br><span class="line"><span class="number">40</span> <span class="number">145</span>  <span class="number">1</span> <span class="number">104</span>  <span class="number">82</span>  <span class="number">74</span> <span class="number">560</span>  <span class="number">981</span>  <span class="number">96</span> <span class="number">126</span>  <span class="number">88</span> <span class="number">31</span> <span class="number">488</span>  <span class="number">228</span> <span class="number">0.038801</span> <span class="number">29.3004</span> <span class="number">1151</span></span><br><span class="line"><span class="number">41</span> <span class="number">148</span>  <span class="number">0</span> <span class="number">122</span>  <span class="number">72</span>  <span class="number">66</span> <span class="number">601</span>  <span class="number">998</span>   <span class="number">9</span>  <span class="number">19</span>  <span class="number">84</span> <span class="number">20</span> <span class="number">590</span>  <span class="number">144</span> <span class="number">0.025100</span> <span class="number">30.0001</span>  <span class="number">880</span></span><br><span class="line"><span class="number">42</span> <span class="number">141</span>  <span class="number">0</span> <span class="number">109</span>  <span class="number">56</span>  <span class="number">54</span> <span class="number">523</span>  <span class="number">968</span>   <span class="number">4</span>   <span class="number">2</span> <span class="number">107</span> <span class="number">37</span> <span class="number">489</span>  <span class="number">170</span> <span class="number">0.088904</span> <span class="number">12.1996</span>  <span class="number">542</span></span><br><span class="line"><span class="number">43</span> <span class="number">162</span>  <span class="number">1</span>  <span class="number">99</span>  <span class="number">75</span>  <span class="number">70</span> <span class="number">522</span>  <span class="number">996</span>  <span class="number">40</span> <span class="number">208</span>  <span class="number">73</span> <span class="number">27</span> <span class="number">496</span>  <span class="number">224</span> <span class="number">0.054902</span> <span class="number">31.9989</span>  <span class="number">823</span></span><br><span class="line"><span class="number">44</span> <span class="number">136</span>  <span class="number">0</span> <span class="number">121</span>  <span class="number">95</span>  <span class="number">96</span> <span class="number">574</span> <span class="number">1012</span>  <span class="number">29</span>  <span class="number">36</span> <span class="number">111</span> <span class="number">37</span> <span class="number">622</span>  <span class="number">162</span> <span class="number">0.028100</span> <span class="number">30.0001</span> <span class="number">1030</span></span><br><span class="line"><span class="number">45</span> <span class="number">139</span>  <span class="number">1</span>  <span class="number">88</span>  <span class="number">46</span>  <span class="number">41</span> <span class="number">480</span>  <span class="number">968</span>  <span class="number">19</span>  <span class="number">49</span> <span class="number">135</span> <span class="number">53</span> <span class="number">457</span>  <span class="number">249</span> <span class="number">0.056202</span> <span class="number">32.5996</span>  <span class="number">455</span></span><br><span class="line"><span class="number">46</span> <span class="number">126</span>  <span class="number">0</span> <span class="number">104</span> <span class="number">106</span>  <span class="number">97</span> <span class="number">599</span>  <span class="number">989</span>  <span class="number">40</span>  <span class="number">24</span>  <span class="number">78</span> <span class="number">25</span> <span class="number">593</span>  <span class="number">171</span> <span class="number">0.046598</span> <span class="number">16.6999</span>  <span class="number">508</span></span><br><span class="line"><span class="number">47</span> <span class="number">130</span>  <span class="number">0</span> <span class="number">121</span>  <span class="number">90</span>  <span class="number">91</span> <span class="number">623</span> <span class="number">1049</span>   <span class="number">3</span>  <span class="number">22</span> <span class="number">113</span> <span class="number">40</span> <span class="number">588</span>  <span class="number">160</span> <span class="number">0.052802</span> <span class="number">16.0997</span>  <span class="number">849</span></span><br><span class="line"><span class="operator">&gt;</span> t.test<span class="punctuation">(</span>Prob <span class="operator">~</span> So<span class="punctuation">,</span>data <span class="operator">=</span> UScrime<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">	Welch Two Sample t<span class="operator">-</span>test</span><br><span class="line"></span><br><span class="line">data<span class="operator">:</span>  Prob by So</span><br><span class="line">t <span class="operator">=</span> <span class="operator">-</span><span class="number">3.8954</span><span class="punctuation">,</span> df <span class="operator">=</span> <span class="number">24.925</span><span class="punctuation">,</span> p<span class="operator">-</span>value <span class="operator">=</span> <span class="number">0.0006506</span> <span class="comment"># p-value小于0.05</span></span><br><span class="line">alternative hypothesis<span class="operator">:</span> true difference <span class="keyword">in</span> means between group <span class="number">0</span> and group <span class="number">1</span> is not equal to <span class="number">0</span></span><br><span class="line"><span class="number">95</span> percent confidence interval<span class="operator">:</span></span><br><span class="line"> <span class="operator">-</span><span class="number">0.03852569</span> <span class="operator">-</span><span class="number">0.01187439</span></span><br><span class="line">sample estimates<span class="operator">:</span></span><br><span class="line">mean <span class="keyword">in</span> group <span class="number">0</span> mean <span class="keyword">in</span> group <span class="number">1</span> </span><br><span class="line">     <span class="number">0.03851265</span>      <span class="number">0.06371269</span> </span><br></pre></td></tr></table></figure>
<p><code>t.test(y ~ x)</code>：其中<code>y</code>为数值型变量，<code>x</code>为二分型的变量</p>
<p>如果数据满足正态分布，可以使用方差分析，如果不满足正态分布，就需要使用非参数的方法。在相关性检验中常常会听到参数检验和非参数检验。</p>
<p>参数检验，Parametric tests，是在总体分布形式已知的情况下，对总体分布的参数如均值、方差等进行推断的方法。也就是数据分布已知比如满足正态分布。</p>
<p>非参数检验，称为Nonparametric tests，在总体方差未知或知道甚少的情况下，利用样本数据对总体分布形态等进行推断的方法。由于非参数检验方法在推断过程中不涉及有关总体分布的参数，因而得名为“非参数”检验。</p>
<h3 id="5-8-绘图函数">5.8 绘图函数</h3>
<p>R语言四大绘图系统：</p>
<ul>
<li>基础绘图系统</li>
<li>lattice包</li>
<li>ggplot2包</li>
<li>grid包</li>
</ul>
<p>基础绘图包：<code>graphics</code>包</p>
<p>通过命令<code>ls</code>将<code>graphics</code>包所有的函数都列举出来。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> ls<span class="punctuation">(</span><span class="string">&quot;package:graphics&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><code>arrows</code>函数用来绘制箭头，<code>hist</code>函数绘制直方图，<code>stars</code>函数是绘制晶状体，<code>pie</code>函数绘制饼图，<code>polygon</code>函数绘制多边形图。</p>
<p>R基础绘图系统：</p>
<ol>
<li>高级绘图</li>
</ol>
<p>高级绘图是一步到位，可以直接绘制出图。</p>
<ol start="2">
<li>低级绘图</li>
</ol>
<p>低级绘图不能单独使用，必须再高级绘图产生图形的基础上，对图形进行调整，比如加一条线，加上标题文字等。</p>
<p>R绘图输入数据：</p>
<p>散点图：x和y两个坐标数据</p>
<p>直方图：因子</p>
<p>热力图：数据矩阵</p>
<p>…</p>
<p><code>plot</code>函数进行绘图：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>women<span class="operator">$</span>height<span class="punctuation">)</span> <span class="comment"># women$height为向量，绘制出的是散点图</span></span><br></pre></td></tr></table></figure>
<p>如图，如果只是一列向量，则为序列为横坐标，纵坐标为向量值。</p>
<p><img src="https://vip2.loli.io/2023/03/13/BEbpMz4dfXcKSJs.png" alt=""></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>women<span class="operator">$</span>height<span class="punctuation">,</span>women<span class="operator">$</span>weight<span class="punctuation">)</span> <span class="comment"># women$height,women$weight均为向量，绘制出的是散点图</span></span><br></pre></td></tr></table></figure>
<p>如图，如果是两列向量，则反映两个向量之间的关系。</p>
<p><img src="https://vip2.loli.io/2023/03/13/5ydG1DtwTlQKoEH.png" alt="image-20220812095806887"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plot<span class="punctuation">(</span>as.factor<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果输入的是因子，绘制出来的是直方图。</p>
<p><img src="https://vip2.loli.io/2023/03/13/Ni7VhPJnylrDXFQ.png" alt="image-20220812100205889"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>as.factor<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span><span class="punctuation">,</span>mtcars<span class="operator">$</span>carb<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果一个是因子，一个是向量，则绘制出的是箱线图。</p>
<p><img src="https://vip2.loli.io/2023/03/13/oj3cSPUlwaL4Rib.png" alt="image-20220812103138148"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>mtcars<span class="operator">$</span>carb<span class="punctuation">,</span>as.factor<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果第一个是向量，第二个是因子，绘制的是散列图。</p>
<p><img src="https://vip2.loli.io/2023/03/13/r5OTBeNZ2dLhqDk.png" alt="image-20220812103322006"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>as.factor<span class="punctuation">(</span>mtcars<span class="operator">$</span>carb<span class="punctuation">)</span><span class="punctuation">,</span>as.factor<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果两个都是因子，输出的是脊柱图。</p>
<p><img src="https://vip2.loli.io/2023/03/13/bkcI14wiVEgaLeN.png" alt="image-20220812103455696"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>women<span class="operator">$</span>height <span class="operator">~</span> women<span class="operator">$</span>weight<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>这里<code>plot</code>绘制的是二者的关系图。</p>
<p><img src="https://vip2.loli.io/2023/03/13/P3Ha1SzkvbTZChd.png" alt="image-20220812103849495"></p>
<p>实际上，<code>plot</code>函数的参数主要由<code>par</code>提供。不同于<code>plot</code>函数，<code>par</code>函数的参数除个别外一旦设定，除非再次更改或重启R，否则就会对后续所有的绘图命令起作用。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>as.factor<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span><span class="punctuation">,</span>col<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span><span class="string">&quot;blue&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/4OAm2jMlVac5IBs.png" alt="image-20220812105524219"></p>
<p>在设置参数之前，可以使用以下代码保存绘图系统的默认参数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 储存当前参数</span></span><br><span class="line">opar <span class="operator">&lt;-</span> par<span class="punctuation">(</span>no.readonly <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>设置参数前可以先查看当前的参数值：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">par<span class="punctuation">(</span><span class="string">&quot;usr&quot;</span><span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;usr&quot;</span><span class="punctuation">,</span> <span class="string">&quot;fin&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>大部分参数既可以在<code>par</code>中设置，又可以在<code>plot</code>中设置，区别在于前者设置的参数对全局起作用，后者设置的参数只对本条命令起作用，相当于<code>plot</code>中的<code>...</code>参数，个别参数在两种情况下面对的对象也不同。还有，以下参数只能在<code>par</code>中使用：</p>
<ul>
<li>ask</li>
<li>fig, fin</li>
<li>lheight</li>
<li>mai, mar, mex, mfcol, mfrow, mfg</li>
<li>new</li>
<li>oma, omd, omi</li>
<li>pin, plt, ps, pty</li>
<li>usr</li>
<li>xlog, ylog</li>
<li>ylbias</li>
</ul>
<h3 id="5-9-自定义函数">5.9 自定义函数</h3>
<p>直接在终端中输入函数名，会给出源代码：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cor</span><br></pre></td></tr></table></figure>
<p>R自定义函数：</p>
<ol>
<li>
<p>函数名称：函数命令与功能相关，可以是字母和数字的组合，但必须是字母开头</p>
</li>
<li>
<p>函数声明</p>
</li>
<li>
<p>函数参数</p>
</li>
<li>
<p>函数体</p>
</li>
</ol>
<p>利用function函数来声明</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">myfun <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>选项参数<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">	函数体</span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>示例：计算偏度与峰度的函数</p>
<p>偏度（skewness）是统计数据分布偏斜方向和程度的度量，是统计数据分布非对称程度的数字特征。</p>
<p>峰度（peakedness; kurtosis）又称峰态系数。表征概率密度分布曲线在平均值处峰值的特征数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mystats<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">         n       mean      stdev       skew   kurtosis </span><br><span class="line"> <span class="number">87.000000</span> <span class="number">440.000000</span> <span class="number">252.586619</span>  <span class="operator">-</span><span class="number">5.285971</span> <span class="operator">-</span><span class="number">12.208086</span> </span><br><span class="line"><span class="operator">&gt;</span> mystats <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span>na.omit<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="operator">+</span>     <span class="keyword">if</span><span class="punctuation">(</span>na.omit<span class="punctuation">)</span></span><br><span class="line"><span class="operator">+</span>         x <span class="operator">&lt;-</span> x<span class="punctuation">[</span><span class="operator">!</span><span class="built_in">is.na</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">+</span>     m <span class="operator">&lt;-</span> mean<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="operator">+</span>     n <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="operator">+</span>     s <span class="operator">&lt;-</span> sd<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="operator">+</span>     skew <span class="operator">&lt;-</span> <span class="built_in">sum</span><span class="punctuation">(</span><span class="punctuation">(</span>x<span class="operator">-</span>m<span class="punctuation">)</span><span class="operator">^</span><span class="number">3</span><span class="operator">/</span>s<span class="operator">^</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">/</span>n</span><br><span class="line"><span class="operator">+</span>     kurt <span class="operator">&lt;-</span> <span class="built_in">sum</span><span class="punctuation">(</span><span class="punctuation">(</span>x<span class="operator">-</span>m<span class="punctuation">)</span><span class="operator">^</span><span class="number">4</span><span class="operator">/</span>s<span class="operator">^</span><span class="number">4</span><span class="punctuation">)</span><span class="operator">/</span>n<span class="operator">-</span><span class="number">3</span></span><br><span class="line"><span class="operator">+</span>     <span class="built_in">return</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>n<span class="operator">=</span>n<span class="punctuation">,</span>mean<span class="operator">=</span>m<span class="punctuation">,</span>stdev<span class="operator">=</span>s<span class="punctuation">,</span>skew<span class="operator">=</span>skew<span class="punctuation">,</span>kurtosis<span class="operator">=</span>kurt<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">+</span> <span class="punctuation">&#125;</span></span><br><span class="line"><span class="operator">&gt;</span> mystats<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">         n       mean      stdev       skew   kurtosis </span><br><span class="line"> <span class="number">87.000000</span> <span class="number">440.000000</span> <span class="number">252.586619</span>   <span class="number">0.000000</span>  <span class="operator">-</span><span class="number">1.241451</span> </span><br></pre></td></tr></table></figure>
<p>循环和向量化操作：</p>
<p>函数内部通过循环实现向量化操作。</p>
<p>循环三部分：</p>
<ul>
<li>条件判断，是真或者假</li>
<li>用于循环执行的结构</li>
<li>表达式</li>
</ul>
<p><code>for</code>循环：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span>print <span class="punctuation">(</span><span class="string">&quot;Hello,World&quot;</span><span class="punctuation">)</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>while</code>循环：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> i<span class="operator">=</span><span class="number">1</span>;<span class="keyword">while</span><span class="punctuation">(</span>i <span class="operator">&lt;=</span> <span class="number">10</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span>print <span class="punctuation">(</span><span class="string">&quot;Hello,World&quot;</span><span class="punctuation">)</span>;i<span class="operator">=</span>i<span class="operator">+</span><span class="number">1</span>;<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Hello,World&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>if…else…</code>：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> score<span class="operator">=</span><span class="number">70</span>;<span class="keyword">if</span> <span class="punctuation">(</span>score <span class="operator">&gt;</span><span class="number">60</span> <span class="punctuation">)</span> <span class="punctuation">&#123;</span>print <span class="punctuation">(</span><span class="string">&quot;Passwd&quot;</span><span class="punctuation">)</span> <span class="punctuation">&#125;</span> <span class="keyword">else</span> <span class="punctuation">&#123;</span>print <span class="punctuation">(</span><span class="string">&quot;Failed&quot;</span><span class="punctuation">)</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Passwd&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> ifelse<span class="punctuation">(</span> score <span class="operator">&gt;</span><span class="number">60</span><span class="punctuation">,</span>print <span class="punctuation">(</span><span class="string">&quot;Passwd&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>print <span class="punctuation">(</span><span class="string">&quot;Failed&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 也可以写在一起，进行简化</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Passwd&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Passwd&quot;</span></span><br></pre></td></tr></table></figure>
<p>也可以使用<code>switch</code>。</p>
<h2 id="6-数据分析实战">6 数据分析实战</h2>
<h3 id="6-1-线性回归一">6.1 线性回归一</h3>
<p>回归regression，通常指那些用一个或多个预测变量，也称自变量或解释变量，来预测相应变量，也称为因变量、校标变量或结果变量的方法。</p>
<p><img src="https://vip2.loli.io/2023/03/13/Fjg4t5AL3WJ6n8m.png" alt="image-20220812145355299"></p>
<p>普通最小二乘回归法（OLS）</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>Y</mi><mo>^</mo></mover><mi>i</mi></msub><mo>=</mo><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mn>0</mn></msub><mo>+</mo><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mn>1</mn></msub><msub><mi>X</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mi>k</mi></msub><msub><mi>X</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mspace width="1em"/><mspace width="1em"/><mi>i</mi><mo>=</mo><mn>1</mn><mo>⋯</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\hat{Y}_i=\hat{\beta}_0+\hat{\beta}_1X_{1i}+\cdots +\hat{\beta}_kX_{ki}\quad \quad    i=1\cdots n
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0968em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1523em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1523em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1523em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ki</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>Y</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\hat{Y}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0968em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ：第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 次观测对应的因变量的预测值（具体来讲，它是在已知预测变量值的条件下，对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 分布估计的均值）；</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> ：第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 次观测对应的第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 个预测变量值；</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\hat{\beta}_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1523em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ： 截距项（当所有的预测变量都为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> 时， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 的预测值）</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\hat{\beta}_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.244em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> ： 预测变量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 的回归系数（斜率表示 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">X_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 改变一个单位所引起的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 的改变量）</p>
<p><strong>满足OLS模型统计假设</strong>：</p>
<ul>
<li>正态性：对于固定的自变量值，因变量值成正态分布。</li>
<li>独立性：因变量之间相互独立。</li>
<li>线性：因变量与自变量之间为线性相关。</li>
<li>同方差性：因变量的方差不随自变量的水平不同而变化。也可称作不变方差。</li>
</ul>
<p>==注意==：只有满足以上条件才能运用<code>lm</code>函数进行拟合。</p>
<p>可是使用<code>lm</code>函数进行线性回归模型分析：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>weight <span class="operator">~</span> height<span class="punctuation">,</span>data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit</span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height<span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>       height  </span><br><span class="line">     <span class="operator">-</span><span class="number">87.52</span>         <span class="number">3.45</span>  </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span>   <span class="comment"># 列出使用的回归公式</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height<span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span> <span class="comment"># 残差，真实值和预测值之间的差</span></span><br><span class="line">    Min      <span class="number">1</span>Q  Median      <span class="number">3</span>Q     Max </span><br><span class="line"><span class="operator">-</span><span class="number">1.7333</span> <span class="operator">-</span><span class="number">1.1333</span> <span class="operator">-</span><span class="number">0.3833</span>  <span class="number">0.7417</span>  <span class="number">3.1167</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">87.51667</span>    <span class="number">5.93694</span>  <span class="operator">-</span><span class="number">14.74</span> <span class="number">1.71e-09</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">height        <span class="number">3.45000</span>    <span class="number">0.09114</span>   <span class="number">37.85</span> <span class="number">1.09e-14</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">1.525</span> on <span class="number">13</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.991</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9903</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>  <span class="number">1433</span> on <span class="number">1</span> and <span class="number">13</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">1.091e-14</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary.lm<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height<span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">    Min      <span class="number">1</span>Q  Median      <span class="number">3</span>Q     Max </span><br><span class="line"><span class="operator">-</span><span class="number">1.7333</span> <span class="operator">-</span><span class="number">1.1333</span> <span class="operator">-</span><span class="number">0.3833</span>  <span class="number">0.7417</span>  <span class="number">3.1167</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">87.51667</span>    <span class="number">5.93694</span>  <span class="operator">-</span><span class="number">14.74</span> <span class="number">1.71e-09</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">height        <span class="number">3.45000</span>    <span class="number">0.09114</span>   <span class="number">37.85</span> <span class="number">1.09e-14</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">1.525</span> on <span class="number">13</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.991</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9903</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>  <span class="number">1433</span> on <span class="number">1</span> and <span class="number">13</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">1.091e-14</span></span><br></pre></td></tr></table></figure>
<p>使用<code>summary</code>和使用<code>summary.lm</code>结果相同，因为使用<code>summary</code>，会自动调用其子函数<code>summary.lm</code>。</p>
<p><code>Call</code>列出使用的回归公式；</p>
<p><code>Residuals</code>为残差，真实值和预测值之间的差，残差值越小说明模型越精确。</p>
<p><code>Coefficients</code>为系数项，<code>Intercept</code>为截距，即x为0时，y轴的坐标。</p>
<p>因此公式为：weight = 3.45000×Height-87.51667</p>
<p><code>Pr</code>即p-value，估计系数为0假设的概率，小于0.05比较好</p>
<p>R对p值和t值进行了标记，分为五个等级，<code>***</code>结果最好。</p>
<p><code>Residual standard error: 1.525 on 13 degrees of freedom</code>为残差标准误差，误差越小越好。</p>
<p><code>Multiple R-squared</code>为R方判定系数，衡量模型拟合质量的指标，取值在0和1之间，值越大越好，它是表示回归模型所能解释的响应变量的方差比例，即这个模型能够解释99.1%的数据，只有0.9%的数据不符合此模型。</p>
<p><code>F-statistic</code>为F统计量，这个值说明模型是否显著，也是用p-value来衡量，p-value值越小越好，说明模型越显著。</p>
<blockquote>
<p>==重点==：一般首先看F统计量，如果不小于0.05，这个模型没有价值，需要重新进行拟合，如果小于0.05再看R方，看模型能够解释多少变量。</p>
</blockquote>
<h3 id="6-2-线性回归二">6.2 线性回归二</h3>
<p>除了<code>summary</code>可以查看运行结果，还可以通过其他函数进行查看：</p>
<p>函数：</p>
<p><code>summary</code>：展示拟合模型的详细结果</p>
<p><code>coefficients</code>：列出拟合模型的模型参数（截距项和斜率），</p>
<p><code>confint</code>：提供模型参数的置信区间（默认95%）</p>
<p><code>fitted</code>：列出拟合模型的预测值</p>
<p><code>residuals</code>：列出拟合模型的残差值</p>
<p><code>anova</code>：生成一个拟合模型的方差分析表，或者比较两个或更多拟合模型的方差分析表</p>
<p><code>vcov</code>：列出模型参数的协方差矩阵</p>
<p><code>AIC</code>：输出赤池信息统计量</p>
<p><code>plot</code>：生成评价拟合模型的诊断图</p>
<p><code>predict</code>：用拟合模型对新的数据集预测响应变量值</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>weight <span class="operator">~</span> height<span class="punctuation">,</span>data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit</span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height<span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>       height  </span><br><span class="line">     <span class="operator">-</span><span class="number">87.52</span>         <span class="number">3.45</span>  </span><br><span class="line"><span class="operator">&gt;</span> coefficients<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>      height </span><br><span class="line">  <span class="operator">-</span><span class="number">87.51667</span>     <span class="number">3.45000</span> </span><br><span class="line"><span class="operator">&gt;</span> confint<span class="punctuation">(</span>fit<span class="punctuation">)</span> <span class="comment"># 默认为95%的置信区间</span></span><br><span class="line">                  <span class="number">2.5</span> <span class="operator">%     97.5 %</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">100.342655</span> <span class="operator">-</span><span class="number">74.690679</span></span><br><span class="line">height         <span class="number">3.253112</span>   <span class="number">3.646888</span></span><br><span class="line"><span class="operator">&gt;</span> confint<span class="punctuation">(</span>fit<span class="punctuation">,</span>level <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="comment"># 默认为95%的置信区间，可以通过level进行调整</span></span><br><span class="line">                  <span class="number">25</span> <span class="operator">%       75 %</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">91.635892</span> <span class="operator">-</span><span class="number">83.397441</span></span><br><span class="line">height        <span class="number">3.386767</span>   <span class="number">3.513233</span></span><br><span class="line"><span class="operator">&gt;</span> fitted<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">       <span class="number">1</span>        <span class="number">2</span>        <span class="number">3</span>        <span class="number">4</span>        <span class="number">5</span>        <span class="number">6</span>        <span class="number">7</span>        <span class="number">8</span>        <span class="number">9</span>       <span class="number">10</span>       <span class="number">11</span>       <span class="number">12</span> </span><br><span class="line"><span class="number">112.5833</span> <span class="number">116.0333</span> <span class="number">119.4833</span> <span class="number">122.9333</span> <span class="number">126.3833</span> <span class="number">129.8333</span> <span class="number">133.2833</span> <span class="number">136.7333</span> <span class="number">140.1833</span> <span class="number">143.6333</span> <span class="number">147.0833</span> <span class="number">150.5333</span> </span><br><span class="line">      <span class="number">13</span>       <span class="number">14</span>       <span class="number">15</span> </span><br><span class="line"><span class="number">153.9833</span> <span class="number">157.4333</span> <span class="number">160.8833</span> </span><br><span class="line"><span class="operator">&gt;</span> women<span class="operator">$</span>weight <span class="operator">-</span> fitted<span class="punctuation">(</span>fit<span class="punctuation">)</span> <span class="comment"># 真实值 - fitted(预测值) 就是残差</span></span><br><span class="line">          <span class="number">1</span>           <span class="number">2</span>           <span class="number">3</span>           <span class="number">4</span>           <span class="number">5</span>           <span class="number">6</span>           <span class="number">7</span>           <span class="number">8</span>           <span class="number">9</span> </span><br><span class="line"> <span class="number">2.41666667</span>  <span class="number">0.96666667</span>  <span class="number">0.51666667</span>  <span class="number">0.06666667</span> <span class="operator">-</span><span class="number">0.38333333</span> <span class="operator">-</span><span class="number">0.83333333</span> <span class="operator">-</span><span class="number">1.28333333</span> <span class="operator">-</span><span class="number">1.73333333</span> <span class="operator">-</span><span class="number">1.18333333</span> </span><br><span class="line">         <span class="number">10</span>          <span class="number">11</span>          <span class="number">12</span>          <span class="number">13</span>          <span class="number">14</span>          <span class="number">15</span> </span><br><span class="line"><span class="operator">-</span><span class="number">1.63333333</span> <span class="operator">-</span><span class="number">1.08333333</span> <span class="operator">-</span><span class="number">0.53333333</span>  <span class="number">0.01666667</span>  <span class="number">1.56666667</span>  <span class="number">3.11666667</span> </span><br><span class="line"><span class="operator">&gt;</span> residuals<span class="punctuation">(</span>fit<span class="punctuation">)</span> <span class="comment"># 残差</span></span><br><span class="line">          <span class="number">1</span>           <span class="number">2</span>           <span class="number">3</span>           <span class="number">4</span>           <span class="number">5</span>           <span class="number">6</span>           <span class="number">7</span>           <span class="number">8</span>           <span class="number">9</span> </span><br><span class="line"> <span class="number">2.41666667</span>  <span class="number">0.96666667</span>  <span class="number">0.51666667</span>  <span class="number">0.06666667</span> <span class="operator">-</span><span class="number">0.38333333</span> <span class="operator">-</span><span class="number">0.83333333</span> <span class="operator">-</span><span class="number">1.28333333</span> <span class="operator">-</span><span class="number">1.73333333</span> <span class="operator">-</span><span class="number">1.18333333</span> </span><br><span class="line">         <span class="number">10</span>          <span class="number">11</span>          <span class="number">12</span>          <span class="number">13</span>          <span class="number">14</span>          <span class="number">15</span> </span><br><span class="line"><span class="operator">-</span><span class="number">1.63333333</span> <span class="operator">-</span><span class="number">1.08333333</span> <span class="operator">-</span><span class="number">0.53333333</span>  <span class="number">0.01666667</span>  <span class="number">1.56666667</span>  <span class="number">3.11666667</span> </span><br><span class="line"><span class="operator">&gt;</span> predict<span class="punctuation">(</span>fit<span class="punctuation">,</span>women<span class="punctuation">)</span></span><br><span class="line">       <span class="number">1</span>        <span class="number">2</span>        <span class="number">3</span>        <span class="number">4</span>        <span class="number">5</span>        <span class="number">6</span>        <span class="number">7</span>        <span class="number">8</span>        <span class="number">9</span>       <span class="number">10</span>       <span class="number">11</span>       <span class="number">12</span> </span><br><span class="line"><span class="number">112.5833</span> <span class="number">116.0333</span> <span class="number">119.4833</span> <span class="number">122.9333</span> <span class="number">126.3833</span> <span class="number">129.8333</span> <span class="number">133.2833</span> <span class="number">136.7333</span> <span class="number">140.1833</span> <span class="number">143.6333</span> <span class="number">147.0833</span> <span class="number">150.5333</span> </span><br><span class="line">      <span class="number">13</span>       <span class="number">14</span>       <span class="number">15</span> </span><br><span class="line"><span class="number">153.9833</span> <span class="number">157.4333</span> <span class="number">160.8833</span> </span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>fit<span class="punctuation">)</span> <span class="comment"># 下面会生成四幅图</span></span><br><span class="line">Hit <span class="operator">&lt;</span>Return<span class="operator">&gt;</span> to see <span class="keyword">next</span> plot<span class="operator">:</span>  <span class="comment"># 残差拟合图</span></span><br><span class="line">Hit <span class="operator">&lt;</span>Return<span class="operator">&gt;</span> to see <span class="keyword">next</span> plot<span class="operator">:</span>  <span class="comment"># 正态QQ图</span></span><br><span class="line">Hit <span class="operator">&lt;</span>Return<span class="operator">&gt;</span> to see <span class="keyword">next</span> plot<span class="operator">:</span>  <span class="comment"># 大小位列图</span></span><br><span class="line">Hit <span class="operator">&lt;</span>Return<span class="operator">&gt;</span> to see <span class="keyword">next</span> plot<span class="operator">:</span>  <span class="comment"># 残差影响图</span></span><br></pre></td></tr></table></figure>
<p>通过abline函数生成拟合曲线：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>women<span class="operator">$</span>height<span class="punctuation">,</span>women<span class="operator">$</span>weight<span class="punctuation">)</span> <span class="comment"># 绘制散点图</span></span><br><span class="line"><span class="operator">&gt;</span> abline<span class="punctuation">(</span>fit<span class="punctuation">)</span> <span class="comment"># 在plot的基础上绘制拟合曲线</span></span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/lyhNOGWk2Fu3mZd.png" alt="image-20220812214052232"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fit2 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>weight <span class="operator">~</span> height<span class="operator">+</span>I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span>data<span class="operator">=</span>women<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit2</span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height <span class="operator">+</span> I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>       height  I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span>  </span><br><span class="line">  <span class="number">261.87818</span>     <span class="operator">-</span><span class="number">7.34832</span>      <span class="number">0.08306</span>  </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height <span class="operator">+</span> I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">     Min       <span class="number">1</span>Q   Median       <span class="number">3</span>Q      Max </span><br><span class="line"><span class="operator">-</span><span class="number">0.50941</span> <span class="operator">-</span><span class="number">0.29611</span> <span class="operator">-</span><span class="number">0.00941</span>  <span class="number">0.28615</span>  <span class="number">0.59706</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">261.87818</span>   <span class="number">25.19677</span>  <span class="number">10.393</span> <span class="number">2.36e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">height       <span class="operator">-</span><span class="number">7.34832</span>    <span class="number">0.77769</span>  <span class="operator">-</span><span class="number">9.449</span> <span class="number">6.58e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span>   <span class="number">0.08306</span>    <span class="number">0.00598</span>  <span class="number">13.891</span> <span class="number">9.32e-09</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.3841</span> on <span class="number">12</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9995</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9994</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">1.139e+04</span> on <span class="number">2</span> and <span class="number">12</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>women<span class="operator">$</span>height<span class="punctuation">,</span>women<span class="operator">$</span>weight<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> abline<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> lines<span class="punctuation">(</span>women<span class="operator">$</span>height<span class="punctuation">,</span>fitted<span class="punctuation">(</span>fit2<span class="punctuation">)</span><span class="punctuation">,</span>col<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/VE6WCcftrmuqykb.png" alt="image-20220812215015350"></p>
<p>注意：<code>abline</code>函数只能绘制直线，<code>lines</code>函数可以绘制曲线。在线性回归时，<code>fit2 &lt;- lm(weight ~ height+I(height^2),data=women)</code>中的二次项，不能直接用<code>height^2</code>，因为倒三角符号<code>^</code>具有特殊的含义。</p>
<p>拟合多项式不是越多越好，多项式越多，可能存导致拟合。</p>
<h3 id="6-3-多元线性回归">6.3 多元线性回归</h3>
<p><code>lm</code>函数输入数据必须时数据框的格式。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> states <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Murder&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Population&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Illiteracy&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Income&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Frost&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> states</span><br><span class="line">               Murder Population Illiteracy Income Frost</span><br><span class="line">Alabama          <span class="number">15.1</span>       <span class="number">3615</span>        <span class="number">2.1</span>   <span class="number">3624</span>    <span class="number">20</span></span><br><span class="line">Alaska           <span class="number">11.3</span>        <span class="number">365</span>        <span class="number">1.5</span>   <span class="number">6315</span>   <span class="number">152</span></span><br><span class="line">Arizona           <span class="number">7.8</span>       <span class="number">2212</span>        <span class="number">1.8</span>   <span class="number">4530</span>    <span class="number">15</span></span><br><span class="line">Arkansas         <span class="number">10.1</span>       <span class="number">2110</span>        <span class="number">1.9</span>   <span class="number">3378</span>    <span class="number">65</span></span><br><span class="line">California       <span class="number">10.3</span>      <span class="number">21198</span>        <span class="number">1.1</span>   <span class="number">5114</span>    <span class="number">20</span></span><br><span class="line">...</span><br><span class="line">Virginia          <span class="number">9.5</span>       <span class="number">4981</span>        <span class="number">1.4</span>   <span class="number">4701</span>    <span class="number">85</span></span><br><span class="line">Washington        <span class="number">4.3</span>       <span class="number">3559</span>        <span class="number">0.6</span>   <span class="number">4864</span>    <span class="number">32</span></span><br><span class="line">West Virginia     <span class="number">6.7</span>       <span class="number">1799</span>        <span class="number">1.4</span>   <span class="number">3617</span>   <span class="number">100</span></span><br><span class="line">Wisconsin         <span class="number">3.0</span>       <span class="number">4589</span>        <span class="number">0.7</span>   <span class="number">4468</span>   <span class="number">149</span></span><br><span class="line">Wyoming           <span class="number">6.9</span>        <span class="number">376</span>        <span class="number">0.6</span>   <span class="number">4566</span>   <span class="number">173</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Murder <span class="operator">~</span> Population<span class="operator">+</span>Illiteracy<span class="operator">+</span>Income<span class="operator">+</span>Frost<span class="punctuation">,</span>data <span class="operator">=</span>states<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Murder <span class="operator">~</span> Population <span class="operator">+</span> Illiteracy <span class="operator">+</span> Income <span class="operator">+</span> Frost<span class="punctuation">,</span> </span><br><span class="line">    data <span class="operator">=</span> states<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">    Min      <span class="number">1</span>Q  Median      <span class="number">3</span>Q     Max </span><br><span class="line"><span class="operator">-</span><span class="number">4.7960</span> <span class="operator">-</span><span class="number">1.6495</span> <span class="operator">-</span><span class="number">0.0811</span>  <span class="number">1.4815</span>  <span class="number">7.6210</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">1.235e+00</span>  <span class="number">3.866e+00</span>   <span class="number">0.319</span>   <span class="number">0.7510</span>    </span><br><span class="line">Population  <span class="number">2.237e-04</span>  <span class="number">9.052e-05</span>   <span class="number">2.471</span>   <span class="number">0.0173</span> <span class="operator">*</span>  </span><br><span class="line">Illiteracy  <span class="number">4.143e+00</span>  <span class="number">8.744e-01</span>   <span class="number">4.738</span> <span class="number">2.19e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Income      <span class="number">6.442e-05</span>  <span class="number">6.837e-04</span>   <span class="number">0.094</span>   <span class="number">0.9253</span>    </span><br><span class="line">Frost       <span class="number">5.813e-04</span>  <span class="number">1.005e-02</span>   <span class="number">0.058</span>   <span class="number">0.9541</span>    </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">2.535</span> on <span class="number">45</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.567</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.5285</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">14.73</span> on <span class="number">4</span> and <span class="number">45</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">9.133e-08</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> coef<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>   Population   Illiteracy       Income        Frost </span><br><span class="line"><span class="number">1.2345634112</span> <span class="number">0.0002236754</span> <span class="number">4.1428365903</span> <span class="number">0.0000644247</span> <span class="number">0.0005813055</span> </span><br><span class="line"><span class="operator">&gt;</span> options<span class="punctuation">(</span>digits <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span> <span class="comment"># 表示保留几位有效数字</span></span><br><span class="line"><span class="operator">&gt;</span> coef<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  Population  Illiteracy      Income       Frost </span><br><span class="line">  <span class="number">1.235e+00</span>   <span class="number">2.237e-04</span>   <span class="number">4.143e+00</span>   <span class="number">6.442e-05</span>   <span class="number">5.813e-04</span> </span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>mpg <span class="operator">~</span> hp<span class="operator">+</span>wt<span class="operator">+</span>hp<span class="operator">:</span>wt<span class="punctuation">,</span>data <span class="operator">=</span> mtcars<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> mpg <span class="operator">~</span> hp <span class="operator">+</span> wt <span class="operator">+</span> hp<span class="operator">:</span>wt<span class="punctuation">,</span> data <span class="operator">=</span> mtcars<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">   Min     <span class="number">1</span>Q Median     <span class="number">3</span>Q    Max </span><br><span class="line"><span class="operator">-</span><span class="number">3.063</span> <span class="operator">-</span><span class="number">1.649</span> <span class="operator">-</span><span class="number">0.736</span>  <span class="number">1.421</span>  <span class="number">4.551</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">49.80842</span>    <span class="number">3.60516</span>   <span class="number">13.82</span>  <span class="number">5.0e-14</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">hp          <span class="operator">-</span><span class="number">0.12010</span>    <span class="number">0.02470</span>   <span class="operator">-</span><span class="number">4.86</span>  <span class="number">4.0e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">wt          <span class="operator">-</span><span class="number">8.21662</span>    <span class="number">1.26971</span>   <span class="operator">-</span><span class="number">6.47</span>  <span class="number">5.2e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">hp<span class="operator">:</span>wt        <span class="number">0.02785</span>    <span class="number">0.00742</span>    <span class="number">3.75</span>  <span class="number">0.00081</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">2.15</span> on <span class="number">28</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.885</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.872</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">71.7</span> on <span class="number">3</span> and <span class="number">28</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">2.98e-13</span></span><br></pre></td></tr></table></figure>
<p><code>fit &lt;- lm(mpg ~ hp+wt+hp:wt,data = mtcars)</code>中<code>hp:wt</code>表示<code>hp</code>和<code>wt</code>之间是某种交互关系。</p>
<p>当存在多个变量，各个变量之间存在相互关系，是否需要添加交互项或者多项式来提高拟合度？对于这个问题，可以使用AIC函数来比较模型。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="operator">?</span>AIC</span><br></pre></td></tr></table></figure>
<p>AIC全名为Akaike’s An Information Criterion</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fit1 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Murder <span class="operator">~</span> Population <span class="operator">+</span> Illiteracy <span class="operator">+</span> Income <span class="operator">+</span> Frost<span class="punctuation">,</span>data<span class="operator">=</span>states<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit2 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Murder <span class="operator">~</span> Population <span class="operator">+</span> Illiteracy<span class="punctuation">,</span>data<span class="operator">=</span>states<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> AIC<span class="punctuation">(</span>fit1<span class="punctuation">,</span>fit2<span class="punctuation">)</span></span><br><span class="line">     df   AIC</span><br><span class="line">fit1  <span class="number">6</span> <span class="number">241.6</span></span><br><span class="line">fit2  <span class="number">4</span> <span class="number">237.7</span></span><br></pre></td></tr></table></figure>
<p>结果显示，<code>fit2</code>的拟合度最好</p>
<p>如果太多这样的情况，效果就不好了，可以采用逐步回归法和全子集回归法。</p>
<p>逐步回归法中模型会一次添加或删除一个变量，直到达到某个节点为止，继续添加或者删除变量，模型不再继续变化，如果每次增加变量，则向前逐步回归，如果每次删除变量，向后逐步回归。</p>
<p>全子集回归法是取所有可能的模型，然后从中计算最佳的模型。</p>
<p>全子集回归法要比逐步回归法要好，因为为检测到所有的模型，但是缺点是变量太多，会有大量的计算，会非常慢，这两种方法都需要通过R拓展包来实现。MASS包中的<code>stepAIC</code>函数可以进行逐步回归法的计算，<code>leaps</code>包中的<code>regsubsets</code>可以进行全子集回归法计算。</p>
<p>拟合效果最佳，而没有实际意义的模型是没有意义的，需要对数据有所了解。</p>
<h3 id="6-4-回归诊断">6.4 回归诊断</h3>
<p><strong>满足OLS模型统计假设</strong>：</p>
<ul>
<li>正态性：对于固定的自变量值，因变量值成正态分布。</li>
<li>独立性：因变量之间相互独立。</li>
<li>线性：因变量与自变量之间为线性相关。</li>
<li>同方差性：因变量的方差不随自变量的水平不同而变化。也可称作不变方差。</li>
</ul>
<p>==注意==：只有满足以上条件才能运用<code>lm</code>函数进行拟合。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>weight <span class="operator">~</span> height<span class="punctuation">,</span>data <span class="operator">=</span>women<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit</span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height<span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>       height  </span><br><span class="line">     <span class="operator">-</span><span class="number">87.52</span>         <span class="number">3.45</span>  </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> par<span class="punctuation">(</span>mfrow<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 通过par将四个图呈现2×2排列</span></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/mcuzkyL3IO9iZRF.png" alt="image-20220813095452051"></p>
<p>通过<code>plot(fit)</code>可以绘制出四幅图，这四幅图就是反映上面的OLS模型的四个条件。</p>
<p>第一幅图反映残差和拟合是否为线性关系，图中的点为残差值的分布，曲线为拟合曲线。</p>
<p>第二幅图为QQ图，QQ图用来描述正态性，如果数据呈正态性，则为一条直线，图中残差值也为一条直线分布，说明满足正态性要求。</p>
<p>第三幅图为位置与尺寸图，用来描述同方差性，如果满足不变方差的假设，那么图中水平线附近的点应该是随机分布的，如图，也满足条件。</p>
<p>第四幅图为残差与杠杆图，提供了对单个数据值的观测，可以看出哪些点偏差较远，可以用来鉴别离群点、高杠杆点和强影响点。</p>
<p>离群点表示回归模型对这个点的预测效果不好，残差值比较大，不适合模型。</p>
<p>高杠杆点表示异常的预测变量的组合。</p>
<p>强影响点表示这个值对模型参数的估计产生的影响过大，可以用Cook’s distance来鉴别</p>
<p>对于这些异常点，因为会干扰到模型的拟合，如果将这些点删除掉，拟合的结果会更好，如果数据中这些点干扰太大，可以删除这些观察点重新进行拟合，或者对数据进行转换，比如对所有数据取指数、取对数等，来减少这些点的影响，但是对于这些数据的修改也会存在一定的争议，因为这些干扰的数据也是数据本身的一部分，也是客观存在的，如果删除或者转换就可能违背了客观事实，类似于实验中，为了试验数据好看，去掉不符合结论的样品。甚至先有结论，然后挑选符合结论的样品进行分析。</p>
<p>上述四幅图并没有反映独立性的，独立性没有办法通过图来进行分辨，只能从搜集的数据中验证。</p>
<p>给拟合函数添加二次项，进行拟合：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fit2 <span class="operator">&lt;-</span>lm<span class="punctuation">(</span>weight <span class="operator">~</span> height <span class="operator">+</span> I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span>data<span class="operator">=</span>women<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> opar <span class="operator">&lt;-</span><span class="punctuation">(</span>no.readonly <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> par<span class="punctuation">(</span>mfrow<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>fit2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/78TqdCxl2VFSAUm.png" alt="image-20220813102302433"></p>
<p>为了验证模型准确性，可以进行抽样法验证</p>
<ol>
<li>数据集中有1000个样本，随机抽取500个数据进行回归分析；</li>
<li>模型建好之后，利用predict函数，对剩余500个样本进行预测，比较残差值；</li>
<li>如果预测准确，说明模型可以，否则就需要调整模型。</li>
</ol>
<h3 id="6-5-方差分析一">6.5 方差分析一</h3>
<p>方差分析，称为Analysis of Variance，简称ANOVA，也称为&quot;变异数分析”，用于两个及两个以上样本均数差别的显著性检验。从广义上来讲，方差分析也属于回归分析的一种。只不过线性回归的因变量一般是连续型变量。而当自变量是因子时，研究关注的重点通常会从预测转向不同组之间差异的比较。这就是方差分析。</p>
<p><strong>R中因子的应用</strong>：计算频数、独立性检验、相关性检验、方差分析、主成分分析、因子分析……</p>
<p>方差分析会大量用在科学研究中，例如实验设计时，进行分组比较，例如药物研究实验，处理组与对照组进行比较</p>
<p>方差分析分为多种：</p>
<ul>
<li>单因素方差分析ANOVA（组内，组间）</li>
<li>双因素方差分析ANOVA</li>
<li>协方差分析ANCOVA</li>
<li>多元方差分析MANOVA</li>
<li>多元协方差分析MANCOVA</li>
</ul>
<ol>
<li>单因素组间方差分析</li>
</ol>
<p><img src="https://vip2.loli.io/2023/03/13/IjgG6kUacP2iZlm.png" alt="image-20220813104123644"></p>
<p>如图，对10位患有某种病的患者进行治疗，有两种治疗方案，将患者分为两组，每组采用不同的方案进行治疗。这里每种人数相同，为均衡分组，如果每组人数不同，则为非均衡分组。由于只有一种变量：治疗方案。因此为单因素组间方差分析。</p>
<ol start="2">
<li>单因素组内方差分析</li>
</ol>
<p>如果验证CBT方案更好，现在修改治疗方案如下：</p>
<p><img src="https://vip2.loli.io/2023/03/13/DSHQtrJ9camTB6f.png" alt="image-20220813104751584"></p>
<p>患者进行五周和六个月的治疗，这里时间不同，为组内因子，与前面的组间因子不同，这种方法称为单因素组内方差分析。实验中每位患者分别进行了两次治疗，也成为重复测量方差分析。</p>
<ol start="3">
<li>双因素方差分析</li>
</ol>
<p><img src="https://vip2.loli.io/2023/03/13/JpfhcXBNw94SxTm.png" alt="image-20220813105110385"></p>
<p>这种方案设计既有组间因子也有组内因子，即为多因素方差分析</p>
<ol start="4">
<li>协方差分析（ANCOVA）</li>
</ol>
<p>如果方差分析中，包含了协变量，就属于协方差分析，ANCOVA。如果其他病对此疗法有影响，即试验中多了干扰变量，这种干扰变量也称为协变量，如果方差分析中包含了协变量，就属于协方差分析。</p>
<ol start="5">
<li>多元方差分析（MANOVA）</li>
</ol>
<p>如果方差研究中包含了多个因变量，那么这种实验设计称为多元方差分析，简称为MANOVA。</p>
<ol start="6">
<li>多元协方差分析（MANCOVA）</li>
</ol>
<p>如果多元方差分析中存在协变量，那么就称为多元协方差分析。</p>
<p>方差分析可以使用<code>lm</code>函数进行拟合，不过一般都使用<code>aov</code>函数进行分析，二者在格式上有差别，但是<code>aov</code>函数的使用和<code>lm</code>函数几乎是一致的。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aov<span class="punctuation">(</span>formula<span class="punctuation">,</span> data <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> projections <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> qr <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> contrasts <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>方差分析公式中特殊符号</strong>：</p>
<p><img src="https://vip2.loli.io/2023/03/13/ucYRIS4GPqVZ3jr.png" alt="image-20220813110150153"></p>
<p><strong>各种方差分析公式写法</strong>：</p>
<p><img src="https://vip2.loli.io/2023/03/13/yOPQLmulI6FscDn.png" alt="image-20220813110300468"></p>
<p>==注意==：在方差分析中自变量的顺序很重要，如果是平衡设计还好，如果是非平衡实验设计或者存在协变量值，变量的顺序影响比较大。</p>
<p>==顺序很重要！==</p>
<p>当自变量与其他自变量或者协变量相关时，没有明确的方法可以评价自变量对因变量的贡献。例如，含因子A、B和因变量y的双因素不平衡因子设计，有三种效应：A和B的主效应，A和B的交互效应。假设你正使用如下表达式对数据进行建模：</p>
<p><code>Y~A+B A:B</code></p>
<p>有三种类型的方法可以分解等式右边各效应对y所解释的方差。<br>
类型一：（序贯型）效应根据表达式中先出现的效应做调整。A不做调整，B根据A调整，<code>A:B</code>交互项根据A和B调整。<br>
类型二：（分层型）效应根据同水平或低水平的效应做调整。A根据B调整，B依据A调整，<code>A:B</code>交互项同时根据A和B调整。<br>
类型三：（边界型）<br>
每个效应根据模型其他各效应做相应调整。A根据B和<code>A:B</code>做调整，<code>A:B</code>交互项根据A和B调整。<br>
R默认调用类型一方法，其他软件（比如SAS和SPSS）默认调用类型三方法。</p>
<h3 id="6-6-方差分析二">6.6 方差分析二</h3>
<h4 id="6-6-1-单因素方差分析">6.6.1 单因素方差分析</h4>
<p>使用<code>multcomp</code>包中的<code>cholesterol</code>数据集（50名患者接受降低胆固醇药物的五种治疗方案的数据）来进行演示。五十个患者分成十人一组，每天服用20克药物。第一组一天一次性服用20克药物；第二组一天分两次服用20克药物；第三组一天分四次服用20克药物。剩余两组办法是drugD和drugE，为两种候选药物。里面只有治疗方案一个因子，所以是单因素方差分析。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> cholesterol</span><br><span class="line">      trt response</span><br><span class="line"><span class="number">1</span>   <span class="number">1</span>time    <span class="number">3.861</span></span><br><span class="line"><span class="number">2</span>   <span class="number">1</span>time   <span class="number">10.387</span></span><br><span class="line"><span class="number">3</span>   <span class="number">1</span>time    <span class="number">5.906</span></span><br><span class="line"><span class="number">4</span>   <span class="number">1</span>time    <span class="number">3.061</span></span><br><span class="line"><span class="number">5</span>   <span class="number">1</span>time    <span class="number">7.720</span></span><br><span class="line"><span class="number">6</span>   <span class="number">1</span>time    <span class="number">2.714</span></span><br><span class="line"><span class="number">7</span>   <span class="number">1</span>time    <span class="number">4.924</span></span><br><span class="line"><span class="number">8</span>   <span class="number">1</span>time    <span class="number">2.304</span></span><br><span class="line"><span class="number">9</span>   <span class="number">1</span>time    <span class="number">7.530</span></span><br><span class="line"><span class="number">10</span>  <span class="number">1</span>time    <span class="number">9.412</span></span><br><span class="line"><span class="number">11</span> <span class="number">2</span>times   <span class="number">10.399</span></span><br><span class="line"><span class="number">12</span> <span class="number">2</span>times    <span class="number">8.603</span></span><br><span class="line"><span class="number">13</span> <span class="number">2</span>times   <span class="number">13.632</span></span><br><span class="line"><span class="number">14</span> <span class="number">2</span>times    <span class="number">3.505</span></span><br><span class="line"><span class="number">15</span> <span class="number">2</span>times    <span class="number">7.770</span></span><br><span class="line"><span class="number">16</span> <span class="number">2</span>times    <span class="number">8.627</span></span><br><span class="line"><span class="number">17</span> <span class="number">2</span>times    <span class="number">9.227</span></span><br><span class="line"><span class="number">18</span> <span class="number">2</span>times    <span class="number">6.316</span></span><br><span class="line"><span class="number">19</span> <span class="number">2</span>times   <span class="number">15.826</span></span><br><span class="line"><span class="number">20</span> <span class="number">2</span>times    <span class="number">8.344</span></span><br><span class="line"><span class="number">21</span> <span class="number">4</span>times   <span class="number">13.962</span></span><br><span class="line"><span class="number">22</span> <span class="number">4</span>times   <span class="number">13.961</span></span><br><span class="line"><span class="number">23</span> <span class="number">4</span>times   <span class="number">13.918</span></span><br><span class="line"><span class="number">24</span> <span class="number">4</span>times    <span class="number">8.053</span></span><br><span class="line"><span class="number">25</span> <span class="number">4</span>times   <span class="number">11.043</span></span><br><span class="line"><span class="number">26</span> <span class="number">4</span>times   <span class="number">12.369</span></span><br><span class="line"><span class="number">27</span> <span class="number">4</span>times   <span class="number">10.392</span></span><br><span class="line"><span class="number">28</span> <span class="number">4</span>times    <span class="number">9.029</span></span><br><span class="line"><span class="number">29</span> <span class="number">4</span>times   <span class="number">12.842</span></span><br><span class="line"><span class="number">30</span> <span class="number">4</span>times   <span class="number">18.179</span></span><br><span class="line"><span class="number">31</span>  drugD   <span class="number">16.982</span></span><br><span class="line"><span class="number">32</span>  drugD   <span class="number">15.458</span></span><br><span class="line"><span class="number">33</span>  drugD   <span class="number">19.979</span></span><br><span class="line"><span class="number">34</span>  drugD   <span class="number">14.739</span></span><br><span class="line"><span class="number">35</span>  drugD   <span class="number">13.585</span></span><br><span class="line"><span class="number">36</span>  drugD   <span class="number">10.865</span></span><br><span class="line"><span class="number">37</span>  drugD   <span class="number">17.590</span></span><br><span class="line"><span class="number">38</span>  drugD    <span class="number">8.819</span></span><br><span class="line"><span class="number">39</span>  drugD   <span class="number">17.963</span></span><br><span class="line"><span class="number">40</span>  drugD   <span class="number">17.632</span></span><br><span class="line"><span class="number">41</span>  drugE   <span class="number">21.512</span></span><br><span class="line"><span class="number">42</span>  drugE   <span class="number">27.244</span></span><br><span class="line"><span class="number">43</span>  drugE   <span class="number">20.520</span></span><br><span class="line"><span class="number">44</span>  drugE   <span class="number">15.771</span></span><br><span class="line"><span class="number">45</span>  drugE   <span class="number">22.885</span></span><br><span class="line"><span class="number">46</span>  drugE   <span class="number">23.953</span></span><br><span class="line"><span class="number">47</span>  drugE   <span class="number">21.593</span></span><br><span class="line"><span class="number">48</span>  drugE   <span class="number">18.306</span></span><br><span class="line"><span class="number">49</span>  drugE   <span class="number">20.385</span></span><br><span class="line"><span class="number">50</span>  drugE   <span class="number">17.307</span></span><br><span class="line">attach<span class="punctuation">(</span>cholesterol<span class="punctuation">)</span> <span class="comment"># 用来加载数据，用attach函数就不需要用变量赋值操作</span></span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>trt<span class="punctuation">)</span> <span class="comment">#统计分组情况</span></span><br><span class="line">trt</span><br><span class="line"> <span class="number">1</span>time <span class="number">2</span>times <span class="number">4</span>times  drugD  drugE </span><br><span class="line">    <span class="number">10</span>     <span class="number">10</span>     <span class="number">10</span>     <span class="number">10</span>     <span class="number">10</span> </span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>response<span class="punctuation">,</span>by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>trt<span class="punctuation">)</span><span class="punctuation">,</span>FUN<span class="operator">=</span>mean<span class="punctuation">)</span> <span class="comment"># 分组统计平均数</span></span><br><span class="line">  Group.1      x</span><br><span class="line"><span class="number">1</span>   <span class="number">1</span>time  <span class="number">5.782</span></span><br><span class="line"><span class="number">2</span>  <span class="number">2</span>times  <span class="number">9.225</span></span><br><span class="line"><span class="number">3</span>  <span class="number">4</span>times <span class="number">12.375</span></span><br><span class="line"><span class="number">4</span>   drugD <span class="number">15.361</span></span><br><span class="line"><span class="number">5</span>   drugE <span class="number">20.948</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> aov<span class="punctuation">(</span>response <span class="operator">~</span> trt<span class="punctuation">,</span>data<span class="operator">=</span>cholesterol<span class="punctuation">)</span> <span class="comment">#进行方差分析</span></span><br><span class="line"><span class="operator">&gt;</span> fit</span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">   aov<span class="punctuation">(</span>formula <span class="operator">=</span> response <span class="operator">~</span> trt<span class="punctuation">,</span> data <span class="operator">=</span> cholesterol<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Terms<span class="operator">:</span></span><br><span class="line">                   trt Residuals</span><br><span class="line">Sum of Squares  <span class="number">1351.4</span>     <span class="number">468.8</span></span><br><span class="line">Deg. of Freedom      <span class="number">4</span>        <span class="number">45</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">3.227</span></span><br><span class="line">Estimated effects may be unbalanced</span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value  Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line">trt          <span class="number">4</span>   <span class="number">1351</span>     <span class="number">338</span>    <span class="number">32.4</span> <span class="number">9.8e-13</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Residuals   <span class="number">45</span>    <span class="number">469</span>      <span class="number">10</span>                    </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>方差分析结果主要看F值和p值，F值越大说明组间差异越显著，这里就是五组之间平均值的差别，而p-value则是用来衡量F值，p值越小说明F值越可靠。这里可以看出p-value值非常小，说明F检测值非常显著，五组治疗方法效果不同。</p>
<p>同样可以使用plot绘制方差结果：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> par<span class="punctuation">(</span>mfrow<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/G4eEq28YcPp7fFW.png" alt="image-20220813150305955"></p>
<p>下面用<code>lm</code>函数进行方差分析：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fit.lm <span class="operator">&lt;-</span>lm<span class="punctuation">(</span>response<span class="operator">~</span>trt<span class="punctuation">,</span>data<span class="operator">=</span>cholesterol<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit.lm</span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> response <span class="operator">~</span> trt<span class="punctuation">,</span> data <span class="operator">=</span> cholesterol<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>    trt2times    trt4times     trtdrugD     trtdrugE  </span><br><span class="line">       <span class="number">5.78</span>         <span class="number">3.44</span>         <span class="number">6.59</span>         <span class="number">9.58</span>        <span class="number">15.17</span>  </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit.lm<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> response <span class="operator">~</span> trt<span class="punctuation">,</span> data <span class="operator">=</span> cholesterol<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">   Min     <span class="number">1</span>Q Median     <span class="number">3</span>Q    Max </span><br><span class="line"><span class="operator">-</span><span class="number">6.542</span> <span class="operator">-</span><span class="number">1.967</span> <span class="operator">-</span><span class="number">0.002</span>  <span class="number">1.890</span>  <span class="number">6.601</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>     <span class="number">5.78</span>       <span class="number">1.02</span>    <span class="number">5.67</span>  <span class="number">9.8e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">trt2times       <span class="number">3.44</span>       <span class="number">1.44</span>    <span class="number">2.39</span>    <span class="number">0.021</span> <span class="operator">*</span>  </span><br><span class="line">trt4times       <span class="number">6.59</span>       <span class="number">1.44</span>    <span class="number">4.57</span>  <span class="number">3.8e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">trtdrugD        <span class="number">9.58</span>       <span class="number">1.44</span>    <span class="number">6.64</span>  <span class="number">3.5e-08</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">trtdrugE       <span class="number">15.17</span>       <span class="number">1.44</span>   <span class="number">10.51</span>  <span class="number">1.1e-13</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">3.23</span> on <span class="number">45</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.742</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.72</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">32.4</span> on <span class="number">4</span> and <span class="number">45</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">9.82e-13</span></span><br></pre></td></tr></table></figure>
<p>F检测值和p-value和<code>aov</code>函数都一样，所以<code>lm</code>函数也可以进行方差分析。</p>
<h4 id="6-6-2-协方差分析">6.6.2 协方差分析</h4>
<p>使用<code>multcomp</code>包中的<code>litter</code>数据集，<code>litter</code>数据集为怀孕小鼠的数据集。该实验不是均衡设计，每个小鼠接受不同剂量药物处理，分别是不处理（0）、5单位剂量、50单位剂量和500单位剂量，这是自变量，产下幼崽的体重均值为因变量。因为怀孕的总时间有差异，会影响到幼崽的体重，所以属于协变量，这是一个协方差的例子。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>litter<span class="operator">$</span>dose<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">  <span class="number">0</span>   <span class="number">5</span>  <span class="number">50</span> <span class="number">500</span> </span><br><span class="line"> <span class="number">20</span>  <span class="number">19</span>  <span class="number">18</span>  <span class="number">17</span> </span><br><span class="line"><span class="operator">&gt;</span> attach<span class="punctuation">(</span>litter<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>weight<span class="punctuation">,</span>by <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>dose<span class="punctuation">)</span><span class="punctuation">,</span>FUN<span class="operator">=</span>mean<span class="punctuation">)</span></span><br><span class="line">  Group.1     x</span><br><span class="line"><span class="number">1</span>       <span class="number">0</span> <span class="number">32.31</span></span><br><span class="line"><span class="number">2</span>       <span class="number">5</span> <span class="number">29.31</span></span><br><span class="line"><span class="number">3</span>      <span class="number">50</span> <span class="number">29.87</span></span><br><span class="line"><span class="number">4</span>     <span class="number">500</span> <span class="number">29.65</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> aov<span class="punctuation">(</span>weight <span class="operator">~</span> gesttime<span class="operator">+</span>dose<span class="punctuation">,</span>data<span class="operator">=</span>litter<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>   </span><br><span class="line">gesttime     <span class="number">1</span>    <span class="number">134</span>   <span class="number">134.3</span>    <span class="number">8.05</span>  <span class="number">0.006</span> <span class="operator">*</span><span class="operator">*</span></span><br><span class="line">dose         <span class="number">3</span>    <span class="number">137</span>    <span class="number">45.7</span>    <span class="number">2.74</span>  <span class="number">0.050</span> <span class="operator">*</span> </span><br><span class="line">Residuals   <span class="number">69</span>   <span class="number">1151</span>    <span class="number">16.7</span>                  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>F值表明，怀孕时间和小鼠出生体重相关；控制怀孕时间，药物剂量和出生体重相关。证明药物是有影响的，而不是随机性产生的。</p>
<h4 id="6-6-3-双因素方差分析">6.6.3 双因素方差分析</h4>
<p>下面看一个双因素方差分析案例：</p>
<p>使用<code>ToothGrowth</code>数据集，这个数据集是200只豚鼠分别用两种喂食方法，橙汁（包含维生素C，也包含其他维生素）和维生素C，每种喂食方法中，抗坏血栓含量有三个水平，分别是0.5mg、1mg、2mg。每组分别选择10只豚鼠做实验，刚好60只，最后测试牙齿长度，看哪种更有利于牙齿生长。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> ToothGrowth</span><br><span class="line">    len supp dose</span><br><span class="line"><span class="number">1</span>   <span class="number">4.2</span>   VC  <span class="number">0.5</span></span><br><span class="line"><span class="number">2</span>  <span class="number">11.5</span>   VC  <span class="number">0.5</span></span><br><span class="line"><span class="number">3</span>   <span class="number">7.3</span>   VC  <span class="number">0.5</span></span><br><span class="line"><span class="number">4</span>   <span class="number">5.8</span>   VC  <span class="number">0.5</span></span><br><span class="line"><span class="number">5</span>   <span class="number">6.4</span>   VC  <span class="number">0.5</span></span><br><span class="line">...</span><br><span class="line"><span class="number">56</span> <span class="number">30.9</span>   OJ  <span class="number">2.0</span></span><br><span class="line"><span class="number">57</span> <span class="number">26.4</span>   OJ  <span class="number">2.0</span></span><br><span class="line"><span class="number">58</span> <span class="number">27.3</span>   OJ  <span class="number">2.0</span></span><br><span class="line"><span class="number">59</span> <span class="number">29.4</span>   OJ  <span class="number">2.0</span></span><br><span class="line"><span class="number">60</span> <span class="number">23.0</span>   OJ  <span class="number">2.0</span></span><br><span class="line"><span class="operator">&gt;</span> attach<span class="punctuation">(</span>ToothGrowth<span class="punctuation">)</span> <span class="comment"># 加载数据</span></span><br><span class="line">The following object is masked from litter<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">    dose</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> xtabs<span class="punctuation">(</span><span class="operator">~</span>supp<span class="operator">+</span>dose<span class="punctuation">)</span> <span class="comment"># 通过xtabs统计一下频数</span></span><br><span class="line">    dose</span><br><span class="line">supp <span class="number">0.5</span>  <span class="number">1</span>  <span class="number">2</span></span><br><span class="line">  OJ  <span class="number">10</span> <span class="number">10</span> <span class="number">10</span></span><br><span class="line">  VC  <span class="number">10</span> <span class="number">10</span> <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>len<span class="punctuation">,</span>by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>supp<span class="punctuation">,</span>dose<span class="punctuation">)</span><span class="punctuation">,</span>FUN<span class="operator">=</span>mean<span class="punctuation">)</span> <span class="comment"># 统计平均值</span></span><br><span class="line">  Group.1 Group.2     x</span><br><span class="line"><span class="number">1</span>      OJ     <span class="number">0.5</span> <span class="number">13.23</span></span><br><span class="line"><span class="number">2</span>      VC     <span class="number">0.5</span>  <span class="number">7.98</span></span><br><span class="line"><span class="number">3</span>      OJ     <span class="number">1.0</span> <span class="number">22.70</span></span><br><span class="line"><span class="number">4</span>      VC     <span class="number">1.0</span> <span class="number">16.77</span></span><br><span class="line"><span class="number">5</span>      OJ     <span class="number">2.0</span> <span class="number">26.06</span></span><br><span class="line"><span class="number">6</span>      VC     <span class="number">2.0</span> <span class="number">26.14</span></span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>len<span class="punctuation">,</span>by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>supp<span class="punctuation">,</span>dose<span class="punctuation">)</span><span class="punctuation">,</span>FUN<span class="operator">=</span>sd<span class="punctuation">)</span> <span class="comment"># 计算标准差</span></span><br><span class="line">  Group.1 Group.2     x</span><br><span class="line"><span class="number">1</span>      OJ     <span class="number">0.5</span> <span class="number">4.460</span></span><br><span class="line"><span class="number">2</span>      VC     <span class="number">0.5</span> <span class="number">2.747</span></span><br><span class="line"><span class="number">3</span>      OJ     <span class="number">1.0</span> <span class="number">3.911</span></span><br><span class="line"><span class="number">4</span>      VC     <span class="number">1.0</span> <span class="number">2.515</span></span><br><span class="line"><span class="number">5</span>      OJ     <span class="number">2.0</span> <span class="number">2.655</span></span><br><span class="line"><span class="number">6</span>      VC     <span class="number">2.0</span> <span class="number">4.798</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>ToothGrowth<span class="operator">$</span>dose<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;numeric&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> ToothGrowth<span class="operator">$</span>dose <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>dose<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>ToothGrowth<span class="operator">$</span>dose<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;factor&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> aov<span class="punctuation">(</span>len <span class="operator">~</span> supp<span class="operator">*</span>dose<span class="punctuation">,</span>data<span class="operator">=</span>ToothGrowth<span class="punctuation">)</span> <span class="comment"># 这里是*号，这里是两个变量的方差分析，两个变量之间还有交互，所以应该写成乘号</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value  Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line">supp         <span class="number">1</span>    <span class="number">205</span>     <span class="number">205</span>   <span class="number">15.57</span> <span class="number">0.00023</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">dose         <span class="number">2</span>   <span class="number">2426</span>    <span class="number">1213</span>   <span class="number">92.00</span> <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">supp<span class="operator">:</span>dose    <span class="number">2</span>    <span class="number">108</span>      <span class="number">54</span>    <span class="number">4.11</span> <span class="number">0.02186</span> <span class="operator">*</span>  </span><br><span class="line">Residuals   <span class="number">54</span>    <span class="number">712</span>      <span class="number">13</span>                    </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p><code>fit &lt;- aov(len ~ supp*dose,data=ToothGrowth)</code>代码中是<code>*</code>号，这里是两个变量的方差分析，两个变量之间还有交互，所以应该写成乘号，等价于：<code>fit &lt;- aov(len ~ supp+dose+supp:dose,data=ToothGrowth)</code>。</p>
<p>supp和dose结果表明不同的喂食方法和剂量对豚鼠牙齿生长都有影响。</p>
<p>使用<code>HH</code>包中的<code>interaction.plot</code>函数可以对结果进行可视化：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> interaction.plot<span class="punctuation">(</span>dose<span class="punctuation">,</span> supp<span class="punctuation">,</span> len<span class="punctuation">,</span> type<span class="operator">=</span><span class="string">&quot;b&quot;</span><span class="punctuation">,</span> </span><br><span class="line"><span class="operator">+</span>                  col<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span><span class="string">&quot;blue&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> pch<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">16</span><span class="punctuation">,</span> <span class="number">18</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"><span class="operator">+</span>                  main <span class="operator">=</span> <span class="string">&quot;Interaction between Dose and Supplement Type&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/bL1DA4BylMkKG9h.png" alt="image-20220813155702776"></p>
<h4 id="6-6-4-多元方差分析">6.6.4 多元方差分析</h4>
<p>使用UScereal数据集，这里研究的是美国谷物中的卡路里、脂肪和糖类含量是否会因为储物架的不同而发生变化。其中shelf列1代表低货架，2代表中货架，3代表顶层货架，其中卡路里、脂肪和糖类含量的变化是因变量，货架水平是自变量。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> attach<span class="punctuation">(</span>UScereal<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> shelf <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>shelf<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>cbind<span class="punctuation">(</span>calories<span class="punctuation">,</span>fat<span class="punctuation">,</span>sugars<span class="punctuation">)</span><span class="punctuation">,</span>by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>shelf<span class="punctuation">)</span><span class="punctuation">,</span>FUN<span class="operator">=</span>mean<span class="punctuation">)</span> <span class="comment"># 求平均值</span></span><br><span class="line">  Group.1 calories    fat sugars</span><br><span class="line"><span class="number">1</span>       <span class="number">1</span>    <span class="number">119.5</span> <span class="number">0.6621</span>  <span class="number">6.295</span></span><br><span class="line"><span class="number">2</span>       <span class="number">2</span>    <span class="number">129.8</span> <span class="number">1.3413</span> <span class="number">12.508</span></span><br><span class="line"><span class="number">3</span>       <span class="number">3</span>    <span class="number">180.1</span> <span class="number">1.9449</span> <span class="number">10.857</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> manova<span class="punctuation">(</span>cbind<span class="punctuation">(</span>calories<span class="punctuation">,</span>fat<span class="punctuation">,</span>sugars<span class="punctuation">)</span><span class="operator">~</span>shelf<span class="punctuation">)</span> <span class="comment"># 因为已经用attach加载数据，所以data项可以不写</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">          Df Pillai approx <span class="built_in">F</span> num Df den Df Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line">shelf      <span class="number">2</span>  <span class="number">0.402</span>     <span class="number">5.12</span>      <span class="number">6</span>    <span class="number">122</span>  <span class="number">1e-04</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Residuals <span class="number">62</span>                                         </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary.aov<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"> Response calories <span class="operator">:</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value  Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line">shelf        <span class="number">2</span>  <span class="number">50435</span>   <span class="number">25218</span>    <span class="number">7.86</span> <span class="number">0.00091</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Residuals   <span class="number">62</span> <span class="number">198860</span>    <span class="number">3207</span>                    </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"> Response fat <span class="operator">:</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>  </span><br><span class="line">shelf        <span class="number">2</span>   <span class="number">18.4</span>    <span class="number">9.22</span>    <span class="number">3.68</span>  <span class="number">0.031</span> <span class="operator">*</span></span><br><span class="line">Residuals   <span class="number">62</span>  <span class="number">155.2</span>    <span class="number">2.50</span>                 </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"> Response sugars <span class="operator">:</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>   </span><br><span class="line">shelf        <span class="number">2</span>    <span class="number">381</span>     <span class="number">191</span>    <span class="number">6.58</span> <span class="number">0.0026</span> <span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Residuals   <span class="number">62</span>   <span class="number">1798</span>      <span class="number">29</span>                  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>因为已经因变量有多个，不能通过<code>+</code>将其合并，需要通过<code>cbind</code>将其合并成数据框，也可以使用<code>summary.aov</code>分别查看每个变量的结果。通过检测结果可以发现，三组中每组营养成分的测量值是不同的，差异结果显著。</p>
<p>注意：<code>aggregate</code>只能接受一个数据，可以通过<code>cbind</code>将三个变量组成一个数据框。</p>
<h3 id="6-7-功效分析">6.7 功效分析</h3>
<p>功效分析，power analysis，可以帮助在给定置信度的情况下，判断检测到给定效应值时所需的样本量。反过来，它也可以在给定置信度水平情况下，计算在某样本量内能检测到给定效应值的概率。</p>
<p><strong>功效分析函数</strong>：<code>pwr</code>包中的函数</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>功效计算的对象</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pwr.2p.test()</code></td>
<td>两比例（n相等）</td>
</tr>
<tr>
<td><code>pwr.2p2n.test()</code></td>
<td>两比例（n不相等）</td>
</tr>
<tr>
<td><code>pwr.anova.test()</code></td>
<td>平衡的单因素ANOVA</td>
</tr>
<tr>
<td><code>pwr.chisq.test()</code></td>
<td>卡方检验</td>
</tr>
<tr>
<td><code>pwr.f2.test()</code></td>
<td>广义线性模型</td>
</tr>
<tr>
<td><code>pwr.p.test()</code></td>
<td>比例（单样本）</td>
</tr>
<tr>
<td><code>pwr.r.test()</code></td>
<td>相关系数</td>
</tr>
<tr>
<td><code>pwr.t.test()</code></td>
<td>t检验（单样本、两样本、配对）</td>
</tr>
<tr>
<td><code>pwr.t2n.test()</code></td>
<td>t检验（n不相等的两样本）</td>
</tr>
</tbody>
</table>
<p>功效分析的理论基础：</p>
<p><img src="https://vip2.loli.io/2023/03/13/2Oz7E3tdPAc8LHq.png" alt="image-20220813180608399"></p>
<ol>
<li>样本大小指的是实验设计中每种条件/组中观测的数目。</li>
<li>显著性水平（也称为alpha）由Ⅰ型错误的概率来定义。也可以把它看做是发现效应不发生的概率。</li>
<li>功效通过Ⅰ减去Ⅱ型错误的概率来定义。我们可以把它看做是真实效应发生的概率。</li>
<li>效应值指的是在备择或研究假设下效应的量。效应值的表达式依赖于假设检验中使用的统计方法。</li>
</ol>
<p><img src="https://vip2.loli.io/2023/03/13/kwZyGeJ847CfAvK.png" alt="image-20220813190447017"></p>
<p>案例：老板的领导风格对员工满意度的影响，是否超过薪水和工作小费对员工满意度的影响，领导风格可以用四个变量来估计，薪水和小费与三个变量有关，过去的经验表明，薪水和小费能够解决30%员工满意度的方差，而从现实出发，领导风格至少能解释35%的方差，假定显著性水平为0.05，那么在95%的置信度情况下，需要多少受试者才能得到这样的方差贡献率。</p>
<p>线性回归的功效分析可以使用<code>pwr</code>包中的<code>pwr.f2.test</code>函数进行计算，其中<code>sig.level</code>表示显著性水平，<code>power</code>为功效水平，<code>u</code>和<code>v</code>分别为分子自由度和分母自由度，<code>f2</code>为效应值。</p>
<p><code>pwr.f2.test</code>函数使用如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pwr.f2.test<span class="punctuation">(</span>u <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> v <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> f2 <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> sig.level <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span> power <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>上面的案例分析如下，其中<code>f2</code>的值根据公式计算出来。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> pwr.f2.test<span class="punctuation">(</span>u<span class="operator">=</span><span class="number">3</span><span class="punctuation">,</span> sig.level <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span> power<span class="operator">=</span><span class="number">0.9</span><span class="punctuation">,</span> f2<span class="operator">=</span><span class="number">0.0769</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">     Multiple regression power calculation </span><br><span class="line"></span><br><span class="line">              u <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">              v <span class="operator">=</span> <span class="number">184.2</span> <span class="comment"># 至少需要185个受试者</span></span><br><span class="line">             f2 <span class="operator">=</span> <span class="number">0.0769</span></span><br><span class="line">      sig.level <span class="operator">=</span> <span class="number">0.05</span></span><br><span class="line">          power <span class="operator">=</span> <span class="number">0.9</span></span><br></pre></td></tr></table></figure>
<p>可以得到<code>v</code>为184.2，假设显著性水平为0.05，在90%的置信度的情况下，至少需要185个受试者才可以。</p>
<p>假设两组样品做单因素方差分析，要达到0.9的功效，效应值为0.25，并选择0.05的显著性水平，那么每组需要多少样本量？</p>
<p>可以使用<code>pwr.anova.test()</code>函数对平衡单因素方差进行功效分析：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pwr.anova.test<span class="punctuation">(</span>k <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> n <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> f <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> sig.level <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span> power <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>其中<code>k</code>为组的个数，这里为两组；<code>n</code>为各组的样本大小，即要求的量，<code>f</code>是效应值，<code>sig.level</code>为显著性水平，<code>power</code>为功效水平。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> pwr.anova.test<span class="punctuation">(</span>k<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>f<span class="operator">=</span><span class="number">0.25</span><span class="punctuation">,</span>sig.level <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span>power <span class="operator">=</span> <span class="number">0.9</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">     Balanced one<span class="operator">-</span>way analysis of variance power calculation </span><br><span class="line"></span><br><span class="line">              k <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">              n <span class="operator">=</span> <span class="number">85.03</span></span><br><span class="line">              f <span class="operator">=</span> <span class="number">0.25</span></span><br><span class="line">      sig.level <span class="operator">=</span> <span class="number">0.05</span></span><br><span class="line">          power <span class="operator">=</span> <span class="number">0.9</span></span><br><span class="line"></span><br><span class="line">NOTE<span class="operator">:</span> n is number <span class="keyword">in</span> each group</span><br></pre></td></tr></table></figure>
<p><code>n</code>为所求的值，可知<code>n</code>至少应为86，即每组中至少86个样本，由于是两组，所以总体样本数为其二倍，172个样本。</p>
<h2 id="7-广义线性模型">7 广义线性模型</h2>
<p>线性回归和方差分析都是基于正态分布的假设。在线性模型中，可以通过一系列连续型或类别型预测变量来预测正态分布的响应变量，但是实际的数据分析中，呈简单线性分布的数据只占很少的一部分，绝大部分数据都是无规则分布的，通过数据分析来找到规律。刚开始假设数据为正态分布也不合理，例如二值型变量，比如多分类变量，结果变量也可能呈条件分布，对于这些数据不能用简单线性回归来处理，需要拓宽简单线性回归的方法，提出了广义线性回归。</p>
<p>线性回归和方差分析都是基于正态分布的假设，广义线性模型扩展了线性模型的框架，它包含了非正态因变量的分析。</p>
<p>在R中可以通过<code>glm</code>（Generalized Linear Models）函数进行广义线性回归分析。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">glm<span class="punctuation">(</span>formula<span class="punctuation">,</span> family <span class="operator">=</span> gaussian<span class="punctuation">,</span> data<span class="punctuation">,</span> weights<span class="punctuation">,</span> subset<span class="punctuation">,</span></span><br><span class="line">    na.action<span class="punctuation">,</span> start <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> etastart<span class="punctuation">,</span> mustart<span class="punctuation">,</span> offset<span class="punctuation">,</span></span><br><span class="line">    control <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>...<span class="punctuation">)</span><span class="punctuation">,</span> model <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&quot;glm.fit&quot;</span><span class="punctuation">,</span></span><br><span class="line">    x <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> singular.ok <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> contrasts <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>这个函数与<code>lm</code>函数类似，其中最重要的参数为概率分布<code>family</code>，和相应的连接函数<code>formula</code>。</p>
<p>如果<code>glm</code>中<code>family = gaussian</code>，则结果和<code>lm</code>函数结果一致。</p>
<p>广义线性模型是通过拟合相应变量的条件均值的一个函数。假设响应变量服从指数分布族中的某个分布，并不仅限于正态分布，这样极大扩展了标准线性模型，模型参数估计的推导依据是极大似然法估计，而非最小二乘法。</p>
<h3 id="7-1-泊松回归">7.1 泊松回归</h3>
<p><strong>泊松回归</strong>是用来为计数资料和列联表建模的一种回归分析。泊松回归假设因变量是泊松分布，并假设它平均值的对数可被未知参数的线性组合建模。</p>
<p>泊松回归适合预测计数型结果变量。</p>
<p>需要下载<code>robust</code>包，并加载，用到里面的<code>breslow</code>数据集，这个数据集是对遭受轻微或严重性癫痫病病人的年龄和癫痫病发病数搜集的数据，包含了病人被随机分配到药物组或安慰剂组前八周和后八周两种情况，响应变量是后八周内癫痫病发病数<code>sumY</code>，预测变量为治疗条件<code>Trt</code>，年龄<code>Age</code>和前八周内的基础癫痫病发病数<code>Base</code>，之所以包含基础发病数和年龄，是因为它们对响应变量有潜在的影响，在解释这些协变量后，我们探究的问题是药物治疗是否能够减少癫痫病的发病数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> data<span class="punctuation">(</span>breslow.dat<span class="punctuation">,</span>package<span class="operator">=</span><span class="string">&quot;robust&quot;</span><span class="punctuation">)</span> <span class="comment"># 利用data函数加载数据集</span></span><br><span class="line"><span class="operator">&gt;</span> breslow.dat</span><br><span class="line">    ID  Y1 Y2 Y3 Y4 Base Age       Trt Ysum sumY Age10 Base4</span><br><span class="line"><span class="number">1</span>  <span class="number">104</span>   <span class="number">5</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span>   <span class="number">11</span>  <span class="number">31</span>   placebo   <span class="number">14</span>   <span class="number">14</span>   <span class="number">3.1</span>  <span class="number">2.75</span></span><br><span class="line"><span class="number">2</span>  <span class="number">106</span>   <span class="number">3</span>  <span class="number">5</span>  <span class="number">3</span>  <span class="number">3</span>   <span class="number">11</span>  <span class="number">30</span>   placebo   <span class="number">14</span>   <span class="number">14</span>   <span class="number">3.0</span>  <span class="number">2.75</span></span><br><span class="line"><span class="number">3</span>  <span class="number">107</span>   <span class="number">2</span>  <span class="number">4</span>  <span class="number">0</span>  <span class="number">5</span>    <span class="number">6</span>  <span class="number">25</span>   placebo   <span class="number">11</span>   <span class="number">11</span>   <span class="number">2.5</span>  <span class="number">1.50</span></span><br><span class="line">...</span><br><span class="line"><span class="number">57</span> <span class="number">228</span>   <span class="number">2</span>  <span class="number">3</span>  <span class="number">0</span>  <span class="number">1</span>   <span class="number">25</span>  <span class="number">21</span> progabide    <span class="number">6</span>    <span class="number">6</span>   <span class="number">2.1</span>  <span class="number">6.25</span></span><br><span class="line"><span class="number">58</span> <span class="number">232</span>   <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>   <span class="number">13</span>  <span class="number">36</span> progabide    <span class="number">0</span>    <span class="number">0</span>   <span class="number">3.6</span>  <span class="number">3.25</span></span><br><span class="line"><span class="number">59</span> <span class="number">236</span>   <span class="number">1</span>  <span class="number">4</span>  <span class="number">3</span>  <span class="number">2</span>   <span class="number">12</span>  <span class="number">37</span> progabide   <span class="number">10</span>   <span class="number">10</span>   <span class="number">3.7</span>  <span class="number">3.00</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>breslow.dat<span class="punctuation">)</span></span><br><span class="line">       ID            Y1               Y2              Y3              Y4             Base            Age      </span><br><span class="line"> Min.   <span class="operator">:</span><span class="number">101</span>   Min.   <span class="operator">:</span>  <span class="number">0.00</span>   Min.   <span class="operator">:</span> <span class="number">0.00</span>   Min.   <span class="operator">:</span> <span class="number">0.00</span>   Min.   <span class="operator">:</span> <span class="number">0.00</span>   Min.   <span class="operator">:</span>  <span class="number">6.0</span>   Min.   <span class="operator">:</span><span class="number">18.0</span>  </span><br><span class="line"> <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">120</span>   <span class="number">1</span>st Qu.<span class="operator">:</span>  <span class="number">2.00</span>   <span class="number">1</span>st Qu.<span class="operator">:</span> <span class="number">3.00</span>   <span class="number">1</span>st Qu.<span class="operator">:</span> <span class="number">2.00</span>   <span class="number">1</span>st Qu.<span class="operator">:</span> <span class="number">3.00</span>   <span class="number">1</span>st Qu.<span class="operator">:</span> <span class="number">12.0</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">23.0</span>  </span><br><span class="line"> Median <span class="operator">:</span><span class="number">147</span>   Median <span class="operator">:</span>  <span class="number">4.00</span>   Median <span class="operator">:</span> <span class="number">5.00</span>   Median <span class="operator">:</span> <span class="number">4.00</span>   Median <span class="operator">:</span> <span class="number">4.00</span>   Median <span class="operator">:</span> <span class="number">22.0</span>   Median <span class="operator">:</span><span class="number">28.0</span>  </span><br><span class="line"> Mean   <span class="operator">:</span><span class="number">168</span>   Mean   <span class="operator">:</span>  <span class="number">8.95</span>   Mean   <span class="operator">:</span> <span class="number">8.36</span>   Mean   <span class="operator">:</span> <span class="number">8.44</span>   Mean   <span class="operator">:</span> <span class="number">7.31</span>   Mean   <span class="operator">:</span> <span class="number">31.2</span>   Mean   <span class="operator">:</span><span class="number">28.3</span>  </span><br><span class="line"> <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">216</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span> <span class="number">10.50</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">11.50</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span> <span class="number">8.00</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span> <span class="number">8.00</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span> <span class="number">41.0</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">32.0</span>  </span><br><span class="line"> Max.   <span class="operator">:</span><span class="number">238</span>   Max.   <span class="operator">:</span><span class="number">102.00</span>   Max.   <span class="operator">:</span><span class="number">65.00</span>   Max.   <span class="operator">:</span><span class="number">76.00</span>   Max.   <span class="operator">:</span><span class="number">63.00</span>   Max.   <span class="operator">:</span><span class="number">151.0</span>   Max.   <span class="operator">:</span><span class="number">42.0</span>  </span><br><span class="line">        Trt          Ysum            sumY           Age10          Base4      </span><br><span class="line"> placebo  <span class="operator">:</span><span class="number">28</span>   Min.   <span class="operator">:</span>  <span class="number">0.0</span>   Min.   <span class="operator">:</span>  <span class="number">0.0</span>   Min.   <span class="operator">:</span><span class="number">1.80</span>   Min.   <span class="operator">:</span> <span class="number">1.50</span>  </span><br><span class="line"> progabide<span class="operator">:</span><span class="number">31</span>   <span class="number">1</span>st Qu.<span class="operator">:</span> <span class="number">11.5</span>   <span class="number">1</span>st Qu.<span class="operator">:</span> <span class="number">11.5</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">2.30</span>   <span class="number">1</span>st Qu.<span class="operator">:</span> <span class="number">3.00</span>  </span><br><span class="line">                Median <span class="operator">:</span> <span class="number">16.0</span>   Median <span class="operator">:</span> <span class="number">16.0</span>   Median <span class="operator">:</span><span class="number">2.80</span>   Median <span class="operator">:</span> <span class="number">5.50</span>  </span><br><span class="line">                Mean   <span class="operator">:</span> <span class="number">33.0</span>   Mean   <span class="operator">:</span> <span class="number">33.0</span>   Mean   <span class="operator">:</span><span class="number">2.83</span>   Mean   <span class="operator">:</span> <span class="number">7.81</span>  </span><br><span class="line">                <span class="number">3</span>rd Qu.<span class="operator">:</span> <span class="number">36.0</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span> <span class="number">36.0</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">3.20</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">10.25</span>  </span><br><span class="line">                Max.   <span class="operator">:</span><span class="number">302.0</span>   Max.   <span class="operator">:</span><span class="number">302.0</span>   Max.   <span class="operator">:</span><span class="number">4.20</span>   Max.   <span class="operator">:</span><span class="number">37.75</span>  </span><br><span class="line"><span class="operator">&gt;</span> attach<span class="punctuation">(</span>breslow.dat<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> glm<span class="punctuation">(</span>sumY <span class="operator">~</span> Base <span class="operator">+</span>Trt <span class="operator">+</span> Age<span class="punctuation">,</span>data<span class="operator">=</span>breslow.dat<span class="punctuation">,</span>family <span class="operator">=</span> poisson<span class="punctuation">(</span>link <span class="operator">=</span> <span class="string">&quot;log&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 通过glm函数进行拟合泊松回归</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">glm<span class="punctuation">(</span>formula <span class="operator">=</span> sumY <span class="operator">~</span> Base <span class="operator">+</span> Trt <span class="operator">+</span> Age<span class="punctuation">,</span> family <span class="operator">=</span> poisson<span class="punctuation">(</span>link <span class="operator">=</span> <span class="string">&quot;log&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">    data <span class="operator">=</span> breslow.dat<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Deviance Residuals<span class="operator">:</span>  <span class="comment"># 残差统计量</span></span><br><span class="line">   Min      <span class="number">1</span>Q  Median      <span class="number">3</span>Q     Max  </span><br><span class="line"><span class="operator">-</span><span class="number">6.057</span>  <span class="operator">-</span><span class="number">2.043</span>  <span class="operator">-</span><span class="number">0.940</span>   <span class="number">0.793</span>  <span class="number">11.006</span>  </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span> <span class="comment">#系数</span></span><br><span class="line">              Estimate Std. Error z value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>   <span class="number">1.948826</span>   <span class="number">0.135619</span>   <span class="number">14.37</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Base          <span class="number">0.022652</span>   <span class="number">0.000509</span>   <span class="number">44.48</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Trtprogabide <span class="operator">-</span><span class="number">0.152701</span>   <span class="number">0.047805</span>   <span class="operator">-</span><span class="number">3.19</span>   <span class="number">0.0014</span> <span class="operator">*</span><span class="operator">*</span> </span><br><span class="line">Age           <span class="number">0.022740</span>   <span class="number">0.004024</span>    <span class="number">5.65</span>  <span class="number">1.6e-08</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">(</span>Dispersion parameter <span class="keyword">for</span> poisson family taken to be <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">    Null deviance<span class="operator">:</span> <span class="number">2122.73</span>  on <span class="number">58</span>  degrees of freedom</span><br><span class="line">Residual deviance<span class="operator">:</span>  <span class="number">559.44</span>  on <span class="number">55</span>  degrees of freedom</span><br><span class="line">AIC<span class="operator">:</span> <span class="number">850.7</span></span><br><span class="line"></span><br><span class="line">Number of Fisher Scoring iterations<span class="operator">:</span> <span class="number">5</span></span><br><span class="line"><span class="operator">&gt;</span> coef<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>         Base Trtprogabide          Age </span><br><span class="line">  <span class="number">1.94882593</span>   <span class="number">0.02265174</span>  <span class="operator">-</span><span class="number">0.15270095</span>   <span class="number">0.02274013</span> </span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">exp</span><span class="punctuation">(</span>coef<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>         Base Trtprogabide          Age </span><br><span class="line">   <span class="number">7.0204403</span>    <span class="number">1.0229102</span>    <span class="number">0.8583864</span>    <span class="number">1.0230007</span> </span><br></pre></td></tr></table></figure>
<p><code>family = poisson(link = &quot;log&quot;)</code>是广义线性模型中泊松回归的写法。</p>
<p>在线性回归中使用的函数，在广义线性模型中都可以使用。例如<code>coef</code>函数可以获取模型的系数，在poisson回归中，因变量以条件均值的对数形式来建模，年龄的回归参数为0.02274013，这表明保持其他预测变量不变，年龄每增加一岁，癫痫病发病数的对数均值将相应地增加0.02274013，截距项表示当预测变量都为0的时候，癫痫病发病数的对数均值。因为年龄都不可能为0，并且调查对象的基础癫痫病发病数均不为0，因此截距无意义。通常在因变量初始尺度上解的回归系数比较困难，因为是对数形式，所以再对其取指数，使用<code>exp</code>函数，可以看到保持其他变量不变，年龄增加一岁期望的癫痫病发病数将乘以1.0230007。说明年龄增加，和较高的癫痫病发病数相关联。一单位治疗条件<code>Trt</code>的变化，平均的癫痫病发病数将乘以0.8583864，也就是说保持基础癫痫病发病数和年龄不变，服药组相对于安慰剂发病率降低了20%，药物是有效的。</p>
<h3 id="7-2-Logistic回归">7.2 Logistic回归</h3>
<p>当通过一系列连续型或类别型预测变量来预测二值型结果变量时，Logistic回归是一个非常有用的工具。</p>
<p>二值型变量在现实为有还是无，是一种二项分布，在现实中很多。</p>
<p>根据危险因素预测某疾病发生的概率。例如，想探讨胃癌发生的危险因素，可以选择两组人群，一组是胃癌组，一组是非胃癌组，两组人群肯定有不同的体征和生活方式等。这里的因变量就是是否胃癌，即“是”或“否”，为两分类变量，自变量就可以包括很多了，例如年龄、性别、饮食习惯、幽门螺杆菌感染等。自变量既可以是连续的，也可以是分类的。通过Logistic回归分析，就可以大致了解到底哪些因素是胃癌的危险因素。</p>
<p>这里使用<code>AER</code>包中的<code>Affairs</code>数据集为例：</p>
<p>这个数据集从601个参与者中搜集了9个变量，包括一年来婚外情的频率、参与者的性别、年龄、婚龄、是否有小孩、宗教信仰、教育、职业、对婚姻的自我评分。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> data<span class="punctuation">(</span><span class="string">&quot;Affairs&quot;</span><span class="punctuation">,</span>package <span class="operator">=</span> <span class="string">&quot;AER&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>Affairs<span class="punctuation">)</span></span><br><span class="line">    affairs          gender         age         yearsmarried    children  religiousness     education    </span><br><span class="line"> Min.   <span class="operator">:</span> <span class="number">0.000</span>   female<span class="operator">:</span><span class="number">315</span>   Min.   <span class="operator">:</span><span class="number">17.50</span>   Min.   <span class="operator">:</span> <span class="number">0.125</span>   no <span class="operator">:</span><span class="number">171</span>   Min.   <span class="operator">:</span><span class="number">1.000</span>   Min.   <span class="operator">:</span> <span class="number">9.00</span>  </span><br><span class="line"> <span class="number">1</span>st Qu.<span class="operator">:</span> <span class="number">0.000</span>   male  <span class="operator">:</span><span class="number">286</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">27.00</span>   <span class="number">1</span>st Qu.<span class="operator">:</span> <span class="number">4.000</span>   yes<span class="operator">:</span><span class="number">430</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">2.000</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">14.00</span>  </span><br><span class="line"> Median <span class="operator">:</span> <span class="number">0.000</span>                Median <span class="operator">:</span><span class="number">32.00</span>   Median <span class="operator">:</span> <span class="number">7.000</span>             Median <span class="operator">:</span><span class="number">3.000</span>   Median <span class="operator">:</span><span class="number">16.00</span>  </span><br><span class="line"> Mean   <span class="operator">:</span> <span class="number">1.456</span>                Mean   <span class="operator">:</span><span class="number">32.49</span>   Mean   <span class="operator">:</span> <span class="number">8.178</span>             Mean   <span class="operator">:</span><span class="number">3.116</span>   Mean   <span class="operator">:</span><span class="number">16.17</span>  </span><br><span class="line"> <span class="number">3</span>rd Qu.<span class="operator">:</span> <span class="number">0.000</span>                <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">37.00</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">15.000</span>             <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">4.000</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">18.00</span>  </span><br><span class="line"> Max.   <span class="operator">:</span><span class="number">12.000</span>                Max.   <span class="operator">:</span><span class="number">57.00</span>   Max.   <span class="operator">:</span><span class="number">15.000</span>             Max.   <span class="operator">:</span><span class="number">5.000</span>   Max.   <span class="operator">:</span><span class="number">20.00</span>  </span><br><span class="line">   occupation        rating     </span><br><span class="line"> Min.   <span class="operator">:</span><span class="number">1.000</span>   Min.   <span class="operator">:</span><span class="number">1.000</span>  </span><br><span class="line"> <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">3.000</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">3.000</span>  </span><br><span class="line"> Median <span class="operator">:</span><span class="number">5.000</span>   Median <span class="operator">:</span><span class="number">4.000</span>  </span><br><span class="line"> Mean   <span class="operator">:</span><span class="number">4.195</span>   Mean   <span class="operator">:</span><span class="number">3.932</span>  </span><br><span class="line"> <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">6.000</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">5.000</span>  </span><br><span class="line"> Max.   <span class="operator">:</span><span class="number">7.000</span>   Max.   <span class="operator">:</span><span class="number">5.000</span>  </span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>Affairs<span class="operator">$</span>affairs<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">  <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">7</span>  <span class="number">12</span> </span><br><span class="line"><span class="number">451</span>  <span class="number">34</span>  <span class="number">17</span>  <span class="number">19</span>  <span class="number">42</span>  <span class="number">38</span> </span><br><span class="line"><span class="operator">&gt;</span> prop.table<span class="punctuation">(</span>table<span class="punctuation">(</span>Affairs<span class="operator">$</span>affairs<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">         <span class="number">0</span>          <span class="number">1</span>          <span class="number">2</span>          <span class="number">3</span>          <span class="number">7</span>         <span class="number">12</span> </span><br><span class="line"><span class="number">0.75041597</span> <span class="number">0.05657238</span> <span class="number">0.02828619</span> <span class="number">0.03161398</span> <span class="number">0.06988353</span> <span class="number">0.06322795</span> </span><br><span class="line"><span class="operator">&gt;</span> prop.table<span class="punctuation">(</span>table<span class="punctuation">(</span>Affairs<span class="operator">$</span>gender<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">   female      male </span><br><span class="line"><span class="number">0.5241265</span> <span class="number">0.4758735</span> </span><br><span class="line"><span class="operator">&gt;</span> Affairs<span class="operator">$</span>ynaffair<span class="punctuation">[</span>Affairs<span class="operator">$</span>affairs <span class="operator">&gt;</span> <span class="number">0</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> Affairs<span class="operator">$</span>ynaffair<span class="punctuation">[</span>Affairs<span class="operator">$</span>affairs <span class="operator">==</span> <span class="number">0</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">0</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>Affairs<span class="punctuation">)</span></span><br><span class="line">   affairs gender age yearsmarried children religiousness education occupation rating ynaffair</span><br><span class="line"><span class="number">4</span>        <span class="number">0</span>   male  <span class="number">37</span>        <span class="number">10.00</span>       no             <span class="number">3</span>        <span class="number">18</span>          <span class="number">7</span>      <span class="number">4</span>        <span class="number">0</span></span><br><span class="line"><span class="number">5</span>        <span class="number">0</span> female  <span class="number">27</span>         <span class="number">4.00</span>       no             <span class="number">4</span>        <span class="number">14</span>          <span class="number">6</span>      <span class="number">4</span>        <span class="number">0</span></span><br><span class="line"><span class="number">11</span>       <span class="number">0</span> female  <span class="number">32</span>        <span class="number">15.00</span>      yes             <span class="number">1</span>        <span class="number">12</span>          <span class="number">1</span>      <span class="number">4</span>        <span class="number">0</span></span><br><span class="line"><span class="number">16</span>       <span class="number">0</span>   male  <span class="number">57</span>        <span class="number">15.00</span>      yes             <span class="number">5</span>        <span class="number">18</span>          <span class="number">6</span>      <span class="number">5</span>        <span class="number">0</span></span><br><span class="line"><span class="number">23</span>       <span class="number">0</span>   male  <span class="number">22</span>         <span class="number">0.75</span>       no             <span class="number">2</span>        <span class="number">17</span>          <span class="number">6</span>      <span class="number">3</span>        <span class="number">0</span></span><br><span class="line"><span class="number">29</span>       <span class="number">0</span> female  <span class="number">32</span>         <span class="number">1.50</span>       no             <span class="number">2</span>        <span class="number">17</span>          <span class="number">5</span>      <span class="number">5</span>        <span class="number">0</span></span><br><span class="line"><span class="operator">&gt;</span> Affairs<span class="operator">$</span>ynaffair <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>Affairs<span class="operator">$</span>ynaffair<span class="punctuation">,</span> </span><br><span class="line"><span class="operator">+</span>                            levels<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"><span class="operator">+</span>                            labels<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;No&quot;</span><span class="punctuation">,</span><span class="string">&quot;Yes&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>Affairs<span class="operator">$</span>ynaffair<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"> No Yes </span><br><span class="line"><span class="number">451</span> <span class="number">150</span> </span><br><span class="line"><span class="operator">&gt;</span> attach<span class="punctuation">(</span>Affairs<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> glm<span class="punctuation">(</span>ynaffair <span class="operator">~</span> gender <span class="operator">+</span> age <span class="operator">+</span> yearsmarried <span class="operator">+</span> children <span class="operator">+</span> </span><br><span class="line"><span class="operator">+</span>                religiousness <span class="operator">+</span> education <span class="operator">+</span> occupation <span class="operator">+</span>rating<span class="punctuation">,</span></span><br><span class="line"><span class="operator">+</span>            data<span class="operator">=</span>Affairs<span class="punctuation">,</span>family<span class="operator">=</span>binomial<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">glm<span class="punctuation">(</span>formula <span class="operator">=</span> ynaffair <span class="operator">~</span> gender <span class="operator">+</span> age <span class="operator">+</span> yearsmarried <span class="operator">+</span> children <span class="operator">+</span> </span><br><span class="line">    religiousness <span class="operator">+</span> education <span class="operator">+</span> occupation <span class="operator">+</span> rating<span class="punctuation">,</span> family <span class="operator">=</span> binomial<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">    data <span class="operator">=</span> Affairs<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Deviance Residuals<span class="operator">:</span> </span><br><span class="line">    Min       <span class="number">1</span>Q   Median       <span class="number">3</span>Q      Max  </span><br><span class="line"><span class="operator">-</span><span class="number">1.5713</span>  <span class="operator">-</span><span class="number">0.7499</span>  <span class="operator">-</span><span class="number">0.5690</span>  <span class="operator">-</span><span class="number">0.2539</span>   <span class="number">2.5191</span>  </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">              Estimate Std. Error z value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>    <span class="number">1.37726</span>    <span class="number">0.88776</span>   <span class="number">1.551</span> <span class="number">0.120807</span>    </span><br><span class="line">gendermale     <span class="number">0.28029</span>    <span class="number">0.23909</span>   <span class="number">1.172</span> <span class="number">0.241083</span>    </span><br><span class="line">age           <span class="operator">-</span><span class="number">0.04426</span>    <span class="number">0.01825</span>  <span class="operator">-</span><span class="number">2.425</span> <span class="number">0.015301</span> <span class="operator">*</span>  </span><br><span class="line">yearsmarried   <span class="number">0.09477</span>    <span class="number">0.03221</span>   <span class="number">2.942</span> <span class="number">0.003262</span> <span class="operator">*</span><span class="operator">*</span> </span><br><span class="line">childrenyes    <span class="number">0.39767</span>    <span class="number">0.29151</span>   <span class="number">1.364</span> <span class="number">0.172508</span>    </span><br><span class="line">religiousness <span class="operator">-</span><span class="number">0.32472</span>    <span class="number">0.08975</span>  <span class="operator">-</span><span class="number">3.618</span> <span class="number">0.000297</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">education      <span class="number">0.02105</span>    <span class="number">0.05051</span>   <span class="number">0.417</span> <span class="number">0.676851</span>    </span><br><span class="line">occupation     <span class="number">0.03092</span>    <span class="number">0.07178</span>   <span class="number">0.431</span> <span class="number">0.666630</span>    </span><br><span class="line">rating        <span class="operator">-</span><span class="number">0.46845</span>    <span class="number">0.09091</span>  <span class="operator">-</span><span class="number">5.153</span> <span class="number">2.56e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">(</span>Dispersion parameter <span class="keyword">for</span> binomial family taken to be <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">    Null deviance<span class="operator">:</span> <span class="number">675.38</span>  on <span class="number">600</span>  degrees of freedom</span><br><span class="line">Residual deviance<span class="operator">:</span> <span class="number">609.51</span>  on <span class="number">592</span>  degrees of freedom</span><br><span class="line">AIC<span class="operator">:</span> <span class="number">627.51</span></span><br><span class="line"></span><br><span class="line">Number of Fisher Scoring iterations<span class="operator">:</span> <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> fit1 <span class="operator">&lt;-</span> glm<span class="punctuation">(</span>ynaffair <span class="operator">~</span> age <span class="operator">+</span> yearsmarried <span class="operator">+</span> religiousness <span class="operator">+</span> </span><br><span class="line"><span class="operator">+</span>                 rating<span class="punctuation">,</span> data<span class="operator">=</span>Affairs<span class="punctuation">,</span> family<span class="operator">=</span>binomial<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit1<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">glm<span class="punctuation">(</span>formula <span class="operator">=</span> ynaffair <span class="operator">~</span> age <span class="operator">+</span> yearsmarried <span class="operator">+</span> religiousness <span class="operator">+</span> </span><br><span class="line">    rating<span class="punctuation">,</span> family <span class="operator">=</span> binomial<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> Affairs<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Deviance Residuals<span class="operator">:</span> </span><br><span class="line">    Min       <span class="number">1</span>Q   Median       <span class="number">3</span>Q      Max  </span><br><span class="line"><span class="operator">-</span><span class="number">1.6278</span>  <span class="operator">-</span><span class="number">0.7550</span>  <span class="operator">-</span><span class="number">0.5701</span>  <span class="operator">-</span><span class="number">0.2624</span>   <span class="number">2.3998</span>  </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">              Estimate Std. Error z value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>    <span class="number">1.93083</span>    <span class="number">0.61032</span>   <span class="number">3.164</span> <span class="number">0.001558</span> <span class="operator">*</span><span class="operator">*</span> </span><br><span class="line">age           <span class="operator">-</span><span class="number">0.03527</span>    <span class="number">0.01736</span>  <span class="operator">-</span><span class="number">2.032</span> <span class="number">0.042127</span> <span class="operator">*</span>  </span><br><span class="line">yearsmarried   <span class="number">0.10062</span>    <span class="number">0.02921</span>   <span class="number">3.445</span> <span class="number">0.000571</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">religiousness <span class="operator">-</span><span class="number">0.32902</span>    <span class="number">0.08945</span>  <span class="operator">-</span><span class="number">3.678</span> <span class="number">0.000235</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">rating        <span class="operator">-</span><span class="number">0.46136</span>    <span class="number">0.08884</span>  <span class="operator">-</span><span class="number">5.193</span> <span class="number">2.06e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">(</span>Dispersion parameter <span class="keyword">for</span> binomial family taken to be <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">    Null deviance<span class="operator">:</span> <span class="number">675.38</span>  on <span class="number">600</span>  degrees of freedom</span><br><span class="line">Residual deviance<span class="operator">:</span> <span class="number">615.36</span>  on <span class="number">596</span>  degrees of freedom</span><br><span class="line">AIC<span class="operator">:</span> <span class="number">625.36</span></span><br><span class="line"></span><br><span class="line">Number of Fisher Scoring iterations<span class="operator">:</span> <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>从回归系数的p-value可以看到，性别、是否有孩子、学历和职业对方程的贡献都不显著，说明出轨和这些关系不大。可以把这些变量去除，重新拟合一次，如<code>fit1</code>，在新模型中每个回归系数都非常显著，p-value均小于0.05，由于<code>fit</code>和<code>fit1</code>两个模型是嵌套关系，可以使用<code>anova</code>函数对它们进行比较。对于广义线性回归可以使用卡方检验。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit<span class="punctuation">,</span> fit1<span class="punctuation">,</span> test<span class="operator">=</span><span class="string">&quot;Chisq&quot;</span><span class="punctuation">)</span></span><br><span class="line">Analysis of Deviance Table</span><br><span class="line"></span><br><span class="line">Model <span class="number">1</span><span class="operator">:</span> ynaffair <span class="operator">~</span> gender <span class="operator">+</span> age <span class="operator">+</span> yearsmarried <span class="operator">+</span> children <span class="operator">+</span> religiousness <span class="operator">+</span> </span><br><span class="line">    education <span class="operator">+</span> occupation <span class="operator">+</span> rating</span><br><span class="line">Model <span class="number">2</span><span class="operator">:</span> ynaffair <span class="operator">~</span> age <span class="operator">+</span> yearsmarried <span class="operator">+</span> religiousness <span class="operator">+</span> rating</span><br><span class="line">  Resid. Df Resid. Dev Df Deviance Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chi<span class="punctuation">)</span></span><br><span class="line"><span class="number">1</span>       <span class="number">592</span>     <span class="number">609.51</span>                     </span><br><span class="line"><span class="number">2</span>       <span class="number">596</span>     <span class="number">615.36</span> <span class="operator">-</span><span class="number">4</span>  <span class="operator">-</span><span class="number">5.8474</span>   <span class="number">0.2108</span></span><br></pre></td></tr></table></figure>
<p><code>p-value</code>为0.21，卡方检验不显著。证明两次结果差别不大。说明只有四个预测变量的新模型比前面9个完整预测的模型拟合的程度好，所以性别、是否有孩子、学历和职业变量不会显著提高方程的预测精度。可以把这些变量去除掉。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> coef<span class="punctuation">(</span>fit1<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>           age  yearsmarried religiousness        rating </span><br><span class="line">   <span class="number">1.93083017</span>   <span class="operator">-</span><span class="number">0.03527112</span>    <span class="number">0.10062274</span>   <span class="operator">-</span><span class="number">0.32902386</span>   <span class="operator">-</span><span class="number">0.46136144</span> </span><br></pre></td></tr></table></figure>
<p>回归系数可以看出，在Logistic回归中，响应变量是y为e的对数优势比，回归系数的含义是当其他预测变量不变时，一单位预测变量的变化，可能引起的响应变化对数优势比的变化，由于使用了对数优势比，再对其使用指数运算，回到正常模式：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">exp</span><span class="punctuation">(</span>coef<span class="punctuation">(</span>fit1<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>           age  yearsmarried religiousness        rating </span><br><span class="line">    <span class="number">6.8952321</span>     <span class="number">0.9653437</span>     <span class="number">1.1058594</span>     <span class="number">0.7196258</span>     <span class="number">0.6304248</span> </span><br></pre></td></tr></table></figure>
<p>可以看到，婚龄增加一年，婚外情的优势比将乘以1.1058594，相反年龄增加一岁，婚外情的优势比将乘以0.9653437，因此随着婚龄的增加，年龄和宗教信仰与婚姻评分的降低，婚外情优势比将上升。因为预测变量不能等于0，截距项在这里没有意义。</p>
<p>对新数据进行验证，首先创建包含感兴趣变量值的虚拟数据集，为了方便都取数据的平均值：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> testdata <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rating <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"><span class="operator">+</span>                        age <span class="operator">=</span> mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>age<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"><span class="operator">+</span>                        yearsmarried <span class="operator">=</span> mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>yearsmarried<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"><span class="operator">+</span>                        religiousness <span class="operator">=</span> mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>religiousness<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> testdata</span><br><span class="line">  rating      age yearsmarried religiousness</span><br><span class="line"><span class="number">1</span>      <span class="number">1</span> <span class="number">32.48752</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span></span><br><span class="line"><span class="number">2</span>      <span class="number">2</span> <span class="number">32.48752</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span></span><br><span class="line"><span class="number">3</span>      <span class="number">3</span> <span class="number">32.48752</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span></span><br><span class="line"><span class="number">4</span>      <span class="number">4</span> <span class="number">32.48752</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span></span><br><span class="line"><span class="number">5</span>      <span class="number">5</span> <span class="number">32.48752</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span></span><br><span class="line"><span class="operator">&gt;</span> testdata<span class="operator">$</span>prob <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>fit1<span class="punctuation">,</span> newdata<span class="operator">=</span>testdata<span class="punctuation">,</span> type<span class="operator">=</span><span class="string">&quot;response&quot;</span><span class="punctuation">)</span> <span class="comment"># 使用测试数据集，预测相应的概率</span></span><br><span class="line"><span class="operator">&gt;</span> testdata</span><br><span class="line">  rating      age yearsmarried religiousness      prob</span><br><span class="line"><span class="number">1</span>      <span class="number">1</span> <span class="number">32.48752</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span> <span class="number">0.5302296</span></span><br><span class="line"><span class="number">2</span>      <span class="number">2</span> <span class="number">32.48752</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span> <span class="number">0.4157377</span></span><br><span class="line"><span class="number">3</span>      <span class="number">3</span> <span class="number">32.48752</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span> <span class="number">0.3096712</span></span><br><span class="line"><span class="number">4</span>      <span class="number">4</span> <span class="number">32.48752</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span> <span class="number">0.2204547</span></span><br><span class="line"><span class="number">5</span>      <span class="number">5</span> <span class="number">32.48752</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span> <span class="number">0.1513079</span></span><br></pre></td></tr></table></figure>
<p>从上面的结果可以看出，对婚姻的评分越高，婚外情的概率越低。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> testdata <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rating <span class="operator">=</span> mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>rating<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"><span class="operator">+</span>                        age <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">17</span><span class="punctuation">,</span> <span class="number">57</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line"><span class="operator">+</span>                        yearsmarried <span class="operator">=</span> mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>yearsmarried<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"><span class="operator">+</span>                        religiousness <span class="operator">=</span> mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>religiousness<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> testdata</span><br><span class="line">   rating age yearsmarried religiousness</span><br><span class="line"><span class="number">1</span> <span class="number">3.93178</span>  <span class="number">17</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span></span><br><span class="line"><span class="number">2</span> <span class="number">3.93178</span>  <span class="number">27</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span></span><br><span class="line"><span class="number">3</span> <span class="number">3.93178</span>  <span class="number">37</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span></span><br><span class="line"><span class="number">4</span> <span class="number">3.93178</span>  <span class="number">47</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span></span><br><span class="line"><span class="number">5</span> <span class="number">3.93178</span>  <span class="number">57</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span></span><br><span class="line"><span class="operator">&gt;</span> testdata<span class="operator">$</span>prob <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>fit1<span class="punctuation">,</span> newdata<span class="operator">=</span>testdata<span class="punctuation">,</span> type<span class="operator">=</span><span class="string">&quot;response&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> testdata</span><br><span class="line">   rating age yearsmarried religiousness      prob</span><br><span class="line"><span class="number">1</span> <span class="number">3.93178</span>  <span class="number">17</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span> <span class="number">0.3350834</span></span><br><span class="line"><span class="number">2</span> <span class="number">3.93178</span>  <span class="number">27</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span> <span class="number">0.2615373</span></span><br><span class="line"><span class="number">3</span> <span class="number">3.93178</span>  <span class="number">37</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span> <span class="number">0.1992953</span></span><br><span class="line"><span class="number">4</span> <span class="number">3.93178</span>  <span class="number">47</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span> <span class="number">0.1488796</span></span><br><span class="line"><span class="number">5</span> <span class="number">3.93178</span>  <span class="number">57</span>     <span class="number">8.177696</span>      <span class="number">3.116473</span> <span class="number">0.1094738</span></span><br></pre></td></tr></table></figure>
<p>从上面的结果可以看出，随着年龄的增长，婚外情的概率越低。</p>
<h3 id="7-3-主成分分析">7.3 主成分分析</h3>
<p>主成分分析和因子分析是统计学中非常重要的分析方法。</p>
<p>主成分分析，Principal Component Analysis，也简称为PCA，是一种数据降维技巧，它能将大量相关变量转化为一组很少的不相关变量，这些无关的变量称为主成分。主成分其实是对原始变量重新进行线性组合将原先众多具有一定相关性的指标，重新组合为一组的新的相互独立的综合指标。</p>
<p>主成分分析和因子分析模型图：</p>
<p><img src="https://vip2.loli.io/2023/03/13/7Hmi93gUVQXk48J.png" alt="image-20220814101044077"></p>
<p>主成分分析公式：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>C</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><msub><mi>a</mi><mn>3</mn></msub><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mi>k</mi></msub><msub><mi>X</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">PC_1=a_1X_1=a_2X_2+a_3X_3+\dots+a_kX_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>R内置的<code>princomp</code>函数可以进行主成分分析，也可以使用<code>psych</code>包中的函数进行分析，比R提供的内置函数更丰富。</p>
<p><strong>主成分分析与因子分析步骤</strong>：</p>
<p>1、数据预处理；<br>
2、选择分析模型；<br>
3、判断要选择的主成分/因子数目；<br>
4、选择主成分/因子；<br>
5、旋转主成分/因子；（可选）<br>
6、解释结果；<br>
7、计算主成分或因子得分。（可选）</p>
<p>这里使用<code>psych</code>包中的<code>USJudgeRatings</code>数据集进行演示：</p>
<p><img src="https://vip2.loli.io/2023/03/13/PI4AtdJ1ciEBbQ6.png" alt="image-20220814102123976"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">载入程辑包：‘psych’</span><br><span class="line"></span><br><span class="line">The following object is masked from ‘package<span class="operator">:</span>car’<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">    logit</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>USJudgeRatings<span class="punctuation">)</span></span><br><span class="line">               CONT INTG DMNR DILG CFMG DECI PREP FAMI ORAL WRIT PHYS RTEN</span><br><span class="line">AARONSON<span class="punctuation">,</span>L.H.   <span class="number">5.7</span>  <span class="number">7.9</span>  <span class="number">7.7</span>  <span class="number">7.3</span>  <span class="number">7.1</span>  <span class="number">7.4</span>  <span class="number">7.1</span>  <span class="number">7.1</span>  <span class="number">7.1</span>  <span class="number">7.0</span>  <span class="number">8.3</span>  <span class="number">7.8</span></span><br><span class="line">ALEXANDER<span class="punctuation">,</span>J.M.  <span class="number">6.8</span>  <span class="number">8.9</span>  <span class="number">8.8</span>  <span class="number">8.5</span>  <span class="number">7.8</span>  <span class="number">8.1</span>  <span class="number">8.0</span>  <span class="number">8.0</span>  <span class="number">7.8</span>  <span class="number">7.9</span>  <span class="number">8.5</span>  <span class="number">8.7</span></span><br><span class="line">ARMENTANO<span class="punctuation">,</span>A.J.  <span class="number">7.2</span>  <span class="number">8.1</span>  <span class="number">7.8</span>  <span class="number">7.8</span>  <span class="number">7.5</span>  <span class="number">7.6</span>  <span class="number">7.5</span>  <span class="number">7.5</span>  <span class="number">7.3</span>  <span class="number">7.4</span>  <span class="number">7.9</span>  <span class="number">7.8</span></span><br><span class="line">BERDON<span class="punctuation">,</span>R.I.     <span class="number">6.8</span>  <span class="number">8.8</span>  <span class="number">8.5</span>  <span class="number">8.8</span>  <span class="number">8.3</span>  <span class="number">8.5</span>  <span class="number">8.7</span>  <span class="number">8.7</span>  <span class="number">8.4</span>  <span class="number">8.5</span>  <span class="number">8.8</span>  <span class="number">8.7</span></span><br><span class="line">BRACKEN<span class="punctuation">,</span>J.J.    <span class="number">7.3</span>  <span class="number">6.4</span>  <span class="number">4.3</span>  <span class="number">6.5</span>  <span class="number">6.0</span>  <span class="number">6.2</span>  <span class="number">5.7</span>  <span class="number">5.7</span>  <span class="number">5.1</span>  <span class="number">5.3</span>  <span class="number">5.5</span>  <span class="number">4.8</span></span><br><span class="line">BURNS<span class="punctuation">,</span>E.B.      <span class="number">6.2</span>  <span class="number">8.8</span>  <span class="number">8.7</span>  <span class="number">8.5</span>  <span class="number">7.9</span>  <span class="number">8.0</span>  <span class="number">8.1</span>  <span class="number">8.0</span>  <span class="number">8.0</span>  <span class="number">8.0</span>  <span class="number">8.6</span>  <span class="number">8.6</span></span><br><span class="line"><span class="operator">&gt;</span> fa.parallel<span class="punctuation">(</span>USJudgeRatings<span class="punctuation">,</span>fa<span class="operator">=</span><span class="string">&quot;pc&quot;</span><span class="punctuation">,</span>n.iter <span class="operator">=</span> <span class="number">100</span><span class="punctuation">)</span> <span class="comment"># 循环一百次</span></span><br><span class="line">Parallel analysis suggests that the number of factors <span class="operator">=</span>  <span class="literal">NA</span>  and the number of components <span class="operator">=</span>  <span class="number">1</span> </span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line">In fa.stats<span class="punctuation">(</span>r <span class="operator">=</span> r<span class="punctuation">,</span> f <span class="operator">=</span> f<span class="punctuation">,</span> phi <span class="operator">=</span> phi<span class="punctuation">,</span> n.obs <span class="operator">=</span> n.obs<span class="punctuation">,</span> np.obs <span class="operator">=</span> np.obs<span class="punctuation">,</span>  <span class="operator">:</span></span><br><span class="line">  The estimated weights <span class="keyword">for</span> the factor scores are probably incorrect.  Try a different factor score estimation method.</span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/wxTyAsqg25XPWuF.png" alt="image-20220814102704549"></p>
<p>生成如上所示的碎石图。碎石图的判定规则为实线与x符号，特征值大于1准则和100次模拟的平行分析。图中虚线表示保存一个主成分，在y=1的水平线上有一个碎石和一条虚线，因此只要保留一个主成分即可。具体碎石图的原理，可以研究平衡分析法。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> pc <span class="operator">&lt;-</span> principal<span class="punctuation">(</span>USJudgeRatings<span class="punctuation">,</span>nfactors <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>rotate <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span>scores <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> pc</span><br><span class="line">Principal Components Analysis</span><br><span class="line">Call<span class="operator">:</span> principal<span class="punctuation">(</span>r <span class="operator">=</span> USJudgeRatings<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    scores <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">Standardized loadings <span class="punctuation">(</span>pattern matrix<span class="punctuation">)</span> based upon correlation matrix</span><br><span class="line">       PC1      h2     u2 com</span><br><span class="line">CONT <span class="operator">-</span><span class="number">0.01</span> <span class="number">9.6e-05</span> <span class="number">0.9999</span>   <span class="number">1</span></span><br><span class="line">INTG  <span class="number">0.92</span> <span class="number">8.4e-01</span> <span class="number">0.1563</span>   <span class="number">1</span></span><br><span class="line">DMNR  <span class="number">0.91</span> <span class="number">8.3e-01</span> <span class="number">0.1660</span>   <span class="number">1</span></span><br><span class="line">DILG  <span class="number">0.97</span> <span class="number">9.4e-01</span> <span class="number">0.0613</span>   <span class="number">1</span></span><br><span class="line">CFMG  <span class="number">0.96</span> <span class="number">9.3e-01</span> <span class="number">0.0723</span>   <span class="number">1</span></span><br><span class="line">DECI  <span class="number">0.96</span> <span class="number">9.2e-01</span> <span class="number">0.0764</span>   <span class="number">1</span></span><br><span class="line">PREP  <span class="number">0.98</span> <span class="number">9.7e-01</span> <span class="number">0.0299</span>   <span class="number">1</span></span><br><span class="line">FAMI  <span class="number">0.98</span> <span class="number">9.5e-01</span> <span class="number">0.0469</span>   <span class="number">1</span></span><br><span class="line">ORAL  <span class="number">1.00</span> <span class="number">9.9e-01</span> <span class="number">0.0091</span>   <span class="number">1</span></span><br><span class="line">WRIT  <span class="number">0.99</span> <span class="number">9.8e-01</span> <span class="number">0.0195</span>   <span class="number">1</span></span><br><span class="line">PHYS  <span class="number">0.89</span> <span class="number">8.0e-01</span> <span class="number">0.2014</span>   <span class="number">1</span></span><br><span class="line">RTEN  <span class="number">0.99</span> <span class="number">9.7e-01</span> <span class="number">0.0275</span>   <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                 PC1</span><br><span class="line">SS loadings    <span class="number">10.13</span></span><br><span class="line">Proportion Var  <span class="number">0.84</span></span><br><span class="line"></span><br><span class="line">Mean item complexity <span class="operator">=</span>  <span class="number">1</span></span><br><span class="line">Test of the hypothesis that <span class="number">1</span> component is sufficient.</span><br><span class="line"></span><br><span class="line">The root mean square of the residuals <span class="punctuation">(</span>RMSR<span class="punctuation">)</span> is  <span class="number">0.05</span> </span><br><span class="line"> with the empirical chi square  <span class="number">12.56</span>  with prob <span class="operator">&lt;</span>  <span class="number">1</span> </span><br><span class="line"></span><br><span class="line">Fit based upon off diagonal values <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>PC1列包含了成分载荷，指观测变量与主成分的相关系数，如果提取不止一个主成分，比如将<code>nfactors</code>参数设置为2或3，还会有PC2，PC3等成分。</p>
<p>h2列指成分公因子的方差，它是主成分对每个变量的方差解释度。u2列指的是主成分唯一性，它是方差无法被主成分解释的比例，例如体能PHYS有89%的方差能够被第一主成分来解释。</p>
<p><code>SS loadings</code>表示与主成分相关联的特征值。指的是特定主成分相关联的标准化后的方差值。</p>
<p><code>Proportion Var</code>表示每个主成分对整个数据集的解释程度，可以看到第一主成分解释了12个变量84%的方差。</p>
<p>将<code>scores</code>参数设置为TRUE，就可以获得每个变量的得分，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> pc <span class="operator">&lt;-</span> principal<span class="punctuation">(</span>USJudgeRatings<span class="punctuation">,</span>nfactors <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>rotate <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span>scores <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> pc</span><br><span class="line">Principal Components Analysis</span><br><span class="line">Call<span class="operator">:</span> principal<span class="punctuation">(</span>r <span class="operator">=</span> USJudgeRatings<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    scores <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">Standardized loadings <span class="punctuation">(</span>pattern matrix<span class="punctuation">)</span> based upon correlation matrix</span><br><span class="line">       PC1      h2     u2 com</span><br><span class="line">CONT <span class="operator">-</span><span class="number">0.01</span> <span class="number">9.6e-05</span> <span class="number">0.9999</span>   <span class="number">1</span></span><br><span class="line">INTG  <span class="number">0.92</span> <span class="number">8.4e-01</span> <span class="number">0.1563</span>   <span class="number">1</span></span><br><span class="line">DMNR  <span class="number">0.91</span> <span class="number">8.3e-01</span> <span class="number">0.1660</span>   <span class="number">1</span></span><br><span class="line">DILG  <span class="number">0.97</span> <span class="number">9.4e-01</span> <span class="number">0.0613</span>   <span class="number">1</span></span><br><span class="line">CFMG  <span class="number">0.96</span> <span class="number">9.3e-01</span> <span class="number">0.0723</span>   <span class="number">1</span></span><br><span class="line">DECI  <span class="number">0.96</span> <span class="number">9.2e-01</span> <span class="number">0.0764</span>   <span class="number">1</span></span><br><span class="line">PREP  <span class="number">0.98</span> <span class="number">9.7e-01</span> <span class="number">0.0299</span>   <span class="number">1</span></span><br><span class="line">FAMI  <span class="number">0.98</span> <span class="number">9.5e-01</span> <span class="number">0.0469</span>   <span class="number">1</span></span><br><span class="line">ORAL  <span class="number">1.00</span> <span class="number">9.9e-01</span> <span class="number">0.0091</span>   <span class="number">1</span></span><br><span class="line">WRIT  <span class="number">0.99</span> <span class="number">9.8e-01</span> <span class="number">0.0195</span>   <span class="number">1</span></span><br><span class="line">PHYS  <span class="number">0.89</span> <span class="number">8.0e-01</span> <span class="number">0.2014</span>   <span class="number">1</span></span><br><span class="line">RTEN  <span class="number">0.99</span> <span class="number">9.7e-01</span> <span class="number">0.0275</span>   <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                 PC1</span><br><span class="line">SS loadings    <span class="number">10.13</span></span><br><span class="line">Proportion Var  <span class="number">0.84</span></span><br><span class="line"></span><br><span class="line">Mean item complexity <span class="operator">=</span>  <span class="number">1</span></span><br><span class="line">Test of the hypothesis that <span class="number">1</span> component is sufficient.</span><br><span class="line"></span><br><span class="line">The root mean square of the residuals <span class="punctuation">(</span>RMSR<span class="punctuation">)</span> is  <span class="number">0.05</span> </span><br><span class="line"> with the empirical chi square  <span class="number">12.56</span>  with prob <span class="operator">&lt;</span>  <span class="number">1</span> </span><br><span class="line"></span><br><span class="line">Fit based upon off diagonal values <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> pc<span class="operator">$</span>scores</span><br><span class="line">                        PC1</span><br><span class="line">AARONSON<span class="punctuation">,</span>L.H.   <span class="operator">-</span><span class="number">0.18400648</span></span><br><span class="line">ALEXANDER<span class="punctuation">,</span>J.M.   <span class="number">0.74765156</span></span><br><span class="line">ARMENTANO<span class="punctuation">,</span>A.J.   <span class="number">0.07072468</span></span><br><span class="line">BERDON<span class="punctuation">,</span>R.I.      <span class="number">1.13651889</span></span><br><span class="line">BRACKEN<span class="punctuation">,</span>J.J.    <span class="operator">-</span><span class="number">2.15848207</span></span><br><span class="line">BURNS<span class="punctuation">,</span>E.B.       <span class="number">0.76821742</span></span><br><span class="line">CALLAHAN<span class="punctuation">,</span>R.J.    <span class="number">1.22243063</span></span><br><span class="line">COHEN<span class="punctuation">,</span>S.S.      <span class="operator">-</span><span class="number">2.51260343</span></span><br><span class="line">DALY<span class="punctuation">,</span>J.J.        <span class="number">1.14963289</span></span><br><span class="line">DANNEHY<span class="punctuation">,</span>J.F.     <span class="number">0.32918115</span></span><br><span class="line">DEAN<span class="punctuation">,</span>H.H.       <span class="operator">-</span><span class="number">0.10589377</span></span><br><span class="line">DEVITA<span class="punctuation">,</span>H.J.     <span class="operator">-</span><span class="number">0.45257054</span></span><br><span class="line">DRISCOLL<span class="punctuation">,</span>P.J.   <span class="operator">-</span><span class="number">0.21014722</span></span><br><span class="line">GRILLO<span class="punctuation">,</span>A.E.     <span class="operator">-</span><span class="number">1.01338259</span></span><br><span class="line">HADDEN<span class="punctuation">,</span>W.L.JR.   <span class="number">0.42501399</span></span><br><span class="line">HAMILL<span class="punctuation">,</span>E.C.     <span class="operator">-</span><span class="number">0.13973759</span></span><br><span class="line">HEALEY.A.H.     <span class="operator">-</span><span class="number">0.91030943</span></span><br><span class="line">HULL<span class="punctuation">,</span>T.C.       <span class="operator">-</span><span class="number">0.22553233</span></span><br><span class="line">LEVINE<span class="punctuation">,</span>I.        <span class="number">0.20145341</span></span><br><span class="line">LEVISTER<span class="punctuation">,</span>R.L.   <span class="operator">-</span><span class="number">1.36839157</span></span><br><span class="line">MARTIN<span class="punctuation">,</span>L.F.     <span class="operator">-</span><span class="number">0.57128247</span></span><br><span class="line">MCGRATH<span class="punctuation">,</span>J.F.    <span class="operator">-</span><span class="number">0.97984173</span></span><br><span class="line">MIGNONE<span class="punctuation">,</span>A.F.    <span class="operator">-</span><span class="number">1.99621925</span></span><br><span class="line">MISSAL<span class="punctuation">,</span>H.M.     <span class="operator">-</span><span class="number">0.02581675</span></span><br><span class="line">MULVEY<span class="punctuation">,</span>H.M.      <span class="number">1.05284946</span></span><br><span class="line">NARUK<span class="punctuation">,</span>H.J.       <span class="number">1.42897516</span></span><br><span class="line">O<span class="string">&#x27;BRIEN,F.J.     0.47123628</span></span><br><span class="line"><span class="string">O&#x27;</span>SULLIVAN<span class="punctuation">,</span>T.J.  <span class="number">1.09004545</span></span><br><span class="line">PASKEY<span class="punctuation">,</span>L.        <span class="number">0.59472217</span></span><br><span class="line">RUBINOW<span class="punctuation">,</span>J.E.     <span class="number">1.50120742</span></span><br><span class="line">SADEN.G.A.       <span class="number">0.34527687</span></span><br><span class="line">SATANIELLO<span class="punctuation">,</span>A.G.  <span class="number">0.17036943</span></span><br><span class="line">SHEA<span class="punctuation">,</span>D.M.        <span class="number">0.81143377</span></span><br><span class="line">SHEA<span class="punctuation">,</span>J.F.JR.     <span class="number">1.12983152</span></span><br><span class="line">SIDOR<span class="punctuation">,</span>W.J.      <span class="operator">-</span><span class="number">2.15582532</span></span><br><span class="line">SPEZIALE<span class="punctuation">,</span>J.A.    <span class="number">0.63632965</span></span><br><span class="line">SPONZO<span class="punctuation">,</span>M.J.      <span class="number">0.37901740</span></span><br><span class="line">STAPLETON<span class="punctuation">,</span>J.F.   <span class="number">0.22614913</span></span><br><span class="line">TESTO<span class="punctuation">,</span>R.J.      <span class="operator">-</span><span class="number">0.66166162</span></span><br><span class="line">TIERNEY<span class="punctuation">,</span>W.L.JR.  <span class="number">0.42466794</span></span><br><span class="line">WALL<span class="punctuation">,</span>R.A.       <span class="operator">-</span><span class="number">0.81315467</span></span><br><span class="line">WRIGHT<span class="punctuation">,</span>D.B.      <span class="number">0.45956919</span></span><br><span class="line">ZARRILLI<span class="punctuation">,</span>K.J.   <span class="operator">-</span><span class="number">0.28764663</span></span><br></pre></td></tr></table></figure>
<p>再看第二个案例：<code>Harman23.cor</code>数据集</p>
<p><img src="https://vip2.loli.io/2023/03/13/UVKns8k7fgjWxM4.png" alt="image-20220814105148861"></p>
<p><code>Harman23.cor</code>数据集包含了305个女孩8个身体测量指标。在这个例子中，数据集由变量的相关系数组成，而不是原始数据集，用主成分分析，使用较少的变量替换原始身体指标。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> Harman23.cor</span><br><span class="line"><span class="operator">$</span>cov</span><br><span class="line">               height arm.span forearm lower.leg weight bitro.diameter chest.girth chest.width</span><br><span class="line">height          <span class="number">1.000</span>    <span class="number">0.846</span>   <span class="number">0.805</span>     <span class="number">0.859</span>  <span class="number">0.473</span>          <span class="number">0.398</span>       <span class="number">0.301</span>       <span class="number">0.382</span></span><br><span class="line">arm.span        <span class="number">0.846</span>    <span class="number">1.000</span>   <span class="number">0.881</span>     <span class="number">0.826</span>  <span class="number">0.376</span>          <span class="number">0.326</span>       <span class="number">0.277</span>       <span class="number">0.415</span></span><br><span class="line">forearm         <span class="number">0.805</span>    <span class="number">0.881</span>   <span class="number">1.000</span>     <span class="number">0.801</span>  <span class="number">0.380</span>          <span class="number">0.319</span>       <span class="number">0.237</span>       <span class="number">0.345</span></span><br><span class="line">lower.leg       <span class="number">0.859</span>    <span class="number">0.826</span>   <span class="number">0.801</span>     <span class="number">1.000</span>  <span class="number">0.436</span>          <span class="number">0.329</span>       <span class="number">0.327</span>       <span class="number">0.365</span></span><br><span class="line">weight          <span class="number">0.473</span>    <span class="number">0.376</span>   <span class="number">0.380</span>     <span class="number">0.436</span>  <span class="number">1.000</span>          <span class="number">0.762</span>       <span class="number">0.730</span>       <span class="number">0.629</span></span><br><span class="line">bitro.diameter  <span class="number">0.398</span>    <span class="number">0.326</span>   <span class="number">0.319</span>     <span class="number">0.329</span>  <span class="number">0.762</span>          <span class="number">1.000</span>       <span class="number">0.583</span>       <span class="number">0.577</span></span><br><span class="line">chest.girth     <span class="number">0.301</span>    <span class="number">0.277</span>   <span class="number">0.237</span>     <span class="number">0.327</span>  <span class="number">0.730</span>          <span class="number">0.583</span>       <span class="number">1.000</span>       <span class="number">0.539</span></span><br><span class="line">chest.width     <span class="number">0.382</span>    <span class="number">0.415</span>   <span class="number">0.345</span>     <span class="number">0.365</span>  <span class="number">0.629</span>          <span class="number">0.577</span>       <span class="number">0.539</span>       <span class="number">1.000</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>center</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>n.obs</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">305</span></span><br><span class="line"><span class="operator">&gt;</span> fa.parallel<span class="punctuation">(</span>Harman23.cor<span class="operator">$</span>cov<span class="punctuation">,</span>n.obs <span class="operator">=</span> <span class="number">302</span><span class="punctuation">,</span>fa<span class="operator">=</span><span class="string">&quot;pc&quot;</span><span class="punctuation">,</span>n.iter <span class="operator">=</span> <span class="number">100</span><span class="punctuation">,</span>show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="comment"># 绘制碎石图，n.obs为样本大小</span></span><br><span class="line">Parallel analysis suggests that the number of factors <span class="operator">=</span>  <span class="literal">NA</span>  and the number of components <span class="operator">=</span>  <span class="number">2</span> </span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/r3E6pfPJlmMaKjs.png" alt="image-20220814105944527"></p>
<p>图中有两个碎石在y=1之上，所以需要两个主成分。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> pc <span class="operator">&lt;-</span> principal<span class="punctuation">(</span>Harman23.cor<span class="operator">$</span>cov<span class="punctuation">,</span>nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span>rotate <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> pc</span><br><span class="line">Principal Components Analysis</span><br><span class="line">Call<span class="operator">:</span> principal<span class="punctuation">(</span>r <span class="operator">=</span> Harman23.cor<span class="operator">$</span>cov<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br><span class="line">Standardized loadings <span class="punctuation">(</span>pattern matrix<span class="punctuation">)</span> based upon correlation matrix</span><br><span class="line">                PC1   PC2   h2    u2 com</span><br><span class="line">height         <span class="number">0.86</span> <span class="operator">-</span><span class="number">0.37</span> <span class="number">0.88</span> <span class="number">0.123</span> <span class="number">1.4</span></span><br><span class="line">arm.span       <span class="number">0.84</span> <span class="operator">-</span><span class="number">0.44</span> <span class="number">0.90</span> <span class="number">0.097</span> <span class="number">1.5</span></span><br><span class="line">forearm        <span class="number">0.81</span> <span class="operator">-</span><span class="number">0.46</span> <span class="number">0.87</span> <span class="number">0.128</span> <span class="number">1.6</span></span><br><span class="line">lower.leg      <span class="number">0.84</span> <span class="operator">-</span><span class="number">0.40</span> <span class="number">0.86</span> <span class="number">0.139</span> <span class="number">1.4</span></span><br><span class="line">weight         <span class="number">0.76</span>  <span class="number">0.52</span> <span class="number">0.85</span> <span class="number">0.150</span> <span class="number">1.8</span></span><br><span class="line">bitro.diameter <span class="number">0.67</span>  <span class="number">0.53</span> <span class="number">0.74</span> <span class="number">0.261</span> <span class="number">1.9</span></span><br><span class="line">chest.girth    <span class="number">0.62</span>  <span class="number">0.58</span> <span class="number">0.72</span> <span class="number">0.283</span> <span class="number">2.0</span></span><br><span class="line">chest.width    <span class="number">0.67</span>  <span class="number">0.42</span> <span class="number">0.62</span> <span class="number">0.375</span> <span class="number">1.7</span></span><br><span class="line"></span><br><span class="line">                       PC1  PC2</span><br><span class="line">SS loadings           <span class="number">4.67</span> <span class="number">1.77</span></span><br><span class="line">Proportion Var        <span class="number">0.58</span> <span class="number">0.22</span></span><br><span class="line">Cumulative Var        <span class="number">0.58</span> <span class="number">0.81</span></span><br><span class="line">Proportion Explained  <span class="number">0.73</span> <span class="number">0.27</span></span><br><span class="line">Cumulative Proportion <span class="number">0.73</span> <span class="number">1.00</span></span><br><span class="line"></span><br><span class="line">Mean item complexity <span class="operator">=</span>  <span class="number">1.7</span></span><br><span class="line">Test of the hypothesis that <span class="number">2</span> components are sufficient.</span><br><span class="line"></span><br><span class="line">The root mean square of the residuals <span class="punctuation">(</span>RMSR<span class="punctuation">)</span> is  <span class="number">0.05</span> </span><br><span class="line"></span><br><span class="line">Fit based upon off diagonal values <span class="operator">=</span> <span class="number">0.99</span></span><br></pre></td></tr></table></figure>
<p>结果显示第一主成分解释了身体测量指标58%的方差，第二主成分解释了身体测量指标22%的方差，两者总共解释了81%的方差（Cumulative Var），对于高度h变量，两者共解释了88%的方差。</p>
<p>旋转是一系列将成分载荷变得更容易解释的数学方法，它们尽可能地对成分去噪，旋转方法有两种，使旋转的成分保持不相关的正交旋转和让它们变得相关的斜交旋转。旋转方法也会依据去噪定义的不同而不同。最流行的正交旋转是方差极大旋转。它试图对载荷矩阵的列进行去噪，使得每个成分只是由一组有限的变量来解释。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> pc <span class="operator">&lt;-</span> principal<span class="punctuation">(</span>Harman23.cor<span class="operator">$</span>cov<span class="punctuation">,</span>nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span>rotate <span class="operator">=</span> <span class="string">&quot;varimax&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> pc</span><br><span class="line">Principal Components Analysis</span><br><span class="line">Call<span class="operator">:</span> principal<span class="punctuation">(</span>r <span class="operator">=</span> Harman23.cor<span class="operator">$</span>cov<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&quot;varimax&quot;</span><span class="punctuation">)</span></span><br><span class="line">Standardized loadings <span class="punctuation">(</span>pattern matrix<span class="punctuation">)</span> based upon correlation matrix</span><br><span class="line">                RC1  RC2   h2    u2 com</span><br><span class="line">height         <span class="number">0.90</span> <span class="number">0.25</span> <span class="number">0.88</span> <span class="number">0.123</span> <span class="number">1.2</span></span><br><span class="line">arm.span       <span class="number">0.93</span> <span class="number">0.19</span> <span class="number">0.90</span> <span class="number">0.097</span> <span class="number">1.1</span></span><br><span class="line">forearm        <span class="number">0.92</span> <span class="number">0.16</span> <span class="number">0.87</span> <span class="number">0.128</span> <span class="number">1.1</span></span><br><span class="line">lower.leg      <span class="number">0.90</span> <span class="number">0.22</span> <span class="number">0.86</span> <span class="number">0.139</span> <span class="number">1.1</span></span><br><span class="line">weight         <span class="number">0.26</span> <span class="number">0.88</span> <span class="number">0.85</span> <span class="number">0.150</span> <span class="number">1.2</span></span><br><span class="line">bitro.diameter <span class="number">0.19</span> <span class="number">0.84</span> <span class="number">0.74</span> <span class="number">0.261</span> <span class="number">1.1</span></span><br><span class="line">chest.girth    <span class="number">0.11</span> <span class="number">0.84</span> <span class="number">0.72</span> <span class="number">0.283</span> <span class="number">1.0</span></span><br><span class="line">chest.width    <span class="number">0.26</span> <span class="number">0.75</span> <span class="number">0.62</span> <span class="number">0.375</span> <span class="number">1.2</span></span><br><span class="line"></span><br><span class="line">                       RC1  RC2</span><br><span class="line">SS loadings           <span class="number">3.52</span> <span class="number">2.92</span></span><br><span class="line">Proportion Var        <span class="number">0.44</span> <span class="number">0.37</span></span><br><span class="line">Cumulative Var        <span class="number">0.44</span> <span class="number">0.81</span></span><br><span class="line">Proportion Explained  <span class="number">0.55</span> <span class="number">0.45</span></span><br><span class="line">Cumulative Proportion <span class="number">0.55</span> <span class="number">1.00</span></span><br><span class="line"></span><br><span class="line">Mean item complexity <span class="operator">=</span>  <span class="number">1.1</span></span><br><span class="line">Test of the hypothesis that <span class="number">2</span> components are sufficient.</span><br><span class="line"></span><br><span class="line">The root mean square of the residuals <span class="punctuation">(</span>RMSR<span class="punctuation">)</span> is  <span class="number">0.05</span> </span><br><span class="line"></span><br><span class="line">Fit based upon off diagonal values <span class="operator">=</span> <span class="number">0.99</span></span><br></pre></td></tr></table></figure>
<p>列的名字由PC变为RC，表示列的名字被旋转了，观察RC1列的载荷，可以看出第一主成分由前四个变量来解释，主要都是与高度相关的变量，RC2列的载荷表示第二主成分主要由变量5到变量8这四个变量来解释，主要都是与重量相关的变量。两个主成分仍不相关，对变量的解释性不变。这是因为变量的群组没有发生变化，另外两个主成分旋转后的累计方差解释性没有变化，还是81%。变的只是各个主成分对方差的解释度。成分1从58%变为44%，成分2从22%变为37%，各成分的方差解释度趋同，只能称它们为成分，而不是主成分。</p>
<h3 id="7-4-因子分析">7.4 因子分析</h3>
<p>探索性因子分析法Exploratory Factor Analysis，简称为EFA，是一系列用来发现一组变量的潜在结构的方法。它通过寻找一组更小的、潜在的或隐藏的结构来解释已观测到的、显式的变量间的关系。</p>
<p><img src="https://vip2.loli.io/2023/03/13/7Hmi93gUVQXk48J.png" alt="image-20220814101044077"></p>
<p>因子分析公式：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><msub><mi>F</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><msub><mi>F</mi><mn>2</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mi>p</mi></msub><msub><mi>F</mi><mi>p</mi></msub><mo>+</mo><msub><mi>U</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i=a_1F_1+a_2F_2+\dots+a_pF_p+U_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>主成分分析公式：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>C</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><msub><mi>a</mi><mn>3</mn></msub><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mi>k</mi></msub><msub><mi>X</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">PC_1=a_1X_1=a_2X_2+a_3X_3+\dots+a_kX_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>比如：语文、数学、外语、物理、化学、生物、历史、地理、政治</p>
<p><strong>主成分分析</strong>：语文、数学、外语、文科或者理科</p>
<p><strong>因子分析</strong>：逻辑推理（数学、物理、化学，生物），语言天赋（语文、外语），逻辑分析（历史、政治、地理）。</p>
<p>主成分与因子分析比较</p>
<p>相同点：</p>
<ol>
<li>
<p>都对原始数据进行降维处理；</p>
</li>
<li>
<p>都消除了原始指标的相关性对综合评价所造成的信息重复的影响；</p>
</li>
<li>
<p>构造综合评价时所涉及的权数具有客观性；</p>
</li>
<li>
<p>在信息损失不大的前提下，减少了评价工作量。</p>
</li>
</ol>
<p>不同点：<br>
主成分分析：</p>
<ol>
<li>用较少的变量表示原来的样本；</li>
<li>目的是样本数据信息损失最小的原则下，对高维变量进行降维。</li>
<li>参数估计，一般是求相关矩阵的特征值和相应的特征向量，取前几个计算主成分。</li>
<li>应用：应用较少变量来解释各个样本的特征。</li>
</ol>
<p>因子分析：</p>
<ol>
<li>用较少的因子表示原来的变量；</li>
<li>目的是尽可能保持原变量相互关系，寻找变量的公共因子；</li>
<li>参数估计，指定几个公因子，将其还原成相关系数矩阵，在和原样本相关矩阵最相似原则下，估计各个公因子的估计值；</li>
<li>应用：找到具有本质意义的少量因子来归纳原来变量的特征。</li>
</ol>
<p>因子分析的评价结果没有主成分分析准确，计算工作量也比主成分分析工作量大，但是公共因子比主成分更容易被解释。</p>
<p><strong>主成分分析与因子分析步骤</strong>：</p>
<p>1、数据预处理；<br>
2、选择分析模型；<br>
3、判断要选择的主成分/因子数目；<br>
4、选择主成分/因子；<br>
5、旋转主成分/因子；（可选）<br>
6、解释结果；<br>
7、计算主成分或因子得分。（可选）</p>
<p>也是通过碎石图判断选择因子的数目。</p>
<p>R内置的<code>factanal</code>函数可以进行因子分析，这里使用<code>psych</code>包中的<code>ability.cov</code>数据集进行示例演示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> ability.cov</span><br><span class="line"><span class="operator">$</span>cov <span class="comment"># 这部分为协方差矩阵</span></span><br><span class="line">        general picture  blocks   maze reading   vocab</span><br><span class="line">general  <span class="number">24.641</span>   <span class="number">5.991</span>  <span class="number">33.520</span>  <span class="number">6.023</span>  <span class="number">20.755</span>  <span class="number">29.701</span></span><br><span class="line">picture   <span class="number">5.991</span>   <span class="number">6.700</span>  <span class="number">18.137</span>  <span class="number">1.782</span>   <span class="number">4.936</span>   <span class="number">7.204</span></span><br><span class="line">blocks   <span class="number">33.520</span>  <span class="number">18.137</span> <span class="number">149.831</span> <span class="number">19.424</span>  <span class="number">31.430</span>  <span class="number">50.753</span></span><br><span class="line">maze      <span class="number">6.023</span>   <span class="number">1.782</span>  <span class="number">19.424</span> <span class="number">12.711</span>   <span class="number">4.757</span>   <span class="number">9.075</span></span><br><span class="line">reading  <span class="number">20.755</span>   <span class="number">4.936</span>  <span class="number">31.430</span>  <span class="number">4.757</span>  <span class="number">52.604</span>  <span class="number">66.762</span></span><br><span class="line">vocab    <span class="number">29.701</span>   <span class="number">7.204</span>  <span class="number">50.753</span>  <span class="number">9.075</span>  <span class="number">66.762</span> <span class="number">135.292</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>center</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>n.obs</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">112</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>ability.cov</code>数据集：</p>
<p>112个人参与了六个测验，包括非语言的普通智力测验（general）、画图测验（picture）、积木图案测验（blocks）、迷津测验（maze）、阅读测验（reading）和词汇测验（vocab）。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> options<span class="punctuation">(</span>digits <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> covariances <span class="operator">&lt;-</span> ability.cov<span class="operator">$</span>cov</span><br><span class="line"><span class="operator">&gt;</span> correlations <span class="operator">&lt;-</span> cov2cor<span class="punctuation">(</span>covariances<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> correlations</span><br><span class="line">        general picture blocks maze reading vocab</span><br><span class="line">general    <span class="number">1.00</span>    <span class="number">0.47</span>   <span class="number">0.55</span> <span class="number">0.34</span>    <span class="number">0.58</span>  <span class="number">0.51</span></span><br><span class="line">picture    <span class="number">0.47</span>    <span class="number">1.00</span>   <span class="number">0.57</span> <span class="number">0.19</span>    <span class="number">0.26</span>  <span class="number">0.24</span></span><br><span class="line">blocks     <span class="number">0.55</span>    <span class="number">0.57</span>   <span class="number">1.00</span> <span class="number">0.45</span>    <span class="number">0.35</span>  <span class="number">0.36</span></span><br><span class="line">maze       <span class="number">0.34</span>    <span class="number">0.19</span>   <span class="number">0.45</span> <span class="number">1.00</span>    <span class="number">0.18</span>  <span class="number">0.22</span></span><br><span class="line">reading    <span class="number">0.58</span>    <span class="number">0.26</span>   <span class="number">0.35</span> <span class="number">0.18</span>    <span class="number">1.00</span>  <span class="number">0.79</span></span><br><span class="line">vocab      <span class="number">0.51</span>    <span class="number">0.24</span>   <span class="number">0.36</span> <span class="number">0.22</span>    <span class="number">0.79</span>  <span class="number">1.00</span></span><br><span class="line"><span class="operator">&gt;</span> fa.parallel<span class="punctuation">(</span>correlations<span class="punctuation">,</span>fa<span class="operator">=</span><span class="string">&quot;both&quot;</span><span class="punctuation">,</span>n.obs <span class="operator">=</span> <span class="number">112</span><span class="punctuation">,</span>n.iter <span class="operator">=</span> <span class="number">100</span><span class="punctuation">)</span></span><br><span class="line">Parallel analysis suggests that the number of factors <span class="operator">=</span>  <span class="number">2</span>  and the number of components <span class="operator">=</span>  <span class="number">1</span> </span><br><span class="line">There were <span class="number">24</span> warnings <span class="punctuation">(</span>use warnings<span class="punctuation">(</span><span class="punctuation">)</span> to see them<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><code>fa.parallel</code>函数判断提取的因子数，将<code>fa</code>参数设置为<code>both</code>，表示既做主成分又做因子成分的碎石图，这是为了比较二者的区别，也可以单独设置为<code>pc</code>或<code>fa</code>。</p>
<p><img src="https://vip2.loli.io/2023/03/13/9YQZALlbXUWz8xa.png" alt="image-20220814151514520"></p>
<p>观察图中EFA的结果，显示需要提取两个因子，因子是图中三角形部分，碎石检验的前两个特征值都在拐角之上，并且大于基于100次模拟数据矩阵的特征值的均值，对于EFA，图中建议选取两个因子。接下来可以使用FA函数进行因子分析。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fa <span class="operator">&lt;-</span> fa<span class="punctuation">(</span>correlations<span class="punctuation">,</span>nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span>rotate <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span>fm<span class="operator">=</span><span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fa</span><br><span class="line">Factor Analysis using method <span class="operator">=</span>  pa</span><br><span class="line">Call<span class="operator">:</span> fa<span class="punctuation">(</span>r <span class="operator">=</span> correlations<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span> fm <span class="operator">=</span> <span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line">Standardized loadings <span class="punctuation">(</span>pattern matrix<span class="punctuation">)</span> based upon correlation matrix</span><br><span class="line">         PA1   PA2   h2    u2 com</span><br><span class="line">general <span class="number">0.75</span>  <span class="number">0.07</span> <span class="number">0.57</span> <span class="number">0.432</span> <span class="number">1.0</span></span><br><span class="line">picture <span class="number">0.52</span>  <span class="number">0.32</span> <span class="number">0.38</span> <span class="number">0.623</span> <span class="number">1.7</span></span><br><span class="line">blocks  <span class="number">0.75</span>  <span class="number">0.52</span> <span class="number">0.83</span> <span class="number">0.166</span> <span class="number">1.8</span></span><br><span class="line">maze    <span class="number">0.39</span>  <span class="number">0.22</span> <span class="number">0.20</span> <span class="number">0.798</span> <span class="number">1.6</span></span><br><span class="line">reading <span class="number">0.81</span> <span class="operator">-</span><span class="number">0.51</span> <span class="number">0.91</span> <span class="number">0.089</span> <span class="number">1.7</span></span><br><span class="line">vocab   <span class="number">0.73</span> <span class="operator">-</span><span class="number">0.39</span> <span class="number">0.69</span> <span class="number">0.313</span> <span class="number">1.5</span></span><br><span class="line"></span><br><span class="line">                       PA1  PA2</span><br><span class="line">SS loadings           <span class="number">2.75</span> <span class="number">0.83</span></span><br><span class="line">Proportion Var        <span class="number">0.46</span> <span class="number">0.14</span></span><br><span class="line">Cumulative Var        <span class="number">0.46</span> <span class="number">0.60</span> <span class="comment"># 这两个因子解决了心理学测试60%的方差</span></span><br><span class="line">Proportion Explained  <span class="number">0.77</span> <span class="number">0.23</span></span><br><span class="line">Cumulative Proportion <span class="number">0.77</span> <span class="number">1.00</span></span><br><span class="line"></span><br><span class="line">Mean item complexity <span class="operator">=</span>  <span class="number">1.5</span></span><br><span class="line">Test of the hypothesis that <span class="number">2</span> factors are sufficient.</span><br><span class="line"></span><br><span class="line">The degrees of freedom <span class="keyword">for</span> the null model are  <span class="number">15</span>  and the objective <span class="keyword">function</span> was  <span class="number">2.5</span></span><br><span class="line">The degrees of freedom <span class="keyword">for</span> the model are <span class="number">4</span>  and the objective <span class="keyword">function</span> was  <span class="number">0.07</span> </span><br><span class="line"></span><br><span class="line">The root mean square of the residuals <span class="punctuation">(</span>RMSR<span class="punctuation">)</span> is  <span class="number">0.03</span> </span><br><span class="line">The df corrected root mean square of the residuals is  <span class="number">0.06</span> </span><br><span class="line"></span><br><span class="line">Fit based upon off diagonal values <span class="operator">=</span> <span class="number">0.99</span></span><br><span class="line">Measures of factor score adequacy             </span><br><span class="line">                                                   PA1  PA2</span><br><span class="line">Correlation of <span class="punctuation">(</span>regression<span class="punctuation">)</span> scores with factors   <span class="number">0.96</span> <span class="number">0.92</span></span><br><span class="line">Multiple R square of scores with factors          <span class="number">0.93</span> <span class="number">0.84</span></span><br><span class="line">Minimum correlation of possible factor scores     <span class="number">0.86</span> <span class="number">0.68</span></span><br></pre></td></tr></table></figure>
<p><code>fa</code>函数用法如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fa<span class="punctuation">(</span>r<span class="punctuation">,</span>nfactors<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>n.obs <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span>n.iter<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> rotate<span class="operator">=</span><span class="string">&quot;oblimin&quot;</span><span class="punctuation">,</span> scores<span class="operator">=</span><span class="string">&quot;regression&quot;</span><span class="punctuation">,</span> </span><br><span class="line">residuals<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span> SMC<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> covar<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span><span class="built_in">missing</span><span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span>impute<span class="operator">=</span><span class="string">&quot;median&quot;</span><span class="punctuation">,</span></span><br><span class="line">min.err <span class="operator">=</span> <span class="number">0.001</span><span class="punctuation">,</span>  max.iter <span class="operator">=</span> <span class="number">50</span><span class="punctuation">,</span>symmetric<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> warnings<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&quot;minres&quot;</span><span class="punctuation">,</span></span><br><span class="line"> alpha<span class="operator">=</span><span class="number">.1</span><span class="punctuation">,</span>p<span class="operator">=</span><span class="number">.05</span><span class="punctuation">,</span>oblique.scores<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span>np.obs<span class="operator">=</span><span class="literal">NULL</span><span class="punctuation">,</span>use<span class="operator">=</span><span class="string">&quot;pairwise&quot;</span><span class="punctuation">,</span>cor<span class="operator">=</span><span class="string">&quot;cor&quot;</span><span class="punctuation">,</span></span><br><span class="line"> correct<span class="operator">=</span><span class="number">.5</span><span class="punctuation">,</span>weight<span class="operator">=</span><span class="literal">NULL</span><span class="punctuation">,</span>n.rotations<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>hyper<span class="operator">=</span><span class="number">.15</span><span class="punctuation">,</span>...<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><code>r</code>是相关系数矩阵或原始数据矩阵，这里使用的是相关系数矩阵；<code>nfactors</code>设定提取的因子数；<code>n.obs</code>是观测数，也就是样本数；rotate设定旋转的方法；<code>scores</code>是是否计算因子得分，默认不计算；这些与主成分分析函数都是一致的，与PCA不同的是，提取公共因子的方法有很多，包括最大似然法、主轴迭代法、加权最小二乘法、广义加权最小二乘法和最小残差法，通过fm选项进行设置，默认使用的是极小残差法。这里选择使用主轴迭代法，将<code>fm</code>设置为<code>pa</code>。</p>
<p>这里不需要<code>summary</code>函数了，因为<code>summary</code>信息很少，都是统计信息。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fa<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Factor analysis with Call<span class="operator">:</span> fa<span class="punctuation">(</span>r <span class="operator">=</span> correlations<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span> fm <span class="operator">=</span> <span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Test of the hypothesis that <span class="number">2</span> factors are sufficient.</span><br><span class="line">The degrees of freedom <span class="keyword">for</span> the model is <span class="number">4</span>  and the objective <span class="keyword">function</span> was  <span class="number">0.07</span> </span><br><span class="line"></span><br><span class="line">The root mean square of the residuals <span class="punctuation">(</span>RMSA<span class="punctuation">)</span> is  <span class="number">0.03</span> </span><br><span class="line">The df corrected root mean square of the residuals is  <span class="number">0.06</span> </span><br></pre></td></tr></table></figure>
<p>下面介绍一下因子的旋转，和主成分旋转类似，也是希望成分载荷矩阵变为更容易解释的数学方法，可以使用正交旋转和斜交旋转两种方法。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fa.varimax <span class="operator">&lt;-</span> fa<span class="punctuation">(</span>correlations<span class="punctuation">,</span>nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span>rotate <span class="operator">=</span> <span class="string">&quot;varimax&quot;</span><span class="punctuation">,</span>fm<span class="operator">=</span><span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fa.varimax</span><br><span class="line">Factor Analysis using method <span class="operator">=</span>  pa</span><br><span class="line">Call<span class="operator">:</span> fa<span class="punctuation">(</span>r <span class="operator">=</span> correlations<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&quot;varimax&quot;</span><span class="punctuation">,</span> fm <span class="operator">=</span> <span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line">Standardized loadings <span class="punctuation">(</span>pattern matrix<span class="punctuation">)</span> based upon correlation matrix</span><br><span class="line">         PA1  PA2   h2    u2 com</span><br><span class="line">general <span class="number">0.49</span> <span class="number">0.57</span> <span class="number">0.57</span> <span class="number">0.432</span> <span class="number">2.0</span></span><br><span class="line">picture <span class="number">0.16</span> <span class="number">0.59</span> <span class="number">0.38</span> <span class="number">0.623</span> <span class="number">1.1</span></span><br><span class="line">blocks  <span class="number">0.18</span> <span class="number">0.89</span> <span class="number">0.83</span> <span class="number">0.166</span> <span class="number">1.1</span></span><br><span class="line">maze    <span class="number">0.13</span> <span class="number">0.43</span> <span class="number">0.20</span> <span class="number">0.798</span> <span class="number">1.2</span></span><br><span class="line">reading <span class="number">0.93</span> <span class="number">0.20</span> <span class="number">0.91</span> <span class="number">0.089</span> <span class="number">1.1</span></span><br><span class="line">vocab   <span class="number">0.80</span> <span class="number">0.23</span> <span class="number">0.69</span> <span class="number">0.313</span> <span class="number">1.2</span></span><br><span class="line"></span><br><span class="line">                       PA1  PA2</span><br><span class="line">SS loadings           <span class="number">1.83</span> <span class="number">1.75</span></span><br><span class="line">Proportion Var        <span class="number">0.30</span> <span class="number">0.29</span></span><br><span class="line">Cumulative Var        <span class="number">0.30</span> <span class="number">0.60</span></span><br><span class="line">Proportion Explained  <span class="number">0.51</span> <span class="number">0.49</span></span><br><span class="line">Cumulative Proportion <span class="number">0.51</span> <span class="number">1.00</span></span><br><span class="line"></span><br><span class="line">Mean item complexity <span class="operator">=</span>  <span class="number">1.3</span></span><br><span class="line">Test of the hypothesis that <span class="number">2</span> factors are sufficient.</span><br><span class="line"></span><br><span class="line">The degrees of freedom <span class="keyword">for</span> the null model are  <span class="number">15</span>  and the objective <span class="keyword">function</span> was  <span class="number">2.5</span></span><br><span class="line">The degrees of freedom <span class="keyword">for</span> the model are <span class="number">4</span>  and the objective <span class="keyword">function</span> was  <span class="number">0.07</span> </span><br><span class="line"></span><br><span class="line">The root mean square of the residuals <span class="punctuation">(</span>RMSR<span class="punctuation">)</span> is  <span class="number">0.03</span> </span><br><span class="line">The df corrected root mean square of the residuals is  <span class="number">0.06</span> </span><br><span class="line"></span><br><span class="line">Fit based upon off diagonal values <span class="operator">=</span> <span class="number">0.99</span></span><br><span class="line">Measures of factor score adequacy             </span><br><span class="line">                                                   PA1  PA2</span><br><span class="line">Correlation of <span class="punctuation">(</span>regression<span class="punctuation">)</span> scores with factors   <span class="number">0.96</span> <span class="number">0.92</span></span><br><span class="line">Multiple R square of scores with factors          <span class="number">0.91</span> <span class="number">0.85</span></span><br><span class="line">Minimum correlation of possible factor scores     <span class="number">0.82</span> <span class="number">0.71</span></span><br></pre></td></tr></table></figure>
<p><code>reading</code>和<code>vocab</code>在第一因子上载荷较大，画图、积木和迷宫在第二因子上载荷较大，非语言的普通智力测试在两个因子上载荷较为平均，这表明存在一个语言智力因子和一个非语言的智力因子，使用正交旋转将人为地强制两个因子不相关，如果想允许两个因子相关，可以使用斜交旋转法</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fa.promax <span class="operator">&lt;-</span> fa<span class="punctuation">(</span>correlations<span class="punctuation">,</span>nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span>rotate <span class="operator">=</span> <span class="string">&quot;promax&quot;</span><span class="punctuation">,</span>fm<span class="operator">=</span><span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fa.promax</span><br><span class="line">Factor Analysis using method <span class="operator">=</span>  pa</span><br><span class="line">Call<span class="operator">:</span> fa<span class="punctuation">(</span>r <span class="operator">=</span> correlations<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&quot;promax&quot;</span><span class="punctuation">,</span> fm <span class="operator">=</span> <span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line">Standardized loadings <span class="punctuation">(</span>pattern matrix<span class="punctuation">)</span> based upon correlation matrix</span><br><span class="line">          PA1   PA2   h2    u2 com</span><br><span class="line">general  <span class="number">0.37</span>  <span class="number">0.48</span> <span class="number">0.57</span> <span class="number">0.432</span> <span class="number">1.9</span></span><br><span class="line">picture <span class="operator">-</span><span class="number">0.03</span>  <span class="number">0.63</span> <span class="number">0.38</span> <span class="number">0.623</span> <span class="number">1.0</span></span><br><span class="line">blocks  <span class="operator">-</span><span class="number">0.10</span>  <span class="number">0.97</span> <span class="number">0.83</span> <span class="number">0.166</span> <span class="number">1.0</span></span><br><span class="line">maze     <span class="number">0.00</span>  <span class="number">0.45</span> <span class="number">0.20</span> <span class="number">0.798</span> <span class="number">1.0</span></span><br><span class="line">reading  <span class="number">1.00</span> <span class="operator">-</span><span class="number">0.09</span> <span class="number">0.91</span> <span class="number">0.089</span> <span class="number">1.0</span></span><br><span class="line">vocab    <span class="number">0.84</span> <span class="operator">-</span><span class="number">0.01</span> <span class="number">0.69</span> <span class="number">0.313</span> <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">                       PA1  PA2</span><br><span class="line">SS loadings           <span class="number">1.83</span> <span class="number">1.75</span></span><br><span class="line">Proportion Var        <span class="number">0.30</span> <span class="number">0.29</span></span><br><span class="line">Cumulative Var        <span class="number">0.30</span> <span class="number">0.60</span></span><br><span class="line">Proportion Explained  <span class="number">0.51</span> <span class="number">0.49</span></span><br><span class="line">Cumulative Proportion <span class="number">0.51</span> <span class="number">1.00</span></span><br><span class="line"></span><br><span class="line"> With factor correlations of </span><br><span class="line">     PA1  PA2</span><br><span class="line">PA1 <span class="number">1.00</span> <span class="number">0.55</span></span><br><span class="line">PA2 <span class="number">0.55</span> <span class="number">1.00</span></span><br><span class="line"></span><br><span class="line">Mean item complexity <span class="operator">=</span>  <span class="number">1.2</span></span><br><span class="line">Test of the hypothesis that <span class="number">2</span> factors are sufficient.</span><br><span class="line"></span><br><span class="line">The degrees of freedom <span class="keyword">for</span> the null model are  <span class="number">15</span>  and the objective <span class="keyword">function</span> was  <span class="number">2.5</span></span><br><span class="line">The degrees of freedom <span class="keyword">for</span> the model are <span class="number">4</span>  and the objective <span class="keyword">function</span> was  <span class="number">0.07</span> </span><br><span class="line"></span><br><span class="line">The root mean square of the residuals <span class="punctuation">(</span>RMSR<span class="punctuation">)</span> is  <span class="number">0.03</span> </span><br><span class="line">The df corrected root mean square of the residuals is  <span class="number">0.06</span> </span><br><span class="line"></span><br><span class="line">Fit based upon off diagonal values <span class="operator">=</span> <span class="number">0.99</span></span><br><span class="line">Measures of factor score adequacy             </span><br><span class="line">                                                   PA1  PA2</span><br><span class="line">Correlation of <span class="punctuation">(</span>regression<span class="punctuation">)</span> scores with factors   <span class="number">0.97</span> <span class="number">0.94</span></span><br><span class="line">Multiple R square of scores with factors          <span class="number">0.93</span> <span class="number">0.88</span></span><br><span class="line">Minimum correlation of possible factor scores     <span class="number">0.86</span> <span class="number">0.77</span></span><br></pre></td></tr></table></figure>
<p>上述为斜交旋转的结果，根据以上结果可以看出正交旋转和斜交旋转的不同之处，对于正交旋转，因子分析的重点在于因子结构矩阵，而对于斜交旋转，因子分析会考虑三个矩阵：因子结构矩阵、因子模式矩阵和因子关联矩阵。因子模式矩阵即标准化后的回归系数矩阵，它列出因子预测变量的权重，因子关联矩阵也就是因子相关系数矩阵，使用<code>factor.plot</code>或<code>fa.diagram</code>函数可以绘制正交或斜交结果的图形。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> factor.plot<span class="punctuation">(</span>fa.promax<span class="punctuation">,</span>labels <span class="operator">=</span> rownames<span class="punctuation">(</span>fa.promax<span class="operator">$</span>loadings<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/peXbQlAZJHLwuf9.png" alt="image-20220814161156165"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fa.diagram<span class="punctuation">(</span>fa.varimax<span class="punctuation">,</span>simple <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://vip2.loli.io/2023/03/13/FqSybl32N7ijeJM.png" alt="image-20220814161317747"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fa <span class="operator">&lt;-</span> fa<span class="punctuation">(</span>correlations<span class="punctuation">,</span>nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span>rotate <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span>fm<span class="operator">=</span><span class="string">&quot;pa&quot;</span><span class="punctuation">,</span>score <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fa<span class="operator">$</span>weights</span><br><span class="line">          PA1     PA2</span><br><span class="line">general <span class="number">0.162</span>  <span class="number">0.1428</span></span><br><span class="line">picture <span class="number">0.061</span>  <span class="number">0.0754</span></span><br><span class="line">blocks  <span class="number">0.407</span>  <span class="number">0.7099</span></span><br><span class="line">maze    <span class="number">0.035</span>  <span class="number">0.0086</span></span><br><span class="line">reading <span class="number">0.452</span> <span class="operator">-</span><span class="number">0.7447</span></span><br><span class="line">vocab   <span class="number">0.123</span> <span class="operator">-</span><span class="number">0.1468</span></span><br></pre></td></tr></table></figure>
<p>在<code>fa</code>函数中如果添加<code>score=TRUE</code>选项，就可以计算因子得分，另外还可以得到得分系数。得分在返回对象的<code>weights</code>元素中。</p>
<h3 id="7-5-购物篮分析">7.5 购物篮分析</h3>
<p>有个经典的故事：啤酒和尿布</p>
<p>这里使用<code>arules</code>包中的<code>apriori</code>函数进行建模，这个函数相当于<code>lm</code>和<code>aov</code>函数。</p>
<p>这里使用<code>Groceries</code>数据集，<code>Groceries</code>就是购物篮的意思，里面统计顾客购物篮中的商品。<code>Groceries</code>数据集的属性和其他数据集不同，没有办法打印出来。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> apriori<span class="punctuation">(</span>Groceries<span class="punctuation">,</span>parameter <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>support<span class="operator">=</span><span class="number">0.01</span><span class="punctuation">,</span>confidence<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 最小支持度为0.01，最小置信度为50%</span></span><br><span class="line">Apriori</span><br><span class="line"></span><br><span class="line">Parameter specification<span class="operator">:</span></span><br><span class="line"> confidence minval smax arem  aval originalSupport maxtime support minlen maxlen target  ext</span><br><span class="line">        <span class="number">0.5</span>    <span class="number">0.1</span>    <span class="number">1</span> none <span class="literal">FALSE</span>            <span class="literal">TRUE</span>       <span class="number">5</span>    <span class="number">0.01</span>      <span class="number">1</span>     <span class="number">10</span>  rules <span class="literal">TRUE</span></span><br><span class="line"></span><br><span class="line">Algorithmic control<span class="operator">:</span></span><br><span class="line"> filter tree heap memopt load sort verbose</span><br><span class="line">    <span class="number">0.1</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span>  <span class="literal">FALSE</span> <span class="literal">TRUE</span>    <span class="number">2</span>    <span class="literal">TRUE</span></span><br><span class="line"></span><br><span class="line">Absolute minimum support count<span class="operator">:</span> <span class="number">98</span> </span><br><span class="line"></span><br><span class="line">set item appearances ...<span class="punctuation">[</span><span class="number">0</span> item<span class="punctuation">(</span>s<span class="punctuation">)</span><span class="punctuation">]</span> done <span class="punctuation">[</span><span class="number">0.00</span>s<span class="punctuation">]</span>.</span><br><span class="line">set transactions ...<span class="punctuation">[</span><span class="number">169</span> item<span class="punctuation">(</span>s<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">9835</span> transaction<span class="punctuation">(</span>s<span class="punctuation">)</span><span class="punctuation">]</span> done <span class="punctuation">[</span><span class="number">0.00</span>s<span class="punctuation">]</span>.</span><br><span class="line">sorting and recoding items ... <span class="punctuation">[</span><span class="number">88</span> item<span class="punctuation">(</span>s<span class="punctuation">)</span><span class="punctuation">]</span> done <span class="punctuation">[</span><span class="number">0.00</span>s<span class="punctuation">]</span>.</span><br><span class="line">creating transaction tree ... done <span class="punctuation">[</span><span class="number">0.00</span>s<span class="punctuation">]</span>.</span><br><span class="line">checking subsets of size <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> done <span class="punctuation">[</span><span class="number">0.00</span>s<span class="punctuation">]</span>.</span><br><span class="line">writing ... <span class="punctuation">[</span><span class="number">15</span> rule<span class="punctuation">(</span>s<span class="punctuation">)</span><span class="punctuation">]</span> done <span class="punctuation">[</span><span class="number">0.00</span>s<span class="punctuation">]</span>.</span><br><span class="line">creating S4 object  ... done <span class="punctuation">[</span><span class="number">0.00</span>s<span class="punctuation">]</span>.</span><br><span class="line"><span class="operator">&gt;</span> fit</span><br><span class="line">set of <span class="number">15</span> rules </span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span> <span class="comment"># 不明显，都是统计的信息，还需要inspect函数统计具体的结果</span></span><br><span class="line">set of <span class="number">15</span> rules</span><br><span class="line"></span><br><span class="line">rule <span class="built_in">length</span> distribution <span class="punctuation">(</span>lhs <span class="operator">+</span> rhs<span class="punctuation">)</span><span class="operator">:</span>sizes</span><br><span class="line"> <span class="number">3</span> </span><br><span class="line"><span class="number">15</span> </span><br><span class="line"></span><br><span class="line">   Min. <span class="number">1</span>st Qu.  Median    Mean <span class="number">3</span>rd Qu.    Max. </span><br><span class="line">      <span class="number">3</span>       <span class="number">3</span>       <span class="number">3</span>       <span class="number">3</span>       <span class="number">3</span>       <span class="number">3</span> </span><br><span class="line"></span><br><span class="line">summary of quality measures<span class="operator">:</span></span><br><span class="line">    support         confidence      coverage          lift          count    </span><br><span class="line"> Min.   <span class="operator">:</span><span class="number">0.0101</span>   Min.   <span class="operator">:</span><span class="number">0.50</span>   Min.   <span class="operator">:</span><span class="number">0.017</span>   Min.   <span class="operator">:</span><span class="number">1.98</span>   Min.   <span class="operator">:</span> <span class="number">99</span>  </span><br><span class="line"> <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">0.0117</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">0.52</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">0.021</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">2.04</span>   <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">116</span>  </span><br><span class="line"> Median <span class="operator">:</span><span class="number">0.0123</span>   Median <span class="operator">:</span><span class="number">0.52</span>   Median <span class="operator">:</span><span class="number">0.024</span>   Median <span class="operator">:</span><span class="number">2.20</span>   Median <span class="operator">:</span><span class="number">121</span>  </span><br><span class="line"> Mean   <span class="operator">:</span><span class="number">0.0132</span>   Mean   <span class="operator">:</span><span class="number">0.54</span>   Mean   <span class="operator">:</span><span class="number">0.025</span>   Mean   <span class="operator">:</span><span class="number">2.30</span>   Mean   <span class="operator">:</span><span class="number">129</span>  </span><br><span class="line"> <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">0.0140</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">0.57</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">0.026</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">2.43</span>   <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">138</span>  </span><br><span class="line"> Max.   <span class="operator">:</span><span class="number">0.0223</span>   Max.   <span class="operator">:</span><span class="number">0.59</span>   Max.   <span class="operator">:</span><span class="number">0.043</span>   Max.   <span class="operator">:</span><span class="number">3.03</span>   Max.   <span class="operator">:</span><span class="number">219</span>  </span><br><span class="line"></span><br><span class="line">mining info<span class="operator">:</span></span><br><span class="line">      data ntransactions support confidence</span><br><span class="line"> Groceries          <span class="number">9835</span>    <span class="number">0.01</span>        <span class="number">0.5</span></span><br><span class="line">                                                                          <span class="built_in">call</span></span><br><span class="line"> apriori<span class="punctuation">(</span>data <span class="operator">=</span> Groceries<span class="punctuation">,</span> parameter <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>support <span class="operator">=</span> <span class="number">0.01</span><span class="punctuation">,</span> confidence <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> inspect<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">     lhs                                       rhs                support confidence coverage lift count</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="punctuation">&#123;</span>curd<span class="punctuation">,</span> yogurt<span class="punctuation">&#125;</span>                         <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>whole milk<span class="punctuation">&#125;</span>       <span class="number">0.010</span>   <span class="number">0.58</span>       <span class="number">0.017</span>    <span class="number">2.3</span>   <span class="number">99</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span>  <span class="punctuation">&#123;</span>other vegetables<span class="punctuation">,</span> butter<span class="punctuation">&#125;</span>             <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>whole milk<span class="punctuation">&#125;</span>       <span class="number">0.011</span>   <span class="number">0.57</span>       <span class="number">0.020</span>    <span class="number">2.2</span>  <span class="number">113</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">]</span>  <span class="punctuation">&#123;</span>other vegetables<span class="punctuation">,</span> domestic eggs<span class="punctuation">&#125;</span>      <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>whole milk<span class="punctuation">&#125;</span>       <span class="number">0.012</span>   <span class="number">0.55</span>       <span class="number">0.022</span>    <span class="number">2.2</span>  <span class="number">121</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">]</span>  <span class="punctuation">&#123;</span>yogurt<span class="punctuation">,</span> whipped<span class="operator">/</span>sour cream<span class="punctuation">&#125;</span>           <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>whole milk<span class="punctuation">&#125;</span>       <span class="number">0.011</span>   <span class="number">0.52</span>       <span class="number">0.021</span>    <span class="number">2.1</span>  <span class="number">107</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">5</span><span class="punctuation">]</span>  <span class="punctuation">&#123;</span>other vegetables<span class="punctuation">,</span> whipped<span class="operator">/</span>sour cream<span class="punctuation">&#125;</span> <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>whole milk<span class="punctuation">&#125;</span>       <span class="number">0.015</span>   <span class="number">0.51</span>       <span class="number">0.029</span>    <span class="number">2.0</span>  <span class="number">144</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">6</span><span class="punctuation">]</span>  <span class="punctuation">&#123;</span>pip fruit<span class="punctuation">,</span> other vegetables<span class="punctuation">&#125;</span>          <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>whole milk<span class="punctuation">&#125;</span>       <span class="number">0.014</span>   <span class="number">0.52</span>       <span class="number">0.026</span>    <span class="number">2.0</span>  <span class="number">133</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">7</span><span class="punctuation">]</span>  <span class="punctuation">&#123;</span>citrus fruit<span class="punctuation">,</span> root vegetables<span class="punctuation">&#125;</span>        <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>other vegetables<span class="punctuation">&#125;</span> <span class="number">0.010</span>   <span class="number">0.59</span>       <span class="number">0.018</span>    <span class="number">3.0</span>  <span class="number">102</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">8</span><span class="punctuation">]</span>  <span class="punctuation">&#123;</span>tropical fruit<span class="punctuation">,</span> root vegetables<span class="punctuation">&#125;</span>      <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>other vegetables<span class="punctuation">&#125;</span> <span class="number">0.012</span>   <span class="number">0.58</span>       <span class="number">0.021</span>    <span class="number">3.0</span>  <span class="number">121</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">9</span><span class="punctuation">]</span>  <span class="punctuation">&#123;</span>tropical fruit<span class="punctuation">,</span> root vegetables<span class="punctuation">&#125;</span>      <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>whole milk<span class="punctuation">&#125;</span>       <span class="number">0.012</span>   <span class="number">0.57</span>       <span class="number">0.021</span>    <span class="number">2.2</span>  <span class="number">118</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="punctuation">&#123;</span>tropical fruit<span class="punctuation">,</span> yogurt<span class="punctuation">&#125;</span>               <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>whole milk<span class="punctuation">&#125;</span>       <span class="number">0.015</span>   <span class="number">0.52</span>       <span class="number">0.029</span>    <span class="number">2.0</span>  <span class="number">149</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">11</span><span class="punctuation">]</span> <span class="punctuation">&#123;</span>root vegetables<span class="punctuation">,</span> yogurt<span class="punctuation">&#125;</span>              <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>other vegetables<span class="punctuation">&#125;</span> <span class="number">0.013</span>   <span class="number">0.50</span>       <span class="number">0.026</span>    <span class="number">2.6</span>  <span class="number">127</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">12</span><span class="punctuation">]</span> <span class="punctuation">&#123;</span>root vegetables<span class="punctuation">,</span> yogurt<span class="punctuation">&#125;</span>              <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>whole milk<span class="punctuation">&#125;</span>       <span class="number">0.015</span>   <span class="number">0.56</span>       <span class="number">0.026</span>    <span class="number">2.2</span>  <span class="number">143</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">13</span><span class="punctuation">]</span> <span class="punctuation">&#123;</span>root vegetables<span class="punctuation">,</span> rolls<span class="operator">/</span>buns<span class="punctuation">&#125;</span>          <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>other vegetables<span class="punctuation">&#125;</span> <span class="number">0.012</span>   <span class="number">0.50</span>       <span class="number">0.024</span>    <span class="number">2.6</span>  <span class="number">120</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">14</span><span class="punctuation">]</span> <span class="punctuation">&#123;</span>root vegetables<span class="punctuation">,</span> rolls<span class="operator">/</span>buns<span class="punctuation">&#125;</span>          <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>whole milk<span class="punctuation">&#125;</span>       <span class="number">0.013</span>   <span class="number">0.52</span>       <span class="number">0.024</span>    <span class="number">2.0</span>  <span class="number">125</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">15</span><span class="punctuation">]</span> <span class="punctuation">&#123;</span>other vegetables<span class="punctuation">,</span> yogurt<span class="punctuation">&#125;</span>             <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">&#123;</span>whole milk<span class="punctuation">&#125;</span>       <span class="number">0.022</span>   <span class="number">0.51</span>       <span class="number">0.043</span>    <span class="number">2.0</span>  <span class="number">219</span>  </span><br></pre></td></tr></table></figure>
<p>如果购物篮里有<code>curd</code>和<code>yogurt</code>，就一定有<code>milk</code>，这个支持度达到了1%，置信度达到了58%。</p>
<p><code>confidence</code>为置信度，<code>lift</code>类似于相关系数，当<code>lift=1</code>时，表明两个关系并不大，值越大表明相关关系越大，通过这个结果，建议将这些乳制品放一起。</p>
<h2 id="附录-R内置数据集">附录 R内置数据集</h2>
<p><strong>向量</strong></p>
<p>euro	#欧元率，长度为11，每个元素都有命名</p>
<p>landmasses	#48个陆地的面积，每个都有命名</p>
<p>precip	#长度为70的命名向量</p>
<p>rivers	#北美141条河流长度</p>
<p>state.abb	#美国50个州的双字母缩写</p>
<p><strong>state.area	#美国50个州的面积</strong></p>
<p><a target="_blank" rel="noopener" href="http://state.name">state.name</a>	#美国50个州怕的全称</p>
<p><strong>因子</strong></p>
<p><strong>state.division	#美国50个州的分类，9个类别</strong></p>
<p><strong>state.region	#美国50个州的地理分类</strong></p>
<p><strong>矩阵、数组</strong></p>
<p>euro.cross	#11种货币的汇率矩阵</p>
<p>freeny.x	#每个季度影响收入四个因素的记录</p>
<p><strong>state.x77	#美国50个州的八个指标</strong></p>
<p>USPersonalExpenditure	#5个年份在5个消费方向的数据</p>
<p>VADeaths	#1940年弗吉尼亚州死亡率（每千人）</p>
<p>volcano	#某火山区的地理信息（10米×10米的网格）</p>
<p>WorldPhones	#8个区域在7个年份的电话总数</p>
<p><strong>iris3	#3种鸢尾花形态数据</strong></p>
<p>Titanic	#泰坦尼克乘员统计</p>
<p>UCBAdmissions	#伯克利分校1973年院系、录取和性别的频数</p>
<p>crimtab	#3000个男性罪犯左手中指长度和身高关系</p>
<p>HairEyeColor	#592人头发颜色、眼睛颜色和性别的频数</p>
<p>occupationalStatus	#英国男性父子职业联系</p>
<p><strong>类矩阵</strong></p>
<p>eurodist	#欧洲12个城市的距离矩阵，只有下三角部分</p>
<p>Harman23.cor	#305个女孩八个形态指标的相关系数矩阵</p>
<p>Harman74.cor	#145个儿童24个心理指标的相关系数矩阵</p>
<p><strong>数据框</strong></p>
<p>airquality	#纽约1973年5-9月每日空气质量</p>
<p>anscombe	#四组x-y数据，虽有相似的统计量，但实际数据差别较大</p>
<p>attenu	#多个观测站对加利福尼亚23次地震的观测数据</p>
<p>attitude	#30个部门在七个方面的调查结果，调查结果是同一部门35个职员赞成的百分比</p>
<p>beaver1	#一只海狸每10分钟的体温数据，共114条数据</p>
<p>beaver2	#另一只海狸每10分钟的体温数据，共100条数据</p>
<p>BOD	#随水质的提高，生化反应对氧的需求（mg/l）随时间（天）的变化</p>
<p>cars	#1920年代汽车速度对刹车距离的影响</p>
<p>chickwts	#不同饮食种类对小鸡生长速度的影响</p>
<p>esoph	#法国的一个食管癌病例对照研究</p>
<p>faithful	#一个间歇泉的爆发时间和持续时间</p>
<p>Formaldehyde	#两种方法测定甲醛浓度时分光光度计的读数</p>
<p>Freeny	#每季度收入和其他四因素的记录</p>
<p>dating from	#配对的病例对照数据，用于条件logistic回归</p>
<p>InsectSprays	#使用不同杀虫剂时昆虫数目</p>
<p><strong>iris	#3种鸢尾花形态数据</strong></p>
<p>LifeCycleSavings	#50个国家的存款率</p>
<p>longley	#强共线性的宏观经济数据</p>
<p>morley	#光速测量试验数据</p>
<p><strong>mtcars	#32辆汽车在11个指标上的数据</strong></p>
<p>OrchardSprays	#使用拉丁方设计研究不同喷雾剂对蜜蜂的影响</p>
<p>PlantGrowth	#三种处理方式对植物产量的影响</p>
<p>pressure	#温度和气压</p>
<p>Puromycin	#两种细胞中辅因子浓度对酶促反应的影响</p>
<p>quakes	#1000次地震观测数据（震级&gt;4）</p>
<p>randu	#在VMS1.5中使用FORTRAN中的RANDU三个一组生成随机数字，共400组。 该随机数字有问题。在VMS2.0以上版本已修复。</p>
<p>rock	#48块石头的形态数据 sleep #两药物的催眠效果</p>
<p>stackloss	#化工厂将氨转为硝酸的数据 swiss #瑞士生育率和社会经济指标</p>
<p>ToothGrowth	#VC剂量和摄入方式对豚鼠牙齿的影响 trees #树木形态指标</p>
<p>USArrests	#美国50个州的四个犯罪率指标</p>
<p>USJudgeRatings	#43名律师的12个评价指标</p>
<p>warpbreaks	#织布机异常数据</p>
<p>women	#15名女性的身高和体重</p>
<p><strong>列表</strong></p>
<p>state.center	#美国50个州中心的经度和纬度</p>
<p><strong>类数据框</strong></p>
<p>ChickWeight	#饮食对鸡生长的影响</p>
<p>CO2	#耐寒植物CO2摄取的差异</p>
<p>DNase	#若干次试验中，DNase浓度和光密度的关系</p>
<p>Indometh #某药物的药物动力学数据</p>
<p>Loblolly	#火炬松的高度、年龄和种源</p>
<p>Orange #桔子树生长数据</p>
<p>Theoph	#茶碱药动学数据</p>
<p><strong>时间序列数据</strong></p>
<p><strong>airmiles	#美国1937-1960年客运里程营收（实际售出机位乘以飞行里数）</strong></p>
<p>AirPassengers	#Box &amp; Jenkins航空公司1949-1960年每月国际航线乘客数</p>
<p>austres	#澳大利亚1971-1994每季度人口数（以千为单位）</p>
<p>BJsales	#有关销售的一个时间序列</p>
<p>BJsales.lead	#前一指标的先行指标（leading indicator）</p>
<p>co2	#1959-1997年每月大气co2浓度（ppm）</p>
<p>discoveries	#1860-1959年每年巨大发现或发明的个数</p>
<p>ldeaths	#1974-1979年英国每月支气管炎、肺气肿和哮喘的死亡率</p>
<p>fdeaths	#前述死亡率的女性部分</p>
<p>mdeaths	#前述死亡率的男性部分</p>
<p>freeny.y	#每季度收入</p>
<p>JohnsonJohnson	#1960-1980年每季度Johnson &amp; Johnson股票的红利</p>
<p>LakeHuron	#1875-1972年某一湖泊水位的记录</p>
<p>lh	#黄体生成素水平，10分钟测量一次</p>
<p>lynx	#1821-1934年加拿大猞猁数据</p>
<p>nhtemp	#1912-1971年每年平均温度</p>
<p>Nile	#1871-1970尼罗河流量</p>
<p>nottem	#1920-1939每月大气温度</p>
<p><strong>presidents	#1945-1974年每季度美国总统支持率</strong></p>
<p>UKDriverDeaths	#1969-1984年每月英国司机死亡或严重伤害的数目</p>
<p>sunspot.month	#1749-1997每月太阳黑子数</p>
<p>sunspot.year	#1700-1988每年太阳黑子数</p>
<p>sunspots	#1749-1983每月太阳黑子数</p>
<p>treering	#归一化的树木年轮数据</p>
<p>UKgas	#1960-1986每月英国天然气消耗</p>
<p>USAccDeaths	#1973-1978美国每月意外死亡人数</p>
<p>uspop	#1790–1970美国每十年一次的人口总数（百万为单位）</p>
<p>WWWusage	#每分钟网络连接数</p>
<p>Seatbelts	#多变量时间序列。和UKDriverDeaths时间段相同，反映更多因素。</p>
<p>EuStockMarkets	#多变量时间序列。欧洲股市四个主要指标的每个工作日记录。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://ywwsnowboy.github.io">snowboy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://ywwsnowboy.github.io/2022/08/14/R/R%E8%AF%AD%E8%A8%80%E6%95%99%E7%A8%8B/">https://ywwsnowboy.github.io/2022/08/14/R/R%E8%AF%AD%E8%A8%80%E6%95%99%E7%A8%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://ywwsnowboy.github.io" target="_blank">既然选择了远方 便只顾风雨兼程</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/R%E8%AF%AD%E8%A8%80/">R语言</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a></div><div class="post_share"><div class="social-share" data-image="https://vip2.loli.io/2023/03/13/4lsdSBFfeuRixYV.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/09/14/Others/others/Ubuntu%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%B3%95%E6%95%99%E7%A8%8B/"><img class="prev-cover" src="https://s2.loli.net/2023/03/12/ho8u6TUk4F1drle.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Ubuntu系统安装中文输入法教程</div></div></a></div><div class="next-post pull-right"><a href="/2022/05/07/Academic/%E8%AE%BA%E6%96%87%E6%8E%92%E7%89%88/%E7%A7%91%E7%A0%94%E7%BB%98%E5%9B%BE%E4%B8%AD%E7%9A%84%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E9%97%AE%E9%A2%98/"><img class="next-cover" src="https://s2.loli.net/2023/03/12/bFwO89akHLDRcTA.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">科研绘图中的图片格式问题</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NTU2NC8zMjAzMQ=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">snowboy</div><div class="author-info__description">满招损 谦受益</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">34</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ywwsnowboy/"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ywwsnowboy" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:ywwsnowboy@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.cnblogs.com/ywwsnowboy/" target="_blank" title="Blog"><i class="fa-solid fa-cube"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到snowboy的博客, 让我们一起进步吧！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">R语言教程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#R%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80"><span class="toc-text">R语言基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-R%E8%AF%AD%E8%A8%80%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD"><span class="toc-text">1.1 R语言的基本功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-R%E5%8C%85%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-text">1.2 R包的安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-R%E5%8C%85%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">1.3 R包的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E8%8E%B7%E5%8F%96%E5%B8%AE%E5%8A%A9"><span class="toc-text">1.4 获取帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E5%86%85%E7%BD%AE%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-text">1.5 内置数据集</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">2 数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%90%91%E9%87%8F"><span class="toc-text">2.1 向量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%90%91%E9%87%8F%E7%B4%A2%E5%BC%95"><span class="toc-text">2.2 向量索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%90%91%E9%87%8F%E8%BF%90%E7%AE%97"><span class="toc-text">2.3 向量运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E7%9F%A9%E9%98%B5"><span class="toc-text">2.4 矩阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E5%88%97%E8%A1%A8"><span class="toc-text">2.5 列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-%E6%95%B0%E6%8D%AE%E6%A1%86"><span class="toc-text">2.6 数据框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-%E5%9B%A0%E5%AD%90"><span class="toc-text">2.7 因子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-8-%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE"><span class="toc-text">2.8 缺失数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-9-%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-text">2.9 字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4"><span class="toc-text">2.10 日期和时间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-11-%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF"><span class="toc-text">2.11 常见错误</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-text">3 数据基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-text">3.1 获取数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-text">3.2 读取文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="toc-text">3.3 写入文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E8%AF%BBExcel%E6%96%87%E4%BB%B6"><span class="toc-text">3.4 读Excel文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E5%86%99Excel%E6%96%87%E4%BB%B6"><span class="toc-text">3.5 写Excel文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-%E8%AF%BB%E5%86%99R%E6%A0%BC%E5%BC%8F%E6%96%87%E4%BB%B6"><span class="toc-text">3.6 读写R格式文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2"><span class="toc-text">4 数据转换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="toc-text">4.1 数据格式转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E6%95%B0%E6%8D%AE%E9%83%A8%E5%88%86%E6%8F%90%E5%8F%96"><span class="toc-text">4.2 数据部分提取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E6%95%B0%E6%8D%AE%E5%90%88%E5%B9%B6%E4%B8%8E%E5%8E%BB%E9%87%8D"><span class="toc-text">4.3 数据合并与去重</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E6%95%B0%E6%8D%AE%E7%BF%BB%E8%BD%AC"><span class="toc-text">4.4 数据翻转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-%E6%95%B0%E6%8D%AE%E6%8E%92%E5%BA%8F"><span class="toc-text">4.5 数据排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1"><span class="toc-text">4.6 数据统计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-%E6%95%B0%E6%8D%AE%E7%9A%84%E4%B8%AD%E5%BF%83%E5%8C%96%E4%B8%8E%E6%A0%87%E5%87%86%E5%8C%96"><span class="toc-text">4.7 数据的中心化与标准化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8-merge%E5%87%BD%E6%95%B0"><span class="toc-text">4.8 merge函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9-reshape2%E5%8C%85"><span class="toc-text">4.9 reshape2包</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-9-1-melt%E5%87%BD%E6%95%B0"><span class="toc-text">4.9.1 melt函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-10-tidyr%E5%8C%85"><span class="toc-text">4.10 tidyr包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-11-dplyr%E5%8C%85"><span class="toc-text">4.11 dplyr包</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-R%E5%87%BD%E6%95%B0"><span class="toc-text">5 R函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E9%80%89%E9%A1%B9%E5%8F%82%E6%95%B0"><span class="toc-text">5.1 选项参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%95%B0%E5%AD%A6%E7%BB%9F%E8%AE%A1%E5%87%BD%E6%95%B0"><span class="toc-text">5.2 数学统计函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%8F%8F%E8%BF%B0%E6%80%A7%E7%BB%9F%E8%AE%A1%E5%87%BD%E6%95%B0"><span class="toc-text">5.3 描述性统计函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-1-%E6%95%B4%E4%BD%93%E6%8F%8F%E8%BF%B0%E5%87%BD%E6%95%B0"><span class="toc-text">5.3.1 整体描述函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-2-%E5%88%86%E7%BB%84%E6%8F%8F%E8%BF%B0%E5%87%BD%E6%95%B0"><span class="toc-text">5.3.2 分组描述函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E9%A2%91%E6%95%B0%E7%BB%9F%E8%AE%A1%E5%87%BD%E6%95%B0"><span class="toc-text">5.4 频数统计函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E7%8B%AC%E7%AB%8B%E6%80%A7%E6%A3%80%E9%AA%8C%E5%87%BD%E6%95%B0"><span class="toc-text">5.5 独立性检验函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-%E7%9B%B8%E5%85%B3%E6%80%A7%E5%88%86%E6%9E%90%E5%87%BD%E6%95%B0"><span class="toc-text">5.6 相关性分析函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-%E7%9B%B8%E5%85%B3%E6%80%A7%E6%A3%80%E9%AA%8C%E5%87%BD%E6%95%B0"><span class="toc-text">5.7 相关性检验函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-8-%E7%BB%98%E5%9B%BE%E5%87%BD%E6%95%B0"><span class="toc-text">5.8 绘图函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-9-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-text">5.9 自定义函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98"><span class="toc-text">6 数据分析实战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E4%B8%80"><span class="toc-text">6.1 线性回归一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E4%BA%8C"><span class="toc-text">6.2 线性回归二</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E5%A4%9A%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92"><span class="toc-text">6.3 多元线性回归</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E5%9B%9E%E5%BD%92%E8%AF%8A%E6%96%AD"><span class="toc-text">6.4 回归诊断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90%E4%B8%80"><span class="toc-text">6.5 方差分析一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6-%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90%E4%BA%8C"><span class="toc-text">6.6 方差分析二</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-1-%E5%8D%95%E5%9B%A0%E7%B4%A0%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><span class="toc-text">6.6.1 单因素方差分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-2-%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><span class="toc-text">6.6.2 协方差分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-3-%E5%8F%8C%E5%9B%A0%E7%B4%A0%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><span class="toc-text">6.6.3 双因素方差分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-4-%E5%A4%9A%E5%85%83%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><span class="toc-text">6.6.4 多元方差分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-7-%E5%8A%9F%E6%95%88%E5%88%86%E6%9E%90"><span class="toc-text">6.7 功效分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%B9%BF%E4%B9%89%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B"><span class="toc-text">7 广义线性模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%B3%8A%E6%9D%BE%E5%9B%9E%E5%BD%92"><span class="toc-text">7.1 泊松回归</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-Logistic%E5%9B%9E%E5%BD%92"><span class="toc-text">7.2 Logistic回归</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90"><span class="toc-text">7.3 主成分分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-%E5%9B%A0%E5%AD%90%E5%88%86%E6%9E%90"><span class="toc-text">7.4 因子分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-%E8%B4%AD%E7%89%A9%E7%AF%AE%E5%88%86%E6%9E%90"><span class="toc-text">7.5 购物篮分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%BD%95-R%E5%86%85%E7%BD%AE%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-text">附录 R内置数据集</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/03/14/Git/Git%20%E6%95%99%E7%A8%8B/" title="Git 教程"><img src="https://vip2.loli.io/2023/03/14/DmcyM2PXwjx6gGk.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Git 教程"/></a><div class="content"><a class="title" href="/2023/03/14/Git/Git%20%E6%95%99%E7%A8%8B/" title="Git 教程">Git 教程</a><time datetime="2023-03-14T12:16:02.000Z" title="发表于 2023-03-14 20:16:02">2023-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/11/Others/%E5%9C%A8cmd%E4%B8%AD%E4%BD%BF%E7%94%A8cygwin%E5%91%BD%E4%BB%A4/" title="在cmd中使用cygwin命令的环境配置"><img src="https://s2.loli.net/2023/03/12/YdLleNc2T4p7VGh.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="在cmd中使用cygwin命令的环境配置"/></a><div class="content"><a class="title" href="/2022/12/11/Others/%E5%9C%A8cmd%E4%B8%AD%E4%BD%BF%E7%94%A8cygwin%E5%91%BD%E4%BB%A4/" title="在cmd中使用cygwin命令的环境配置">在cmd中使用cygwin命令的环境配置</a><time datetime="2022-12-11T03:13:23.000Z" title="发表于 2022-12-11 11:13:23">2022-12-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/23/Others/Jupyter%20notebook%E6%9B%B4%E6%94%B9%E6%96%87%E4%BB%B6%E9%BB%98%E8%AE%A4%E5%9C%B0%E5%9D%80/" title="Jupyter notebook更改文件默认地址"><img src="https://s2.loli.net/2023/03/12/mwdcI1GMbQJXBjk.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Jupyter notebook更改文件默认地址"/></a><div class="content"><a class="title" href="/2022/11/23/Others/Jupyter%20notebook%E6%9B%B4%E6%94%B9%E6%96%87%E4%BB%B6%E9%BB%98%E8%AE%A4%E5%9C%B0%E5%9D%80/" title="Jupyter notebook更改文件默认地址">Jupyter notebook更改文件默认地址</a><time datetime="2022-11-23T12:27:23.000Z" title="发表于 2022-11-23 20:27:23">2022-11-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/23/Others/VMware%E5%AE%89%E8%A3%85%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%95%99%E7%A8%8B/" title="VMware安装虚拟机教程"><img src="https://s2.loli.net/2023/03/12/RtgY2UVQFjTuNhM.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="VMware安装虚拟机教程"/></a><div class="content"><a class="title" href="/2022/11/23/Others/VMware%E5%AE%89%E8%A3%85%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%95%99%E7%A8%8B/" title="VMware安装虚拟机教程">VMware安装虚拟机教程</a><time datetime="2022-11-23T12:27:23.000Z" title="发表于 2022-11-23 20:27:23">2022-11-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/19/Others/Markdown%E6%95%99%E7%A8%8B/Markdown%E6%95%99%E7%A8%8B/" title="Markdown的简介"><img src="https://s2.loli.net/2023/03/12/Wosb3C5rPyJI2jv.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Markdown的简介"/></a><div class="content"><a class="title" href="/2022/11/19/Others/Markdown%E6%95%99%E7%A8%8B/Markdown%E6%95%99%E7%A8%8B/" title="Markdown的简介">Markdown的简介</a><time datetime="2022-11-19T11:18:28.000Z" title="发表于 2022-11-19 19:18:28">2022-11-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By snowboy</div><div class="footer_custom_text">很高兴认识你, 让我们一起努力吧!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>